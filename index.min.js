!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("evp",[],t):"object"==typeof exports?exports.evp=t():e.evp=t()}(self,(()=>(()=>{var e={176:e=>{var t;self,t=()=>(()=>{var e={4593:(e,t)=>{var r,n,i,o,l,u={};r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=function(e){for(var t=0,n=[],i=0|e.length/3;0<i--;){var a=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push(r.charAt(63&a>>6)),n.push(r.charAt(63&a))}return 2==e.length-t?(a=(e[t]<<16)+(e[t+1]<<8),n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push(r.charAt(63&a>>6)),n.push("=")):1==e.length-t&&(a=e[t]<<16,n.push(r.charAt(63&a>>18)),n.push(r.charAt(63&a>>12)),n.push("==")),n.join("")},i=function(){for(var e=[],t=0;t<64;++t)e[r.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),o=function(e){for(var t=0,r=[],n=0|e.length/4;0<n--;){var a=(i[e.charCodeAt(t)]<<18)+(i[e.charCodeAt(t+1)]<<12)+(i[e.charCodeAt(t+2)]<<6)+i[e.charCodeAt(t+3)];r.push(255&a>>16),r.push(255&a>>8),r.push(255&a),t+=4}return r&&("="==e.charAt(t-2)?(r.pop(),r.pop()):"="==e.charAt(t-1)&&r.pop()),r},l={encode:function(e){for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},u.decodeArray=function(e){var t=o(e);return new Uint8Array(t)},u.encodeASCII=function(e){var t=l.encode(e);return n(t)},u.decodeASCII=function(e){var t=o(e);return l.decode(t)},u.encode=function(e){var t=function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):n<65536?(t.push(224|n>>12),t.push(128|63&n>>6),t.push(128|63&n)):(t.push(240|n>>18),t.push(128|63&n>>12),t.push(128|63&n>>6),t.push(128|63&n))}return t}(e);return n(t)},u.decode=function(e){return function(e){for(var t=[],r=0;r<e.length;){var n=e[r++];n<128||(n<224?(n=(31&n)<<6,n|=63&e[r++]):n<240?(n=(15&n)<<12,n|=(63&e[r++])<<6,n|=63&e[r++]):(n=(7&n)<<18,n|=(63&e[r++])<<12,n|=(63&e[r++])<<6,n|=63&e[r++])),t.push(String.fromCharCode(n))}return t.join("")}(o(e))},t.decode=u.decode,t.decodeArray=u.decodeArray,t.encode=u.encode,t.encodeASCII=u.encodeASCII},452:(e,t)=>{!function(e){"use strict";var t={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},r=function(e){var r=e;return t.hasOwnProperty(e)&&(r=t[e]),String.fromCharCode(r)},n=15,i=32,a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},o={17:2,18:4,21:6,22:8,23:10,19:13,20:15},s={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},l={25:2,26:4,29:6,30:8,31:10,27:13,28:15},u=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],c={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},f=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},d=function(e,t,r,n,i){this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1};d.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var h=function(e,t,r,n,i,a){this.uchar=e||" ",this.penState=new d(t,r,n,i,a)};h.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};var g=function(){this.chars=[];for(var e=0;e<i;e++)this.chars.push(new h);this.pos=0,this.currPenState=new d};g.prototype={equals:function(e){for(var t=!0,r=0;r<i;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<i;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<i;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(c.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>i&&(c.log("ERROR","Too large cursor position "+this.pos),this.pos=i)},moveCursor:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){e>=144&&this.backSpace();var t=r(e);this.pos>=i?c.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<i;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,r=0;r<i;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};var p=function(){this.rows=[];for(var e=0;e<n;e++)this.rows.push(new g);this.currRow=14,this.nrRollUpRows=null,this.reset()};p.prototype={reset:function(){for(var e=0;e<n;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,r=0;r<n;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},copy:function(e){for(var t=0;t<n;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<n;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){c.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){c.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var r=this.rows[this.currRow];if(null!==e.indent){var n=e.indent,i=Math.max(n-1,0);r.setCursor(e.indent),e.color=r.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){c.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){c.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),c.log("INFO","Rolling up")}else c.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],r="",i=-1,a=0;a<n;a++){var o=this.rows[a].getTextString();o&&(i=a+1,e?t.push("Row "+i+': "'+o+'"'):t.push(o.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},getTextAndFormat:function(){return this.rows}};var m=function(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new p,this.nonDisplayedMemory=new p,this.lastOutputScreen=new p,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};m.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,c.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";c.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(c.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){c.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){c.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){c.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){c.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){c.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){c.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){c.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){c.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){c.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){c.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){c.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(c.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,c.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){c.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}c.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=c.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};var v=function(e,t,r){this.field=e||1,this.outputs=[t,r],this.channels=[new m(1,t),new m(2,r)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};v.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var r,n,i,a=!1;this.lastTime=e,c.setTime(e);for(var o=0;o<t.length;o+=2)n=127&t[o],i=127&t[o+1],n>=16&&n<=31&&n===this.lastCmdA&&i===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,c.log("DEBUG","Repeated command ("+f([n,i])+") is dropped")):0!==n||0!==i?(c.log("DATA","["+f([t[o],t[o+1]])+"] -> ("+f([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),r||(a=this.parseChars(n,i))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(a):c.log("WARNING","No channel found yet. TEXT-MODE?")),r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,c.log("WARNING","Couldn't parse cleaned data "+f([n,i])+" orig: "+f([t[o],t[o+1]])))):this.dataCounters.padding+=2},parseCmd:function(e,t){var r;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47||(23===e||31===e)&&33<=t&&t<=35))return!1;r=20===e||21===e||23===e?1:2;var n=this.channels[r-1];return 20===e||21===e||28===e||29===e?32===t?n.cc_RCL():33===t?n.cc_BS():34===t?n.cc_AOF():35===t?n.cc_AON():36===t?n.cc_DER():37===t?n.cc_RU(2):38===t?n.cc_RU(3):39===t?n.cc_RU(4):40===t?n.cc_FON():41===t?n.cc_RDC():42===t?n.cc_TR():43===t?n.cc_RTD():44===t?n.cc_EDM():45===t?n.cc_CR():46===t?n.cc_ENM():47===t&&n.cc_EOC():n.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},parseMidrow:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currChNr)return c.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[r-1];return n.insertChars([32]),n.cc_MIDROW(t),c.log("DEBUG","MIDROW ("+f([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var r,n;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127||(16===e||24===e)&&64<=t&&t<=95))return!1;r=e<=23?1:2,n=64<=t&&t<=95?1===r?a[e]:s[e]:1===r?o[e]:l[e];var i=this.interpretPAC(n,t);return this.channels[r-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0},interpretPAC:function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},parseChars:function(e,t){var n,i=null,a=null,o=null;if(e>=25?(i=2,o=e-8):(i=1,o=e),17<=o&&o<=19?(n=17===o?t+80:18===o?t+112:t+144,c.log("INFO","Special char '"+r(n)+"' in channel "+i),a=[n],this.lastCmdA=e,this.lastCmdB=t):32<=e&&e<=127&&(a=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null),a){var s=f(a);c.log("DEBUG","Char codes =  "+s.join(","))}return a},parseBackgroundAttributes:function(e,t){var r,n,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=u[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(r),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}},e.logger=c,e.PenState=d,e.CaptionScreen=p,e.Cea608Parser=v,e.findCea608Nalus=function(e,t,r){for(var n=0,i=t,a=[],o=function(e,t,r,n){if(4!==e||t<8)return null;var i=r.getUint8(n),a=r.getUint16(n+1),o=r.getUint32(n+3),s=r.getUint8(n+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+r;){if(n=e.getUint32(i),6==(31&e.getUint8(i+4)))for(var s=i+5,l=-1;s<i+4+n-1;){l=0;for(var u=255;255===u;)l+=u=e.getUint8(s),s++;var c=0;for(u=255;255===u;)c+=u=e.getUint8(s),s++;o(l,c,e,s)&&a.push([s,c]),s+=c}i+=n+4}return a},e.extractCea608DataFromRange=function(e,t){var r=t[0],n=[[],[]];r+=8;var i=31&e.getUint8(r);r+=2;for(var a=0;a<i;a++){var o=e.getUint8(r),s=4&o,l=3&o;r++;var u=e.getUint8(r);r++;var c=e.getUint8(r);r++,s&&(127&u)+(127&c)!=0&&(0===l?(n[0].push(u),n[0].push(c)):1===l&&(n[1].push(u),n[1].push(c)))}return n}}(t)},8416:(e,t,r)=>{"use strict";var n=r(7688),i=r(5448),a=r(6398),o=r(2032),s=(r(5530),"undefined"!=typeof window&&window||r.g),l=s.dashjs;l||(l=s.dashjs={}),l.MediaPlayer=n.Z,l.FactoryMaker=i.Z,l.Debug=a.Z,l.Version=(0,o.e)()},6398:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(5595),i=r(8512),a=r(5448),o=1,s=2,l=3,u=4,c=5;function f(e){e=e||{};var t,r,a,f,d=this.context,h=(0,n.Z)(d).getInstance(),g=e.settings,p=[];function m(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function v(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[o,this].concat(t))}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[s,this].concat(t))}function E(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[l,this].concat(t))}function T(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[u,this].concat(t))}function _(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];S.apply(void 0,[c,this].concat(t))}function S(e,t){var n="",o=null;r&&(o=(new Date).getTime(),n+="["+(o-f)+"]"),a&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),n.length>0&&(n+=" ");for(var s=arguments.length,l=new Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];Array.apply(null,l).forEach((function(e){n+=e+" "})),p[e]&&g&&g.get().debug.logLevel>=e&&p[e](n),g&&g.get().debug.dispatchEvent&&h.trigger(i.Z.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:v.bind(e),error:y.bind(e),warn:E.bind(e),info:T.bind(e),debug:_.bind(e)}},setLogTimestampVisible:function(e){r=e},setCalleeNameVisible:function(e){a=e}},r=!0,a=!0,f=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(p[o]=m(window.console.error),p[s]=m(window.console.error),p[l]=m(window.console.warn),p[u]=m(window.console.info),p[c]=m(window.console.debug)),t}f.__dashjs_factory_name="Debug";var d=a.Z.getSingletonFactory(f);d.LOG_LEVEL_NONE=0,d.LOG_LEVEL_FATAL=o,d.LOG_LEVEL_ERROR=s,d.LOG_LEVEL_WARNING=l,d.LOG_LEVEL_INFO=u,d.LOG_LEVEL_DEBUG=c,a.Z.updateSingletonFactory(f.__dashjs_factory_name,d);const h=d},5595:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(8825);function a(){var e={};function t(t,r,n){var i=-1;return e[t]?(e[t].some((function(e,t){if(e&&e.callback===r&&(!n||n===e.scope))return i=t,!0})),i):i}var r={on:function(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!r)throw new Error("event type cannot be null or undefined");if(!n||"function"!=typeof n)throw new Error("listener must be a function: "+n);var o=a.priority||0;if(!(t(r,n,i)>=0)){e[r]=e[r]||[];var s={callback:n,scope:i,priority:o};i&&i.getStreamId&&(s.streamId=i.getStreamId()),i&&i.getType&&(s.mediaType=i.getType()),a&&a.mode&&(s.mode=a.mode);var l=e[r].some((function(t,n){if(t&&o>t.priority)return e[r].splice(n,0,s),!0}));l||e[r].push(s)}},off:function(r,n,i){if(r&&n&&e[r]){var a=t(r,n,i);a<0||(e[r][a]=null)}},trigger:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&e[t]){if((r=r||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");r.type=t,n.streamId&&(r.streamId=n.streamId),n.mediaType&&(r.mediaType=n.mediaType),e[t].filter((function(e){return!(!e||n.streamId&&e.streamId&&e.streamId!==n.streamId||n.mediaType&&e.mediaType&&e.mediaType!==n.mediaType||n.mode&&e.mode&&e.mode!==n.mode||!e.mode&&n.mode&&n.mode===i.Z.EVENT_MODE_ON_RECEIVE)})).forEach((function(e){return e&&e.callback.call(e.scope,r)}))}},reset:function(){e={}}};return r}a.__dashjs_factory_name="EventBus";var o=n.Z.getSingletonFactory(a);o.EVENT_PRIORITY_LOW=0,o.EVENT_PRIORITY_HIGH=5e3,n.Z.updateSingletonFactory(a.__dashjs_factory_name,o);const s=o},5448:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(){var e,t=[],r={},n={};function i(e,r){for(var n in t){var i=t[n];if(i.context===e&&i.name===r)return i.instance}return null}function a(e,t){return t[e]}function o(e,t,r){e in r&&(r[e]=t)}function s(t,r,n){var i,a=t.__dashjs_factory_name,o=r[a];if(o){var s=o.instance;if(!o.override)return s.apply({context:r,factory:e},n);for(var l in i=t.apply({context:r},n),s=s.apply({context:r,factory:e,parent:i},n))i.hasOwnProperty(l)&&(i[l]=s[l])}else i=t.apply({context:r},n);return i.getClassName=function(){return a},i}return e={extend:function(e,t,r,n){!n[e]&&t&&(n[e]={instance:t,override:r})},getSingletonInstance:i,setSingletonInstance:function(e,r,n){for(var i in t){var a=t[i];if(a.context===e&&a.name===r)return void(t[i].instance=n)}t.push({name:r,context:e,instance:n})},deleteSingletonInstances:function(e){t=t.filter((function(t){return t.context!==e}))},getSingletonFactory:function(e){var n=a(e.__dashjs_factory_name,r);return n||(n=function(r){var n;return void 0===r&&(r={}),{getInstance:function(){return n||(n=i(r,e.__dashjs_factory_name)),n||(n=s(e,r,arguments),t.push({name:e.__dashjs_factory_name,context:r,instance:n})),n}}},r[e.__dashjs_factory_name]=n),n},getSingletonFactoryByName:function(e){return a(e,r)},updateSingletonFactory:function(e,t){o(e,t,r)},getClassFactory:function(e){var t=a(e.__dashjs_factory_name,n);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return s(e,t,arguments)}}},n[e.__dashjs_factory_name]=t),t},getClassFactoryByName:function(e){return a(e,n)},updateClassFactory:function(e,t){o(e,t,n)}},e}()},1264:(e,t,r)=>{"use strict";r.d(t,{Z:()=>h});var n=r(5448),i=r(703),a=r(6398),o=r(3393),s=r(7855),l=r(5595),u=r(8512);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(){var e,t,r=this.context,n=(0,l.Z)(r).getInstance(),d={"streaming.delay.liveDelay":u.Z.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":u.Z.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX},h={debug:{logLevel:a.Z.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,parseInbandPrft:!1,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:o.Z.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:o.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:o.Z.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:o.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,fragmentRequestProgressTimeout:-1,manifestRequestTimeout:1e4,retryIntervals:(e={},f(e,s.w.MPD_TYPE,500),f(e,s.w.XLINK_EXPANSION_TYPE,500),f(e,s.w.MEDIA_SEGMENT_TYPE,1e3),f(e,s.w.INIT_SEGMENT_TYPE,1e3),f(e,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),f(e,s.w.INDEX_SEGMENT_TYPE,1e3),f(e,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),f(e,s.w.LICENSE,1e3),f(e,s.w.OTHER_TYPE,1e3),f(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},f(t,s.w.MPD_TYPE,3),f(t,s.w.XLINK_EXPANSION_TYPE,1),f(t,s.w.MEDIA_SEGMENT_TYPE,3),f(t,s.w.INIT_SEGMENT_TYPE,3),f(t,s.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),f(t,s.w.INDEX_SEGMENT_TYPE,3),f(t,s.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),f(t,s.w.LICENSE,3),f(t,s.w.OTHER_TYPE,3),f(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:o.Z.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:o.Z.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:o.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:o.Z.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},g=i.Z.clone(h);function p(e,t,r){for(var a in e)e.hasOwnProperty(a)&&(t.hasOwnProperty(a)?"object"!==c(e[a])||e[a]instanceof Array||null===e[a]?(t[a]=i.Z.clone(e[a]),d[r+a]&&n.trigger(d[r+a])):p(e[a],t[a],r.slice()+a+"."):console.error("Settings parameter "+r+a+" is not supported"))}return{get:function(){return g},update:function(e){"object"===c(e)&&p(e,g,"")},reset:function(){g=i.Z.clone(h)}}}d.__dashjs_factory_name="Settings";const h=n.Z.getSingletonFactory(d)},703:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(3875),i=r.n(n),a=r(1067);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}const s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"mixin",value:function(t,r,n){var i,a={};if(t)for(var s in r)r.hasOwnProperty(s)&&(i=r[s],s in t&&(t[s]===i||s in a&&a[s]===i)||("object"===o(t[s])&&null!==t[s]?t[s]=e.mixin(t[s],i,n):t[s]=n(i)));return t}},{key:"clone",value:function(t){if(!t||"object"!==o(t))return t;var r;if(t instanceof Array){r=[];for(var n=0,i=t.length;n<i;++n)n in t&&r.push(e.clone(t[n]))}else r={};return e.mixin(r,t,e.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(e,t){try{if(!t||0===t.length)return e;var r=new URL(e);return t.forEach((function(e){e.key&&e.value&&r.searchParams.set(e.key,e.value)})),r.href}catch(t){return e}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var r=e.trim().split("\r\n"),n=0,i=r.length;n<i;n++){var a=r[n],o=a.indexOf(": ");o>0&&(t[a.substring(0,o)]=a.substring(o+2))}return t}},{key:"generateUuid",value:function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?r:3&r|8).toString(16)}))}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}},{key:"getRelativeUrl",value:function(e,t){try{var r=new URL(e),n=new URL(t);if(r.protocol=n.protocol,r.origin!==n.origin)return t;var a=i().relative(r.pathname.substr(0,r.pathname.lastIndexOf("/")),n.pathname.substr(0,n.pathname.lastIndexOf("/"))),o=0===a.length?1:0;return a+=n.pathname.substr(n.pathname.lastIndexOf("/")+o,n.pathname.length-1),n.pathname.length<a.length?n.pathname:a}catch(e){return t}}},{key:"parseUserAgent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=null===e&&"undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";return(0,a.UAParser)(t)}catch(e){return{}}}},{key:"stringHasProtocol",value:function(e){return/(http(s?)):\/\//i.test(e)}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e,t),e}()},2032:(e,t,r)=>{"use strict";function n(){return"4.7.1"}r.d(t,{e:()=>n})},2230:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return(t=[{key:"extend",value:function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}()},4351:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}r.d(t,{Z:()=>s});const s=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=o(t);if(r){var i=o(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=n.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CMSD_STATIC_HEADER="cmsdStaticHeader",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD="serviceLocationLocationBlacklistAdd",e.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED="serviceLocationLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",e.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",e.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",e.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",e.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",e}return s}(r(8342).Z)},8512:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}r.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=o(t);if(r){var i=o(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return a(this,e)});function s(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n.apply(this,arguments)}return s}(r(4351).Z))},8342:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return(t=[{key:"extend",value:function(e,t){if(e){var r=!!t&&t.override,n=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!r||n&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}()},9326:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(3186),i=r(7855),a=r(5448),o=r(8825),s=r(7387),l=r(1553);function u(e){var t,r,a,u,c,f=(e=e||{}).eventBus,d=e.debug,h=e.urlUtils,g=e.type,p=e.streamInfo,m=e.segmentsController,v=e.timelineConverter,y=e.baseURLController;function E(){return g}function T(){a=null}function _(e,t,r){var n,i,a=y.resolve(r.path),o={};return a&&t!==a.url&&h.isRelative(t)?(n=a.url,i=a.serviceLocation,o=a.queryParams,t&&(n=h.resolve(t,n))):n=t,!h.isRelative(n)&&(e.url=n,e.serviceLocation=i,e.queryParams=o,!0)}function S(e,t){if(null==t)return null;var r=new n.Z,a=t.representation,o=a.adaptation.period.mpd.manifest.Period_asArray[a.adaptation.period.index].AdaptationSet_asArray[a.adaptation.index].Representation_asArray[a.index].bandwidth,l=t.media;return l=(0,s.vi)(l,"Number",t.replacementNumber),l=(0,s.vi)(l,"Time",t.replacementTime),l=(0,s.vi)(l,"Bandwidth",o),l=(0,s.Aj)(l,a.id),l=(0,s.eR)(l),r.mediaType=E(),r.type=i.w.MEDIA_SEGMENT_TYPE,r.range=t.mediaRange,r.startTime=t.presentationStartTime,r.mediaStartTime=t.mediaStartTime,r.duration=t.duration,r.timescale=a.timescale,r.availabilityStartTime=t.availabilityStartTime,r.availabilityEndTime=t.availabilityEndTime,r.availabilityTimeComplete=a.availabilityTimeComplete,r.wallStartTime=t.wallStartTime,r.quality=a.index,r.index=t.index,r.mediaInfo=e,r.adaptationIndex=a.adaptation.index,r.representationId=a.id,_(r,l,a)?r:void 0}function A(e,t,n){var i=null;if(!t||!t.segmentInfoType)return i;var o=m.getSegmentByTime(t,n);return o&&(a=o,r.debug("Index for time "+n+" is "+o.index),i=S(e,o)),i}function b(){r.debug("Dynamic stream complete"),c=!0}return t={initialize:function(e){u=e,c=!1,m.initialize(e)},getStreamId:function(){return p.id},getType:E,getStreamInfo:function(){return p},getInitRequest:function(e,t){return t?function(e,t,r){var a=new n.Z,o=t.adaptation.period,l=o.start;if(a.mediaType=r,a.type=i.w.INIT_SEGMENT_TYPE,a.range=t.range,a.availabilityStartTime=v.calcAvailabilityStartTimeFromPresentationTime(l,t,u),a.availabilityEndTime=v.calcAvailabilityEndTimeFromPresentationTime(l+o.duration,t,u),a.quality=t.index,a.mediaInfo=e,a.representationId=t.id,_(a,t.initialization,t))return a.url=(0,s.vi)(a.url,"Bandwidth",t.bandwidth),a}(e,t,E()):null},getSegmentRequestForTime:A,getCurrentIndex:function(){return a?a.index:-1},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;var i=a?a.index+1:0,o=m.getSegmentByIndex(t,i,a?a.mediaStartTime:-1);if(o)n=S(e,o),a=o;else{if(u&&!c)return r.debug(E()+" No segment found at index: "+i+". Wait for next loop"),null;c=!0}return n},isLastSegmentRequested:function(e,t){if(!e||!a)return!1;if(c)return!0;if(!isFinite(e.adaptation.period.duration))return!1;if(a.presentationStartTime+a.duration>t)return!1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(a.index)&&a.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!u||e.segmentInfoType===l.Z.SEGMENT_TEMPLATE)return!0;if(u&&e.segmentInfoType===l.Z.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return!0}return!!(u&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===l.Z.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&a&&!isNaN(a.mediaStartTime)&&!isNaN(a.duration)&&a.mediaStartTime+a.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},reset:function(){T(),f.off(o.Z.DYNAMIC_TO_STATIC,b,t)},getNextSegmentRequestIdempotent:function(e,t){var r=a?a.index+1:0,n=m.getSegmentByIndex(t,r,a?a.mediaStartTime:-1);return n?S(e,n):null},getValidTimeAheadOfTargetTime:function(e,t,r,n){try{if(isNaN(e)||!t||!r)return NaN;if(e<0&&(e=0),isNaN(n)&&(n=.5),A(t,r,e))return e;if(r.adaptation.period.start+r.adaptation.period.duration<e)return NaN;for(var i=isFinite(r.adaptation.period.duration)?r.adaptation.period.start+r.adaptation.period.duration:e+30,a=Math.min(e+n,i),o=NaN,s=null;a<=i;){var l=null;if(a<=i&&(l=A(t,r,a)),l){o=a,s=l;break}a+=n}if(s){var u=s.startTime+s.duration;return e>s.startTime&&u-e>n?e:!isNaN(s.startTime)&&e<s.startTime&&o>s.startTime?s.startTime+.001:Math.min(u-n,o)}return o}catch(e){return NaN}}},r=d.getLogger(t),T(),f.on(o.Z.DYNAMIC_TO_STATIC,b,t),t}u.__dashjs_factory_name="DashHandler";const c=a.Z.getClassFactory(u)},1553:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.SUPPLEMENTAL_PROPERTY_ASARRAY="SupplementalProperty_asArray",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.INBAND="inband",this.TYPE="type",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.VIEWPOINT_ASARRAY="Viewpoint_asArray",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PATCH_LOCATION_AS_ARRAY="PatchLocation_asArray",this.LOCATION="Location",this.LOCATION_AS_ARRAY="Location_asArray",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.CLIENT_REQUIREMENT="clientRequirement",this.TTL="ttl",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",PATHWAY_PRIORITY:"PATHWAY-PRIORITY",PATHWAY_CLONES:"PATHWAY-CLONES",BASE_ID:"BASE-ID",ID:"ID",URI_REPLACEMENT:"URI-REPLACEMENT",HOST:"HOST",PARAMS:"PARAMS"},this.PRODUCER_REFERENCE_TIME_TYPE={ENCODER:"encoder",CAPTURED:"captured",APPLICATION:"application"},this.SEGMENT_ALIGNMENT="segmentAlignment",this.SUB_SEGMENT_ALIGNMENT="subsegmentAlignment"}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}())},7802:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(5448),i=r(1724),a=r(3636),o=r(1736),s=r(5246);function l(e){e=e||{};var t,r,n=this.context,l=e.dashConstants,u=e.type,c=e.segmentBaseController;function f(e){return e?e.segments?r[l.SEGMENT_BASE]:r[e.segmentInfoType]:null}return t={initialize:function(t){r[l.SEGMENT_TIMELINE]=(0,i.Z)(n).create(e,t),r[l.SEGMENT_TEMPLATE]=(0,a.Z)(n).create(e,t),r[l.SEGMENT_LIST]=(0,o.Z)(n).create(e,t),r[l.SEGMENT_BASE]=(0,s.Z)(n).create(e,t)},updateInitData:function(e,t){return t?Promise.resolve():c.getSegmentBaseInitSegment({representation:e,mediaType:u})},updateSegmentData:function(e,t){return t?Promise.resolve():c.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:u})},getSegmentByIndex:function(e,t,r){var n=f(e);return n?n.getSegmentByIndex(e,t,r):null},getSegmentByTime:function(e,t){var r=f(e);return r?r.getSegmentByTime(e,t):null},getMediaFinishedInformation:function(e){var t=f(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},r={},t}l.__dashjs_factory_name="SegmentsController";const u=n.Z.getClassFactory(l)},1736:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(3393),a=r(7387);function o(e,t){var r=(e=e||{}).timelineConverter;function n(){if(!r||!r.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function o(e,i){if(n(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,s=o.SegmentURL_asArray.length,l=e&&!isNaN(e.startNumber)?e.startNumber:1,u=Math.max(l-1,0),c=Math.max(i-u,0),f=null;if(c<s){var d=o.SegmentURL_asArray[c];(f=(0,a.NF)(r,t,e,i))&&(f.replacementTime=(l+i-1)*e.segmentDuration,f.media=d.media?d.media:"",f.mediaRange=d.mediaRange,f.indexRange=d.indexRange)}return f}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(n(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=r.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var r=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,n=e&&!isNaN(e.startNumber)?e.startNumber:1,i=Math.max(n-1,0);return t.numberOfSegments=i+r.SegmentURL_asArray.length,t}}}o.__dashjs_factory_name="ListSegmentsGetter";const s=n.Z.getClassFactory(o)},5246:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(3393);function a(e){var t=(e=e||{}).timelineConverter;function r(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function n(e,t){if(r(),!e)return null;var n,i=e.segments?e.segments.length:-1;if(t<i&&(n=e.segments[t])&&n.index===t)return n;for(var a=0;a<i;a++)if((n=e.segments[a])&&n.index===t)return n;return null}return{getSegmentByIndex:n,getSegmentByTime:function(e,t){r();var i=function(e,t){if(!e)return-1;var r,n,i,a,o,s=e.segments,l=s?s.length:null,u=-1;if(s&&l>0)for(o=0;o<l;o++)if(i=(n=s[o]).presentationStartTime,t+(r=(a=n.duration)/2)>=i&&t-r<i+a){u=n.index;break}return u}(e,t);return n(e,i)},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments?(t.numberOfSegments=e.segments.length,t):t}}}a.__dashjs_factory_name="SegmentBaseGetter";const o=n.Z.getClassFactory(a)},7387:(e,t,r)=>{"use strict";r.d(t,{Aj:()=>o,NF:()=>c,TJ:()=>f,eR:()=>a,vi:()=>s});var n=r(2011);function i(e,t){for(;e.length<t;)e="0"+e;return e}function a(e){return e?e.split("$$").join("$"):e}function o(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var r=t.toString();return e.split("$RepresentationID$").join(r)}function s(e,t,r){var n,a,o,s,l,u,c=t.length;if(!e)return e;for(;;){if((n=e.indexOf("$"+t))<0)return e;if((a=e.indexOf("$",n+c))<0)return e;if((o=e.indexOf("%0",n+c))>n&&o<a)switch(s=e.charAt(a-1),l=parseInt(e.substring(o+2,a-1),10),s){case"d":case"i":case"u":u=i(r.toString(),l);break;case"x":u=i(r.toString(16),l);break;case"X":u=i(r.toString(16),l).toUpperCase();break;case"o":u=i(r.toString(8),l);break;default:return e}else u=r;e=e.substring(0,n)+u+e.substring(a+1)}}function l(e,t,r,i,a,o,s,l){var u,c=new n.Z;return c.representation=e,c.duration=t,c.presentationStartTime=r,c.mediaStartTime=i,c.availabilityStartTime=a.calcAvailabilityStartTimeFromPresentationTime(o,e,s),c.availabilityEndTime=a.calcAvailabilityEndTimeFromPresentationTime(o+t,e,s),c.wallStartTime=a.calcWallTimeForSegment(c,s),c.replacementNumber=(u=l,c.representation.startNumber+u),c.index=l,c}function u(e,t,r,n){var i=t.adaptation.period;if(isFinite(i.duration)&&i.start+i.duration<=r.presentationStartTime)return!1;if(n){if("INF"===t.availabilityTimeOffset)return!0;var a=e.getClientReferenceTime();return r.availabilityStartTime.getTime()<=a&&(!isFinite(r.availabilityEndTime)||r.availabilityEndTime.getTime()>=a)}return!0}function c(e,t,r,n){var i,a,o;i=r.segmentDuration,isNaN(i)&&(i=r.adaptation.period.duration),a=parseFloat((r.adaptation.period.start+n*i).toFixed(5)),o=parseFloat((a+i).toFixed(5));var s=l(r,i,a,e.calcMediaTimeFromPresentationTime(a,r),e,o,t,n);return u(e,r,s,t)?s:null}function f(e,t,r,n,i,a,o,c,f,d){var h,g,p=n/a,m=i/a;return h=e.calcPresentationTimeFromMediaTime(p,r),u(e,r,g=l(r,m,h,p,e,h+m,t,f),t)?(g.replacementTime=d||n,o=s(o,"Number",g.replacementNumber),o=s(o,"Time",g.replacementTime),g.media=o,g.mediaRange=c,g):null}},3636:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(3393),a=r(7387);function o(e,t){var r=(e=e||{}).timelineConverter;function n(){if(!r||!r.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.Z.MISSING_CONFIG_ERROR)}function o(e,i){if(n(),!e)return null;var o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;i=Math.max(i,0);var s=(0,a.NF)(r,t,e,i);if(s){s.replacementTime=Math.round((i-1)*e.segmentDuration*e.timescale,10);var l=o.media;l=(0,a.vi)(l,"Number",s.replacementNumber),l=(0,a.vi)(l,"Time",s.replacementTime),s.media=l}return s}return{getSegmentByIndex:o,getSegmentByTime:function(e,t){if(n(),!e)return null;var i=e.segmentDuration;if(isNaN(i))return null;var a=r.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return o(e,Math.floor(a/i))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var r=e.segmentDuration;return isNaN(r)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/r),t}}}o.__dashjs_factory_name="TemplateSegmentsGetter";const s=n.Z.getClassFactory(o)},1724:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(3393),a=r(7387);function o(e,t){var r=(e=e||{}).timelineConverter,n=e.dashMetrics;function o(){if(!r)throw new Error(i.Z.MISSING_CONFIG_ERROR)}function s(e,t){var r,n,i,a,o,s,u,c=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,f=c.SegmentTimeline,d=c.SegmentURL_asArray,h=0,g=-1;u=e.timescale;var p=!1;for(i=0,a=(r=f.S_asArray).length;i<a&&!p;i++)for(s=0,(n=r[i]).hasOwnProperty("r")&&(s=n.r),n.hasOwnProperty("t")&&(h=n.t),s<0&&(s=l(e,r[i+1],n,u,h/u)),o=0;o<=s&&!p;o++)(p=t(h,c,d,n,u,++g,i))&&(e.segmentDuration=n.d/u),h+=n.d}function l(e,t,i,a,o){var s;if(t&&t.hasOwnProperty("t"))s=t.t/a;else try{var l=0;if(isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)){var u=n.getCurrentDVRInfo();l=isNaN(u.end)?0:u.end}else l=e.adaptation.period.start+e.adaptation.period.duration;s=r.calcMediaTimeFromPresentationTime(l,e),e.segmentDuration=i.d/a}catch(e){s=0}return Math.max(Math.ceil((s-o)/(i.d/a))-1,0)}return{getSegmentByIndex:function(e,n,i){if(o(),!e)return null;var l=null,u=!1;return s(e,(function(n,o,s,c,f,d,h){if(u||i<0){var g=o.media,p=c.mediaRange;return s&&(g=s[h].media||"",p=s[h].mediaRange),l=(0,a.TJ)(r,t,e,n,c.d,f,g,p,d,c.tManifest),!0}return n>=i*f-.5*c.d&&(u=!0),!1})),l},getSegmentByTime:function(e,n){if(o(),!e)return null;void 0===n&&(n=null);var i=null,l=r.calcMediaTimeFromPresentationTime(n,e);return s(e,(function(n,o,s,u,c,f,d){var h=parseFloat((l*c).toPrecision(15));if(h<n+u.d&&h>=n){var g=o.media,p=u.mediaRange;return s&&(g=s[d].media||"",p=s[d].mediaRange),i=(0,a.TJ)(r,t,e,n,u.d,c,g,p,f,u.tManifest),!0}return!1})),i},getMediaFinishedInformation:function(e){if(!e)return 0;var t,r,n,i,a,o,s,u=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,c=0,f=0,d=0;for(s=e.timescale,i=(t=u.S_asArray).length,n=0;n<i;n++)for(o=0,(r=t[n]).hasOwnProperty("r")&&(o=r.r),r.hasOwnProperty("t")&&(f=(c=r.t)/s),o<0&&(o=l(e,t[n+1],r,s,f)),a=0;a<=o;a++)d++,f=(c+=r.d)/s;return{numberOfSegments:d,mediaTimeOfLastSignaledSegment:f}}}}o.__dashjs_factory_name="TimelineSegmentsGetter";const s=n.Z.getClassFactory(o)},2011:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},2610:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},7688:(e,t,r)=>{"use strict";r.d(t,{Z:()=>Aa});var n=r(452),i=r.n(n),a=r(3393),o=r(1553),s=r(3860),l=r(5595),u=r(8512),c=r(5448),f=r(6398),d=r(8825);function h(){var e,t,r,n,i,o,c,h,g,p,m,v,y,E,T,_,S,A,b,R,I,w,D,C,N=this.context,L=(0,l.Z)(N).getInstance();function O(){x(),E=!1,p=0,m=0,_=0,w=!1,S=!0,A=!1,D=!1,b=NaN,c&&(L.off(u.Z.DATA_UPDATE_COMPLETED,Q,e),L.off(u.Z.LOADING_PROGRESS,me,e),L.off(u.Z.MANIFEST_UPDATED,Te,e),L.off(u.Z.STREAMS_COMPOSED,_e,e),L.off(d.Z.PLAYBACK_ENDED,ge,e),L.off(d.Z.STREAM_INITIALIZING,ye,e),L.off(d.Z.REPRESENTATION_SWITCH,Ee,e),L.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),X(),c.removeEventListener("canplay",J),c.removeEventListener("canplaythrough",$),c.removeEventListener("play",te),c.removeEventListener("waiting",re),c.removeEventListener("playing",ne),c.removeEventListener("pause",ie),c.removeEventListener("error",pe),c.removeEventListener("seeking",ae),c.removeEventListener("seeked",oe),c.removeEventListener("timeupdate",se),c.removeEventListener("progress",le),c.removeEventListener("ratechange",ue),c.removeEventListener("loadedmetadata",ce),c.removeEventListener("loadeddata",fe),c.removeEventListener("stalled",ve),c.removeEventListener("ended",de),c.removeEventListener("volumechange",he)),g=null,c=null,v=null,y=null}function P(){return parseFloat((M(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)-Z()).toFixed(5))}function M(e){var t=e||v;return t.start+t.duration}function k(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];v&&c&&c.getElement()?(e&&y&&B(Z()),c.play()):E=!0}function x(){v&&c&&c.pause()}function F(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];v&&c&&c.getElement()&&e!==(isNaN(b)?c.getTime():b)&&((R=!0===n)||(b=e),t.info("Requesting seek to time: "+e+(R?" (internal)":"")),y&&i&&B(e),c.setCurrentTime(e,r))}function U(){if(v&&c&&y){var e=r&&r.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=i.getCurrentDVRInfo(e);return t&&t.range?t.range.end:0}}function B(e){var t=new Date(h.getClientReferenceTime()),r=o.getRegularPeriods()[0],n=h.calcPresentationTimeFromWallTime(t,r);p=n-e}function Z(){return v&&c?c.getTime():null}function G(){return v&&c?c.isPaused():null}function K(){return v&&c?c.isSeeking():null}function H(){return v&&c?c.isStalled():null}function Y(){return v&&c?c.getPlaybackRate():null}function V(){return v&&c?c.getEnded():null}function q(){return y}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!G()&&y&&0!==c.getReadyState()&&!K()&&!w){e||(e=r.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO);var n=Z(),i=z(n,e);!isNaN(i)&&i!==n&&!K()&&(H()||I||1===c.getReadyState())&&(t.debug("UpdateCurrentTime: Seek to actual time: ".concat(i," from currentTime: ").concat(n)),F(i,!1,!1))}}function z(e,t){var r=i.getCurrentDVRInfo(t),n=r?r.range:null;return n?e>n.end?Math.max(n.end-p,n.start):e>0&&e+.25<n.start&&Math.abs(e-n.start)<31536e4?A?Math.max(n.end-p,n.start):n.start:e:NaN}function W(){null===g&&(g=setInterval((function(){var e;L.trigger(u.Z.WALLCLOCK_TIME_UPDATED,{isDynamic:y,time:new Date}),q()&&(r.addDVRMetric(),G()?(e=Date.now(),(!T||e>T+500)&&(T=e,se())):j())}),C.get().streaming.wallclockTimeUpdateInterval))}function X(){clearInterval(g),g=null}function Q(e){var t=o.convertRepresentationToRepresentationInfo(e.currentRepresentation),r=t?t.mediaInfo.streamInfo:null;null!==r&&v.id===r.id&&(v=r)}function J(){L.trigger(u.Z.CAN_PLAY)}function $(){L.trigger(u.Z.CAN_PLAY_THROUGH)}function ee(e){e.streamId===r.getActiveStreamInfo().id&&(I=e.state===s.Z.BUFFER_EMPTY,C.get().streaming.buffer.setStallState&&c.setStallState(e.mediaType,e.state===s.Z.BUFFER_EMPTY))}function te(){t.info("Native video element event: play"),j(),W(),L.trigger(u.Z.PLAYBACK_STARTED,{startTime:Z()})}function re(){t.info("Native video element event: waiting"),L.trigger(u.Z.PLAYBACK_WAITING,{playingTime:Z()})}function ne(){t.info("Native video element event: playing"),R=!1,L.trigger(u.Z.PLAYBACK_PLAYING,{playingTime:Z()})}function ie(){t.info("Native video element event: pause"),L.trigger(u.Z.PLAYBACK_PAUSED,{ended:V()})}function ae(){if(!R){var e=Z();isNaN(b)||b===e||(e=b),b=NaN,t.info("Seeking to: "+e),W(),L.trigger(u.Z.PLAYBACK_SEEKING,{seekTime:e,streamId:v.id})}}function oe(){t.info("Native video element event: seeked"),R=!1,L.trigger(u.Z.PLAYBACK_SEEKED)}function se(){v&&L.trigger(u.Z.PLAYBACK_TIME_UPDATED,{timeToEnd:P(),time:Z(),streamId:v.id})}function le(){L.trigger(u.Z.PLAYBACK_PROGRESS,{streamId:v.id})}function ue(){var e=Y();t.info("Native video element event: ratechange: ",e),L.trigger(u.Z.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function ce(){t.info("Native video element event: loadedmetadata"),L.trigger(u.Z.PLAYBACK_METADATA_LOADED),W()}function fe(){t.info("Native video element event: loadeddata"),L.trigger(u.Z.PLAYBACK_LOADED_DATA)}function de(){t.info("Native video element event: ended"),x(),X();var e=r?r.getActiveStreamInfo():null;e&&L.trigger(u.Z.PLAYBACK_ENDED,{isLast:e.isLast})}function he(){L.trigger(u.Z.PLAYBACK_VOLUME_CHANGED)}function ge(e){if(g&&e.isLast){t.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var r=e.seekTime?e.seekTime:M();c.setCurrentTime(r),x(),X()}}function pe(e){var t=e.target||e.srcElement;L.trigger(u.Z.PLAYBACK_ERROR,{error:t.error})}function me(e){if(!1===e.stream&&A&&!isNaN(e.request.duration)){var r=1.2*e.request.duration;r>p&&(t.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",r.toFixed(2)),p=r,m=r)}}function ve(e){L.trigger(u.Z.PLAYBACK_STALLED,{e})}function ye(e){var r;(r=e.mediaInfo)&&r.supplementalProperties&&"true"===r.supplementalProperties[a.Z.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]&&(t.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),A=!0)}function Ee(e){var t=r.getActiveStreamInfo();e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===a.Z.VIDEO||e.mediaType===a.Z.AUDIO)&&(S=e.currentRepresentation.availabilityTimeComplete,(A=!S)&&!D&&(D=!0))}function Te(){w=!0}function _e(){w=!1}return e={initialize:function(t,r){v=t,!0!==r&&(c.addEventListener("canplay",J),c.addEventListener("canplaythrough",$),c.addEventListener("play",te),c.addEventListener("waiting",re),c.addEventListener("playing",ne),c.addEventListener("pause",ie),c.addEventListener("error",pe),c.addEventListener("seeking",ae),c.addEventListener("seeked",oe),c.addEventListener("timeupdate",se),c.addEventListener("progress",le),c.addEventListener("ratechange",ue),c.addEventListener("loadedmetadata",ce),c.addEventListener("loadeddata",fe),c.addEventListener("stalled",ve),c.addEventListener("ended",de),c.addEventListener("volumechange",he),y=v.manifestInfo.isDynamic,I=!1,R=!1,L.on(u.Z.DATA_UPDATE_COMPLETED,Q,e),L.on(u.Z.LOADING_PROGRESS,me,e),L.on(u.Z.MANIFEST_UPDATED,Te,e),L.on(u.Z.STREAMS_COMPOSED,_e,e),L.on(d.Z.PLAYBACK_ENDED,ge,e,{priority:l.Z.EVENT_PRIORITY_HIGH}),L.on(d.Z.STREAM_INITIALIZING,ye,e),L.on(d.Z.REPRESENTATION_SWITCH,Ee,e),L.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,ee,e),E&&(E=!1,k()))},setConfig:function(e){e&&(e.streamController&&(r=e.streamController),e.serviceDescriptionController&&(n=e.serviceDescriptionController),e.dashMetrics&&(i=e.dashMetrics),e.adapter&&(o=e.adapter),e.videoModel&&(c=e.videoModel),e.timelineConverter&&(h=e.timelineConverter),e.settings&&(C=e.settings))},getTimeToStreamEnd:P,getBufferLevel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=null;return r.getActiveStreamProcessors().forEach((function(r){if(!e||0===e.length||-1===e.indexOf(r.getType())){var n=r.getBufferLevel();t=null===t?n:Math.min(t,n)}})),t},getPlaybackStalled:function(){return I},getTime:Z,getLowLatencyModeEnabled:function(){return A},getInitialCatchupModeActivated:function(){return D},getIsManifestUpdateInProgress:function(){return w},getPlaybackRate:Y,getPlayedRanges:function(){return v&&c?c.getPlayedRanges():null},getEnded:V,getIsDynamic:q,getStreamController:function(){return r},computeAndSetLiveDelay:function(e,t){var r,i,a,s=!isNaN(e)&&isFinite(e)?e:NaN,l=o.getSuggestedPresentationDelay(),u=n.getServiceDescriptionSettings();return r=isNaN(C.get().streaming.delay.liveDelay)?null===C.get().streaming.delay.liveDelayFragmentCount||isNaN(C.get().streaming.delay.liveDelayFragmentCount)||isNaN(s)?u&&!isNaN(u.liveDelay)&&u.liveDelay>0?u.liveDelay:!0===C.get().streaming.delay.useSuggestedPresentationDelay&&null!==l&&!isNaN(l)&&l>0?l:isNaN(s)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*v.manifestInfo.minBufferTime:4*s:s*C.get().streaming.delay.liveDelayFragmentCount:C.get().streaming.delay.liveDelay,null!==(a=o.getAvailabilityStartTime())&&(_=a),i=t&&t.dvrWindowSize>0?Math.min(r,t.dvrWindowSize):r,p=i,m=i,i},getLiveDelay:function(){return p},getOriginalLiveDelay:function(){return m},getCurrentLiveLatency:function(){if(!y||isNaN(_))return NaN;var e=Z();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*h.getClientTimeOffset();return Math.max(((t-_-1e3*e)/1e3).toFixed(3),0)},play:k,isPaused:G,isStalled:H,pause:x,isSeeking:K,getStreamEndTime:M,seek:F,seekToOriginalLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=U();0!==n&&F(n-(p=m),e,t,r)},seekToCurrentLive:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=U();0!==n&&F(n-p,e,t,r)},reset:O,updateCurrentTime:j,getAvailabilityStartTime:function(){return _}},t=(0,f.Z)(N).getInstance().getLogger(e),O(),e}h.__dashjs_factory_name="PlaybackController";const g=c.Z.getSingletonFactory(h);var p=r(3186),m="loading",v="executed",y="failed";function E(e){var t,r,n,i,a=(e=e||{}).eventBus,o=e.events,s=e.dashMetrics,l=e.fragmentLoader,u=e.debug,c=e.streamInfo,f=e.type;function d(e){var t;return!!e&&(t=!1,n.some((function(r){if(n=e,i=r,!isNaN(n.index)&&n.startTime===i.startTime&&n.adaptationIndex===i.adaptationIndex&&n.type===i.type||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(e,r)||function(e,t){return e.action===p.Z.ACTION_COMPLETE&&e.action===t.action}(e,r))return t=!0;var n,i})),t)}function h(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function g(e){n=n.filter((function(t){var r=h(t);return isNaN(t.startTime)||void 0!==e&&t.startTime>=e-r}))}function E(e,t){t<=e+.5||(n=n.filter((function(r){var n=h(r);return isNaN(r.startTime)||r.startTime>=t-n||isNaN(r.duration)||r.startTime+r.duration<=e+n})))}function T(e,t,r){for(var n=e.length-1;n>=0;n--){var i=e[n],a=i.startTime,o=a+i.duration;if(r=isNaN(r)?h(i):r,!isNaN(a)&&!isNaN(o)&&t+r>=a&&t-r<o||isNaN(a)&&isNaN(t))return i}return null}function _(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,i,n)}function S(e){e.sender===l&&(i.splice(i.indexOf(e.request),1),e.response&&!e.error&&n.push(e.request),_(e.request,e.error?y:v),a.trigger(o.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f}))}function A(e){e.sender===l&&a.trigger(o.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:f})}function b(e){e.sender===l&&a.trigger(o.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:f})}function R(){n=[],i=[]}return t={getStreamId:function(){return c.id},getType:function(){return f},getRequests:function(e){var t=e?e.state instanceof Array?e.state:[e.state]:[],r=[];return t.forEach((function(t){var a=function(e){var t;switch(e){case m:t=i;break;case v:t=n;break;default:t=[]}return t}(t);r=r.concat(function(e,t){return t.hasOwnProperty("time")?[T(e,t.time,t.threshold)]:e.filter((function(e){for(var r in t)if("state"!==r&&t.hasOwnProperty(r)&&e[r]!=t[r])return!1;return!0}))}(a,e))})),r},isFragmentLoaded:d,isFragmentLoadedOrPending:function(e){var t,r=!1,n=0;if(!(r=d(e)))for(n=0;n<i.length;n++)t=i[n],e.url===t.url&&e.startTime===t.startTime&&(r=!0);return r},removeExecutedRequestsBeforeTime:g,removeExecutedRequestsAfterTime:function(e){n=n.filter((function(t){return isNaN(t.startTime)||void 0!==e&&t.startTime<e}))},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var r=0,n=0,i=e.length;n<i;n++)E(r,e.start(n)),r=e.end(n);t>0&&E(r,t)}else g()},abortRequests:function(){r.debug("abort requests"),l.abort(),i=[]},executeRequest:function(e){e.action===p.Z.ACTION_DOWNLOAD?(_(e,m),i.push(e),function(e){a.trigger(o.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:f}),l.load(e)}(e)):r.warn("Unknown request action.")},reset:function(){a.off(o.LOADING_COMPLETED,S,this),a.off(o.LOADING_DATA_PROGRESS,A,this),a.off(o.LOADING_ABANDONED,b,this),l&&l.reset(),R()},resetInitialSettings:R,addExecutedRequest:function(e){n.push(e)}},r=u.getLogger(t),R(),a.on(o.LOADING_COMPLETED,S,t),a.on(o.LOADING_DATA_PROGRESS,A,t),a.on(o.LOADING_ABANDONED,b,t),t}E.__dashjs_factory_name="FragmentModel";var T=c.Z.getClassFactory(E);T.FRAGMENT_MODEL_LOADING=m,T.FRAGMENT_MODEL_EXECUTED=v,T.FRAGMENT_MODEL_CANCELED="canceled",T.FRAGMENT_MODEL_FAILED=y,c.Z.updateClassFactory(E.__dashjs_factory_name,T);const _=T;var S=r(5459);function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}const I=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=R(t);if(r){var i=R(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=n.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return i}(r(2230).Z));var w=r(1264),D=r(7855);function C(e){var t,r,n,i,o,s,l=this.context,c=(0,w.Z)(l).getInstance(),d=e.textController,h=e.eventBus,g=[],p=[],m=!1,v=e.mediaSource,y=null;function E(e){return new Promise((function(t){O((function(){i.changeType&&i.changeType(e),t()}))}))}function T(e){return i=d.getTextSourceBuffer(e),Promise.resolve()}function _(){if("function"==typeof i.addEventListener)try{i.addEventListener("updateend",N,!1),i.addEventListener("error",L,!1),i.addEventListener("abort",L,!1)}catch(e){s=setInterval(N,50)}else s=setInterval(N,50)}function A(e){return new Promise((function(t){i&&c.get().streaming.buffer.useAppendWindow?O((function(){try{if(!i)return void t();var r=v.duration,a=0;e&&!isNaN(e.start)&&!isNaN(e.duration)&&isFinite(e.duration)&&(r=e.start+e.duration),e&&!isNaN(e.start)&&(a=e.start),i.appendWindowEnd===r&&i.appendWindowStart===a||(i.appendWindowStart=0,i.appendWindowEnd=r+.01,i.appendWindowStart=Math.max(a-.1,0),n.debug("Updated append window for ".concat(o.type,". Set start to ").concat(i.appendWindowStart," and end to ").concat(i.appendWindowEnd))),t()}catch(e){n.warn("Failed to set append window"),t()}})):t()}))}function b(e){return new Promise((function(t){i?O((function(){try{i.timestampOffset===e||isNaN(e)||(i.timestampOffset=e,n.debug("Set MSE timestamp offset to ".concat(e))),t()}catch(e){t()}})):t()}))}function R(){if(!m&&p.length>0){m=!0;var e=p[0];p.splice(0,1);var t=function(){m=!1,p.length>0&&R.call(this),e&&e.data&&e.data.segmentType&&e.data.segmentType!==D.w.INIT_SEGMENT_TYPE&&delete e.data.bytes,e.promise.resolve({chunk:e.data})};try{y=e.request,0===e.data.bytes.byteLength?t.call(this):(i.appendBuffer?i.appendBuffer(e.data.bytes):i.append(e.data.bytes,e.data),O(t.bind(this)))}catch(t){n.fatal('SourceBuffer append failed "'+t+'"'),p.length>0?R():m=!1,delete e.data.bytes,e.promise.reject({chunk:e.data,error:new S.Z(t.code,t.message)})}}}function C(){g.length>0&&(i.updating||(g.shift()(),C()))}function N(){i.updating||C()}function L(e){var t,n,i=e.target||{};t=u.Z.SOURCE_BUFFER_ERROR,n={error:i,lastRequestAppended:y}||{},h.trigger(t,n,{streamId:o.streamInfo.id,mediaType:r})}function O(e){g.push(e),i.updating||C()}return t={getType:function(){return r},getAllBufferRanges:function(){try{return i.buffered}catch(e){return n.error("getAllBufferRanges exception: "+e.message),null}},getBuffer:function(){return i},append:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(n,i){e?(p.push({data:e,promise:{resolve:n,reject:i},request:r}),O(R.bind(t))):i({chunk:e,error:new S.Z(I.APPEND_ERROR_CODE,I.APPEND_ERROR_MESSAGE)})}))},remove:function(e){return new Promise((function(t,r){var n=e.start,a=e.end;n>=0&&a>n?O((function(){try{i.remove(n,a),O((function(){t({from:n,to:a,unintended:!1}),e.resolve&&e.resolve()}))}catch(t){r({from:n,to:a,unintended:!1,error:new S.Z(I.REMOVE_ERROR_CODE,I.REMOVE_ERROR_MESSAGE)}),e.reject&&e.reject(t)}})):t()}))},abort:function(){return new Promise((function(e){try{p=[],"open"===v.readyState?O((function(){try{i&&i.abort(),e()}catch(t){e()}})):i&&i.setTextTrack&&"ended"===v.readyState?(i.abort(),e()):e()}catch(t){e()}}))},reset:function(){if(i){try{g=[],function(){try{"function"==typeof i.removeEventListener&&(i.removeEventListener("updateend",N,!1),i.removeEventListener("error",L,!1),i.removeEventListener("abort",L,!1)),clearInterval(s)}catch(e){n.error(e)}}(),m=!1,p=[],i.getClassName&&"TextSourceBuffer"===i.getClassName()||(n.debug("Removing sourcebuffer from media source"),v.removeSourceBuffer(i))}catch(e){}i=null}y=null},updateTimestampOffset:b,initializeForStreamSwitch:function(e,t,n){r=(o=e).type;var a=o.codec;!function(e){i=e.getBuffer()}(n),_();var s=[];return s.push(new Promise((function(e){O((function(){var t=i.appendWindowStart,r=i.appendWindowEnd;i&&(i.abort(),i.appendWindowStart=t,i.appendWindowEnd=r),e()}))}))),s.push(A(o.streamInfo)),c.get().streaming.buffer.useChangeTypeForTrackSwitch&&s.push(E(a)),t&&void 0!==t.MSETimeOffset&&s.push(b(t.MSETimeOffset)),Promise.all(s)},initializeForFirstUse:function(e,t,n){r=(o=t).type;var s=o.codec;try{if(s.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return T(e);i=v.addSourceBuffer(s),_();var l=[];return l.push(A(o.streamInfo)),n&&void 0!==n.MSETimeOffset&&l.push(b(n.MSETimeOffset)),Promise.all(l)}catch(t){return o.type==a.Z.TEXT&&!o.isFragmented||-1!==s.indexOf('codecs="stpp')||-1!==s.indexOf('codecs="vtt')?T(e):Promise.reject(t)}},updateAppendWindow:A,changeType:E},n=(0,f.Z)(l).getInstance().getLogger(t),t}C.__dashjs_factory_name="SourceBufferSink";const N=c.Z.getClassFactory(C);function L(e){var t,r,n,i=this.context,a=[],o=e;function s(e,t){return a=a.filter((function(r){return!((isNaN(t)||r.start<t)&&(isNaN(e)||r.end>e))})),Promise.resolve()}return t={getAllBufferRanges:function(){for(var e=[],t=0;t<a.length;t++){var r=a[t];0===e.length||r.start>e[e.length-1].end?e.push({start:r.start,end:r.end}):e[e.length-1].end=r.end}var n={start:function(t){return e[t].start},end:function(t){return e[t].end}};return Object.defineProperty(n,"length",{get:function(){return e.length}}),n},append:function(e){return"InitializationSegment"!==e.segmentType?(a.push(e),a.sort((function(e,t){return e.start-t.start})),n=null):n=e,r.debug("PreBufferSink appended chunk s: "+e.start+"; e: "+e.end),o&&o({chunk:e}),Promise.resolve()},remove:s,abort:function(){return Promise.resolve()},discharge:function(e,t){var r=function(e,t){return a.filter((function(r){return(isNaN(t)||r.start<t)&&(isNaN(e)||r.end>e)}))}(e,t);return n&&(r.push(n),n=null),s(e,t),r},reset:function(){a=[],n=null,o=null},updateTimestampOffset:function(){return Promise.resolve()},waitForUpdateEnd:function(e){e()},getBuffer:function(){return this}},r=(0,f.Z)(i).getInstance().getLogger(t),t}L.__dashjs_factory_name="PreBufferSink";const O=c.Z.getClassFactory(L);function P(){var e={};return{save:function(t){var r=t.streamId,n=t.representationId;e[r]=e[r]||{},e[r][n]=t},extract:function(t,r){return e&&e[t]&&e[t][r]?e[t][r]:null},reset:function(){e={}}}}P.__dashjs_factory_name="InitCache";const M=c.Z.getSingletonFactory(P);var k=.01,x="BufferController";function F(e){e=e||{};var t,r,n,i,o,c,h,g,p,m,v,y,E,T,A,b,R,w,C,L,P,F=this.context,U=(0,l.Z)(F).getInstance(),B=e.errHandler,Z=e.fragmentModel,G=e.representationController,K=e.adapter,H=e.textController,Y=e.abrController,V=e.playbackController,q=e.streamInfo,j=e.type,z=e.settings;function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise((function(r,n){c=e,p&&t&&"function"==typeof p.discharge?(m=p,Q(t).then((function(){r()})).catch((function(e){n(e)}))):r()}))}function X(e){return K.convertRepresentationToRepresentationInfo(G.getRepresentationForQuality(e))}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((function(r,n){w&&e?c?(v=!1,J(e,t).then((function(e){r(e)})).catch((function(e){n(e)}))):(v=!0,function(){var e=this;return new Promise((function(t,r){var n=Y.getQualityFor(j,q.id);p=O(F).create(ne.bind(e)),Ee(X(n)).then((function(){t(p)})).catch((function(){r()}))}))}().then((function(e){r(e)})).catch((function(e){n(e)}))):r(null)}))}function J(e,t){return new Promise((function(n,i){var o=Y.getQualityFor(j,q.id);p=N(F).create({mediaSource:c,textController:H,eventBus:U}),function(e,t,r){var n=X(r);return t&&t[j]&&(j===a.Z.VIDEO||j===a.Z.AUDIO)?p.initializeForStreamSwitch(e,n,t[j]):p.initializeForFirstUse(q,e,n)}(e,t,o).then((function(){return Ee(X(o))})).then((function(){n(p)})).catch((function(e){r.fatal("Caught error on create SourceBuffer: "+e),B.error(new S.Z(I.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,I.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+j)),i(e)}))}))}function $(e){z.get().streaming.cacheInitSegments&&(r.info("Init fragment finished loading saving to",j+"'s init cache"),w.save(e.chunk)),r.debug("Append Init fragment",j," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),te(e.chunk)}function ee(e){te(e.chunk,e.request)}function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;p.append(e,t).then((function(e){ne(e)})).catch((function(e){ne(e)})),e.mediaInfo.type===a.Z.VIDEO&&we(u.Z.VIDEO_CHUNK_RECEIVED,{chunk:e})}function re(e){if(e&&e.length>0)for(var t=0,n=e.length;t<n;t++)r.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",V.getTime())}function ne(e){if(e.error)return 22===e.error.code&&function(){if(R=!0,o=.8*be(),r.warn("Quota exceeded, Critical Buffer: "+o),o>0){var e=Math.max(.2*o,1),t=o-e,n=Math.min(z.get().streaming.buffer.bufferTimeAtTopQuality,.9*t),i=Math.min(z.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*t),a={streaming:{buffer:{bufferToKeep:parseFloat(e.toFixed(5)),bufferTimeAtTopQuality:parseFloat(n.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(i.toFixed(5))}}};z.update(a)}}(),void(22!==e.error.code&&Ie()||(r.warn("Clearing playback buffer to overcome quota exceed situation"),we(u.Z.QUOTA_EXCEEDED,{criticalBufferLevel:o,quotaExceededTime:e.chunk.start}),me(pe())));if(p&&(ce(),R=!1,(T=e.chunk)&&T.endFragment)){T&&!isNaN(T.index)&&(h=Math.max(T.index,h),fe());var t=p.getAllBufferRanges();T.segmentType===D.w.MEDIA_SEGMENT_TYPE&&(re(t),oe(),function(){if(!isNaN(P)&&!v)if(j===a.Z.AUDIO||j===a.Z.VIDEO){var e=V.getTime(),t=ue(e,0),r=ue(P,0);if(t&&r&&t.start===r.start)P=NaN;else{var n=G.getCurrentRepresentation().segmentDuration,i=ue(P,n);i&&(z.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-P)>n?P<=i.end&&V.seek(Math.max(P,i.start),!1,!0):e<i.start&&V.seek(i.start,!1,!0))}}else P=NaN}());var n=!1;y&&(y.indexOf(T)>0&&(n=!0),y=null),T&&!n&&we(u.Z.BYTES_APPENDED_END_FRAGMENT,{quality:T.quality,startTime:T.start,index:T.index,bufferedRanges:t,segmentType:T.segmentType,mediaType:j})}}function ie(){return new Promise((function(e,t){var r=ae();if(!r||0===r.length)return oe(),void e();me(r).then((function(){e()})).catch((function(e){t(e)}))}))}function ae(e){var t=[],n=p.getAllBufferRanges();if(!n||0===n.length)return t;if(!e&&0!==e||isNaN(e))t.push({start:n.start(0),end:n.end(n.length-1)+.5});else{var i=function(e,t){var r=z.get().streaming.buffer.bufferToKeep,n=t.start(0);if(e-n>r){var i=Math.max(0,e-r),a=Z.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,time:e,threshold:k})[0];if(a&&(i=Math.min(a.startTime,i)),i>0)return{start:n,end:i}}return null}(e,n),a=function(e,t){var n=t.end(t.length-1)+.5,i=Re(e),a=q.manifestInfo.duration>=z.get().streaming.buffer.longFormContentDurationThreshold?z.get().streaming.buffer.bufferTimeAtTopQualityLongForm:z.get().streaming.buffer.bufferTimeAtTopQuality,o=isNaN(i)?e:Math.min(i,e+a);if(o>=t.end(t.length-1))return null;var s=Z.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,time:e,threshold:k})[0];if(s&&(o=Math.max(s.startTime+s.duration,o)),z.get().streaming.buffer.avoidCurrentTimeRangePruning)for(var l=0;l<t.length;l++)if(t.start(l)<=e&&e<=t.end(l)&&t.start(l)<=o&&o<=t.end(l)){var u=o;o=l+1<t.length?t.start(l+1):t.end(l)+1,r.debug("Buffered range ["+t.start(l)+", "+t.end(l)+"] overlaps with targetTime "+e+" and range to be pruned ["+u+", "+n+"], using ["+o+", "+n+"] instead"+(o<n?"":" (no actual pruning)"));break}return o<t.end(t.length-1)?{start:o,end:n}:null}(e,n);i&&t.push(i),a&&t.push(a)}return t}function oe(){(!L||j===a.Z.TEXT&&H.isTextEnabled())&&ce()}function se(){de()}function le(){de(),P=NaN}function ue(e,t){var r,n,i=p.getAllBufferRanges(),a=0,o=0,s=null,l=null,u=0,c=isNaN(t)?.15:t;if(null!=i){for(n=0,r=i.length;n<r;n++)if(a=i.start(n),o=i.end(n),null===s)u=Math.abs(a-e),(e>=a&&e<o||u<=c)&&(s=a,l=o);else{if(!((u=a-l)<=c))break;l=o}if(null!==s)return{start:s,end:l}}return null}function ce(){if(V){var e=V.getTime()||0;v&&(e=isNaN(P)?0:P);var t=z.get().streaming.gaps.jumpGaps&&!isNaN(z.get().streaming.gaps.smallGapLimit)?z.get().streaming.gaps.smallGapLimit:NaN;i=Math.max(function(e,t){var r;return z.get().streaming.gaps.jumpGaps&&(t=z.get().streaming.gaps.smallGapLimit),null===(r=ue(e,t))?0:r.end-e}(e,t),0),we(u.Z.BUFFER_LEVEL_UPDATED,{mediaType:j,bufferLevel:i}),de()}}function fe(){var e=h>=g-1,t=V.getTimeToStreamEnd(q)-i<1e-5;!e&&!t||n||(Ae(!0),r.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(q.id," and type ").concat(j)))}function de(){j!==a.Z.AUDIO&&j!==a.Z.VIDEO||((!V.getLowLatencyModeEnabled()&&i<z.get().streaming.buffer.stallThreshold||0===i)&&!n?he(s.Z.BUFFER_EMPTY):(n||i>=z.get().streaming.buffer.stallThreshold||V.getLowLatencyModeEnabled()&&i>0)&&he(s.Z.BUFFER_LOADED))}function he(e){E===e||e===s.Z.BUFFER_EMPTY&&0===V.getTime()||j===a.Z.TEXT&&!H.isTextEnabled()||(E=e,we(u.Z.BUFFER_LEVEL_STATE_CHANGED,{state:e}),we(e===s.Z.BUFFER_LOADED?u.Z.BUFFER_LOADED:u.Z.BUFFER_EMPTY),r.debug(e===s.Z.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function ge(){p&&j!==a.Z.TEXT&&(n||me(pe()))}function pe(){var e=[],t=p.getAllBufferRanges();if(!t||0===t.length)return e;var r=V.getTime(),n=Math.max(0,r-z.get().streaming.buffer.bufferToKeep),i=Z.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,time:r,threshold:k})[0];if(i)n=Math.min(i.startTime,n);else if(0===r&&V.getIsDynamic())return[];if(t.start(0)<=n){for(var a={start:0,end:n},o=0;o<t.length&&t.end(o)<=n;o++)a.end=t.end(o);a.start<a.end&&e.push(a)}return e}function me(e){return new Promise((function(t,r){if(e&&p&&0!==e.length){var n=[];e.forEach((function(e){n.push(function(e){return new Promise((function(t,r){e.resolve=t,e.reject=r,C.push(e)}))}(e))})),b||ve(),Promise.all(n).then((function(){t()})).catch((function(e){r(e)}))}else t()}))}function ve(){try{if(0===C.length||!p)return r.debug("Nothing to prune, halt pruning"),C=[],void(b=!1);var e=p.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return r.debug("SourceBuffer is empty (or does not exist), halt pruning"),C=[],void(b=!1);var t=C.shift();r.debug("".concat(j,": Removing buffer from: ").concat(t.start," to ").concat(t.end)),b=!0,V.getTime()<t.end&&Ae(!1),p.remove(t).then((function(e){ye(e)})).catch((function(e){ye(e)}))}catch(e){b=!1}}function ye(e){r.debug("onRemoved buffer from:",e.from,"to",e.to),re(p.getAllBufferRanges()),0===C.length&&(b=!1,ce()),e.unintended&&(r.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),we(u.Z.SEEK_TARGET,{time:e.from})),b?ve():(L?L=!1:ce(),we(u.Z.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:Ie(),quotaExceeded:R}))}function Ee(e){return new Promise((function(t){e&&void 0!==e.MSETimeOffset&&p&&p.updateTimestampOffset?p.updateTimestampOffset(e.MSETimeOffset).then((function(){t()})).catch((function(){t()})):t()}))}function Te(){return p&&!n?p.updateAppendWindow(q):Promise.resolve()}function _e(){++A*(z.get().streaming.wallclockTimeUpdateInterval/1e3)>=z.get().streaming.buffer.bufferPruningInterval&&(A=0,ge())}function Se(){de()}function Ae(e){(n=e)?we(u.Z.BUFFERING_COMPLETED):g=Number.POSITIVE_INFINITY}function be(){try{var e,t,r=p.getAllBufferRanges(),n=0;if(!r)return n;for(t=0,e=r.length;t<e;t++)n+=r.end(t)-r.start(t);return n}catch(e){return 0}}function Re(e){try{var t=e,r=p.getAllBufferRanges();if(!r||0===r.length)return NaN;for(var n=0;t===e&&n<r.length;){var i=r.start(n),a=r.end(n);t>=i&&t<=a&&(t=a),n+=1}return t===e?NaN:t}catch(e){}}function Ie(){var e=be();return isNaN(e)||e<o}function we(e,t){var r=t||{};U.trigger(e,r,{streamId:q.id,mediaType:j})}function De(e,t){if(o=Number.POSITIVE_INFINITY,E=void 0,g=Number.POSITIVE_INFINITY,h=0,T=null,n=!1,b=!1,R=!1,i=0,A=0,C=[],P=NaN,v=!1,p){var r=p;p=null,e||t||r.abort().then((function(){r.reset(t),r=null}))}L=!1}return t={initialize:function(e){W(e),U.on(u.Z.INIT_FRAGMENT_LOADED,$,t),U.on(u.Z.MEDIA_FRAGMENT_LOADED,ee,t),U.on(u.Z.WALLCLOCK_TIME_UPDATED,_e,t),U.on(d.Z.PLAYBACK_PLAYING,le,t),U.on(d.Z.PLAYBACK_PROGRESS,oe,t),U.on(d.Z.PLAYBACK_TIME_UPDATED,oe,t),U.on(d.Z.PLAYBACK_RATE_CHANGED,Se,t),U.on(d.Z.PLAYBACK_STALLED,se,t)},getStreamId:function(){return q.id},getType:function(){return j},getBufferControllerType:function(){return x},createBufferSink:Q,dischargePreBuffer:function(){if(p&&m&&"function"==typeof m.discharge){var e=m.getAllBufferRanges();if(e.length>0){for(var t="Beginning "+j+"PreBuffer discharge, adding buffer for:",n=0;n<e.length;n++)t+=" start: "+e.start(n)+", end: "+e.end(n)+";";r.debug(t)}else r.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");y=[];for(var i=m.discharge(),a=null,o=0;o<i.length;o++){var s=i[o];if(s.segmentType!==D.w.INIT_SEGMENT_TYPE){var l=w.extract(s.streamId,s.representationId);l&&a!==l&&(y.push(l),p.append(l),a=l)}y.push(s),p.append(s)}m.reset(),m=null}},getBuffer:function(){return p},getBufferLevel:function(){return i},getRangeAt:ue,hasBufferAtTime:function(e){try{var t=p.getAllBufferRanges();if(!t||0===t.length)return!1;for(var n=0;n<t.length;){var i=t.start(n),a=t.end(n);if(e>=i&&e<=a)return!0;n+=1}return!1}catch(e){return r.error(e),!1}},pruneBuffer:ge,setMediaSource:W,getMediaSource:function(){return c},appendInitSegmentFromCache:function(e){var t=w.extract(q.id,e);return!!t&&(r.info("Append Init fragment",j," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),te(t),!0)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:Ae,getIsPruningInProgress:function(){return b},reset:function(e,t){U.off(u.Z.INIT_FRAGMENT_LOADED,$,this),U.off(u.Z.MEDIA_FRAGMENT_LOADED,ee,this),U.off(u.Z.WALLCLOCK_TIME_UPDATED,_e,this),U.off(d.Z.PLAYBACK_PLAYING,le,this),U.off(d.Z.PLAYBACK_PROGRESS,oe,this),U.off(d.Z.PLAYBACK_TIME_UPDATED,oe,this),U.off(d.Z.PLAYBACK_RATE_CHANGED,Se,this),U.off(d.Z.PLAYBACK_STALLED,se,this),De(e,t)},prepareForPlaybackSeek:function(){return n&&Ae(!1),p.abort()},prepareForReplacementTrackSwitch:function(e){return new Promise((function(t,r){p.abort().then((function(){return Te()})).then((function(){return z.get().streaming.buffer.useChangeTypeForTrackSwitch?p.changeType(e):Promise.resolve()})).then((function(){return ie()})).then((function(){Ae(!1),t()})).catch((function(e){r(e)}))}))},prepareForNonReplacementTrackSwitch:function(e){return new Promise((function(t,r){Te().then((function(){return z.get().streaming.buffer.useChangeTypeForTrackSwitch?p.changeType(e):Promise.resolve()})).then((function(){t()})).catch((function(e){r(e)}))}))},prepareForForceReplacementQualitySwitch:function(e){return new Promise((function(t,r){p.abort().then((function(){return Te()})).then((function(){return ie()})).then((function(){return Ee(e)})).then((function(){Ae(!1),t()})).catch((function(e){r(e)}))}))},updateAppendWindow:Te,getAllRangesWithSafetyFactor:ae,getContinuousBufferTimeForTargetTime:Re,clearBuffers:me,pruneAllSafely:ie,updateBufferTimestampOffset:Ee,setSeekTarget:function(e){P=e},segmentRequestingCompleted:function(e){isNaN(e)||(g=e,fe())}},r=(0,f.Z)(F).getInstance().getLogger(t),w=M(F).getInstance(),De(),t}F.__dashjs_factory_name=x;const U=c.Z.getClassFactory(F);var B="NotFragmentedTextBufferController";function Z(e){e=e||{};var t,r,n,i,a,o,s=this.context,c=(0,l.Z)(s).getInstance(),f=e.textController,d=e.errHandler,h=e.streamInfo,g=e.type;function p(e){i=e}function m(e){var t,n;r!==e&&(r=e)&&(t=u.Z.BUFFERING_COMPLETED,n={},c.trigger(t,n,{streamId:h.id,mediaType:g}))}function v(e){e.chunk.bytes&&!r&&(o.save(e.chunk),a.append(e.chunk),m(!0))}return t={initialize:function(e){p(e)},getStreamId:function(){return h.id},getType:function(){return g},getBufferControllerType:function(){return B},createBufferSink:function(e){return new Promise((function(t,r){try{(a=N(s).create({mediaSource:i,textController:f,eventBus:c})).initializeForFirstUse(h,e),n||(a.getBuffer()&&"function"==typeof a.getBuffer().initialize&&a.getBuffer().initialize(),n=!0),t(a)}catch(e){d.error(new S.Z(I.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,I.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+g)),r(e)}}))},dischargePreBuffer:function(){},getBuffer:function(){return a},getBufferLevel:function(){return 0},getRangeAt:function(){return null},pruneBuffer:function(){},hasBufferAtTime:function(){return!0},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:p,getMediaSource:function(){return i},appendInitSegmentFromCache:function(e){return null!==o.extract(h.id,e)},getIsBufferingCompleted:function(){return r},setIsBufferingCompleted:m,getIsPruningInProgress:function(){return!1},reset:function(e){c.off(u.Z.INIT_FRAGMENT_LOADED,v,t),!e&&a&&(a.abort(),a.reset(),a=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return r=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},n=!1,i=null,r=!1,o=M(s).getInstance(),c.on(u.Z.INIT_FRAGMENT_LOADED,v,t),t}Z.__dashjs_factory_name=B;const G=c.Z.getClassFactory(Z);function K(e){e=e||{};var t,r,n,i,o,c,h,g,p,m,v,y,E=this.context,T=(0,l.Z)(E).getInstance(),S=e.dashMetrics,A=e.mediaPlayerModel,b=e.fragmentModel,R=e.abrController,I=e.playbackController,w=e.textController,D=e.type,C=e.bufferController,N=e.representationController,L=e.settings;function O(e){if(!C.getIsBufferingCompleted()){P();var t=isNaN(e)?0:e;o=setTimeout(M,t)}}function P(){o&&(clearTimeout(o),o=null)}function M(){try{if(function(){try{return D===a.Z.TEXT&&!w.isTextEnabled()||I.isPaused()&&(!I.getStreamController().getInitialPlayback()||!I.getStreamController().getAutoPlay())&&!L.get().streaming.scheduling.scheduleWhilePaused}catch(e){return!1}}())return void P();if(function(){try{return N.getCurrentRepresentationInfo()&&(isNaN(p)||m||(e=r.id,t=R.getMaxAllowedIndexFor(D,e),!(!isNaN(g)&&g==t||(n.info("Top quality "+D+" index has changed from "+g+" to "+t),g=t,0)))||function(){var e=N.getCurrentRepresentationInfo();return!D||!e||S.getCurrentBufferLevel(D)<k()}())}catch(e){return!1}var e,t}()){var e=!1;y&&(e=R.checkPlaybackQuality(D,r.id)),e||(i=N.getCurrentRepresentationInfo(),v||i.quality!==p||m?(m?(n.debug("Switch track for "+D+", representation id = "+i.id),m=!1):n.debug("Quality has changed, get init request for representationid = "+i.id),T.trigger(u.Z.INIT_FRAGMENT_NEEDED,{representationId:i.id,sender:t},{streamId:r.id,mediaType:D}),y=!1,v=!1):(n.debug("Media segment needed for ".concat(D," and stream id ").concat(r.id)),T.trigger(u.Z.MEDIA_FRAGMENT_NEEDED,{},{streamId:r.id,mediaType:D}),y=!0))}else O(I.getLowLatencyModeEnabled()?L.get().streaming.scheduling.lowLatencyTimeout:L.get().streaming.scheduling.defaultTimeout)}catch(e){O(I.getLowLatencyModeEnabled()?L.get().streaming.scheduling.lowLatencyTimeout:L.get().streaming.scheduling.defaultTimeout)}var i}function k(){var e=NaN,t=N.getCurrentRepresentationInfo();return D&&t?(e=D===a.Z.TEXT?function(){try{if(w.isTextEnabled()){var e=N.getCurrentRepresentationInfo();if(isNaN(e.fragmentDuration)){var t=S.getCurrentSchedulingInfo(s.Z.SCHEDULING_INFO);return t?t.duration:0}return e.fragmentDuration}return 0}catch(e){return 0}}():D===a.Z.AUDIO&&c?function(){try{var e=S.getCurrentBufferLevel(a.Z.VIDEO),t=N.getCurrentRepresentationInfo();return isNaN(t.fragmentDuration)?e+1:Math.max(e+1,t.fragmentDuration)}catch(e){return 0}}():function(){try{var e=N.getCurrentRepresentationInfo().mediaInfo.streamInfo;return R.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=L.get().streaming.buffer.longFormContentDurationThreshold?L.get().streaming.buffer.bufferTimeAtTopQualityLongForm:L.get().streaming.buffer.bufferTimeAtTopQuality:A.getStableBufferTime()}catch(e){return A.getStableBufferTime()}}(),e):e}function x(){F(!0)}function F(e){if(I&&b){var t=b.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,time:I.getTime(),threshold:0})[0];t&&I.getTime()>=t.startTime&&((!h.mediaInfo||t.mediaInfo.type===h.mediaInfo.type&&t.mediaInfo.id!==h.mediaInfo.id)&&e&&T.trigger(u.Z.TRACK_CHANGE_RENDERED,{mediaType:D,oldMediaInfo:h.mediaInfo,newMediaInfo:t.mediaInfo,streamId:r.id}),t.quality===h.quality&&t.adaptationIndex===h.adaptationIndex||!e||(n.debug("Quality change rendered for streamId ".concat(r.id," and type ").concat(D)),T.trigger(u.Z.QUALITY_CHANGE_RENDERED,{mediaType:D,oldQuality:h.quality,newQuality:t.quality,streamId:r.id})),h={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function U(){b.abortRequests(),P()}function B(){L.get().streaming.scheduling.scheduleWhilePaused||O()}function Z(e){S.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function G(){y=!0,i=0,p=NaN,h={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},g=NaN,m=!1,v=!1}return t={initialize:function(e){c=e,T.on(u.Z.URL_RESOLUTION_FAILED,U,t),T.on(d.Z.PLAYBACK_STARTED,B,t),T.on(d.Z.PLAYBACK_RATE_CHANGED,Z,t),T.on(d.Z.PLAYBACK_TIME_UPDATED,x,t)},getType:function(){return D},getStreamId:function(){return r.id},setTimeToLoadDelay:function(e){i=e},getTimeToLoadDelay:function(){return i},setSwitchTrack:function(e){m=e},getSwitchTrack:function(){return m},startScheduleTimer:O,clearScheduleTimer:P,reset:function(){T.off(u.Z.URL_RESOLUTION_FAILED,U,t),T.off(d.Z.PLAYBACK_STARTED,B,t),T.off(d.Z.PLAYBACK_RATE_CHANGED,Z,t),T.off(d.Z.PLAYBACK_TIME_UPDATED,x,t),P(),F(!1),G(),r=null},getBufferTarget:k,getPlaybackController:function(){return I},setCheckPlaybackQuality:function(e){y=e},setInitSegmentRequired:function(e){v=e},setLastInitializedQuality:function(e){p=e}},n=(0,f.Z)(E).getInstance().getLogger(t),G(),r=e.streamInfo,t}K.__dashjs_factory_name="ScheduleController";const H=c.Z.getClassFactory(K);var Y=r(7387);function V(e){var t,r,n,i,o,s,l=(e=e||{}).eventBus,u=e.events,c=e.abrController,f=e.dashMetrics,h=e.playbackController,g=e.timelineConverter,p=e.type,m=e.streamInfo,v=e.dashConstants,y=e.segmentsController,E=e.isDynamic,T=e.adapter;function _(){return p}function S(){return n}function A(){return s}function b(){r=null,n=!0,i=[],o=null}function R(e){return new Promise((function(t,r){var n=e.hasInitialization(),a=e.hasSegments(),o=[];o.push(y.updateInitData(e,n)),o.push(y.updateSegmentData(e,a)),Promise.all(o).then((function(r){var n;r[0]&&!r[0].error&&(e=function(e,t){return t&&!t.error&&t.representation?t.representation:e}(e,r[0])),r[1]&&!r[1].error&&(e=function(e,t){if(t&&!t.error){var r,n,i,a,o=t.segments,s=[],l=0;for(r=0,n=o?o.length:0;r<n;r++)i=o[r],(a=(0,Y.TJ)(g,E,e,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,l))&&(s.push(a),a=null,l++);return s.length>0&&(e.segments=s),e}}(e,r[1])),(n=e).mediaFinishedInformation=y.getMediaFinishedInformation(n),function(e){if(S()){var t,r,n=f.getCurrentManifestUpdate(),a=!1;if(n){for(var o=0;o<n.representationInfo.length;o++)if((t=n.representationInfo[o]).index===e.index&&t.mediaType===_()){a=!0;break}a||f.addManifestUpdateRepresentationInfo(e,_())}if(function(){for(var e=0,t=i.length;e<t;e++){var r=i[e].segmentInfoType;if(!i[e].hasInitialization()||(r===v.SEGMENT_BASE||r===v.BASE_URL)&&!i[e].segments)return!1}return!0}()){c.setPlaybackQuality(p,m,(r=s,i.indexOf(r)));var l=f.getCurrentDVRInfo(p);l&&f.updateManifestUpdateInfo({latency:l.range.end-h.getTime()}),f.getCurrentRepresentationSwitch(A().adaptation.type)||I(),D()}}}(e),t()})).catch((function(e){r(e)}))}))}function I(){!function(){if(!(c&&f&&h&&g))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var e=new Date,t=A(),r=1e3*h.getTime();t&&f.addRepresentationSwitch(t.adaptation.type,e,r,t.id),l.trigger(d.Z.REPRESENTATION_SWITCH,{mediaType:p,streamId:m.id,currentRepresentation:t,numberOfRepresentations:i.length},{streamId:m.id,mediaType:p})}function w(e){return null==e||e>=i.length?null:i[e]}function D(e){n=!1,l.trigger(u.DATA_UPDATE_COMPLETED,{data:r,currentRepresentation:s,error:e},{streamId:m.id,mediaType:p})}function C(e){s=e,o=T.convertRepresentationToRepresentationInfo(s)}function N(e){if(e.newDuration){var t=A();t&&t.adaptation.period&&(t.adaptation.period.duration=e.newDuration)}}return t={getStreamId:function(){return m.id},getType:_,getData:function(){return r},isUpdating:S,updateData:function(e,t,o,s,l){return new Promise((function(u,c){if(n=!0,i=t,r=e,C(w(l)),o!==a.Z.VIDEO&&o!==a.Z.AUDIO&&(o!==a.Z.TEXT||!s))return D(),void u();for(var f=[],d=0,h=i.length;d<h;d++){var g=i[d];f.push(R(g))}Promise.all(f).then((function(){C(w(l)),u()})).catch((function(e){c(e)}))}))},getCurrentRepresentation:A,getCurrentRepresentationInfo:function(){return o},getRepresentationForQuality:w,prepareQualityChange:function(e){C(w(e)),I()},reset:function(){l.off(d.Z.MANIFEST_VALIDITY_CHANGED,N,t),b()}},b(),l.on(d.Z.MANIFEST_VALIDITY_CHANGED,N,t),t}V.__dashjs_factory_name="RepresentationController";const q=c.Z.getClassFactory(V);var j=r(3106),z=r(9326),W=r(7473),X=r(2594);function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var J=function e(){Q(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};J.INITIAL_PLAYOUT_START_REASON="initial_playout",J.SEEK_START_REASON="seek",J.RESUME_FROM_PAUSE_START_REASON="resume",J.METRICS_COLLECTION_START_REASON="metrics_collection_start";var $=function e(){Q(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};$.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",$.REBUFFERING_REASON="rebuffering",$.USER_REQUEST_STOP_REASON="user_request",$.END_OF_PERIOD_STOP_REASON="end_of_period",$.END_OF_CONTENT_STOP_REASON="end_of_content",$.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",$.FAILURE_STOP_REASON="failure";var ee=r(7802);function te(){return{ntpToUTC:function(e){var t=new Date(Date.UTC(1900,0,1,0,0,0));return new Date(t.getTime()+e).getTime()}}}te.__dashjs_factory_name="TimeUtils";const re=c.Z.getSingletonFactory(te);function ne(e){e=e||{};var t,r,n,i,c,h,g,p,m,v,y,E,T,A,b=this.context,R=(0,l.Z)(b).getInstance(),w=e.streamInfo,C=e.type,N=e.errHandler,L=e.mimeType,O=e.timelineConverter,P=e.adapter,M=e.manifestModel,k=e.mediaPlayerModel,x=e.fragmentModel,F=e.abrController,B=e.playbackController,Z=e.mediaController,K=e.textController,Y=e.dashMetrics,V=e.settings,Q=e.boxParser,J=e.segmentBlacklistController;function te(){return w.id}function ne(){return C}function ie(){return P.getIsTextTrack(p.getData())}function ae(){c=[],i=null,T=0,m=!1,v=!1,A=null}function oe(e){return!isNaN(e)&&!isNaN(w.duration)&&isFinite(w.duration)&&e>=w.start+w.duration}function se(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.sender)if(B.getIsManifestUpdateInProgress())fe();else if((!ie()||K.isTextEnabled())&&h&&e.representationId&&!h.appendInitSegmentFromCache(e.representationId)){var r=p.getCurrentRepresentation();if(0===r.range)return void le();var n=y?y.getInitRequest(i,r):null;n?x.executeRequest(n):t&&(g.setInitSegmentRequired(!0),fe())}}function le(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(B.getIsManifestUpdateInProgress()||h.getIsPruningInProgress())fe();else{var r=function(){var e,t=Ie();if(isNaN(T)||ne()===a.Z.TEXT&&!K.isTextEnabled())return null;if(y){var r=p&&t?p.getRepresentationForQuality(t.quality):null;e=m?y.getSegmentRequestForTime(i,r,T):y.getNextSegmentRequest(i,r)}return e}();r?(m=!1,ue(r)):ce(t)}}function ue(e){isNaN(e.startTime+e.duration)||(T=e.startTime+e.duration),e.delayLoadingTime=(new Date).getTime()+g.getTimeToLoadDelay(),g.setTimeToLoadDelay(0),function(e){var t=e.url;return e.range&&(t=t.concat("_",e.range)),J.contains(t)}(e)?(r.warn("Fragment request url ".concat(e.url," for stream id ").concat(w.id," and media type ").concat(C," is on the ignore list and will be skipped")),fe()):(r.debug("Next fragment request url for stream id ".concat(w.id," and media type ").concat(C," is ").concat(e.url)),x.executeRequest(e))}function ce(e){var t,a=p.getCurrentRepresentation();if(!V.get().streaming.gaps.enableSeekFix||!m&&0!==B.getTime()||(n?n&&a.segmentInfoType===o.Z.SEGMENT_TIMELINE&&(t=y.getValidTimeAheadOfTargetTime(T,i,a,V.get().streaming.gaps.threshold)):t=y.getValidTimeAheadOfTargetTime(T,i,a,V.get().streaming.gaps.threshold),isNaN(t)||t===T)){if(y.isLastSegmentRequested(a,T)){var s=y.getCurrentIndex();return r.debug("Segment requesting for stream ".concat(w.id," has finished")),R.trigger(u.Z.STREAM_REQUESTING_COMPLETED,{segmentIndex:s},{streamId:w.id,mediaType:C}),h.segmentRequestingCompleted(s),void g.clearScheduleTimer()}e&&fe()}else B.isSeeking()||0===B.getTime()?(r.warn("Adjusting playback time ".concat(t," because of gap in the manifest. Seeking by ").concat(t-T)),B.seek(t,!1,!1)):(r.warn("Adjusting buffering time ".concat(t," because of gap in the manifest. Adjusting time by ").concat(t-T)),Pe(t),e&&fe())}function fe(){g.startScheduleTimer(B.getLowLatencyModeEnabled()?V.get().streaming.scheduling.lowLatencyTimeout:V.get().streaming.scheduling.defaultTimeout)}function de(e){e.error||h.getIsBufferingCompleted()||h.updateBufferTimestampOffset(e.currentRepresentation)}function he(e){Y.addBufferState(C,e.state,g.getBufferTarget()),e.state!==s.Z.BUFFER_EMPTY||B.isSeeking()||(r.info("Buffer is empty! Stalling!"),Y.pushPlayListTraceMetrics(new Date,$.REBUFFERING_REASON))}function ge(e){x.syncExecutedRequestsWithBufferedRange(h.getBuffer().getAllBufferRanges(),w.duration),e.quotaExceeded&&e.from>B.getTime()&&Pe(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&g.startScheduleTimer()}function pe(e){if(e&&e.lastRequestAppended&&e.lastRequestAppended.url){var t=e.lastRequestAppended.url;e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),r.warn("Blacklisting segment with url ".concat(t)),J.add(t)}}function me(e){if(r.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(e.streamId)),e.segmentType===D.w.INIT_SEGMENT_TYPE){var t=e.quality;g.setLastInitializedQuality(t),r.info("["+C+"] lastInitializedRepresentationInfo changed to "+e.quality)}A?ve(A):g.startScheduleTimer(0)}function ve(e){var t=x.getRequests({state:_.FRAGMENT_MODEL_LOADING});if(t&&t.length>0)return r.debug("Preparing for default quality switch: Waiting for ongoing segment request to be finished before applying switch."),void(A=e);h.updateBufferTimestampOffset(e).then((function(){i.segmentAlignment||i.subSegmentAlignment?g.startScheduleTimer():Le(),A=null,v=!1})).catch((function(){A=null,v=!1}))}function ye(e){r.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),B.isSeeking()||g.getSwitchTrack()||v||(r.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?g.setInitSegmentRequired(!0):Pe(e.request.startTime+e.request.duration/2),g.startScheduleTimer(0))}function Ee(e){r.info("OnFragmentLoadingCompleted for stream id "+w.id+" and media type "+C+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),ie()&&g.startScheduleTimer(0),e.error&&e.request.serviceLocation&&function(e){r.info("Fragment loading completed with an error"),e&&e.request&&e.request.type&&(e.request.type===D.w.INIT_SEGMENT_TYPE?se({representationId:e.request.representationId,sender:{}},!1):e.request.type===D.w.MEDIA_SEGMENT_TYPE&&(Pe(e.request.startTime+e.request.duration/2),le({},!1)))}(e)}function Te(){Pe(B.getTime()),Re().startScheduleTimer()}function _e(e){var t=e.currentTrackInfo;if(t){var r=c.find((function(e){return e.index===t.index&&e.lang===t.lang}));r&&be(r).then((function(){h.setIsBufferingCompleted(!1),Pe(B.getTime()),g.setInitSegmentRequired(!0),g.startScheduleTimer()}))}}function Se(e){Pe(e.quotaExceededTime),g.clearScheduleTimer()}function Ae(){return h?h.getBuffer():null}function be(e){e===i||e&&i&&e.type!==i.type||(i=e);var t=P.getRealAdaptation(w,i),r=P.getVoRepresentations(i);if(p){var o,s=p.getData(),l=F.getMaxAllowedIndexFor(C,w.id),u=F.getMinAllowedIndexFor(C,w.id),c=null;return null!==s&&s.id===t.id||C===a.Z.TEXT?o=F.getQualityFor(C,w.id):(c=F.getThroughputHistory().getAverageThroughput(C,n)||F.getInitialBitrateFor(C,w.id),o=F.getQualityForBitrate(i,c,w.id)),void 0!==u&&o<u&&(o=u),o>l&&(o=l),p.updateData(t,r,C,i.isFragmented,o)}return Promise.resolve()}function Re(){return g}function Ie(e){var t;return void 0!==e?((0,j.SE)(e),t=p?p.getRepresentationForQuality(e):null):t=p?p.getCurrentRepresentation():null,P.convertRepresentationToRepresentationInfo(t)}function we(){return!!h&&h.getIsBufferingCompleted()}function De(e){if(V.get().streaming.enableManifestTimescaleMismatchFix){var t=e.chunk,r=t.bytes,n=Ie(t.quality),i=p&&n?p.getRepresentationForQuality(n.quality):null;n&&i&&(i.timescale=Q.getMediaTimescaleFromMoov(r))}}function Ce(e){var t=e.chunk,r=t.bytes,n=t.quality,i=Ie(n),a=p&&i?p.getRepresentationForQuality(i.quality):null;if(i&&a){var s;if(V.get().streaming.parseInbandPrft&&e.request.type===D.w.MEDIA_SEGMENT_TYPE){var l=function(e,t){var r=e.getBoxes("prft"),n=[];return r.forEach((function(e){n.push(function(e,t){var r="unknown";switch(e.flags){case 0:r=o.Z.PRODUCER_REFERENCE_TIME_TYPE.ENCODER;break;case 16:r=o.Z.PRODUCER_REFERENCE_TIME_TYPE.APPLICATION;break;case 24:r=o.Z.PRODUCER_REFERENCE_TIME_TYPE.CAPTURED}var n=1e3*e.ntp_timestamp_sec+e.ntp_timestamp_frac/Math.pow(2,32)*1e3;return{type:r,ntpTimestamp:n=re(b).getInstance().ntpToUTC(n),mediaTime:e.media_time/t}}(e,t))})),n}(s=s||Q.parse(r),a.timescale);l&&l.length&&R.trigger(d.Z.INBAND_PRFT,{data:l},{streamId:w.id,mediaType:C})}var c=P.getEventsFor(i.mediaInfo,null,w),f=P.getEventsFor(i,a,w);if(c&&c.length>0||f&&f.length>0){var h=x.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,quality:n,index:t.index})[0],g=function(e,t,r,n){try{for(var i={},a=[],o=r.concat(n),s=0,l=o.length;s<l;s++)i[o[s].schemeIdUri+"/"+o[s].value]=o[s];var u=e.getBoxes("emsg");if(!u||0===u.length)return a;for(var c=e.getBox("sidx"),f=!c||isNaN(c.earliest_presentation_time)||isNaN(c.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:c.earliest_presentation_time/c.timescale,d=Math.max(f,0),h=p.getCurrentRepresentation(),g=0,m=u.length;g<m;g++){var v=P.getEvent(u[g],i,d,h);v&&a.push(v)}return a}catch(e){return[]}}(s=s||Q.parse(r),h,c,f);R.trigger(u.Z.INBAND_EVENTS,{events:g},{streamId:w.id})}}}function Ne(){var e=B.getTime();V.get().streaming.buffer.flushBufferAtTrackSwitch&&B.seek(e+.001,!1,!0),Pe(e),h.setSeekTarget(e),g.startScheduleTimer()}function Le(){var e=B.getTime(),t=h.getContinuousBufferTimeForTargetTime(e);Pe(isNaN(t)?e:t),g.startScheduleTimer()}function Oe(e){e&&!isNaN(e.time)&&(Pe(e.time),h.setSeekTarget(e.time))}function Pe(e){T=e,m=!0}return t={initialize:function(r,i,s){E=(0,ee.Z)(b).create({events:u.Z,eventBus:R,streamInfo:w,timelineConverter:O,dashConstants:o.Z,segmentBaseController:e.segmentBaseController,type:C}),y=(0,z.Z)(b).create({streamInfo:w,type:C,timelineConverter:O,dashMetrics:Y,mediaPlayerModel:k,baseURLController:e.baseURLController,errHandler:N,segmentsController:E,settings:V,boxParser:Q,events:u.Z,eventBus:R,errors:I,debug:(0,f.Z)(b).getInstance(),requestModifier:(0,W.Z)(b).getInstance(),dashConstants:o.Z,constants:a.Z,urlUtils:(0,X.Z)(b).getInstance()}),n=w.manifestInfo.isDynamic,y.initialize(n),F.registerStreamType(C,t),p=q(b).create({streamInfo:w,type:C,abrController:F,dashMetrics:Y,playbackController:B,timelineConverter:O,dashConstants:o.Z,events:u.Z,eventBus:R,errors:I,isDynamic:n,adapter:P,segmentsController:E}),h=function(e,t){return e?e!==a.Z.TEXT||t?U(b).create({streamInfo:w,type:e,mediaPlayerModel:k,manifestModel:M,fragmentModel:x,errHandler:N,mediaController:Z,representationController:p,adapter:P,textController:K,abrController:F,playbackController:B,settings:V}):G(b).create({streamInfo:w,type:e,mimeType:L,fragmentModel:x,textController:K,errHandler:N,settings:V}):(N.error(new S.Z(I.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,I.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}(C,s),h&&h.initialize(r),(g=H(b).create({streamInfo:w,type:C,mimeType:L,adapter:P,dashMetrics:Y,mediaPlayerModel:k,fragmentModel:x,abrController:F,playbackController:B,textController:K,mediaController:Z,bufferController:h,representationController:p,settings:V})).initialize(i),T=0,m=!1},getStreamId:te,getType:ne,isUpdating:function(){return!!p&&p.isUpdating()},getBufferController:function(){return h},dischargePreBuffer:function(){h.dischargePreBuffer()},getFragmentModel:function(){return x},getScheduleController:Re,getRepresentationController:function(){return p},getRepresentationInfo:Ie,getBufferLevel:function(){return h?h.getBufferLevel():0},isBufferingCompleted:we,createBufferSinks:function(e){var t=Ae();return t?Promise.resolve(t):h?h.createBufferSink(i,e):Promise.resolve(null)},updateStreamInfo:function(e){return w=e,we()?Promise.resolve():h.updateAppendWindow()},getStreamInfo:function(){return w},selectMediaInfo:be,clearMediaInfoArray:function(){c=[]},addMediaInfo:function(e){-1===c.indexOf(e)&&c.push(e)},prepareTrackSwitch:function(){return new Promise((function(e){r.debug("Preparing track switch for type ".concat(C));var t=C===a.Z.TEXT||V.get().streaming.trackSwitchMode[C]===a.Z.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&B.getTimeToStreamEnd(w)>V.get().streaming.buffer.stallThreshold;if(h.getIsBufferingCompleted()&&!t)return h.prepareForNonReplacementTrackSwitch(i.codec).then((function(){R.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:w.id,mediaType:C})})).catch((function(){R.trigger(u.Z.BUFFERING_COMPLETED,{},{streamId:w.id,mediaType:C})})),void e();g.clearScheduleTimer(),g.setSwitchTrack(!0),t?(R.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:C,streamId:w.id},{mediaType:C,streamId:w.id}),x.abortRequests(),h.prepareForReplacementTrackSwitch(i.codec).then((function(){var e=Ie();return h.updateBufferTimestampOffset(e)})).then((function(){Ne(),e()})).catch((function(){Ne(),e()}))):h.prepareForNonReplacementTrackSwitch(i.codec).then((function(){Le(),e()})).catch((function(){Le(),e()}))}))},prepareQualityChange:function(e){A&&r.warning("Canceling queued representation switch to ".concat(A.quality," for ").concat(C)),r.debug("Preparing quality switch for type ".concat(C));var t=e.newQuality;v=!0,g.clearScheduleTimer(),p.prepareQualityChange(t);var n=Ie(t);e.reason&&e.reason.forceReplace?function(e){x.abortRequests(),R.trigger(u.Z.BUFFER_REPLACEMENT_STARTED,{mediaType:C,streamId:w.id},{mediaType:C,streamId:w.id}),h.prepareForForceReplacementQualitySwitch(e).then((function(){Ne(),v=!1})).catch((function(){Ne(),v=!1}))}(n):V.get().streaming.buffer.fastSwitchEnabled?function(e){var t=B.getTime(),r=1.5*(isNaN(e.fragmentDuration)?1:e.fragmentDuration),n=x.getRequests({state:_.FRAGMENT_MODEL_EXECUTED,time:t+r,threshold:0})[0];if(n&&!ie()){var i=h.getBufferLevel(),a=F.getAbandonmentStateFor(w.id,C);n.quality<e.quality&&i>=r&&a!==s.Z.ABANDON_LOAD?h.updateBufferTimestampOffset(e).then((function(){x.abortRequests(),Pe(t+r),g.setCheckPlaybackQuality(!1),g.startScheduleTimer(),v=!1})).catch((function(){v=!1})):ve(e)}else g.startScheduleTimer(),v=!1}(n):ve(n),Y.pushPlayListTraceMetrics(new Date,$.REPRESENTATION_SWITCH_STOP_REASON),Y.createPlaylistTraceMetrics(n.id,1e3*B.getTime(),B.getPlaybackRate())},getMediaInfo:function(){return i},getMediaSource:function(){return h.getMediaSource()},setMediaSource:function(e){return h.setMediaSource(e,i)},getBuffer:Ae,setExplicitBufferingTime:Pe,finalisePlayList:function(e,t){Y.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=Ie(),t=p&&e?p.getRepresentationForQuality(e.quality):null;return y.getNextSegmentRequestIdempotent(i,t)},prepareInnerPeriodPlaybackSeeking:function(e){return new Promise((function(t){if(h.hasBufferAtTime(e.seekTime))return h.pruneBuffer(),oe(h.getContinuousBufferTimeForTargetTime(e.seekTime))&&h.setIsBufferingCompleted(!0),void t();g.clearScheduleTimer(),x.abortRequests(),h.prepareForPlaybackSeek().then((function(){var t=h.getAllRangesWithSafetyFactor(e.seekTime);return h.clearBuffers(t)})).then((function(){var r=h.getContinuousBufferTimeForTargetTime(e.seekTime);if(oe(r))h.setIsBufferingCompleted(!0),t();else{var n=isNaN(r)?e.seekTime:r;Pe(n),h.setSeekTarget(n);var i=[];i.push(h.updateAppendWindow());var a=Ie();i.push(h.updateBufferTimestampOffset(a)),Promise.all(i).then((function(){g.setInitSegmentRequired(!0),g.setCheckPlaybackQuality(!1),g.startScheduleTimer(),t()}))}})).catch((function(e){r.error(e)}))}))},prepareOuterPeriodPlaybackSeeking:function(){return new Promise((function(e,t){try{g.clearScheduleTimer(),x.abortRequests(),h.prepareForPlaybackSeek().then((function(){return h.pruneAllSafely()})).then((function(){e()}))}catch(e){t(e)}}))},reset:function(e,r){y&&y.reset(),h&&(h.reset(e,r),h=null),g&&(g.reset(),g=null),p&&(p.reset(),p=null),E&&(E=null),F&&F.unRegisterStreamType(te(),C),R.off(u.Z.DATA_UPDATE_COMPLETED,de,t),R.off(u.Z.INIT_FRAGMENT_NEEDED,se,t),R.off(u.Z.MEDIA_FRAGMENT_NEEDED,le,t),R.off(u.Z.INIT_FRAGMENT_LOADED,De,t),R.off(u.Z.MEDIA_FRAGMENT_LOADED,Ce,t),R.off(u.Z.BUFFER_LEVEL_STATE_CHANGED,he,t),R.off(u.Z.BUFFER_CLEARED,ge,t),R.off(u.Z.SEEK_TARGET,Oe,t),R.off(u.Z.FRAGMENT_LOADING_ABANDONED,ye,t),R.off(u.Z.FRAGMENT_LOADING_COMPLETED,Ee,t),R.off(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),R.off(u.Z.SET_NON_FRAGMENTED_TEXT,_e,t),R.off(u.Z.QUOTA_EXCEEDED,Se,t),R.off(u.Z.SOURCE_BUFFER_ERROR,pe,t),R.off(u.Z.BYTES_APPENDED_END_FRAGMENT,me,t),ae(),C=null,w=null}},r=(0,f.Z)(b).getInstance().getLogger(t),ae(),R.on(u.Z.DATA_UPDATE_COMPLETED,de,t,{priority:l.Z.EVENT_PRIORITY_HIGH}),R.on(u.Z.INIT_FRAGMENT_NEEDED,se,t),R.on(u.Z.MEDIA_FRAGMENT_NEEDED,le,t),R.on(u.Z.INIT_FRAGMENT_LOADED,De,t),R.on(u.Z.MEDIA_FRAGMENT_LOADED,Ce,t),R.on(u.Z.BUFFER_LEVEL_STATE_CHANGED,he,t),R.on(u.Z.BUFFER_CLEARED,ge,t),R.on(u.Z.SEEK_TARGET,Oe,t),R.on(u.Z.FRAGMENT_LOADING_ABANDONED,ye,t),R.on(u.Z.FRAGMENT_LOADING_COMPLETED,Ee,t),R.on(u.Z.QUOTA_EXCEEDED,Se,t),R.on(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,Te,t),R.on(u.Z.SET_NON_FRAGMENTED_TEXT,_e,t),R.on(u.Z.SOURCE_BUFFER_ERROR,pe,t),R.on(u.Z.BYTES_APPENDED_END_FRAGMENT,me,t),t}ne.__dashjs_factory_name="StreamProcessor";const ie=c.Z.getClassFactory(ne),ae=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};var oe=r(9032);function se(e,t){if(e){if("string"==typeof e)return le(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?le(e,t):void 0}}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ue(e){e=e||{};var t,r,n=this.context,i=e.requestModifier,o=e.lowLatencyThroughputModel,s=e.boxParser,l=(0,w.Z)(n).getInstance();function u(e){var t,n=new Date,u=e.request,d=new Headers;if(u.range&&d.append("Range","bytes="+u.range),e.headers)for(var h in e.headers){var g=e.headers[h];g&&d.append(h,g)}u.requestStartDate||(u.requestStartDate=n),i&&i.modifyRequestHeader&&i.modifyRequestHeader({setRequestHeader:function(e,t){d.append(e,t)}},{url:e.url}),"function"==typeof window.AbortController&&(t=new AbortController,e.abortController=t,t.signal.onabort=e.onabort);var p={method:e.method,headers:d,credentials:e.withCredentials?"include":void 0,signal:t?t.signal:void 0},m=l.get().streaming.abr.fetchThroughputCalculationMode,v=Date.now(),y=0;new Promise((function(e){if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o&&(y=o.getThroughputCapacityDelayMS(u,1e3*r.getCurrentBufferLevel(u.mediaType))))return setTimeout(e,y);e()})).then((function(){var t=Date.now();fetch(e.url,p).then((function(n){e.response||(e.response={}),e.response.status=n.status,e.response.statusText=n.statusText,e.response.responseURL=n.url,n.ok||e.onerror();var i,l="",d=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=se(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(n.headers.keys());try{for(d.s();!(i=d.n()).done;){var h=i.value;l+=h+": "+n.headers.get(h)+"\r\n"}}catch(e){d.e(e)}finally{d.f()}if(e.response.responseHeaders=l,!n.body)return n.arrayBuffer().then((function(t){e.response.response=t;var r={loaded:t.byteLength,total:t.byteLength,stream:!1};e.progress(r),e.onload(),e.onend()}));var g,p,E,T=parseInt(n.headers.get("Content-Length"),10),_=0,S=!1,A=new Uint8Array,b=0;if(m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&o){var R=t,I=0,w=function(e){if(Array.isArray(e))return e}(E=n.body.tee())||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),2!==r.length);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}}(E)||se(E,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),D=w[0],C=w[1];g=D.getReader(),p=[],g.read().then((function n(i){var a=i.value,s=i.done;if(I=Date.now(),a&&a.length){var c=I-R,f=a.length;p.push({chunkDownloadTimeRelativeMS:I-t,chunkDownloadDurationMS:c,chunkBytes:f,kbps:Math.round(8*f/(c/1e3)),bufferLevel:r.getCurrentBufferLevel(u.mediaType)})}if(s){var d=I-t,h=p.reduce((function(e,t){return e+t.chunkBytes}),0);return o.addMeasurement(u,d,p,v,y,l),void e.progress({loaded:h,total:h,lengthComputable:!0,time:o.getEstimatedDownloadDurationMS(u),stream:!0})}return R=Date.now(),g.read().then(n)})),e.reader=C.getReader()}else e.reader=n.body.getReader();var N=[],L=[],O=[],P=!0;c(e,(function t(r){var n=r.value;if(r.done){if(A){if(m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var i=null,o=null;m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(i=function(e,t){try{var r,n;r=e.filter((function(t,r){return r<e.length-1})),n=t.filter((function(e,r){return r<t.length-1}));var i=[];if(r.length>1){for(var a=0,o=0,s=0;s<r.length;s++)if(r[s]&&n[s]){var l=n[s].ts-r[s].ts;if(l>1)i.push(8*n[s].bytes/l),o=0;else{0===o&&(o=r[s].ts,a=0);var u=n[s].ts-o;u>1?(a+=n[s].bytes,i.push(8*a/u),o=0):a+=n[s].bytes}}if(i.length>0)return i.reduce((function(e,t){return e+t}),0)/i.length}return null}catch(e){return null}}(L,O),i&&(o=8*_/i)):m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(o=f(N,_)),e.progress({loaded:_,total:isNaN(T)?_:T,lengthComputable:!0,time:o,stream:!0})}e.response.response=A.buffer}return e.onload(),void e.onend()}if(n&&n.length>0){A=function(e,t){if(0===e.length)return t;var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(A,n),_+=n.length,N.push({ts:Date.now(),bytes:n.length}),m===a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&P&&s.findLastTopIsoBoxCompleted(["moof"],A,b).found&&(P=!1,L.push({ts:performance.now(),bytes:n.length}));var l=s.findLastTopIsoBoxCompleted(["moov","mdat"],A,b);if(l.found){var u,d=l.lastCompletedOffset+l.size;m!==a.Z.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||P||(P=!0,O.push({ts:performance.now(),bytes:A.length})),d===A.length?(u=A,A=new Uint8Array):(u=new Uint8Array(A.subarray(0,d)),A=A.subarray(d)),e.progress({data:u.buffer,lengthComputable:!1,noTrace:!0}),b=0}else b=l.lastCompletedOffset,S||(e.progress({lengthComputable:!1,noTrace:!0}),S=!0)}c(e,t)}))})).catch((function(t){e.onerror&&e.onerror(t)}))}))}function c(e,t){e.reader.read().then(t).catch((function(t){e.onerror&&200===e.response.status&&e.onerror(t)}))}function f(e,t){try{if((e=e.filter((function(r){return r.bytes>t/4/e.length}))).length>1){var r=0,n=(e[e.length-1].ts-e[0].ts)/e.length;return e.forEach((function(t,i){var a=e[i+1];if(a){var o=a.ts-t.ts;r+=o<n?o:0}})),r}return null}catch(e){return null}}return t={load:function(e){i&&i.modifyRequest?(0,W.k)(e,i).then((function(){return u(e)})):u(e)},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:f,setup:function(e){r=e.dashMetrics}},t}ue.__dashjs_factory_name="FetchLoader";const ce=c.Z.getClassFactory(ue);var fe=r(1180);const de=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.frameRate=null}var t;return(t=[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==o.Z.BASE_URL&&this.segmentInfoType!==o.Z.SEGMENT_BASE&&!this.indexRange}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),he=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null};var ge=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};ge.DEFAULT_ID="defaultId";const pe=ge,me=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};var ve=r(2610);const ye=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type="",this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};var Ee=function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=r||t||"",this.dvb_priority=n||1,this.dvb_weight=i||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0,this.queryParams={}};Ee.DEFAULT_DVB_PRIORITY=1,Ee.DEFAULT_DVB_WEIGHT=1;const Te=Ee,_e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0},Se=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null},Ae=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultServiceLocation=null,this.defaultServiceLocationArray=[],this.queryBeforeStart=!1,this.serverUrl=null,this.clientRequirement=!0},be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri=null,this.value=null,this.id=null}var t;return(t=[{key:"init",value:function(e){return e&&(this.schemeIdUri=e.schemeIdUri?e.schemeIdUri:null,this.value=e.value?e.value:null,this.id=e.id?e.id:null),this}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();var Re=r(3101),Ie=r.n(Re);function we(){return{areEqual:function(e,t){return Ie()(e,t)}}}we.__dashjs_factory_name="ObjectUtils";const De=c.Z.getSingletonFactory(we);var Ce=r(7803);const Ne=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=r||null,this.queryParams={}},Le=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||"",this.serviceLocation=r||null,this.ttl=n||NaN,this.queryParams={}};function Oe(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=Pe(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Pe(e,t){if(e){if("string"==typeof e)return Me(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Me(e,t):void 0}}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ke(){var e,t,r,n,i=this.context,s=(0,X.Z)(i).getInstance(),l=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function u(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var r=E(e.Representation_asArray[0]);if(r&&r.length>0&&Ce.Y.indexOf(r[0].schemeIdUri)>=0)return t===a.Z.IMAGE}if(e.ContentComponent_asArray&&e.ContentComponent_asArray.length>0){if(e.ContentComponent_asArray.length>1)return t===a.Z.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return!0}var n=t===a.Z.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){var i=e.Representation_asArray[0].codecs;if(n.test(i))return!0}if(e.hasOwnProperty(o.Z.MIME_TYPE))return n.test(e.mimeType);if(e.Representation_asArray)for(var s,l=0;l<e.Representation_asArray.length;l++)if((s=e.Representation_asArray[l]).hasOwnProperty(o.Z.MIME_TYPE))return n.test(s.mimeType);return!1}function c(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||e.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||e.hasOwnProperty(o.Z.SEGMENT_LIST)||e.hasOwnProperty(o.Z.SEGMENT_BASE))return!0;if(e.Representation_asArray&&e.Representation_asArray.length>0){var t=e.Representation_asArray[0];if(t.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)||t.hasOwnProperty(o.Z.SEGMENT_TIMELINE)||t.hasOwnProperty(o.Z.SEGMENT_LIST)||t.hasOwnProperty(o.Z.SEGMENT_BASE))return!0}return!1}function d(e){return u(e,a.Z.VIDEO)}function h(e){return u(e,a.Z.TEXT)}function g(e){return u(e,a.Z.IMAGE)}function p(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort((function(e,t){return e.bandwidth-t.bandwidth})),e}function m(e,t){return e&&e.Period_asArray&&l(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function v(e){return e&&e.Period_asArray?e.Period_asArray:[]}function y(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===o.Z.DYNAMIC),t}function E(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map((function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}})):null}function T(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],r=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:r.t-t.t}function _(e,t){if(!e)throw new Error("Period cannot be null or undefined");var r=pe.DEFAULT_ID+"_"+t;return e.hasOwnProperty(o.Z.ID)&&e.id.length>0&&"__proto__"!==e.id&&(r=e.id),r}function A(e,t,r){var n,i=[];if(!e)return i;for(n=0;n<e.length;n++){var s=new _e;if(s.timescale=1,s.representation=t,!e[n].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");s.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty(o.Z.TIMESCALE)&&(s.timescale=e[n].timescale),e[n].hasOwnProperty(o.Z.VALUE)&&(s.value=e[n].value),i.push(s),s.period=r}return i}function b(e){var t=[],r=e.BaseURL_asArray||[e.baseUri],n=!1;return r.some((function(r){if(r){var i=new Te,a=r.__text||r;return s.isRelative(a)&&(n=!0,e.baseUri&&(a=s.resolve(a,e.baseUri))),i.url=a,r.hasOwnProperty(o.Z.SERVICE_LOCATION)&&r.serviceLocation.length?i.serviceLocation=r.serviceLocation:i.serviceLocation=a,r.hasOwnProperty(o.Z.DVB_PRIORITY)&&(i.dvb_priority=r[o.Z.DVB_PRIORITY]),r.hasOwnProperty(o.Z.DVB_WEIGHT)&&(i.dvb_weight=r[o.Z.DVB_WEIGHT]),r.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)&&(i.availabilityTimeOffset=r[o.Z.AVAILABILITY_TIME_OFFSET]),r.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)&&(i.availabilityTimeComplete="false"!==r[o.Z.AVAILABILITY_TIME_COMPLETE]),t.push(i),n}})),t}function R(e){var t=new Ae;return t.serverUrl=e.__text,e.hasOwnProperty(o.Z.DEFAULT_SERVICE_LOCATION)&&(t.defaultServiceLocation=e[o.Z.DEFAULT_SERVICE_LOCATION],t.defaultServiceLocationArray=t.defaultServiceLocation.split(" ")),e.hasOwnProperty(o.Z.QUERY_BEFORE_START)&&(t.queryBeforeStart="true"===e[o.Z.QUERY_BEFORE_START].toLowerCase()),e.hasOwnProperty(o.Z.CLIENT_REQUIREMENT)&&(t.clientRequirement="false"!==e[o.Z.CLIENT_REQUIREMENT].toLowerCase()),t}return e={getIsTypeOf:u,getIsText:h,getIsFragmented:c,getProducerReferenceTimesForAdaptation:function(e){var t=e&&e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)?e[o.Z.PRODUCERREFERENCETIME_ASARRAY]:[];(e&&e.hasOwnProperty(o.Z.REPRESENTATION_ASARRAY)?e[o.Z.REPRESENTATION_ASARRAY]:[]).forEach((function(e){var r;e.hasOwnProperty(o.Z.PRODUCERREFERENCETIME_ASARRAY)&&t.push.apply(t,function(e){if(Array.isArray(e))return Me(e)}(r=e[o.Z.PRODUCERREFERENCETIME_ASARRAY])||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(r)||Pe(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}));var r=[];return t.forEach((function(e){var t=new Se;e.hasOwnProperty(o.Z.ID)&&(t[o.Z.ID]=e[o.Z.ID],e.hasOwnProperty(o.Z.WALL_CLOCK_TIME)&&(t[o.Z.WALL_CLOCK_TIME]=e[o.Z.WALL_CLOCK_TIME],e.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(t[o.Z.PRESENTATION_TIME]=e[o.Z.PRESENTATION_TIME],e.hasOwnProperty(o.Z.INBAND)&&(t[o.Z.INBAND]="false"!==e[o.Z.INBAND]),e.hasOwnProperty(o.Z.TYPE)&&(t[o.Z.TYPE]=e[o.Z.TYPE]),r.push(t))))})),r},getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(o.Z.LANG)&&(t=e.lang),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.VIEWPOINT_ASARRAY)&&e[o.Z.VIEWPOINT_ASARRAY].length?e[o.Z.VIEWPOINT_ASARRAY].map((function(e){return(new be).init(e)})):[]},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ROLE_ASARRAY)&&e[o.Z.ROLE_ASARRAY].length?e[o.Z.ROLE_ASARRAY].map((function(e){return(new be).init(e)})):[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.ACCESSIBILITY_ASARRAY)&&e[o.Z.ACCESSIBILITY_ASARRAY].length?e[o.Z.ACCESSIBILITY_ASARRAY].map((function(e){return(new be).init(e)})):[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(e){return(new be).init(e)})):[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY)&&e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].length?e[o.Z.AUDIOCHANNELCONFIGURATION_ASARRAY].map((function(e){return(new be).init(e)})):[]},getAdaptationForIndex:function(e,t,r){var n=m(t,r);return n.length>0&&l(e)?n[e]:null},getIndexForAdaptation:function(e,t,r){if(!e)return-1;for(var n=m(t,r),a=0;a<n.length;a++)if(De(i).getInstance().areEqual(n[a],e))return a;return-1},getAdaptationForId:function(e,t,r){var n,i,a=m(t,r);for(n=0,i=a.length;n<i;n++)if(a[n].hasOwnProperty(o.Z.ID)&&a[n].id===e)return a[n];return null},getAdaptationsForType:function(e,t,r){var n,i,a=m(e,t),o=[];for(n=0,i=a.length;n<i;n++)u(a[n],r)&&o.push(p(a[n]));return o},getRealPeriods:v,getRealPeriodForIndex:function(e,t){var r=v(t);return r.length>0&&l(e)?r[e]:null},getCodec:function(e,t,r){var n=null;if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var i=l(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(n=i.mimeType+';codecs="'+i.codecs+'"',r&&void 0!==i.width&&(n+=';width="'+i.width+'";height="'+i.height+'"'))}return n&&(n=n.replace(/\sprofiles=[^;]*/g,"")),n},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t}catch(e){return 1}},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(o.Z.CENC_DEFAULT_KID)?e[o.Z.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],r=0;r<e.Label_asArray.length;r++)t.push({lang:e.Label_asArray[r].lang,text:e.Label_asArray[r].__text||e.Label_asArray[r]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(o.Z.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:y,getId:function(e){return e&&e[o.Z.ID]||null},hasProfile:function(e,t){var r=!1;return e&&e.profiles&&e.profiles.length>0&&(r=-1!==e.profiles.indexOf(t)),r},getDuration:function(e){return e&&e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=NaN;return e&&e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(r=e.minimumUpdatePeriod),isNaN(r)?r:Math.max(r-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=p(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map((function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}}))},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&l(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,r,n,i,a=[],s=function(e){if(e&&e.period&&l(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&l(e.index))return p(t.AdaptationSet_asArray[e.index])}}(e);if(s&&s.Representation_asArray){if(e&&e.period&&l(e.period.index)){var u=b(e.period.mpd.manifest);u&&(r=u[0])}for(var f=0,d=s.Representation_asArray.length;f<d;++f){var g=s.Representation_asArray[f],m=new de;if(m.index=f,m.adaptation=e,g.hasOwnProperty(o.Z.ID)&&(m.id=g.id),g.hasOwnProperty(o.Z.CODECS)&&(m.codecs=g.codecs),g.hasOwnProperty(o.Z.MIME_TYPE)&&(m.mimeType=g[o.Z.MIME_TYPE]),g.hasOwnProperty(o.Z.CODEC_PRIVATE_DATA)&&(m.codecPrivateData=g.codecPrivateData),g.hasOwnProperty(o.Z.BANDWITH)&&(m.bandwidth=g.bandwidth),g.hasOwnProperty(o.Z.WIDTH)&&(m.width=g.width),g.hasOwnProperty(o.Z.HEIGHT)&&(m.height=g.height),g.hasOwnProperty(o.Z.SCAN_TYPE)&&(m.scanType=g.scanType),g.hasOwnProperty(o.Z.MAX_PLAYOUT_RATE)&&(m.maxPlayoutRate=g.maxPlayoutRate),g.hasOwnProperty(o.Z.SEGMENT_BASE)?(t=g.SegmentBase,m.segmentInfoType=o.Z.SEGMENT_BASE):g.hasOwnProperty(o.Z.SEGMENT_LIST)?(t=g.SegmentList).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_LIST:g.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)?((t=g.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)?m.segmentInfoType=o.Z.SEGMENT_TIMELINE:m.segmentInfoType=o.Z.SEGMENT_TEMPLATE,t.hasOwnProperty(o.Z.INITIALIZATION_MINUS)&&(m.initialization=t.initialization.split("$Bandwidth$").join(g.bandwidth).split("$RepresentationID$").join(g.id))):m.segmentInfoType=o.Z.BASE_URL,m.essentialProperties=E(g),t){if(t.hasOwnProperty(o.Z.INITIALIZATION)){var v=t.Initialization;v.hasOwnProperty(o.Z.SOURCE_URL)&&(m.initialization=v.sourceURL),v.hasOwnProperty(o.Z.RANGE)&&(m.range=v.range)}else h(s)&&c(s)&&s.mimeType&&-1===s.mimeType.indexOf("application/mp4")&&(m.range=0);t.hasOwnProperty(o.Z.TIMESCALE)&&(m.timescale=t.timescale),t.hasOwnProperty(o.Z.DURATION)?m.segmentDuration=t.duration/m.timescale:g.hasOwnProperty(o.Z.SEGMENT_TEMPLATE)&&(t=g.SegmentTemplate).hasOwnProperty(o.Z.SEGMENT_TIMELINE)&&(m.segmentDuration=T(t.SegmentTimeline)/m.timescale),t.hasOwnProperty(o.Z.MEDIA)&&(m.media=t.media),t.hasOwnProperty(o.Z.START_NUMBER)&&(m.startNumber=t.startNumber),t.hasOwnProperty(o.Z.INDEX_RANGE)&&(m.indexRange=t.indexRange),t.hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(m.presentationTimeOffset=t.presentationTimeOffset/m.timescale),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_OFFSET)?m.availabilityTimeOffset=t.availabilityTimeOffset:r&&void 0!==r.availabilityTimeOffset&&(m.availabilityTimeOffset=r.availabilityTimeOffset),t.hasOwnProperty(o.Z.AVAILABILITY_TIME_COMPLETE)?m.availabilityTimeComplete="false"!==t.availabilityTimeComplete:r&&void 0!==r.availabilityTimeComplete&&(m.availabilityTimeComplete=r.availabilityTimeComplete)}m.MSETimeOffset=(i=(n=m).presentationTimeOffset,n.adaptation.period.start-i),m.path=[e.period.index,e.index,f],a.push(m)}}return a},getAdaptationsForPeriod:function(e){var r,n,i,s=e&&l(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,c=[];if(s&&s.AdaptationSet_asArray)for(i=0;i<s.AdaptationSet_asArray.length;i++)n=s.AdaptationSet_asArray[i],r=new he,n.hasOwnProperty(o.Z.ID)&&(r.id=n.id),r.index=i,r.period=e,u(n,a.Z.MUXED)?r.type=a.Z.MUXED:u(n,a.Z.AUDIO)?r.type=a.Z.AUDIO:d(n)?r.type=a.Z.VIDEO:h(n)?r.type=a.Z.TEXT:g(n)?r.type=a.Z.IMAGE:t.warn("Unknown Adaptation stream type"),c.push(r);return c},getRegularPeriods:function(e){var n,i,s=!!e&&y(e.manifest),l=[],u=null,c=null,f=null,d=null;for(i=0,n=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;i<n;i++)(c=e.manifest.Period_asArray[i]).hasOwnProperty(o.Z.START)?(d=new pe).start=c.start:null!==u&&u.hasOwnProperty(o.Z.DURATION)&&null!==f?(d=new pe).start=parseFloat((f.start+f.duration).toFixed(5)):0!==i||s||((d=new pe).start=0),null!==f&&isNaN(f.duration)&&(null!==d?f.duration=parseFloat((d.start-f.start).toFixed(5)):t.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==d&&(d.id=_(c,i),d.index=i,d.mpd=e,c.hasOwnProperty(o.Z.DURATION)&&(d.duration=c.duration),f&&(f.nextPeriodId=d.id),l.push(d),u=c,f=d),c=null,d=null;return 0===l.length||null!==f&&isNaN(f.duration)&&(f.duration=parseFloat((function(e){!function(){if(!r||!r.hasOwnProperty("error"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var t,n=y(e.mpd.manifest);return e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:n?t=Number.POSITIVE_INFINITY:r.error(new S.Z(I.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e)),t}(f)-f.start).toFixed(5))),l},getMpd:function(e){var t=new me;return e&&(t.manifest=e,e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(o.Z.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(o.Z.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(o.Z.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(o.Z.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(o.Z.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(o.Z.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t,r,i=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,s=i?i.Period_asArray:null,u=s&&e&&l(e.index)?s[e.index].EventStream_asArray:null,c=[];if(u)for(t=0;t<u.length;t++){var f=new _e;if(f.period=e,f.timescale=1,!u[t].hasOwnProperty(a.Z.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(f.schemeIdUri=u[t][a.Z.SCHEME_ID_URI],u[t].hasOwnProperty(o.Z.TIMESCALE)&&(f.timescale=u[t][o.Z.TIMESCALE]),u[t].hasOwnProperty(o.Z.VALUE)&&(f.value=u[t][o.Z.VALUE]),u[t].hasOwnProperty(o.Z.PRESENTATION_TIME_OFFSET)&&(f.presentationTimeOffset=u[t][o.Z.PRESENTATION_TIME_OFFSET]),r=0;u[t].Event_asArray&&r<u[t].Event_asArray.length;r++){var d=u[t].Event_asArray[r],h=new ye;h.presentationTime=0,h.eventStream=f,d.hasOwnProperty(o.Z.PRESENTATION_TIME)&&(h.presentationTime=d.presentationTime);var g=f.presentationTimeOffset?f.presentationTimeOffset/f.timescale:0;h.calculatedPresentationTime=h.presentationTime/f.timescale+e.start-g,d.hasOwnProperty(o.Z.DURATION)&&(h.duration=d.duration/f.timescale),d.hasOwnProperty(o.Z.ID)?h.id=d.id:h.id=null,d.Signal&&d.Signal.Binary?h.messageData=n.decodeArray(d.Signal.Binary.toString()):h.messageData=d.messageData||d.__cdata||d.__text,c.push(h)}}return c},getEssentialPropertiesForRepresentation:E,getEventStreamForAdaptationSet:function(e,t,r){var n,i,a;return e&&e.Period_asArray&&t&&t.period&&l(t.period.index)&&(i=e.Period_asArray[t.period.index])&&i.AdaptationSet_asArray&&l(t.index)&&(a=i.AdaptationSet_asArray[t.index])&&(n=a.InbandEventStream_asArray),A(n,null,r)},getEventStreamForRepresentation:function(e,t,r){var n,i,a,o;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&l(t.adaptation.period.index)&&(i=e.Period_asArray[t.adaptation.period.index])&&i.AdaptationSet_asArray&&l(t.adaptation.index)&&(a=i.AdaptationSet_asArray[t.adaptation.index])&&a.Representation_asArray&&l(t.index)&&(o=a.Representation_asArray[t.index])&&(n=o.InbandEventStream_asArray),A(n,t,r)},getUTCTimingSources:function(e){var t=y(e),r=!!e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME),n=e?e.UTCTiming_asArray:null,i=[];return(t||r)&&n&&n.forEach((function(e){var t=new ve.Z;e.hasOwnProperty(a.Z.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(o.Z.VALUE)&&(t.value=e.value.toString(),i.push(t)))})),i},getBaseURLsFromElement:b,getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth}},getContentSteering:function(e){if(e&&e.hasOwnProperty(o.Z.CONTENT_STEERING_AS_ARRAY))return R(e[o.Z.CONTENT_STEERING_AS_ARRAY][0])},getLocation:function(e){return e&&e.hasOwnProperty(o.Z.LOCATION_AS_ARRAY)?e[o.Z.LOCATION_AS_ARRAY].map((function(e){var t=e.__text||e,r=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null;return new Ne(t,r)})):[]},getPatchLocation:function(e){return e&&e.hasOwnProperty(o.Z.PATCH_LOCATION_AS_ARRAY)?e[o.Z.PATCH_LOCATION_AS_ARRAY].map((function(e){var t=e.__text||e,r=e.hasOwnProperty(o.Z.SERVICE_LOCATION)?e[o.Z.SERVICE_LOCATION]:null,n=e.hasOwnProperty(o.Z.TTL)?1e3*parseFloat(e[o.Z.TTL]):NaN;return new Le(t,r,n)})):[]},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(o.Z.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(o.Z.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(o.Z.SERVICE_DESCRIPTION)){var r,n=Oe(e.ServiceDescription_asArray);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=null,s=null,l=null,u=null,c=null,f=null,d=null;for(var h in i)i.hasOwnProperty(h)&&(h===o.Z.ID?a=i[h]:h===o.Z.SERVICE_DESCRIPTION_SCOPE?s=i[h].schemeIdUri:h===o.Z.SERVICE_DESCRIPTION_LATENCY?l={target:parseInt(i[h].target),max:parseInt(i[h].max),min:parseInt(i[h].min),referenceId:parseInt(i[h].referenceId)}:h===o.Z.SERVICE_DESCRIPTION_PLAYBACK_RATE?u={max:parseFloat(i[h].max),min:parseFloat(i[h].min)}:h===o.Z.SERVICE_DESCRIPTION_OPERATING_QUALITY?c={mediaType:i[h].mediaType,max:parseInt(i[h].max),min:parseInt(i[h].min),target:parseInt(i[h].target),type:i[h].type,maxQualityDifference:parseInt(i[h].maxQualityDifference)}:h===o.Z.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH?f={mediaType:i[h].mediaType,max:parseInt(i[h].max),min:parseInt(i[h].min),target:parseInt(i[h].target)}:h===o.Z.CONTENT_STEERING&&(d=R(i[h])));t.push({id:a,schemeIdUri:s,latency:l,playbackRate:u,operatingQuality:c,operatingBandwidth:f,contentSteering:d})}}catch(e){n.e(e)}finally{n.f()}}return t},getSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(o.Z.SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SEGMENT_ALIGNMENT]},getSubSegmentAlignment:function(e){return!(!e||!e.hasOwnProperty(o.Z.SUB_SEGMENT_ALIGNMENT))&&"true"===e[o.Z.SUB_SEGMENT_ALIGNMENT]},getSupplementalPropertiesForAdaptation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var r,n=Oe(e.SupplementalProperty_asArray);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.hasOwnProperty(a.Z.SCHEME_ID_URI)&&i.hasOwnProperty(o.Z.VALUE)&&(t[i[a.Z.SCHEME_ID_URI]]=i[o.Z.VALUE])}}catch(e){n.e(e)}finally{n.f()}}return t},getSupplementalPropertiesAsArrayForAdaptation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map((function(e){return(new be).init(e)})):[]},getSupplementalPropertiesForRepresentation:function(e){var t={};if(e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)){var r,n=Oe(e.SupplementalProperty_asArray);try{for(n.s();!(r=n.n()).done;){var i=r.value;i.hasOwnProperty(a.Z.SCHEME_ID_URI)&&i.hasOwnProperty(o.Z.VALUE)&&(t[i[a.Z.SCHEME_ID_URI]]=i[o.Z.VALUE])}}catch(e){n.e(e)}finally{n.f()}}return t},getSupplementalPropertiesAsArrayForRepresentation:function(e){return e&&e.hasOwnProperty(o.Z.SUPPLEMENTAL_PROPERTY_ASARRAY)&&e.SupplementalProperty_asArray.length?e.SupplementalProperty_asArray.map((function(e){return(new be).init(e)})):[]},setConfig:function(e){e&&(e.errHandler&&(r=e.errHandler),e.BASE64&&(n=e.BASE64))}},t=(0,f.Z)(i).getInstance().getLogger(e),e}ke.__dashjs_factory_name="DashManifestModel";const xe=c.Z.getSingletonFactory(ke);var Fe=r(703);function Ue(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Be(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Be(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Ze(){var e,t,r,n,i,o,s,u,c,f,h=this.context,g=(0,l.Z)(h).getInstance(),p=(0,w.Z)(h).getInstance();function m(){r={pr:1,nor:null,st:null,sf:null,sid:"".concat(Fe.Z.generateUuid()),cid:null},c={},u={},f={},y()}function v(){y()}function y(){if(o){var e=o.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(s=t.getProcessors())}}}function E(e,t){var r,n={},i=Ue(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;e[a]&&(n[a]=e[a])}}catch(e){i.e(e)}finally{i.f()}return n}function T(e){var t=p.get().streaming.cmcd.enabledKeys;return e.filter((function(e){return t.includes(e)}))}function _(e){try{return e.type===D.w.MPD_TYPE?((l=S()).ot="m",l):e.type===D.w.MEDIA_SEGMENT_TYPE?(t=e.mediaType,f.hasOwnProperty(t)||(f[t]=!1),u.hasOwnProperty(t)||(u[t]=!1),c.hasOwnProperty(t)||(c[t]=!1),function(e){var t,l=S(),d=function(e){try{var t=e.quality,r=e.mediaInfo.bitrateList;return parseInt(r[t].bandwidth/1e3)}catch(e){return null}}(e),h=function(e){try{return isNaN(e.duration)?NaN:Math.round(1e3*e.duration)}catch(e){return null}}(e),g=function(e){try{return 100*parseInt(n.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),m=function(e){try{var t=r.pr,n=i.getCurrentBufferLevel(e);return isNaN(t)||isNaN(n)?null:100*parseInt(n/t*10)}catch(e){return null}}(e.mediaType),v=A(e.mediaType),y=function(e){try{var t=n.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),E=r.pr,T=function(e){if(s&&0!==s.length){var t,r=Ue(s);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.getType()===e)return n.probeNextRequest()}}catch(e){r.e(e)}finally{r.f()}}}(e.mediaType);e.mediaType===a.Z.VIDEO&&(t="v"),e.mediaType===a.Z.AUDIO&&(t="a"),e.mediaType===a.Z.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?"tt":"c");var _=p.get().streaming.cmcd.rtp;return _||(_=function(e){try{var t=o.getPlaybackRate();t||(t=1);var r=e.quality,n=e.mediaType,i=e.mediaInfo,a=e.duration;if(!i)return NaN;var s=A(n);0===s&&(s=500);var l=i.bitrateList[r].bandwidth*a/1e3/(s/t/1e3),u=p.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(p.get().streaming.cmcd.rtpSafetyFactor)?p.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(l*u/100)+1)}catch(e){return NaN}}(e)),isNaN(_)||(l.rtp=_),T&&(e.url!==T.url?l.nor=encodeURIComponent(Fe.Z.getRelativeUrl(e.url,T.url)):T.range&&(l.nrr=T.range)),d&&(l.br=d),t&&(l.ot=t),isNaN(h)||(l.d=h),isNaN(g)||(l.mtp=g),isNaN(m)||(l.dl=m),isNaN(v)||(l.bl=v),isNaN(y)||(l.tb=y),isNaN(E)||1===E||(l.pr=E),c[e.mediaType]&&(l.bs=!0,c[e.mediaType]=!1),!u[e.mediaType]&&f[e.mediaType]||(l.su=!0,u[e.mediaType]=!1,f[e.mediaType]=!0),l}(e)):e.type===D.w.INIT_SEGMENT_TYPE?function(){var e=S();return e.ot="i",e.su=!0,e}():e.type===D.w.OTHER_TYPE||e.type===D.w.XLINK_EXPANSION_TYPE?function(){var e=S();return e.ot="o",e}():e.type===D.w.LICENSE?function(e){var t=S();return t.ot="k",t}():null}catch(e){return null}var t,l}function S(){var e={},t=p.get().streaming.cmcd.cid?p.get().streaming.cmcd.cid:r.cid;return e.v=1,e.sid=p.get().streaming.cmcd.sid?p.get().streaming.cmcd.sid:r.sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(r.pr)||1===r.pr||null===r.pr||(e.pr=r.pr),r.st&&(e.st=r.st),r.sf&&(e.sf=r.sf),e}function A(e){try{var t=i.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function b(e){try{r.pr=e.playbackRate}catch(e){}}function R(t){try{var n=e.getIsDynamic(t.data)?"l":"v",i=t.protocol&&"MSS"===t.protocol?"s":"d";r.st="".concat(n),r.sf="".concat(i)}catch(e){}}function I(e){try{e.state&&e.mediaType&&e.state===d.Z.BUFFER_EMPTY&&(c[e.mediaType]||(c[e.mediaType]=!0),u[e.mediaType]||(u[e.mediaType]=!0))}catch(e){}}function C(){for(var e in c)c.hasOwnProperty(e)&&(c[e]=!0);for(var t in u)u.hasOwnProperty(t)&&(u[t]=!0)}function N(e){try{if(!e)return null;var t=Object.keys(e).sort((function(e,t){return e.localeCompare(t)})),r=t.length,n=t.reduce((function(t,n,i){return"v"===n&&1===e[n]||("string"==typeof e[n]&&"ot"!==n&&"sf"!==n&&"st"!==n?t+="".concat(n,"=").concat(JSON.stringify(e[n])):t+="".concat(n,"=").concat(e[n]),i<r-1&&(t+=",")),t}),"");return(n=n.replace(/=true/g,"")).replace(/,\s*$/,"")}catch(e){return null}}return t={getQueryParameter:function(e){try{if(p.get().streaming.cmcd&&p.get().streaming.cmcd.enabled){var t=_(e),r=function(e){try{var t=p.get().streaming.cmcd.enabledKeys;return Object.keys(e).filter((function(e){return t.includes(e)})).reduce((function(t,r){return t[r]=e[r],t}),{})}catch(t){return e}}(t),n=N(r);return g.trigger(fe.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:n}),{key:"CMCD",value:n}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(p.get().streaming.cmcd&&p.get().streaming.cmcd.enabled){var t=_(e),r=E(t,T(["br","d","ot","tb"])),n=E(t,T(["bl","dl","mtp","nor","nrr","su"])),i=E(t,T(["bs","rtp"])),a=E(t,T(["cid","pr","sf","sid","st","v"])),o={"CMCD-Object":N(r),"CMCD-Request":N(n),"CMCD-Status":N(i),"CMCD-Session":N(a)};return g.trigger(fe.Z.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:o}),o}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(n=e.abrController),e.dashMetrics&&(i=e.dashMetrics),e.playbackController&&(o=e.playbackController))},reset:function(){g.off(d.Z.PLAYBACK_RATE_CHANGED,b,this),g.off(d.Z.MANIFEST_LOADED,R,this),g.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,I,t),g.off(d.Z.PLAYBACK_SEEKED,C,t),m()},initialize:function(){g.on(d.Z.PLAYBACK_RATE_CHANGED,b,t),g.on(d.Z.MANIFEST_LOADED,R,t),g.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,I,t),g.on(d.Z.PLAYBACK_SEEKED,C,t),g.on(d.Z.PERIOD_SWITCH_COMPLETED,v,t)}},e=xe(h).getInstance(),m(),t}Ze.__dashjs_factory_name="CmcdModel";const Ge=c.Z.getSingletonFactory(Ze);function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function He(e,t){He=function(e,t){return new a(e,void 0,t)};var r=Ye(RegExp),n=RegExp.prototype,i=new WeakMap;function a(e,t,n){var a=r.call(this,e,t);return i.set(a,n||i.get(e)),a}function o(e,t){var r=i.get(t);return Object.keys(r).reduce((function(t,n){return t[n]=e[r[n]],t}),Object.create(null))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(a,r),a.prototype.exec=function(e){var t=n.exec.call(this,e);return t&&(t.groups=o(t,this)),t},a.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var r=i.get(this);return n[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+r[t]})))}if("function"==typeof t){var a=this;return n[Symbol.replace].call(this,e,(function(){var e=[];return e.push.apply(e,arguments),"object"!==Ke(e[e.length-1])&&e.push(o(e,a)),t.apply(this,e)}))}return n[Symbol.replace].call(this,e,t)},He.apply(this,arguments)}function Ye(e){var t="function"==typeof Map?new Map:void 0;return Ye=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Ve(e,arguments,je(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),qe(n,e)},Ye(e)}function Ve(e,t,r){return Ve=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&qe(i,r.prototype),i},Ve.apply(null,arguments)}function qe(e,t){return qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qe(e,t)}function je(e){return je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},je(e)}var ze="static",We="dynamic",Xe="cmsd-",Qe=Xe+ze,Je=Xe+We,$e="stream",et=["mb","st","sf","v"],tt={video:"v",audio:"a",text:"tt",stream:$e},rt=/^[-0-9]/;function nt(){var e,t,r,n,i=this.context,a=(0,l.Z)(i).getInstance();function o(){r={},n={}}function s(e){e&&Object.keys(e).forEach((function(t){et.includes(t)||delete e[t]}))}function c(e){return!e||"false"!==e.toLowerCase()&&(rt.test(e)?parseInt(e,10):e.replace(/["]+/g,""))}function d(e){try{for(var r={},n=e.split(","),i=0;i<n.length;i++){var a=n[i].split("="),o=a[0],s=c(a[1]);r[o]=s}return r}catch(e){t.error("Failed to parse CMSD-Static response header value:",e)}}function h(e){try{for(var r={},n=e.split(","),i=n[n.length-1].split(";"),a=1;a<i.length;a++){var o=i[a].split("="),s=o[0],l=c(o[1]);r[s]=l}return r}catch(e){return t.error("Failed to parse CMSD-Dynamic response header value:",e),[]}}function g(e){return tt[e]||"o"}function p(e,t,i){var a=e===ze?r:n,o=a[t]||{},s=a[$e]||{};return o[i]||s[i]}return e={setConfig:function(){},initialize:function(){},reset:function(){o()},parseResponseHeaders:function(e,t){for(var i=null,o=null,l=e.split("\r\n"),c=l.length-1;c>=0;c--){var f=l[c].match(He(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(f&&f.groups){var p=f.groups.key.toLowerCase(),m=f.groups.value;switch(p){case Qe:i=d(m),a.trigger(u.Z.CMSD_STATIC_HEADER,i);break;case Je:o||(o=h(m))}}}var v=$e;return i&&i.ot?v=i.ot:t&&(v=g(t)),s(r[v]),s(n[v]),i&&(r[v]=Object.assign(r[v]||{},i)),o&&(n[v]=Object.assign(n[v]||{},o)),{static:i,dynamic:o}},getMaxBitrate:function(e){var t=g(e);return p(We,t,"mb")||-1},getEstimatedThroughput:function(e){var t=g(e);return p(We,t,"etp")||null},getResponseDelay:function(e){var t=g(e);return p(We,t,"rd")||null},getRoundTripTime:function(e){var t=g(e);return p(We,t,"rtt")||null}},t=(0,f.Z)(i).getInstance().getLogger(e),o(),e}nt.__dashjs_factory_name="CmsdModel";const it=c.Z.getSingletonFactory(nt);function at(){var e,t,r=this.context,n={};function i(){t=(0,f.Z)(r).getInstance().getLogger(e)}function a(e){for(var t={},r=0,n=0,i=0,a=0,o=e.length,s=0;s<o;++s)r+=e[s].chunkDownloadTimeRelativeMS,n+=e[s].bufferLevel,i+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,a+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(i-r*n/o)/(a-r*r/o),t.b=n/o-t.m*r/o,function(e){return t.m*e+t.b}}function o(e){var t,r=!0,n=e.reduce((function(e,t){return e+t.bufferLevelAtSegmentEnd}),0)/e.length;return e.forEach((function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(r=!1),e.bufferLevelAtSegmentEnd/n<.8&&(r=!1),t?t>e.bitrate&&(r=!1):t=e.bitrate})),r}return e={setup:i,addMeasurement:function(e,t,r,i,o){e&&e.mediaType&&!n[e.mediaType]&&(n[e.mediaType]=[]);var s=e.mediaInfo.bitrateList.find((function(t){return t.id===e.representationId}));n[e.mediaType].push({index:e.index,repId:e.representationId,mediaType:e.mediaType,requestTimeMS:i,adjustedAvailabilityStartTimeMS:e.availabilityStartTime.getTime(),segDurationMS:1e3*e.duration,chunksDurationMS:r.reduce((function(e,t){return e+t.chunkDownloadDurationMS}),0),segmentBytes:r.reduce((function(e,t){return e+t.chunkBytes}),0),bitrate:s&&s.bandwidth,bitrateList:e.mediaInfo.bitrateList,chunkMeasurements:r,fetchDownloadDurationMS:t,throughputCapacityDelayMS:o,getEstimatedBufferLevel:a(r.slice(1))}),n[e.mediaType].length>10&&n[e.mediaType].shift()},getThroughputCapacityDelayMS:function(e,t){var r=n[e.mediaType]&&n[e.mediaType].slice(-3);return!r||r.length<3?0:o(r)?t/4>250?250:t/4:0},getEstimatedDownloadDurationMS:function(e){var r=n[e.mediaType].slice(-1).pop(),i=n[e.mediaType].slice(-3),a=r.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;r.bufferLevelAtSegmentStart=r.getEstimatedBufferLevel(a/2),r.bufferLevelAtSegmentEnd=r.getEstimatedBufferLevel(a);var s=o(i),l=s?.6:.8;if(r.isBufferStable&&1.05*r.segDurationMS<r.fetchDownloadDurationMS)return r.fetchDownloadDurationMS;if(!s||r.segDurationMS<r.fetchDownloadDurationMS)return.8*r.fetchDownloadDurationMS;if(r.adjustedAvailabilityStartTimeMS<=r.requestTimeMS+r.throughputCapacityDelayMS-r.segDurationMS)return.8*r.fetchDownloadDurationMS;for(var u=r.requestTimeMS+r.throughputCapacityDelayMS-r.adjustedAvailabilityStartTimeMS,c=0,f=0,d=0,h=0;h<r.chunkMeasurements.length;h++){var g=r.chunkMeasurements[h];if(u<f+g.chunkDownloadDurationMS)break;f+=g.chunkDownloadDurationMS,c+=g.chunkBytes,d++}if(u<0&&t.warn("request time was before adjusted availibitly start time"),c&&f&&d>.2*r.chunkMeasurements.length){var p=c/f,m=r.segmentBytes/p;return r.fetchDownloadDurationMS<m?r.fetchDownloadDurationMS*l:m*l}var v=r.bitrate;return r.bitrateList.some((function(e){if(e.bandwidth>r.bitrate)return v=e.bandwidth,!0})),v===r.bitrate?r.fetchDownloadDurationMS*l:l*r.segmentBytes*8*1e3/v}},i(),e}at.__dashjs_factory_name="LowLatencyThroughputModel";const ot=c.Z.getSingletonFactory(at);var st=r(5717);function lt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ut(e){e=e||{};var t,r,n,i,o,s,c,d,h,g,p,m=this.context,v=e.errHandler,y=e.dashMetrics,E=e.mediaPlayerModel,T=e.requestModifier,_=e.boxParser,A=e.errors,b=e.requestTimeout||0,R=(0,l.Z)(m).getInstance(),I=(0,w.Z)(m).getInstance();function C(e,t){var l,f=e.request,p=[],A=!0,w=!0,N=new Date,L=N,O=0,P=null,M=null;if(!T||!y||!v)throw new Error("config object is not correct or missing");var k,x=function(e){f.requestStartDate=N,f.requestEndDate=new Date,f.firstByteDate=f.firstByteDate||N,f.fileLoaderType=M;var t=l.response?l.response.responseURL:null,r=l.response?l.response.status:null,n=l.response&&l.response.getAllResponseHeaders?l.response.getAllResponseHeaders():l.response?l.response.responseHeaders:null,i=n&&I.get().streaming.cmsd&&I.get().streaming.cmsd.enabled?c.parseResponseHeaders(n,f.mediaType):null;y.addHttpRequest(f,t,r,n,e?p:null,i)},F=function(e){w=!1,x(e),f.type===D.w.MPD_TYPE&&(y.addManifestUpdate(f),R.trigger(u.Z.MANIFEST_LOADING_FINISHED,{request:f}))},U=function(){if(P&&(clearTimeout(P),P=null),-1!==r.indexOf(l)&&(r.splice(r.indexOf(l),1),w))if(F(!1),t>0){try{I.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&f.type===D.w.MEDIA_SEGMENT_TYPE&&E.getRetryAttemptsForType(D.w.MEDIA_SEGMENT_TYPE)===t&&R.trigger(u.Z.ATTEMPT_BACKGROUND_SYNC)}catch(e){}t--;var n={config:e};i.push(n),n.timeout=setTimeout((function(){-1!==i.indexOf(n)&&(i.splice(i.indexOf(n),1),C(e,t))}),E.getRetryIntervalsForType(f.type))}else{if(f.type===D.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;v.error(new S.Z(o[f.type],f.url+" is not available",{request:f,response:l.response})),e.error&&e.error(f,"error",l.response.statusText,l.response),e.complete&&e.complete(f,l.response.statusText)}};f.hasOwnProperty("availabilityTimeComplete")&&!1===f.availabilityTimeComplete&&window.fetch&&"arraybuffer"===f.responseType&&f.type===D.w.MEDIA_SEGMENT_TYPE?((k=ce(m).create({requestModifier:T,lowLatencyThroughputModel:h,boxParser:_})).setup({dashMetrics:y}),M=a.Z.FILE_LOADER_TYPES.FETCH):(k=(0,oe.Z)(m).create({requestModifier:T}),M=a.Z.FILE_LOADER_TYPES.XHR);var B=null,Z=T.modifyRequestURL?T.modifyRequestURL(f.url):f.url;if(I.get().streaming.cmcd&&I.get().streaming.cmcd.enabled){var G=I.get().streaming.cmcd.mode;if(G===a.Z.CMCD_MODE_QUERY){var K=function(e){try{var t=[],r=s.getQueryParameter(e);return r&&t.push(r),t}catch(e){return[]}}(f);Z=Fe.Z.addAditionalQueryParameterToUrl(Z,K)}else G===a.Z.CMCD_MODE_HEADER&&(B=s.getHeaderParameters(f))}var H=d.getXHRWithCredentialsForType(f.type);if(f.queryParams){var Y=Object.keys(f.queryParams).map((function(e){return{key:e,value:f.queryParams[e]}}));Z=Fe.Z.addAditionalQueryParameterToUrl(Z,Y)}f.url=Z,l={url:Z,method:D.w.GET,withCredentials:H,request:f,onload:function(){l.response.status>=200&&l.response.status<=299&&(F(!0),e.success&&e.success(l.response.response,l.response.statusText,l.response.responseURL),e.complete&&e.complete(f,l.response.statusText))},onend:U,onerror:U,progress:function(t){var r=new Date;A&&(A=!1,(!t.lengthComputable||t.lengthComputable&&t.total!==t.loaded)&&(f.firstByteDate=r)),t.lengthComputable&&(f.bytesLoaded=t.loaded,f.bytesTotal=t.total),t.noTrace||(p.push({s:L,d:t.time?t.time:r.getTime()-L.getTime(),b:[t.loaded?t.loaded-O:0]}),L=r,O=t.loaded),P&&(clearTimeout(P),P=null),I.get().streaming.fragmentRequestProgressTimeout>0&&(P=setTimeout((function(){g.warn("Abort request "+l.url+" due to progress timeout"),l.response.onabort=null,l.loader.abort(l),U()}),I.get().streaming.fragmentRequestProgressTimeout)),e.progress&&t&&e.progress(t)},onabort:function(){x(!0),P&&(clearTimeout(P),P=null),e.abort&&e.abort(f)},ontimeout:function(e){var t;if(e.lengthComputable){var r=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+r.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";g.warn(t)},loader:k,timeout:b,headers:B};var V=(new Date).getTime();if(isNaN(f.delayLoadingTime)||V>=f.delayLoadingTime)r.push(l),k.load(l);else{var q={httpRequest:l};n.push(q),q.delayTimeout=setTimeout((function(){if(-1!==n.indexOf(q)){n.splice(n.indexOf(q),1);try{N=new Date,L=N,r.push(q.httpRequest),k.load(q.httpRequest)}catch(e){q.httpRequest.onerror()}}}),f.delayLoadingTime-V)}}return t={load:function(e){e.request?C(e,E.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){i.forEach((function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)})),i=[],n.forEach((function(e){return clearTimeout(e.delayTimeout)})),n=[],r.forEach((function(e){e.request.type!==D.w.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))})),r=[]}},g=(0,f.Z)(m).getInstance().getLogger(t),r=[],n=[],i=[],s=Ge(m).getInstance(),c=it(m).getInstance(),h=ot(m).getInstance(),d=(0,st.Z)(m).getInstance(),lt(p={},D.w.MPD_TYPE,A.DOWNLOAD_ERROR_ID_MANIFEST_CODE),lt(p,D.w.XLINK_EXPANSION_TYPE,A.DOWNLOAD_ERROR_ID_XLINK_CODE),lt(p,D.w.INIT_SEGMENT_TYPE,A.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),lt(p,D.w.MEDIA_SEGMENT_TYPE,A.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(p,D.w.INDEX_SEGMENT_TYPE,A.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(p,D.w.BITSTREAM_SWITCHING_SEGMENT_TYPE,A.DOWNLOAD_ERROR_ID_CONTENT_CODE),lt(p,D.w.OTHER_TYPE,A.DOWNLOAD_ERROR_ID_CONTENT_CODE),o=p,t}ut.__dashjs_factory_name="HTTPLoader";const ct=c.Z.getClassFactory(ut);function ft(){var e;function t(){e={}}function r(){t()}return r(),{getLoader:function(t){for(var r in e)if(e.hasOwnProperty(r)&&t.startsWith(r))return e[r];return ct},registerLoader:function(t,r){e[t]=r},unregisterLoader:function(t){e[t]&&delete e[t]},unregisterAllLoader:t,reset:r}}ft.__dashjs_factory_name="SchemeLoaderFactory";const dt=c.Z.getSingletonFactory(ft);function ht(e){e=e||{};var t,r,n=this.context;return t=dt(n).getInstance(),{load:function(i){if(!r){var a=t.getLoader(i&&i.request?i.request.url:null);r=a(n).create({errHandler:e.errHandler,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,dashMetrics:e.dashMetrics,boxParser:e.boxParser?e.boxParser:null,constants:e.constants?e.constants:null,dashConstants:e.dashConstants?e.dashConstants:null,urlUtils:e.urlUtils?e.urlUtils:null,requestTimeout:isNaN(e.requestTimeout)?0:e.requestTimeout,errors:e.errors})}r.load(i)},abort:function(){r&&r.abort()}}}ht.__dashjs_factory_name="URLLoader";const gt=c.Z.getClassFactory(ht);function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function mt(e,t){return mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mt(e,t)}function vt(e){return vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},vt(e)}const yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mt(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=vt(t);if(r){var i=vt(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e)).checkForExistenceOnly=!0,t}return i}(p.Z);function Et(e){e=e||{};var t,r,n=this.context,i=e.eventBus,o=e.events,s=e.urlUtils,l=e.errors,u=e.streamId;return t={checkForExistence:function(e){var t=function(t){i.trigger(o.CHECK_FOR_EXISTENCE_COMPLETED,{request:e,exists:t})};if(e){var n=new yt(e.url);r.load({request:n,success:function(){t(!0)},error:function(){t(!1)}})}else t(!1)},load:function(e){var n=function(r,n){i.trigger(o.LOADING_COMPLETED,{request:e,response:r||null,error:n||null,sender:t})};e?r.load({request:e,progress:function(r){i.trigger(o.LOADING_PROGRESS,{request:e,stream:r.stream,streamId:u}),r.data&&i.trigger(o.LOADING_DATA_PROGRESS,{request:e,response:r.data||null,error:null,sender:t})},success:function(e){n(e)},error:function(e,t,r){n(void 0,new S.Z(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,r,t))},abort:function(e){e&&i.trigger(o.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:t})}}):n(void 0,new S.Z(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){r&&r.abort()},reset:function(){r&&(r.abort(),r=null)}},r=gt(n).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:s,constants:a.Z,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),t}Et.__dashjs_factory_name="FragmentLoader";const Tt=c.Z.getClassFactory(Et);function _t(){return{modifyResponseAsync:function(e){return Promise.resolve(e)}}}_t.__dashjs_factory_name="SegmentResponseModifier";const St=c.Z.getSingletonFactory(_t);function At(e){e=e||{};var t,r,n,i=this.context,o=(0,l.Z)(i).getInstance(),s=e.errHandler,c=e.mediaPlayerModel,h=e.dashMetrics,g=(0,f.Z)(i).getInstance(),p=St(i).getInstance(),m=e.streamInfo;function v(){return m.id}function y(){for(var e in n)n[e].reset();n={}}function E(e){if(e.sender){var t=e.request,n=e.response,i=t.isInitializationRequest(),s=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType===a.Z.AUDIO||t.mediaType===a.Z.VIDEO||t.mediaType===a.Z.TEXT&&t.mediaInfo.isFragmented)&&o.trigger(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD,{entry:e.request.serviceLocation}),n&&s){var l=function(e,t,r,n){var i=new ae;return i.streamId=r,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=n,i}(n,t,m.id,e.type!==u.Z.FRAGMENT_LOADING_PROGRESS);p.modifyResponseAsync(l).then((function(e){o.trigger(i?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:e,request:t},{streamId:s.id,mediaType:t.mediaType})})).catch((function(e){r.error(e),o.trigger(i?u.Z.INIT_FRAGMENT_LOADED:u.Z.MEDIA_FRAGMENT_LOADED,{chunk:l,request:t},{streamId:s.id,mediaType:t.mediaType})}))}else r.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return t={getStreamId:v,getModel:function(t){var r=n[t];return r||(r=_(i).create({streamInfo:m,type:t,dashMetrics:h,fragmentLoader:Tt(i).create({dashMetrics:h,mediaPlayerModel:c,errHandler:s,requestModifier:(0,W.Z)(i).getInstance(),settings:e.settings,boxParser:e.boxParser,eventBus:o,events:u.Z,errors:I,dashConstants:e.dashConstants,urlUtils:e.urlUtils,streamId:v()}),debug:g,eventBus:o,events:u.Z}),n[t]=r),r},reset:function(){o.off(d.Z.FRAGMENT_LOADING_COMPLETED,E,this),o.off(d.Z.FRAGMENT_LOADING_PROGRESS,E,this),y()}},r=g.getLogger(t),y(),o.on(d.Z.FRAGMENT_LOADING_COMPLETED,E,t),o.on(d.Z.FRAGMENT_LOADING_PROGRESS,E,t),t}At.__dashjs_factory_name="FragmentController";const bt=c.Z.getClassFactory(At),Rt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null},It=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};function wt(e){var t,r,n=this.context,i=e.streamInfo;function o(e){r.setTrackByIndex(e)}function s(){r&&r.reset()}return t={getStreamId:function(){return i.id},initialize:function(){r.addTracks();var e=r.getTracks();e&&e.length>0&&o(0)},provide:function(e,t){if("function"==typeof t){var n,i,a=r.getCurrentTrack();if(!a||a.segmentDuration<=0||null==e)t(null);else{(i=r.getThumbnailRequestForTime(e))&&(a.segmentDuration=i.duration),n=e%a.segmentDuration;var o=Math.floor(n*a.tilesHor*a.tilesVert/a.segmentDuration),s=new Rt;if(s.width=Math.floor(a.widthPerTile),s.height=Math.floor(a.heightPerTile),s.x=Math.floor(o%a.tilesHor)*a.widthPerTile,s.y=Math.floor(o/a.tilesHor)*a.heightPerTile,"readThumbnail"in a)return a.readThumbnail(e,(function(e){s.url=e,t(s)}));if(i)s.url=i.url,a.segmentDuration=NaN;else{var l=Math.floor(e/a.segmentDuration);s.url=function(e,t){var r=t+e.startNumber,n=(0,Y.vi)(e.templateUrl,"Number",r);return n=(0,Y.vi)(n,"Time",(r-1)*e.segmentDuration*e.timescale),n=(0,Y.vi)(n,"Bandwidth",e.bandwidth),(0,Y.eR)(n)}(a,l)}t(s)}}},setTrackByIndex:o,getCurrentTrackIndex:function(){return r.getCurrentTrackIndex()},getBitrateList:function(){var e=r.getTracks(),t=0;return e.map((function(e){var r=new It;return r.mediaType=a.Z.IMAGE,r.qualityIndex=t++,r.bitrate=e.bitrate,r.width=e.width,r.height=e.height,r}))},reset:s},s(),r=(0,Ce.Z)(n).create({streamInfo:i,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t}wt.__dashjs_factory_name="ThumbnailController";const Dt=c.Z.getClassFactory(wt);var Ct=r(7417);function Nt(e){var t;e=e||{};var r=[],n=(0,l.Z)(this.context).getInstance(),i=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===r.indexOf(e)&&(r.push(e),n.trigger(i,{entry:e}))}return t={add:o,contains:function(e){return!!(r.length&&e&&e.length)&&-1!==r.indexOf(e)},reset:function(){r=[]}},a&&n.on(a,(function(e){o(e.entry)}),t),t}Nt.__dashjs_factory_name="BlackListController";const Lt=c.Z.getClassFactory(Nt);var Ot=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT,a.Z.MUXED,a.Z.IMAGE];function Pt(e){e=e||{};var t,r,n,i,s,c,d,h,g,p,m,v,y,E,T,_,A,b,R=this.context,w=(0,l.Z)(R).getInstance(),D=(0,X.Z)(R).getInstance(),C=e.manifestModel,N=e.mediaPlayerModel,L=e.dashMetrics,O=e.manifestUpdater,P=e.adapter,M=e.timelineConverter,k=e.capabilities,x=e.errHandler,F=e.abrController,U=e.playbackController,B=e.eventController,Z=e.mediaController,G=e.protectionController,K=e.textController,H=e.videoModel,Y=e.streamInfo,V=e.settings;function q(e,t){return new Promise((function(i,o){re(),p=!0,ae();var s=H.getElement(),l=[];Ot.forEach((function(t){(t!==a.Z.TEXT||e)&&(t!==a.Z.VIDEO||!s||s&&/^VIDEO$/i.test(s.nodeName))&&l.push(j(t,e))})),Promise.all(l).then((function(){return e=t,new Promise((function(t){var r={},i=n.map((function(t){return t.createBufferSinks(e)}));Promise.all(i).then((function(e){e.forEach((function(e){e&&(r[e.getType()]=e)})),t(r)})).catch((function(){t(r)}))}));var e})).then((function(t){if(p=!1,0===n.length){var a="No streams to play.";x.error(new S.Z(I.MANIFEST_ERROR_ID_NOSTREAMS_CODE,a,C.getValue())),r.fatal(a)}else oe();e&&K.createTracks(Y),i(t)})).catch((function(e){o(e)}))}))}function j(t,i){var s,l=P.getAllMediaInfoForType(Y,t),c=[],f=null;if(!l||0===l.length)return r.info("No "+t+" data."),Promise.resolve();t===a.Z.VIDEO&&(d=!0),t===a.Z.AUDIO&&(h=!0);for(var g=0,p=l.length;g<p;g++)f=l[g],t===a.Z.TEXT&&f.isEmbedded&&(K.addEmbeddedTrack(Y,f),c.push(f)),z(f)&&Z.addTrack(f);if(c.length>0&&(Z.setInitialMediaSettingsForType(t,Y),K.addMediaInfosToBuffer(Y,t,c)),l=l.filter((function(e){return!e.isEmbedded})),0===l.length)return Promise.resolve();if(t===a.Z.IMAGE)return(v=Dt(R).create({streamInfo:Y,adapter:P,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:_,eventBus:w,events:u.Z,dashConstants:o.Z,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController})).initialize(),Promise.resolve();w.trigger(u.Z.STREAM_INITIALIZING,{streamInfo:Y,mediaInfo:f}),Z.setInitialMediaSettingsForType(t,Y);var E=function(t,r){var i=t&&t.length>0?t[0]:null,o=m.getModel(i?i.type:null),s=i?i.type:null,l=i?i.mimeType:null,u=i?i.isFragmented:null,c=ie(R).create({streamInfo:Y,type:s,mimeType:l,timelineConverter:M,adapter:P,manifestModel:C,mediaPlayerModel:N,fragmentModel:o,dashMetrics:e.dashMetrics,baseURLController:e.baseURLController,segmentBaseController:e.segmentBaseController,abrController:F,playbackController:U,mediaController:Z,textController:K,errHandler:x,settings:V,boxParser:T,segmentBlacklistController:y});c.initialize(r,d,u),n.push(c);for(var f=0;f<t.length;f++)c.addMediaInfo(t[f]);return s===a.Z.TEXT&&K.addMediaInfosToBuffer(Y,s,t,o),c}(l,i);return(s=Z.getCurrentTrackFor(t,Y.id))?(F.updateTopQualityIndex(s),E.selectMediaInfo(t===a.Z.TEXT&&s.isEmbedded?l[0]:s)):Promise.resolve()}function z(e){var t,n=e?e.type:null;return n===a.Z.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",r.fatal(t),x.error(new S.Z(I.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,C.getValue())),!1):!(n!==a.Z.TEXT&&n!==a.Z.IMAGE&&e.contentProtection&&!k.supportsEncryptedMedia()&&(x.error(new S.Z(I.CAPABILITY_MEDIAKEYS_ERROR_CODE,I.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),1))}function W(e){for(var t=n?n.length:0,r=0;r<t;r++){var i=n[r].getFragmentModel();i.abortRequests(),i.resetInitialSettings(),n[r].reset(!1,e)}K&&K.deactivateStream(Y),n=[],s=!1,c=!1,me(!1),J(!1),w.trigger(u.Z.STREAM_DEACTIVATED,{streamInfo:Y})}function Q(e){W(e),i=!1,d=!1,h=!1,g={},p=!1,A=!1,b=[]}function J(e){A=e}function $(){return Y?Y.start:NaN}function ee(){return Y?Y.id:null}function te(){return Y}function re(){if(!H||!F)throw new Error(a.Z.MISSING_CONFIG_ERROR)}function ne(e){e.error&&(x.error(e.error),r.fatal(e.error.message))}function ae(){if(B){var e=P.getEventsFor(Y);e&&e.length>0&&B.addInlineEvents(e,Y.id)}}function oe(){for(var e=n.length,t=g.audio||g.video?new S.Z(I.DATA_UPDATE_FAILED_ERROR_CODE,I.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,r=0;r<e;r++)if(n[r].isUpdating()||p)return;if(G){G.clearMediaInfoArray();for(var o=0;o<e&&n[o];o++){var s=n[o].getType(),l=n[o].getMediaInfo();if(s===a.Z.AUDIO||s===a.Z.VIDEO||s===a.Z.TEXT&&l.isFragmented){var c=n[o].getMediaInfo();c&&G.initializeForMedia(c)}}G.handleKeySystemFromManifest()}t?x.error(t):i||(i=!0,H.waitForReadyState(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){w.trigger(u.Z.STREAM_INITIALIZED,{streamInfo:Y})})))}function se(){var e=de(),t=e.length;if(0!==t){for(var n=0;n<t;n++)if(!e[n].isBufferingCompleted()&&(e[n].getType()===a.Z.AUDIO||e[n].getType()===a.Z.VIDEO))return void r.debug("onBufferingCompleted - One streamProcessor has finished but",e[n].getType(),"one is not buffering completed");r.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),c=!0,w.trigger(u.Z.STREAM_BUFFERING_COMPLETED,{streamInfo:Y},{streamInfo:Y})}else r.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function le(e){g[e.mediaType]=e.error,oe()}function ue(e){B&&B.addInbandEvents(e.events,Y.id)}function ce(e){return e&&e.type?fe(e.type):null}function fe(e){return e?de().filter((function(t){return t.getType()===e}))[0]:null}function de(){for(var e,t,r=[],i=0;i<n.length;i++)(e=(t=n[i]).getType())!==a.Z.AUDIO&&e!==a.Z.VIDEO&&e!==a.Z.TEXT||r.push(t);return r}function he(e,t){var r=te(),n=t.getStreamInfo();if(!n||!r)return!0;var i=P.getAdaptationForType(n.index,e,n),a=P.getAdaptationForType(r.index,e,r);return i&&a?!(!ge(a)&&ge(i)):!i&&!a}function ge(e){return!!e&&!!(e.ContentProtection||e.Representation_asArray&&e.Representation_asArray.length>0&&e.Representation_asArray[0].ContentProtection)}function pe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var n=e.getStreamInfo(),i=r?r.getStreamInfo():te();if(!n||!i)return!1;var a=P.getAdaptationForType(n.index,t,n),o=P.getAdaptationForType(i.index,t,i);if(!a||!o)return!a&&!o;var s=a&&o&&a.mimeType===o.mimeType,l=o.Representation_asArray.map((function(e){return e.codecs})),u=a.Representation_asArray.map((function(e){return e.codecs})),c=u.some((function(e){return l.indexOf(e)>-1})),f=u.some((function(e){return l.some((function(t){return k.codecRootCompatibleWithCodec(t,e)}))}));return c||f&&s}function me(e){E=e}function ve(){return E}return t={initialize:function(){w.on(u.Z.BUFFERING_COMPLETED,se,t),w.on(u.Z.DATA_UPDATE_COMPLETED,le,t),w.on(u.Z.INBAND_EVENTS,ue,t),G&&(w.on(u.Z.KEY_ERROR,ne,t),w.on(u.Z.SERVER_CERTIFICATE_UPDATED,ne,t),w.on(u.Z.LICENSE_REQUEST_COMPLETE,ne,t),w.on(u.Z.KEY_SYSTEM_SELECTED,ne,t),w.on(u.Z.KEY_SESSION_CREATED,ne,t),w.on(u.Z.KEY_STATUSES_CHANGED,ne,t)),K.initializeForStream(Y),w.trigger(u.Z.STREAM_UPDATED,{streamInfo:Y})},getStreamId:function(){return Y?Y.id:null},activate:function(e,t){return new Promise((function(r,n){if(!s)return ve()?(s=!0,w.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:Y}),void r(t)):void function(e,t){return q(e,t)}(e,t).then((function(e){s=!0,w.trigger(u.Z.STREAM_ACTIVATED,{streamInfo:Y}),r(e)})).catch((function(e){n(e)}));r(t)}))},deactivate:W,getIsActive:function(){return s},getDuration:function(){return Y?Y.duration:NaN},getStartTime:$,getId:ee,getStreamInfo:te,getHasAudioTrack:function(){return h},getHasVideoTrack:function(){return d},startPreloading:function(e,t){return new Promise((function(i,a){ve()?a():(r.info("[startPreloading] Preloading next stream with id ".concat(ee())),me(!0),q(e,t).then((function(){for(var e=0;e<n.length&&n[e];e++)n[e].setExplicitBufferingTime($()),n[e].getScheduleController().startScheduleTimer();i()})).catch((function(){me(!1),a()})))}))},initializeForTextWithMediaSource:function(e){return new Promise((function(t,r){j(a.Z.TEXT,e).then((function(){return(e=fe(a.Z.TEXT))?e.createBufferSinks():Promise.resolve();var e})).then((function(){K.createTracks(Y),t()})).catch((function(e){r(e)}))}))},getThumbnailController:function(){return v},getBitrateListFor:function(e){if(re(),e===a.Z.IMAGE)return v?v.getBitrateList():[];var t=function(e){for(var t=null,r=0;r<n.length;r++)if((t=n[r]).getType()===e)return t.getMediaInfo();return null}(e);return F.getBitrateList(t)},updateData:function(e){return new Promise((function(t){p=!0,Y=e,B&&ae();for(var r=[],i=0,a=n.length;i<a;i++){var o=n[i],s=o.getMediaInfo();r.push(o.updateStreamInfo(Y));var l=P.getAllMediaInfoForType(Y,o.getType());if(l=l.filter((function(e){return!e.isEmbedded}))){o.clearMediaInfoArray();for(var c=0;c<l.length;c++){var f=l[c];o.addMediaInfo(l[c]),P.areMediaInfosEqual(s,f)&&(F.updateTopQualityIndex(f),r.push(o.selectMediaInfo(f)))}}}Promise.all(r).then((function(){for(r=[];b.length>0;){var e=b.pop(),t=e.newMediaInfo,n=ce(e.oldMediaInfo);if(!n)return;r.push(n.prepareTrackSwitch()),r.push(n.selectMediaInfo(t))}return Promise.all(r)})).then((function(){p=!1,oe(),w.trigger(u.Z.STREAM_UPDATED,{streamInfo:Y}),t()}))}))},reset:function(e){m&&(m.reset(),m=null),F&&Y&&F.clearDataForStream(Y.id),y&&(y.reset(),y=null),Q(e),Y=null,w.off(u.Z.DATA_UPDATE_COMPLETED,le,t),w.off(u.Z.BUFFERING_COMPLETED,se,t),w.off(u.Z.INBAND_EVENTS,ue,t),G&&(w.off(u.Z.KEY_ERROR,ne,t),w.off(u.Z.SERVER_CERTIFICATE_UPDATED,ne,t),w.off(u.Z.LICENSE_REQUEST_COMPLETE,ne,t),w.off(u.Z.KEY_SYSTEM_SELECTED,ne,t),w.off(u.Z.KEY_SESSION_CREATED,ne,t),w.off(u.Z.KEY_STATUSES_CHANGED,ne,t))},getProcessors:de,setMediaSource:function(e){return new Promise((function(t,i){for(var a=[],o=0;o<n.length;)z(n[o].getMediaInfo())?(a.push(n[o].setMediaSource(e)),o++):(n[o].reset(),n.splice(o,1));Promise.all(a).then((function(){for(var e=0;e<n.length;e++)n[e].dischargePreBuffer();if(0===n.length){var i="No streams to play.";x.error(new S.Z(I.MANIFEST_ERROR_ID_NOSTREAMS_CODE,i+"nostreams",C.getValue())),r.fatal(i)}t()})).catch((function(e){r.error(e),i(e)}))}))},isMediaCodecCompatible:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return pe(e,a.Z.VIDEO,t)&&pe(e,a.Z.AUDIO,t)},isProtectionCompatible:function(e){return!e||he(a.Z.VIDEO,e)&&he(a.Z.AUDIO,e)},getPreloaded:ve,getIsEndedEventSignaled:function(){return A},setIsEndedEventSignaled:J,getAdapter:function(){return P},getHasFinishedBuffering:function(){return c},setPreloaded:me,startScheduleControllers:function(){for(var e=n.length,t=0;t<e&&n[t];t++)n[t].getScheduleController().startScheduleTimer()},prepareTrackChange:function(e){if(s&&Y){c=!1;var t=e.newMediaInfo,n=C.getValue();P.setCurrentMediaInfo(Y.id,t.type,t);var i=ce(t);if(i){var o=U.getTime();r.info("Stream -  Process track changed at current time "+o),n.refreshManifestOnSwitchTrack?(b.push(e),O.getIsUpdating()||(r.debug("Stream -  Refreshing manifest for switch track"),O.refreshManifest())):i.selectMediaInfo(t).then((function(){t.type!==a.Z.VIDEO&&t.type!==a.Z.AUDIO||F.updateTopQualityIndex(t),i.prepareTrackSwitch()}))}}},prepareQualityChange:function(e){var t=fe(e.mediaType);t&&t.prepareQualityChange(e)}},function(){try{_=(0,f.Z)(R).getInstance(),r=_.getLogger(t),Q(),T=(0,Ct.Z)(R).getInstance(),y=Lt(R).create({updateEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SEGMENT_LOCATION_BLACKLIST_ADD}),m=bt(R).create({streamInfo:Y,mediaPlayerModel:N,dashMetrics:L,errHandler:x,settings:V,boxParser:T,dashConstants:o.Z,urlUtils:D})}catch(e){throw e}}(),t}Pt.__dashjs_factory_name="Stream";const Mt=c.Z.getClassFactory(Pt),kt=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t||null,this.type=D.w.CONTENT_STEERING_TYPE,this.responseType="json"},xt=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version=null,this.ttl=300,this.reloadUri=null,this.pathwayPriority=[],this.pathwayClones=[]};function Ft(){var e,t,r,n,i,a,s,l,u,c,h,g,p,m,v,y=this.context,E=(0,X.Z)(y).getInstance();function T(e){R(e,"baseUrl")}function _(e){R(e,"location")}function S(e){if(e&&e.request&&e.request.serviceLocation&&e.request.requestStartDate&&e.request.requestEndDate&&!isNaN(e.request.bytesTotal)){var t=e.request.serviceLocation,r=e.request.requestEndDate.getTime()-e.request.requestStartDate.getTime();b(t,parseInt(8*e.request.bytesTotal/r*1e3))}}function A(e){e&&e.httpRequest&&e.httpRequest._serviceLocation&&!isNaN(e.throughput)&&b(e.httpRequest._serviceLocation,1e3*e.throughput)}function b(e,t){i[e]||(i[e]=[]),i[e].push(t),i[e].length>4&&i[e].shift()}function R(e,t){if(e&&e.request&&e.request.serviceLocation){var r=e.request.serviceLocation;-1===n[t].all.indexOf(r)&&n[t].all.push(r),n[t].current=r}}function w(){var e=h.getValue(),t=v.getContentSteering(e);return t||(t=p.getServiceDescriptionSettings().contentSteering),t}function D(){return new Promise((function(e){try{var a=w();if(!a||!a.serverUrl)return void e();var l=function(e){var t=e.serverUrl;r&&r.reloadUri&&(t=E.isRelative(r.reloadUri)?E.resolve(r.reloadUri,e.serverUrl):r.reloadUri);var a=[],o=n.baseUrl.all.concat(n.location.all);if(o.length>0){var s=o.map((function(e){var t=function(e){if(!e||!i[e]||0===i[e].length)return-1;var t=i[e].reduce((function(e,t){return e+t}))/i[e].length;return parseInt(t)}(e);return{serviceLocation:e,throughput:t}}));s.sort((function(e,t){return t.throughput-e.throughput}));var l="",u="";s.forEach((function(e,t){0!==t&&(l="".concat(l,","),e.throughput>-1&&(u="".concat(u,","))),l="".concat(l).concat(e.serviceLocation),e.throughput>-1&&(u="".concat(u).concat(e.throughput))})),a.push({key:"_DASH_pathway",value:'"'.concat(l,'"')}),a.push({key:"_DASH_throughput",value:u})}return Fe.Z.addAditionalQueryParameterToUrl(t,a)}(a),u=new kt(l);s.load({request:u,success:function(t){!function(e){e&&e[o.Z.CONTENT_STEERING_RESPONSE.VERSION]&&1===parseInt(e[o.Z.CONTENT_STEERING_RESPONSE.VERSION])&&((r=new xt).version=e[o.Z.CONTENT_STEERING_RESPONSE.VERSION],e[o.Z.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(e[o.Z.CONTENT_STEERING_RESPONSE.TTL])&&(r.ttl=e[o.Z.CONTENT_STEERING_RESPONSE.TTL]),e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(r.reloadUri=e[o.Z.CONTENT_STEERING_RESPONSE.RELOAD_URI]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]&&(r.pathwayPriority=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_PRIORITY]),e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES]&&(r.pathwayClones=e[o.Z.CONTENT_STEERING_RESPONSE.PATHWAY_CLONES],r.pathwayClones=r.pathwayClones.filter((function(e){return function(e){return e[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.ID]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT]&&e[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST]}(e)}))),L())}(t),m.trigger(d.Z.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:r,url:l}),e()},error:function(n,i,a,o){!function(e,n){try{switch(t.warn("Error fetching data from content steering server",e),n.status){case 410:break;case 429:var i=n&&n.getResponseHeader?n.getResponseHeader("retry-after"):null;null!==i&&(r||(r={}),r.ttl=parseInt(i)),L();break;default:L()}}catch(e){t.error(e)}}(n,o),e(n)},complete:function(){n.baseUrl.all=C(n.baseUrl),n.location.all=C(n.location)}})}catch(t){e(t)}}))}function C(e){return e.all&&0!==e.all.length&&e.current?e.all.filter((function(t){return t===e.current})):[]}function N(e){try{var n=[];return e&&0!==e.length&&r&&r.pathwayClones&&0!==r.pathwayClones.length?(r.pathwayClones.forEach((function(t){var r=e.filter((function(e){return t[o.Z.CONTENT_STEERING_RESPONSE.BASE_ID]===e.serviceLocation})),i=null;if(r&&r.length>0&&(i=r[0]),i){var a=new URL(i.url),s=t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.HOST];s=Fe.Z.stringHasProtocol(s)?s:"".concat(a.protocol,"//").concat(s);var l={synthesizedUrl:"".concat(s).concat(a.pathname),serviceLocation:t[o.Z.CONTENT_STEERING_RESPONSE.ID],queryParams:t[o.Z.CONTENT_STEERING_RESPONSE.URI_REPLACEMENT][o.Z.CONTENT_STEERING_RESPONSE.PARAMS],reference:i};n.push(l)}})),n):n}catch(e){return t.error(e),[]}}function L(){r&&r.ttl&&!isNaN(r.ttl)&&(a&&clearTimeout(a),a=setTimeout((function(){D()}),1e3*r.ttl))}function O(){a&&clearTimeout(a),a=null}function P(){r=null,i={},n={baseUrl:{current:null,all:[]},location:{current:null,all:[]}},O()}return e={reset:function(){P(),m.off(d.Z.FRAGMENT_LOADING_STARTED,T,e),m.off(d.Z.MANIFEST_LOADING_STARTED,_,e),m.off(d.Z.MANIFEST_LOADING_FINISHED,S,e),m.off(d.Z.THROUGHPUT_MEASUREMENT_STORED,A,e)},setConfig:function(e){e&&(e.adapter&&(v=e.adapter),e.errHandler&&(l=e.errHandler),e.dashMetrics&&(u=e.dashMetrics),e.mediaPlayerModel&&(c=e.mediaPlayerModel),e.requestModifier&&(g=e.requestModifier),e.manifestModel&&(h=e.manifestModel),e.serviceDescriptionController&&(p=e.serviceDescriptionController),e.eventBus&&(m=e.eventBus))},loadSteeringData:D,getCurrentSteeringResponseData:function(){return r},shouldQueryBeforeStart:function(){var e=w();return!!e&&e.queryBeforeStart},getSteeringDataFromManifest:w,stopSteeringRequestTimer:O,getSynthesizedBaseUrlElements:function(e){try{return N(e).map((function(e){var t=new Te(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t.dvb_priority=e.reference.dvb_priority,t.dvb_weight=e.reference.dvb_weight,t.availabilityTimeOffset=e.reference.availabilityTimeOffset,t.availabilityTimeComplete=e.reference.availabilityTimeComplete,t}))}catch(e){return t.error(e),[]}},getSynthesizedLocationElements:function(e){try{return N(e).map((function(e){var t=new Ne(e.synthesizedUrl,e.serviceLocation);return t.queryParams=e.queryParams,t}))}catch(e){return t.error(e),[]}},initialize:function(){s=gt(y).create({errHandler:l,dashMetrics:u,mediaPlayerModel:c,requestModifier:g,errors:I}),m.on(d.Z.FRAGMENT_LOADING_STARTED,T,e),m.on(d.Z.MANIFEST_LOADING_STARTED,_,e),m.on(d.Z.MANIFEST_LOADING_FINISHED,S,e),m.on(d.Z.THROUGHPUT_MEASUREMENT_STORED,A,e)}},t=(0,f.Z)(y).getInstance().getLogger(e),P(),e}Ft.__dashjs_factory_name="ContentSteeringController";const Ut=c.Z.getSingletonFactory(Ft);function Bt(){var e,t,r,n=this.context,i=(0,w.Z)(n).getInstance();return e={select:function(e){if(!e||0===e.length)return null;var n=null;return i.get().streaming.applyContentSteering&&(n=function(e){var n=r.getCurrentSteeringResponseData();return n&&n.pathwayPriority&&n.pathwayPriority.length>0?function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0,i=null,a=function(){var a=e[n],o=r.findIndex((function(e){return e.serviceLocation&&e.serviceLocation===a}));if(-1!==o&&!t.contains(r[o].serviceLocation))return i=r[o],"break";n+=1};n<e.length&&"break"!==a(););return i}(n.pathwayPriority,e):null}(e)),n||(n=function(e){return e[0]}(e)),n},setConfig:function(e){e.blacklistController&&(t=e.blacklistController),e.contentSteeringController&&(r=e.contentSteeringController)},reset:function(){t.reset()}},t=Lt(n).create({updateEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_LOCATION_BLACKLIST_ADD}),r=Ut(n).getInstance(),e}Bt.__dashjs_factory_name="LocationSelector";const Zt=c.Z.getClassFactory(Bt);function Gt(){var e,t,r,n,i,a,s,c,h,g,p,m,v,y,E=this.context,T=(0,l.Z)(E).getInstance(),_=(0,X.Z)(E).getInstance();function S(){r=NaN,s=!1,i=!0,a=!1,A()}function A(){null!==n&&(clearTimeout(n),n=null)}function b(e){A(),a||(isNaN(e)&&!isNaN(r)&&(e=1e3*r),isNaN(e)||(t.debug("Refresh manifest in "+e+" milliseconds."),n=setTimeout(D,e)))}function R(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s=!0;var t=h.getValue(),r=t.url,n=null,i=p.getPatchLocation(t),a=g.select(i),o=null;if(a&&!e)r=a.url,n=a.serviceLocation,o=a.queryParams;else{var l=function(e){var t=p.getLocation(e),r=v.getSynthesizedLocationElements(t);return t.concat(r)}(t),u=g.select(l);u&&(r=u.url,n=u.serviceLocation,o=u.queryParams)}_.isRelative(r)&&(r=_.resolve(r,t.url)),c.load(r,n,o)}function w(e){if(e){if(p.getIsPatch(e)){var n=e;e=h.getValue();var l=p.isPatchValid(e,n),c=l;if(l){var f=p.getPublishTime(e);c=p.applyPatchToManifest(e,n);var d=p.getPublishTime(e);c=f.getTime()!=d.getTime()}if(!c)return t.debug("Patch provided is invalid, performing full manifest refresh"),void R(!0);e.loadedTime=new Date}}else(e=h.getValue()).loadedTime=new Date;if(h.getValue()&&h.getValue().type===o.Z.DYNAMIC&&e.type===o.Z.STATIC)return T.trigger(u.Z.DYNAMIC_TO_STATIC),s=!1,void(a=!0);h.setValue(e);var g=new Date,m=(g.getTime()-e.loadedTime.getTime())/1e3;1e3*(r=p.getManifestUpdatePeriod(e,m))>2147483647&&(r=2147483.647),T.trigger(u.Z.MANIFEST_UPDATED,{manifest:e}),t.info("Manifest has been refreshed at "+g+"["+g.getTime()/1e3+"] "),i||b()}function D(){i||(s?b(y.get().streaming.manifestUpdateRetryInterval):R())}function C(e){e.error?e.error.code===I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&m.error(e.error):w(e.manifest)}function N(){i=!1,b()}function L(){(i=!y.get().streaming.scheduling.scheduleWhilePaused)&&A()}function O(){s=!1}return e={initialize:function(){S(),T.on(u.Z.STREAMS_COMPOSED,O,this),T.on(d.Z.PLAYBACK_STARTED,N,this),T.on(d.Z.PLAYBACK_PAUSED,L,this),T.on(u.Z.INTERNAL_MANIFEST_LOADED,C,this)},setManifest:function(e){w(e)},refreshManifest:R,getIsUpdating:function(){return s},setConfig:function(e){e&&(e.manifestModel&&(h=e.manifestModel),e.adapter&&(p=e.adapter),e.manifestLoader&&(c=e.manifestLoader),e.errHandler&&(m=e.errHandler),e.locationSelector&&(g=e.locationSelector),e.settings&&(y=e.settings),e.contentSteeringController&&(v=e.contentSteeringController))},reset:function(){T.off(d.Z.PLAYBACK_STARTED,N,this),T.off(d.Z.PLAYBACK_PAUSED,L,this),T.off(u.Z.STREAMS_COMPOSED,O,this),T.off(u.Z.INTERNAL_MANIFEST_LOADED,C,this),S()}},t=(0,f.Z)(E).getInstance().getLogger(e),g=Zt(E).create(),e}Gt.__dashjs_factory_name="ManifestUpdater";const Kt=c.Z.getClassFactory(Gt);function Ht(){var e,t,r,n,i,a,o,s,c,d,h,g,p,m,v,y,E=this.context,T=(0,l.Z)(E).getInstance(),_=(0,X.Z)(E).getInstance();function A(){s=[],c=[],d=null,h=null,p=null,g=NaN,r=!1,n=!1,m=i.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function b(){i.get().streaming.utcSynchronization.enabled&&!r&&!n&&p&&p.value&&p.schemeIdUri&&!isNaN(g)&&!isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)&&(h&&(Date.now()-h)/1e3<30||(s=[],n=!0,R(isNaN(i.get().streaming.utcSynchronization.backgroundAttempts)?2:i.get().streaming.utcSynchronization.backgroundAttempts)))}function R(e){try{if(e<=0)return void B();var t=Date.now();a[p.schemeIdUri](p.value,(function(r){var n=Date.now(),i=C(t,n,r);s.push(i),R(e-1)}),(function(){B()}))}catch(e){B()}}function w(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||0;if(!c||0===c.length||e>=c.length)N();else{var t=c[e];if(t)if(a.hasOwnProperty(t.schemeIdUri)){var r=(new Date).getTime();a[t.schemeIdUri](t.value,(function(e){var n=(new Date).getTime(),i=C(r,n,e);p=t,N(i)}),(function(){w(e+1)}))}else w(e+1);else N()}}function C(e,t,r){return r-(t-(t-e)/2)}function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN,t=isNaN(e);t&&i.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?function(){var e=o.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;isNaN(t)?U(!0):U(!1,t-Date.now())}():U(t,e)}function L(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t,r,n=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&(parseInt(n[6],10)||0),n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]&&(r=60*parseInt(n[9],10)+parseInt(n[10],10),t+=("+"===n[8]?-1:1)*r*60*1e3),new Date(t).getTime()}(e)),t}function O(e){return Date.parse(e)}function P(e){return Date.parse(e)}function M(e,t,r){r()}function k(e,t,r){var n=L(e);isNaN(n)?r():t(n)}function x(e,t,r,n,i){var a,o,s=!1,l=new XMLHttpRequest,u=i?D.w.HEAD:D.w.GET,c=t.match(/\S+/g);if(t=c.shift(),a=function(){s||(s=!0,c.length?x(e,c.join(" "),r,n,i):n())},o=function(){var t,n;200===l.status&&(t=i?l.getResponseHeader("Date"):l.response,n=e(t),isNaN(n)||(r(n),s=!0))},_.isRelative(t)){var f=y.resolve();f&&(t=_.resolve(t,f.url))}l.open(u,t),l.timeout=5e3,l.onload=o,l.onloadend=a,l.send()}function F(e,t,r){x(P,e,t,r,!0)}function U(e,n){if(isNaN(g)||isNaN(n)||e||function(e){try{var r,n=Z(e),a=isNaN(m)?30:m,o=isNaN(i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:i.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,s=isNaN(i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:i.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,l=isNaN(i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:i.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;n?(r=Math.min(a*o,s),t.debug("Increasing timeBetweenSyncAttempts to ".concat(r))):(r=Math.max(a/o,l),t.debug("Decreasing timeBetweenSyncAttempts to ".concat(r))),m=r}catch(e){}}(n),!e&&!isNaN(n)){d=Date.now(),r=!1;var a=isNaN(g);g=n,a&&b(),t.debug("Completed UTC sync. Setting client - server offset to ".concat(n))}e&&(p=null,r=!1,v.error(new S.Z(I.TIME_SYNC_FAILED_ERROR_CODE,I.TIME_SYNC_FAILED_ERROR_MESSAGE))),T.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:n}),T.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED)}function B(){if(s&&0!==s.length){var e=s.reduce((function(e,t){return e+t}),0)/s.length;Z(e)?t.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(t.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),g=e,T.trigger(u.Z.UPDATE_TIME_SYNC_OFFSET,{offset:g})),n=!1,h=Date.now()}}function Z(e){try{if(isNaN(g))return!0;var t=i.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(i.get().streaming.utcSynchronization.maximumAllowedDrift)?i.get().streaming.utcSynchronization.maximumAllowedDrift:100;return e>=g-t&&e<=g+t}catch(e){return!0}}return e={initialize:function(){A(),a={"urn:mpeg:dash:utc:http-head:2014":F,"urn:mpeg:dash:utc:http-xsdate:2014":x.bind(null,L),"urn:mpeg:dash:utc:http-iso:2014":x.bind(null,O),"urn:mpeg:dash:utc:direct:2014":k,"urn:mpeg:dash:utc:http-head:2012":F,"urn:mpeg:dash:utc:http-xsdate:2012":x.bind(null,L),"urn:mpeg:dash:utc:http-iso:2012":x.bind(null,O),"urn:mpeg:dash:utc:direct:2012":k,"urn:mpeg:dash:utc:http-ntp:2014":M,"urn:mpeg:dash:utc:ntp:2014":M,"urn:mpeg:dash:utc:sntp:2014":M}},attemptSync:function(e,t){c=e,r||(function(e){try{if(!e||!i.get().streaming.utcSynchronization.enabled)return!1;var t=isNaN(m)?30:m;return!(d&&t&&!isNaN(t))||(Date.now()-d)/1e3>=t}catch(e){return!0}}(t)?(r=!0,w()):T.trigger(u.Z.TIME_SYNCHRONIZATION_COMPLETED))},setConfig:function(e){e&&(e.dashMetrics&&(o=e.dashMetrics),e.baseURLController&&(y=e.baseURLController),e.errHandler&&(v=e.errHandler),e.settings&&(i=e.settings))},reset:function(){A(),T.off(u.Z.ATTEMPT_BACKGROUND_SYNC,b,e)}},t=(0,f.Z)(E).getInstance().getLogger(e),T.on(u.Z.ATTEMPT_BACKGROUND_SYNC,b,e),e}Ht.__dashjs_factory_name="TimeSyncController";var Yt=c.Z.getSingletonFactory(Ht);Yt.HTTP_TIMEOUT_MS=5e3,c.Z.updateSingletonFactory(Ht.__dashjs_factory_name,Yt);const Vt=Yt;function qt(){var e,t,r,n=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?t=new MediaSource:e&&(t=new WebKitMediaSource),t},attachMediaSource:function(e){var r=window.URL.createObjectURL(t);return e.setSource(r),r},detachMediaSource:function(e){e.setSource(null)},setDuration:function e(n){t&&"open"===t.readyState&&(null===n&&isNaN(n)||t.duration!==n&&(function(e){for(var t=e.sourceBuffers,r=0;r<t.length;r++)if(t[r].updating)return!0;return!1}(t)?setTimeout(e.bind(null,n),50):(r.info("Set MediaSource duration:"+n),t.duration=n)))},setSeekable:function(e,r){t&&"function"==typeof t.setLiveSeekableRange&&"function"==typeof t.clearLiveSeekableRange&&"open"===t.readyState&&e>=0&&e<r&&(t.clearLiveSeekableRange(),t.setLiveSeekableRange(e,r))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,n=0;n<t.length;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}r.info("call to mediaSource endOfStream"),e.endOfStream()}}},r=(0,f.Z)(n).getInstance().getLogger(e),e}qt.__dashjs_factory_name="MediaSourceController";const jt=c.Z.getSingletonFactory(qt);function zt(){var e,t,r,n,i,a,o,s,u,c,h,g="urn:mpeg:dash:event:2012",p="updated",m="added",v=this.context,y=(0,l.Z)(v).getInstance();function E(){if(!o||!s)throw new Error("setConfig function has to be called previously")}function T(){h=!1,r={},n={},i=null,c=!1,a=Date.now()/1e3}function _(){try{if(!c){c=!0;var e=s.getTime(),i=e-a;i=a>0?Math.max(0,i):0,S(n,i,e),S(r,i,e),A(n),A(r),a=e,c=!1}}catch(e){c=!1,t.error(e)}}function S(e,r,n){try{w(e,(function(i){if(void 0!==i){var a=isNaN(i.duration)?0:i.duration;i.calculatedPresentationTime<=n&&i.calculatedPresentationTime+r+a>=n?C(i,d.Z.EVENT_MODE_ON_START):(D(n,a+r,i.calculatedPresentationTime)||function(e){try{var r=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>r}catch(e){return t.error(e),!1}}(i))&&(t.debug("Removing event ".concat(i.id," from period ").concat(i.eventStream.period.id," as it is expired or invalid")),function(e,r){try{var n=r.eventStream.schemeIdUri,i=r.eventStream.period.id,a=r.eventStream.value,o=r.id;e[i][n]=e[i][n].filter((function(e){return a&&e.eventStream.value&&e.eventStream.value!==a||e.id!==o})),0===e[i][n].length&&delete e[i][n]}catch(e){t.error(e)}}(e,i))}}))}catch(e){t.error(e)}}function A(e){try{for(var r in e)e.hasOwnProperty(r)&&0===Object.keys(e[r]).length&&delete e[r]}catch(e){t.error(e)}}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.eventStream.schemeIdUri,i=e.eventStream.value,a=e.id,o="discarded";t[n]||(t[n]=[]);var s=t[n].findIndex((function(e){return(!i||e.eventStream.value&&e.eventStream.value===i)&&e.id===a}));if(-1===s)t[n].push(e),e.triggeredReceivedEvent=!1,e.triggeredStartEvent=!1,o=m;else if(r){var l=t[n][s];e.triggeredReceivedEvent=l.triggeredReceivedEvent,e.triggeredStartEvent=l.triggeredStartEvent,t[n][s]=e,o=p}return o}function R(e){try{if(1==e.eventStream.value){var r,n=e.calculatedPresentationTime;r=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,y.trigger(d.Z.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:n,newDuration:r,newManifestValidAfter:NaN},{mode:d.Z.EVENT_MODE_ON_START})}}catch(e){t.error(e)}}function I(e){try{var r=s.getTime();w(e,(function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,n=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;if(!isNaN(t)&&!isNaN(n)){var i=e.calculatedPresentationTime;Math.abs(i-r)<300&&C(e,d.Z.EVENT_MODE_ON_START)}}))}catch(e){t.error(e)}}function w(e,r){try{if(e)for(var n=Object.keys(e),i=0;i<n.length;i++)for(var a=e[n[i]],o=Object.keys(a),s=0;s<o.length;s++)a[o[s]].forEach((function(e){void 0!==e&&r(e)}))}catch(e){t.error(e)}}function D(e,r,n){try{return e-r>n}catch(e){return t.error(e),!1}}function C(e,r){try{var n=s.getTime(),i=e.id;if(r===d.Z.EVENT_MODE_ON_RECEIVE&&!e.triggeredReceivedEvent)return t.debug("Received event ".concat(i)),e.triggeredReceivedEvent=!0,void y.trigger(e.eventStream.schemeIdUri,{event:e},{mode:r});e.triggeredStartEvent||(e.eventStream.schemeIdUri===g&&1==e.eventStream.value?0===e.duration&&0===e.presentationTimeDelta||(t.debug("Starting manifest refresh event ".concat(i," at ").concat(n)),function(){try{E(),o.refreshManifest()}catch(e){t.error(e)}}()):"urn:mpeg:dash:event:callback:2015"===e.eventStream.schemeIdUri&&1==e.eventStream.value?(t.debug("Starting callback event ".concat(i," at ").concat(n)),function(e){try{(0,oe.Z)(v).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){t.error(e)}}(e.messageData)):(t.debug("Starting event ".concat(i," from period ").concat(e.eventStream.period.id," at ").concat(n)),y.trigger(e.eventStream.schemeIdUri,{event:e},{mode:r})),e.triggeredStartEvent=!0)}catch(e){t.error(e)}}return e={addInlineEvents:function(e,n){try{if(E(),r[n]||(r[n]={}),e)for(var i=0;i<e.length;i++){var a=e[i];if(!D(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)){var o=b(a,r[n],!0);o===m?(t.debug("Added inline event with id ".concat(a.id," from period ").concat(n)),C(a,d.Z.EVENT_MODE_ON_RECEIVE)):o===p&&t.debug("Updated inline event with id ".concat(a.id," from period ").concat(n))}}}catch(e){throw e}},addInbandEvents:function(e,r){try{E(),n[r]||(n[r]={});for(var i=0;i<e.length;i++){var a=e[i];D(s.getTime(),isNaN(a.duration)?0:a.duration,a.calculatedPresentationTime)||(b(a,n[r],!1)===m?(a.eventStream.schemeIdUri===g&&R(a),t.debug("Added inband event with id ".concat(a.id," from period ").concat(r)),C(a,d.Z.EVENT_MODE_ON_RECEIVE)):t.debug("Inband event with scheme_id_uri ".concat(a.eventStream.schemeIdUri,", value ").concat(a.eventStream.value,", period id ").concat(r," and event id ").concat(a.id," was ignored because it has been added before.")))}_()}catch(e){throw e}},getInbandEvents:function(){return n},getInlineEvents:function(){return r},start:function(){try{E(),t.debug("Start Event Controller");var e=u.get().streaming.eventControllerRefreshDelay;h||isNaN(e)||(h=!0,i=setInterval(_,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(o=e.manifestUpdater),e.playbackController&&(s=e.playbackController),e.settings&&(u=e.settings)}catch(e){throw e}},reset:function(){(function(){try{null!==i&&h&&(clearInterval(i),i=null,h=!1,function(){try{I(n),I(r)}catch(e){t.error(e)}}())}catch(e){throw e}})(),T()}},t=(0,f.Z)(v).getInstance().getLogger(e),T(),e}zt.__dashjs_factory_name="EventController";const Wt=c.Z.getSingletonFactory(zt),Xt={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}};function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Jt(){var e,t,r,n,i,o,c,h,g,p,m,v,y,E,T,_,A,b,R,w,D,C,N,L,O,P,k,x,F,U,B,Z,G,K,H,Y,V,q,j,z,W,X,Q,ee,te,re,ne,ie,ae=this.context,oe=(0,l.Z)(ae).getInstance();function se(){if(!(o&&o.hasOwnProperty("load")&&D&&D.hasOwnProperty("initialize")&&D.hasOwnProperty("reset")&&D.hasOwnProperty("getClientTimeOffset")&&c&&w&&g&&G))throw new Error(a.Z.MISSING_CONFIG_ERROR)}function le(){!function(){try{var e=h.getStreamsInfo();if(!N&&0===e.length)throw new Error("There are no periods in the MPD");N&&e.length>0&&g.updateManifestUpdateInfo({currentTime:G.getTime(),buffered:Z.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:D.getClientTimeOffset()}),C.length>0&&function(e){0!==e.length?C=C.filter((function(r){var n=e.filter((function(e){return e.id===r.getId()})).length>0||r.getId()===N.getId();return n||(t.debug("Removing stream ".concat(r.getId())),r.reset(!0)),n})):t.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.")}(e);for(var r=[],n=0,i=e.length;n<i;n++){var a=e[n];r.push(ce(a)),g.addManifestUpdateStreamInfo(a)}Promise.all(r).then((function(){return new Promise((function(t,r){N?t():fe(e,t,r)}))})).then((function(){oe.trigger(u.Z.STREAMS_COMPOSED),Le()})).catch((function(e){throw e}))}catch(e){w.error(new S.Z(I.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+" nostreamscomposed",c.getValue())),U=!0,Xe()}}()}function ue(){te=!0}function ce(e){var t=je(e.id);return t?t.updateData(e):(t=Mt(ae).create({manifestModel:c,mediaPlayerModel:H,dashMetrics:g,manifestUpdater:i,adapter:h,timelineConverter:D,capabilities:r,capabilitiesFilter:n,errHandler:w,baseURLController:y,segmentBaseController:E,textController:O,abrController:_,playbackController:G,eventController:b,mediaController:A,protectionController:L,videoModel:Z,streamInfo:e,settings:ee}),C.push(t),t.initialize(),Promise.resolve())}function fe(e,r,n){try{Ae();var i=g.getCurrentDVRInfo().range;if(i.end<i.start){re&&clearTimeout(re);var a=Math.min(1e3*(-1*(i.end-i.start)+2),2147483647);return t.debug("Waiting for ".concat(a," ms before playback can start")),oe.trigger(u.Z.AST_IN_FUTURE,{delay:a}),void(re=setTimeout((function(){fe(e,r,n)}),a))}ee.get().streaming.applyProducerReferenceTime&&K.calculateProducerReferenceTimeOffsets(e);var o=e[0].manifestInfo;if(ee.get().streaming.applyServiceDescription&&K.applyServiceDescription(o),h.getIsDynamic()){var s=Be(e,o);G.computeAndSetLiveDelay(s,o)}(ee.get().streaming.applyContentSteering&&v.shouldQueryBeforeStart()?v.loadSteeringData():Promise.resolve()).then((function(){var e=c.getValue();e&&y.update(e),de(),r()})).catch((function(e){t.error(e),de(),r()}))}catch(e){n(e)}}function de(){var e=function(){var e;if(h.getIsDynamic()){var r=g.getCurrentDVRInfo();e=(r&&r.range?r.range.end:0)-G.getOriginalLiveDelay();var n=r?r.range:null;if(n){if(isNaN(ne)&&-1===ne.toString().indexOf("posix:")){var i=xe(!0);isNaN(i)||(t.info("Start time from URI parameters: ".concat(i)),e=Math.min(e,i))}else{t.info("Start time provided by the app: ".concat(ne));var a=Fe(!0,ne);isNaN(a)||(e=Math.min(e,a))}var o=ee.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;e=Math.max(e,n.start+o)}}else if(e=Je()[0].getStreamInfo().start,isNaN(ne)){var s=xe(!1);isNaN(s)||(t.info("Start time from URI parameters: ".concat(s)),e=Math.max(e,s))}else{t.info("Start time provided by the app: ".concat(ne));var l=Fe(!1,ne);isNaN(l)||(e=Math.max(e,l))}return e}(),r=Se(e),n=null!==r?r:C[0];oe.trigger(u.Z.INITIAL_STREAM_SWITCH,{startTime:e}),he(n,null,e),z||(z=setInterval((function(){!x&&G.getTimeToStreamEnd()<=0&&!G.isSeeking()&&oe.trigger(u.Z.PLAYBACK_ENDED,{isLast:qe().isLast})}),200))}function he(e,r,n){try{if(x||!e||r===e&&e.getIsActive())return;x=!0,oe.trigger(u.Z.PERIOD_SWITCH_STARTED,{fromStreamInfo:r?r.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var i=!1;N=e,r&&(i=Te(e,r),r.deactivate(i)),n=isNaN(n)?!i&&r?e.getStreamInfo().start:NaN:n,t.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(n,", current playback time is ").concat(G.getTime(),". Seamless period switch is set to ").concat(i)),X=X.filter((function(e){return e.getId()!==N.getId()})),G.initialize(qe(),!!r),Z.getElement()?ge(n,i,!1):pe(n,i)}catch(e){x=!1}}function ge(e,r){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];function a(){if(B&&"open"===B.readyState){t.debug("MediaSource is open!"),window.URL.revokeObjectURL(n),B.removeEventListener("sourceopen",a),B.removeEventListener("webkitsourceopen",a),ke();var o=g.getCurrentDVRInfo();p.setSeekable(o.range.start,o.range.end),i?(isNaN(e)||G.seek(e,!0,!0),N.setMediaSource(B).then((function(){N.initializeForTextWithMediaSource(B)}))):pe(e,r)}}function o(){B.addEventListener("sourceopen",a,!1),B.addEventListener("webkitsourceopen",a,!1),n=p.attachMediaSource(Z),t.debug("MediaSource attached to element.  Waiting on open...")}B?r?pe(e,r):(p.detachMediaSource(Z),o()):(B=p.createMediaSource(),o())}function pe(e,t){N.activate(B,t?W:void 0,e).then((function(t){if(t){var r=Object.keys(t);r.length>0&&t[r[0]].getBuffer().changeType&&(Q=!0),W=t}isNaN(e)||(oe.trigger(u.Z.SEEK_TARGET,{time:e},{streamId:N.getId()}),G.seek(e,!1,!0),N.startScheduleControllers()),x=!1,oe.trigger(u.Z.PERIOD_SWITCH_COMPLETED,{toStreamInfo:qe()})}))}function me(e){var t=Se(e.seekTime);t&&t!==N?t&&t!==N&&(ve(),function(e,t){var r=e&&!isNaN(e.seekTime)?e.seekTime:NaN,n=N.getProcessors().map((function(t){return t.prepareOuterPeriodPlaybackSeeking(e)}));Promise.all(n).then((function(){he(t,N,r)})).catch((function(e){w.error(e)}))}(e,t)):(ve(),function(e){N.getProcessors().forEach((function(t){return t.prepareInnerPeriodPlaybackSeeking(e)})),He($.USER_REQUEST_STOP_REASON)}(e)),Ye(J.SEEK_START_REASON)}function ve(){ye()}function ye(){X&&X.length>0&&(X.forEach((function(e){e.deactivate(!0)})),X=[])}function Ee(e){e.newMediaInfo.streamInfo.id===N.getId()&&(ye(),N.prepareTrackChange(e))}function Te(e,t){try{return ee.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||te)&&(Q&&ee.get().streaming.buffer.useChangeTypeForTrackSwitch||t.isMediaCodecCompatible(e,t))}catch(e){return!1}}function _e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;B&&!e.getPreloaded()&&Te(e,t)&&e.startPreloading(B,W).then((function(){X.push(e)}))}function Se(e){if(isNaN(e))return null;for(var t=C.length,r=0;r<t;r++){var n=C[r];if(e<parseFloat((n.getStartTime()+n.getDuration()).toFixed(5)))return n}return null}function Ae(){try{var e=h.getIsDynamic(),t=h.getStreamsInfo()[0].manifestInfo,r=G.getTime(),n=D.calcTimeShiftBufferWindow(C,e),i=Pe();if(void 0===n.start||void 0===n.end)return;i&&0!==i.length?i.forEach((function(e){g.addDVRInfo(e.getType(),r,t,n)})):g.addDVRInfo(a.Z.VIDEO,r,t,n)}catch(e){}}function be(e){if(q&&k){var t=H.getInitialBufferLevel(),r=[a.Z.TEXT];(isNaN(t)||t<=G.getBufferLevel(r)||h.getIsDynamic()&&t>G.getLiveDelay())&&(q=!1,Ye(J.INITIAL_PLAYOUT_START_REASON),G.play())}e&&e.mediaType&&g.addBufferLevel(e.mediaType,new Date,1e3*e.bufferLevel)}function Re(e){e.streamInfo.id===N.getId()&&e.reason&&e.reason.forceReplace&&ye(),je(e.streamInfo.id).prepareQualityChange(e)}function Ie(){if(h.getIsDynamic()&&0!==G.getOriginalLiveDelay()&&N){var e=h.getStreamsInfo();if(e.length>0){var t=e[0].manifestInfo,r=Be(e,t);G.computeAndSetLiveDelay(r,t)}}}function we(){if(Ge()){var e=Z.getPlaybackQuality();e&&g.addDroppedFrames(e)}}function De(){t.debug("[onPlaybackStarted]"),!q&&V&&Ye(J.RESUME_FROM_PAUSE_START_REASON),q&&(q=!1),j&&(j=!1,ee.get().streaming.applyContentSteering&&!v.shouldQueryBeforeStart()&&v.loadSteeringData()),V=!1}function Ce(e){t.debug("[onPlaybackPaused]"),e.ended||(V=!0,He($.USER_REQUEST_STOP_REASON))}function Ne(e){t.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));var r=e.streamInfo.isLast;B&&r?(t.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),p.signalEndOfStream(B)):Le()}function Le(){if(N&&N.getHasFinishedBuffering())for(var e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||N||null;if(t){var r=t.getStreamInfo();return C.filter((function(e){var t=e.getStreamInfo();return t.start>r.start&&r.id!==t.id}))}}catch(e){return[]}}(N),t=0;t<e.length;){var r=e[t],n=0===t?N:e[t-1];!r.getPreloaded()&&n.getHasFinishedBuffering()&&B&&_e(r,n),t+=1}}function Oe(){z&&(clearInterval(z),z=null)}function Pe(){return N?N.getProcessors():[]}function Me(e){if(N&&!N.getIsEndedEventSignaled()){N.setIsEndedEventSignaled(!0);var r=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||N||null;if(!e)return null;for(var t=e.getStreamInfo(),r=t.start,n=0,i=-1,a=NaN;n<C.length;){var o=C[n].getStreamInfo(),s=o.start-r;s>0&&(isNaN(a)||s<a)&&t.id!==o.id&&(a=s,i=n),n+=1}return i>=0?C[i]:null}();r?(t.debug("StreamController onEnded, found next stream with id ".concat(r.getStreamInfo().id,". Switching from ").concat(N.getStreamInfo().id," to ").concat(r.getStreamInfo().id)),he(r,N,NaN)):(t.debug("StreamController no next stream found"),N.setIsEndedEventSignaled(!1)),He(r?$.END_OF_PERIOD_STOP_REASON:$.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&(Oe(),v.stopSteeringRequestTimer())}function ke(e){var t=e||qe().manifestInfo.duration;p.setDuration(t)}function xe(e){var t=T.getURIFragmentData();if(!t||!t.t)return NaN;var r=Je()[0].getStreamInfo().start;return t.t=t.t.split(",")[0],Ue(e,t.t,r)}function Fe(e,t){var r=0;return e||(r=Je()[0].getStreamInfo().start),Ue(e,t,r)}function Ue(e,t,r){var n=h.getRegularPeriods()[0],i=t.toString(),a=-1!==i.indexOf("posix:")?"now"===i.substring(6)?Date.now()/1e3:parseFloat(i.substring(6)):NaN;return e&&!isNaN(a)?D.calcPresentationTimeFromWallTime(new Date(1e3*a),n):parseFloat(i)+r}function Be(e,t){try{var r=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var n=e[0],i=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT].reduce((function(e,t){var r=h.getMediaInfoForType(n,t);return r&&!1!==r.isFragmented&&e.push(r),e}),[]).reduce((function(e,t){var r=h.getVoRepresentations(t);return r&&r.length>0&&r.forEach((function(t){t&&e.push(t)})),e}),[]).reduce((function(e,t){var r=h.convertRepresentationToRepresentationInfo(t);return r&&r.fragmentDuration&&!isNaN(r.fragmentDuration)&&e.push(r.fragmentDuration),e}),[]);r=Math.max.apply(Math,function(e){if(Array.isArray(e))return Qt(e)}(o=i)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return Qt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qt(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return isFinite(r)?r:NaN}catch(e){return NaN}var o}function Ze(e){if(e.error)U=!0,Xe();else{t.info("Manifest updated... updating data system wide.");var r=e.manifest;h.updatePeriods(r);var i=h.getUTCTimingSources();!h.getIsDynamic()||i&&0!==i.length||oe.trigger(d.Z.CONFORMANCE_VIOLATION,{level:Xt.LEVELS.WARNING,event:Xt.EVENTS.NO_UTC_TIMING_ELEMENT});var a=h.getIsDynamic()?i.concat(Y.getUTCTimingSources()):i;n.filterUnsupportedFeatures(r).then((function(){y.initialize(r),m.attemptSync(a,h.getIsDynamic())}))}}function Ge(){return!!N&&N.getHasVideoTrack()}function Ke(){return!!N&&N.getHasAudioTrack()}function He(e,t){t=t||new Date,Pe().forEach((function(r){r.finalisePlayList(t,e)})),g.addPlayList()}function Ye(e){g.createPlaylistMetrics(1e3*G.getTime(),e)}function Ve(e){if(e.error){var r="";switch(e.error.code){case 1:r="MEDIA_ERR_ABORTED";break;case 2:r="MEDIA_ERR_NETWORK";break;case 3:r="MEDIA_ERR_DECODE",ie.counts.mediaErrorDecode+=1;break;case 4:r="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:r="MEDIA_ERR_ENCRYPTED";break;default:r="UNKNOWN"}"MEDIA_ERR_DECODE"===r&&ee.get().errors.recoverAttempts.mediaErrorDecode>=ie.counts.mediaErrorDecode?function(){t.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=G.getTime();N.deactivate(!1),t.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),ge(e,!1,!1)}():(F=!0,e.error.message&&(r+=" ("+e.error.message+")"),e.error.msExtendedCode&&(r+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),t.fatal("Video Element Error: "+r),e.error&&t.fatal(e.error),w.error(new S.Z(e.error.code,r)),Xe())}}function qe(){return N?N.getStreamInfo():null}function je(e){for(var t=0,r=C.length;t<r;t++)if(C[t].getId()===e)return C[t];return null}function ze(e){isNaN(e.newDuration)||ke(e.newDuration)}function We(){C=[],ne=NaN,L=null,x=!1,N=null,F=!1,U=!1,q=!0,j=!0,V=!1,k=!0,z=null,te=!1,Q=!1,X=[],re=null,ie={counts:{mediaErrorDecode:0}}}function Xe(){se(),m.reset(),He(F||U?$.FAILURE_STOP_REASON:$.USER_REQUEST_STOP_REASON);for(var t=0,r=C?C.length:0;t<r;t++)C[t].reset(F);oe.off(d.Z.PLAYBACK_TIME_UPDATED,we,e),oe.off(d.Z.PLAYBACK_SEEKING,me,e),oe.off(d.Z.PLAYBACK_ERROR,Ve,e),oe.off(d.Z.PLAYBACK_STARTED,De,e),oe.off(d.Z.PLAYBACK_PAUSED,Ce,e),oe.off(d.Z.PLAYBACK_ENDED,Me,e),oe.off(d.Z.METRIC_ADDED,Qe,e),oe.off(d.Z.MANIFEST_VALIDITY_CHANGED,ze,e),oe.off(d.Z.BUFFER_LEVEL_UPDATED,be,e),oe.off(d.Z.QUALITY_CHANGE_REQUESTED,Re,e),u.Z.KEY_SESSION_UPDATED&&oe.off(u.Z.KEY_SESSION_UPDATED,ue,e),oe.off(u.Z.MANIFEST_UPDATED,Ze,e),oe.off(u.Z.STREAM_BUFFERING_COMPLETED,Ne,e),oe.off(u.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),oe.off(u.Z.CURRENT_TRACK_CHANGED,Ee,e),oe.off(u.Z.SETTING_UPDATED_LIVE_DELAY,Ie,e),oe.off(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,Ie,e),y.reset(),i.reset(),b.reset(),g.clearAllCurrentMetrics(),c.setValue(null),o.reset(),D.reset(),R.reset(),B&&(p.detachMediaSource(Z),B=null),Z=null,L&&(L=null,P=null,c.getValue()&&oe.trigger(u.Z.PROTECTION_DESTROYED,{data:c.getValue().url})),Oe(),oe.trigger(u.Z.STREAM_TEARDOWN_COMPLETE),We()}function Qe(e){if(e.metric===s.Z.DVR_INFO){var t=Ke()?a.Z.AUDIO:a.Z.VIDEO;e.mediaType===t&&p.setSeekable(e.value.range.start,e.value.range.end)}}function Je(){return C}return e={initialize:function(t,r){se(),k=t,P=r,D.initialize(),(i=Kt(ae).create()).setConfig({manifestModel:c,adapter:h,manifestLoader:o,errHandler:w,settings:ee,contentSteeringController:v}),i.initialize(),(b=Wt(ae).getInstance()).setConfig({manifestUpdater:i,playbackController:G,settings:ee}),b.start(),m.setConfig({dashMetrics:g,baseURLController:y,errHandler:w,settings:ee}),m.initialize(),L&&(oe.trigger(u.Z.PROTECTION_CREATED,{controller:L}),L.setMediaElement(Z.getElement()),P&&L.setProtectionData(P)),oe.on(d.Z.PLAYBACK_TIME_UPDATED,we,e),oe.on(d.Z.PLAYBACK_SEEKING,me,e),oe.on(d.Z.PLAYBACK_ERROR,Ve,e),oe.on(d.Z.PLAYBACK_STARTED,De,e),oe.on(d.Z.PLAYBACK_PAUSED,Ce,e),oe.on(d.Z.PLAYBACK_ENDED,Me,e),oe.on(d.Z.METRIC_ADDED,Qe,e),oe.on(d.Z.MANIFEST_VALIDITY_CHANGED,ze,e),oe.on(d.Z.BUFFER_LEVEL_UPDATED,be,e),oe.on(d.Z.QUALITY_CHANGE_REQUESTED,Re,e),u.Z.KEY_SESSION_UPDATED&&oe.on(u.Z.KEY_SESSION_UPDATED,ue,e),oe.on(u.Z.MANIFEST_UPDATED,Ze,e),oe.on(u.Z.STREAM_BUFFERING_COMPLETED,Ne,e),oe.on(u.Z.TIME_SYNCHRONIZATION_COMPLETED,le,e),oe.on(u.Z.CURRENT_TRACK_CHANGED,Ee,e),oe.on(u.Z.SETTING_UPDATED_LIVE_DELAY,Ie,e),oe.on(u.Z.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,Ie,e)},getActiveStreamInfo:qe,addDVRMetric:Ae,hasVideoTrack:Ge,hasAudioTrack:Ke,getStreamById:je,getStreamForTime:Se,getTimeRelativeToStreamId:function(e,t){for(var r=null,n=0,i=0,a=null,o=0;o<C.length;o++){if(i=(r=C[o]).getStartTime(),a=r.getDuration(),Number.isFinite(i)&&(n=i),r.getId()===t)return e-n;Number.isFinite(a)&&(n+=a)}return null},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;se(),ne=t,o.load(e)},loadWithManifest:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;(function(){if(!i||!i.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")})(),ne=t,i.setManifest(e)},getActiveStreamProcessors:Pe,setConfig:function(e){e&&(e.capabilities&&(r=e.capabilities),e.capabilitiesFilter&&(n=e.capabilitiesFilter),e.manifestLoader&&(o=e.manifestLoader),e.manifestModel&&(c=e.manifestModel),e.mediaPlayerModel&&(H=e.mediaPlayerModel),e.customParametersModel&&(Y=e.customParametersModel),e.protectionController&&(L=e.protectionController),e.adapter&&(h=e.adapter),e.dashMetrics&&(g=e.dashMetrics),e.errHandler&&(w=e.errHandler),e.timelineConverter&&(D=e.timelineConverter),e.videoModel&&(Z=e.videoModel),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(K=e.serviceDescriptionController),e.contentSteeringController&&(v=e.contentSteeringController),e.textController&&(O=e.textController),e.abrController&&(_=e.abrController),e.mediaController&&(A=e.mediaController),e.settings&&(ee=e.settings),e.baseURLController&&(y=e.baseURLController),e.uriFragmentModel&&(T=e.uriFragmentModel),e.segmentBaseController&&(E=e.segmentBaseController))},setProtectionData:function(e){P=e,L&&L.setProtectionData(P)},getIsStreamSwitchInProgress:function(){return x},switchToVideoElement:function(e){N&&(G.initialize(qe()),ge(e,!1,!0))},getHasMediaOrInitialisationError:function(){return F||U},getStreams:Je,getActiveStream:function(){return N},getInitialPlayback:function(){return q},getAutoPlay:function(){return k},reset:Xe},t=(0,f.Z)(ae).getInstance().getLogger(e),m=Vt(ae).getInstance(),p=jt(ae).getInstance(),R=M(ae).getInstance(),We(),e}Jt.__dashjs_factory_name="StreamController";const $t=c.Z.getSingletonFactory(Jt);function er(){var e,t,r,n,i,o,s,c,d,h,g,p,m=this.context,v=(0,l.Z)(m).getInstance();function y(){p.debug("Stopping the gap controller"),i&&(clearInterval(i),i=null),function(){v.off(u.Z.WALLCLOCK_TIME_UPDATED,A,this),v.off(u.Z.INITIAL_STREAM_SWITCH,S,this),v.off(u.Z.PLAYBACK_SEEKING,E,this),v.off(u.Z.BUFFER_REPLACEMENT_STARTED,T,e),v.off(u.Z.TRACK_CHANGE_RENDERED,_,e)}(),i=null,o=NaN,n=0,h=null,g={}}function E(){h&&(clearTimeout(h),h=null)}function T(e){try{if(e.streamId!==c.getActiveStreamInfo().id||e.mediaType!==a.Z.VIDEO&&e.mediaType!==a.Z.AUDIO)return;e.streamId===c.getActiveStreamInfo().id&&(g[e.mediaType]=!0)}catch(e){p.error(e)}}function _(e){e&&e.mediaType&&(g[e.mediaType]=!1)}function S(){i||function(){try{i||(p.debug("Starting the gap controller"),i=setInterval((function(){b()&&R(s.getTime())}),100))}catch(e){}}()}function A(){if(b(r.get().streaming.gaps.enableSeekFix)&&++n>=10){var e=s.getTime();t===e?R(e,!0):(t=e,o=NaN),n=0}}function b(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!c.getActiveStream())return!1;var t=Object.keys(g).some((function(e){return g[e]})),n=!!e&&function(){var e=c.getActiveStream(),t=parseFloat((e.getStartTime()+e.getDuration()).toFixed(5));return s.getTime()+r.get().streaming.gaps.threshold>=t}();return!t&&r.get().streaming.gaps.jumpGaps&&c.getActiveStreamProcessors().length>0&&(!s.isSeeking()||n)&&!s.isPaused()&&!c.getIsStreamSwitchInProgress()&&!c.getHasMediaOrInitialisationError()}function R(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=r.get().streaming.gaps.enableStallFix,a=r.get().streaming.gaps.stallSeek,l=r.get().streaming.gaps.smallGapLimit,u=r.get().streaming.gaps.jumpLargeGaps,f=d.getBufferRange(),g=NaN,m=!1;if(t=function(e,t){try{if(!e||e.length<=1&&t>0)return NaN;for(var n=NaN,i=0;isNaN(n)&&i<e.length;){var a=i>0?e.end(i-1):0;t<e.start(i)&&a-t<r.get().streaming.gaps.threshold&&(n=i),i+=1}return n}catch(e){return null}}(f,e),!isNaN(t)){var v=f.start(t),y=v-e;y>0&&(y<=l||u)&&(g=v)}var E=s.getTimeToStreamEnd();if(isNaN(g)&&n&&isFinite(E)&&!isNaN(E)&&E<l&&(g=parseFloat(s.getStreamEndTime().toFixed(5)),m=!0),i&&isNaN(g)&&n&&isNaN(t)&&function(e,t){for(var r=0,n=e.length;r<n;r++)if(t>=e.start(r)&&t<=e.end(r))return!0;return!1}(f,e)&&(0===a?(p.warn("Toggle play pause to break stall"),d.pause(),d.play()):(p.warn("Jumping ".concat(a,"s to break stall")),g=e+a)),g>0&&o!==g&&g>e&&!h){var T=g-e;if(m){var _=c.getStreamForTime(g),S=_&&!!_.getPreloaded();p.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(g,". Gap duration: ").concat(T)),s.seek(g,!0,S)}else{var A=s.getIsDynamic(),b=t>0?f.end(t-1):e,R=A?1e3*Math.max(0,T-.1):0;h=window.setTimeout((function(){s.seek(g,!0,!0),p.warn("Jumping gap occuring in period ".concat(c.getActiveStream().getStreamId()," starting at ").concat(b," and ending at ").concat(g,". Jumping by: ").concat(g-b)),h=null}),R)}o=g}}return e={reset:y,setConfig:function(e){e&&(e.settings&&(r=e.settings),e.playbackController&&(s=e.playbackController),e.streamController&&(c=e.streamController),e.videoModel&&(d=e.videoModel))},initialize:function(){!function(){v.on(u.Z.WALLCLOCK_TIME_UPDATED,A,this),v.on(u.Z.INITIAL_STREAM_SWITCH,S,this),v.on(u.Z.PLAYBACK_SEEKING,E,this),v.on(u.Z.BUFFER_REPLACEMENT_STARTED,T,e),v.on(u.Z.TRACK_CHANGE_RENDERED,_,e)}()}},p=(0,f.Z)(m).getInstance().getLogger(e),y(),e}er.__dashjs_factory_name="GapController";const tr=c.Z.getSingletonFactory(er);function rr(){var e,t,r,n,i,o,c,h,g,p,m=this.context,v=(0,l.Z)(m).getInstance();function y(){t=!1;var e=Fe.Z.parseUserAgent();r=e&&e.browser&&e.browser.name&&"safari"===e.browser.name.toLowerCase()}function E(){t=!1}function T(e){if(e.streamId===o.getActiveStreamInfo().id&&g){var t=c.getLiveDelay();c.getBufferLevel()>t/2&&(g=!1)}}function _(e){e.streamId===o.getActiveStreamInfo().id&&(g=e.state===s.Z.BUFFER_EMPTY)}function S(){h.getCatchupModeEnabled()||n.setPlaybackRate(1)}function A(){c.getIsDynamic()&&h.getCatchupModeEnabled()&&(h.getCatchupPlaybackRates().max>0||h.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&function(){try{return!(!c.getTime()>0||t)&&(R()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t){try{return Math.abs(b())>0||e<t}catch(e){return!1}}(c.getBufferLevel(),i.get().streaming.liveCatchup.playbackBufferMin):function(){try{return Math.abs(b())>0}catch(e){return!1}}())}catch(e){return!1}}()&&function(){if(!t&&n){var e,o=n.getPlaybackRate(),s=h.getCatchupPlaybackRates(),l=c.getBufferLevel(),u=b(),f=h.getCatchupMaxDrift();if(!isNaN(f)&&f>0&&u>f)p.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),t=!0,c.seekToCurrentLive(!0,!1);else{var d=c.getCurrentLiveLatency(),m=c.getLiveDelay();e=R()===a.Z.LIVE_CATCHUP_MODE_LOLP?function(e,t,r,n,i){var a;if(i<n){var o=Math.abs(e.min),s=5*(i-n);a=1-o+2*o/(1+Math.pow(Math.E,-s)),p.debug("[LoL+ playback control_buffer-based] bufferLevel: "+i+", newRate: "+a)}else{var l=e.max;if(Math.abs(t-r)<=.02*r)a=1;else{var u=5*(t-r);a=1-l+2*l/(1+Math.pow(Math.E,-u))}p.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+a)}return a}(s,d,m,i.get().streaming.liveCatchup.playbackBufferMin,l):function(e,t,r,n){if(g)return 1;var i=t-r,a=i<0?Math.abs(e.min):e.max,o=5*i,s=1-a+2*a/(1+Math.pow(Math.E,-o));return c.getPlaybackStalled()&&n<=r/2&&i>0&&(s=1),s}(s,d,m,l);var v=r?.25:.02/(.5/s.max);e&&Math.abs(o-e)>=v&&(p.debug("[CatchupController]: Setting playback rate to ".concat(e)),n.setPlaybackRate(e))}}}()}function b(){return c.getCurrentLiveLatency()-c.getLiveDelay()}function R(){var e=i.get().streaming.liveCatchup.playbackBufferMin;return i.get().streaming.liveCatchup.mode!==a.Z.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?a.Z.LIVE_CATCHUP_MODE_DEFAULT:a.Z.LIVE_CATCHUP_MODE_LOLP}function I(){h.getCatchupPlaybackRates(!0)}return e={reset:function(){v.off(d.Z.BUFFER_LEVEL_UPDATED,T,e),v.off(d.Z.BUFFER_LEVEL_STATE_CHANGED,_,e),v.off(d.Z.PLAYBACK_PROGRESS,A,e),v.off(d.Z.PLAYBACK_TIME_UPDATED,A,e),v.off(d.Z.PLAYBACK_SEEKED,E,e),v.off(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,S,e),v.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,I,e),v.off(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,I,e),v.off(d.Z.STREAM_INITIALIZED,I,e),y(),n.setPlaybackRate(1,!0)},setConfig:function(e){e&&(e.settings&&(i=e.settings),e.videoModel&&(n=e.videoModel),e.streamController&&(o=e.streamController),e.playbackController&&(c=e.playbackController),e.mediaPlayerModel&&(h=e.mediaPlayerModel))},initialize:function(){v.on(d.Z.BUFFER_LEVEL_UPDATED,T,e),v.on(d.Z.BUFFER_LEVEL_STATE_CHANGED,_,e),v.on(d.Z.PLAYBACK_PROGRESS,A,e),v.on(d.Z.PLAYBACK_TIME_UPDATED,A,e),v.on(d.Z.PLAYBACK_SEEKED,E,e),v.on(u.Z.SETTING_UPDATED_CATCHUP_ENABLED,S,e),v.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MIN,I,e),v.on(u.Z.SETTING_UPDATED_PLAYBACK_RATE_MAX,I,e),v.on(d.Z.STREAM_INITIALIZED,I,e),I()}},p=(0,f.Z)(m).getInstance().getLogger(e),y(),e}rr.__dashjs_factory_name="CatchupController";const nr=c.Z.getSingletonFactory(rr);var ir=[a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME],ar="video",or="audio";function sr(){var e,t,r,n,i,s=this.context;function l(){t={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{},contentSteering:null},r=[]}function u(e,r,i){try{t[e][r]=i/1e3}catch(e){n.error(e)}}return e={getServiceDescriptionSettings:function(){return t},getProducerReferenceTimeOffsets:function(){return r},calculateProducerReferenceTimeOffsets:function(e){try{var t=[];if(e&&e.length>0){var s=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT],l=i.getAvailabilityStartTime()/1e3;e.forEach((function(e){var r=s.reduce((function(t,r){return t.concat(i.getAllMediaInfoForType(e,r))}),[]).reduce((function(t,r){return i.getProducerReferenceTimes(e,r).forEach((function(n){var a=i.getVoRepresentations(r);if(a&&a.length>0&&a[0].adaptation&&a[0].segmentInfoType===o.Z.SEGMENT_TEMPLATE){var s=a[0],u=new Date(n[o.Z.WALL_CLOCK_TIME]).getTime()/1e3-(n[o.Z.PRESENTATION_TIME]/s[o.Z.TIMESCALE]-s[o.Z.PRESENTATION_TIME_OFFSET]+e.start),c=l-u;t.push({id:n[o.Z.ID],to:c})}})),t}),[]);t=t.concat(r)}))}r=t}catch(e){n.error(e),r=[]}},applyServiceDescription:function(e){if(e&&e.serviceDescriptions){var i=e.serviceDescriptions.filter((function(e){return ir.includes(e.schemeIdUri)})),o=e.serviceDescriptions.filter((function(e){return null==e.schemeIdUri})),s=i.length>0?i[i.length-1]:o[o.length-1];s&&(s.latency&&s.latency.target>0&&function(e){var i;if(e.schemeIdUri,a.Z.SERVICE_DESCRIPTION_DVB_LL_SCHEME,i=function(e){return{liveDelay:e.latency.target/1e3,maxDrift:!isNaN(e.latency.max)&&e.latency.max>e.latency.target?(e.latency.max-e.latency.target+500)/1e3:NaN,referenceId:e.latency.referenceId||NaN}}(e),r.length>0){var o=function(e){var t,n=0,i=r.filter((function(t){return t.id===e.referenceId}));return 0===i.length?(n=r.length>0?r[0].to:0,t=r[0].id||NaN):(n=i[0].to||0,t=i[0].id||NaN),{to:n,id:t}}(i),s=o.to,l=o.id;t.liveDelay=i.liveDelay-s,t.liveCatchup.maxDrift=i.maxDrift,n.debug("\n                Found latency properties coming from service description. Applied time offset of ".concat(s," from ProducerReferenceTime element with id ").concat(l,".\n                Live Delay: ").concat(i.liveDelay-s,", Live catchup max drift: ").concat(i.maxDrift,"\n            "))}else t.liveDelay=i.liveDelay,t.liveCatchup.maxDrift=i.maxDrift,n.debug("Found latency properties coming from service description: Live Delay: ".concat(i.liveDelay,", Live catchup max drift: ").concat(i.maxDrift))}(s),s.playbackRate&&function(e){var r=e.playbackRate.min?Math.round(1e3*(e.playbackRate.min-1))/1e3:NaN,i=e.playbackRate.max?Math.round(1e3*(e.playbackRate.max-1))/1e3:NaN;t.liveCatchup.playbackRate.min=r,t.liveCatchup.playbackRate.max=i,n.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(r)),n.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(i))}(s),s.operatingQuality,s.operatingBandwidth&&function(e){if(e&&e.operatingBandwidth&&e.operatingBandwidth.mediaType&&"all"!==e.operatingBandwidth.mediaType){var t={};t.minBandwidth=e.operatingBandwidth.min,t.maxBandwidth=e.operatingBandwidth.max,t.targetBandwidth=e.operatingBandwidth.target;var r=[];e.operatingBandwidth.mediaType===ar||e.operatingBandwidth.mediaType===or?r.push(e.operatingBandwidth.mediaType):"any"===e.operatingBandwidth.mediaType&&(r.push(or),r.push(ar)),r.forEach((function(e){isNaN(t.minBandwidth)||u("minBitrate",e,t.minBandwidth),isNaN(t.maxBandwidth)||u("maxBitrate",e,t.maxBandwidth),isNaN(t.targetBandwidth)||u("initialBitrate",e,t.targetBandwidth)}))}}(s),s.contentSteering&&function(e){t.contentSteering=e.contentSteering}(s))}},reset:function(){l()},setConfig:function(e){e&&e.adapter&&(i=e.adapter)}},n=(0,f.Z)(s).getInstance().getLogger(e),l(),e}sr.__dashjs_factory_name="ServiceDescriptionController";const lr=c.Z.getSingletonFactory(sr);var ur=r(3973),cr=r.n(ur),fr=r(3039);function dr(){var e,t,r,n,i,o,s,c,d=this.context,h=(0,l.Z)(d).getInstance();function g(e,t){return e&&r[t]&&r[t][e]?r[t][e].list:[]}function p(e,t){return e&&r[t]&&r[t][e]?r[t][e].current:null}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.streamInfo){var i=e.type,s=e.streamInfo.id,l=p(i,s);if(r[s]&&r[s][i]&&(r[s][i].current=e,r[s][i].current&&(i!==a.Z.TEXT&&!E(e,l)||i===a.Z.TEXT&&e.isFragmented)&&h.trigger(u.Z.CURRENT_TRACK_CHANGED,{oldMediaInfo:l,newMediaInfo:e,switchMode:n.get().streaming.trackSwitchMode[i]},{streamId:s}),!t)){var f=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&t.role.length>0||t.accessibility&&t.accessibility.length>0||t.audioChannelConfiguration&&t.audioChannelConfiguration.length>0?t:null}(e);if(!f||!r[s][i].storeLastSettings)return;f.roles&&(f.role=f.roles[0],delete f.roles),f.accessibility&&(f.accessibility=f.accessibility[0]),f.audioChannelConfiguration&&(f.audioChannelConfiguration=f.audioChannelConfiguration[0]),o[i]=f,c.setSavedMediaSettings(i,f)}}}function v(e,t){e&&t&&(i[e]=t)}function y(e){return e?i[e]:null}function E(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var r=e.id===t.id,n=e.viewpoint===t.viewpoint,i=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),a=e.lang===t.lang,o=e.codec===t.codec,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),f=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),d=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return r&&o&&n&&i&&a&&s&&l&&u&&c&&f&&d}function T(){r={},o={},i={audio:null,video:null,text:null}}function _(e,t,r){var n=[];return e.forEach((function(e){t(r,e)&&n.push(e)})),0!==n.length?n:e}function S(e,t){return!e.lang||e.lang instanceof RegExp?t.lang.match(e.lang):""!==t.lang&&(0,fr.extendedFilter)(t.lang,cr()(e.lang)).length>0}function A(e,t){return void 0===e.index||null===e.index||t.index===e.index}function b(e,t){return!e.viewpoint||e.viewpoint===t.viewpoint}function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!e.role||!!t.roles.filter((function(t){return t===e.role}))[0]||t.type===a.Z.AUDIO&&r}function I(e,t){return e.accessibility?!!t.accessibility.filter((function(t){return t===e.accessibility}))[0]:!t.accessibility.length}function w(e,t){return!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0]}function D(e){var t,r=0,n=[];return e.forEach((function(e){(t=Math.max.apply(Math,e.bitrateList.map((function(e){return e.bandwidth}))))>r?(r=t,n=[e]):t===r&&n.push(e)})),n}function C(e){var t,r=1/0,n=[];return e.forEach((function(e){var i=e.bitrateList.reduce((function(e,t){var r=Math.max(1,t.width*t.height);return e+t.bandwidth/r}),0);(t=i/e.bitrateList.length)<r?(r=t,n=[e]):t===r&&n.push(e)})),n}function N(e){var t,r=0,n=[];return e.forEach((function(e){(t=e.representationCount)>r?(r=t,n=[e]):t===r&&n.push(e)})),n}function L(e,r){if(e===a.Z.TEXT)return r[0];var i,o=n.get().streaming.selectionModeForInitialTrack,l=s.getCustomInitialTrackSelectionFunction();if(l&&"function"==typeof l)i=l(r);else switch(o){case a.Z.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:i=function(e){var t,r,n=(t=0,r=[],e.forEach((function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,r=[e]):e.selectionPriority===t&&r.push(e))})),r);return n.length>1&&(n=D(n)),n.length>1&&(n=N(n)),n}(r);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_BITRATE:i=function(e){var t=D(e);return t.length>1&&(t=N(t)),t}(r);break;case a.Z.TRACK_SELECTION_MODE_FIRST_TRACK:i=O(r);break;case a.Z.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:i=function(e){var t=C(e);return t.length>1&&(t=D(t)),t}(r);break;case a.Z.TRACK_SELECTION_MODE_WIDEST_RANGE:i=function(e){var t=N(e);return t.length>1&&(t=D(e)),t}(r);break;default:t.warn("Track selection mode ".concat(o," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),i=O(r)}return i.length>0?i[0]:r[0]}function O(e){return e[0]}return e={setInitialMediaSettingsForType:function(e,t){var r=o[e]||y(e),n=g(e,t.id),i=[];r||v(e,r=c.getSavedMediaSettings(e)),n&&0!==n.length&&(r&&(i=_(i=Array.from(n),S,r),i=_(i,A,r),i=_(i,b,r),e===a.Z.AUDIO&&o[e]||(i=_(i,R,r)),i=_(i,I,r),i=_(i,w,r)),0===i.length?m(L(e,n),!0):i.length>1?m(L(e,i,o[e])):m(i[0]))},addTrack:function(e){if(e){var t=e.type;if((n=t)===a.Z.AUDIO||n===a.Z.VIDEO||n===a.Z.TEXT||n===a.Z.IMAGE){var n,i=e.streamInfo.id;r[i]||(r[i]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var o=r[i][t].list,s=0,l=o.length;s<l;++s)if(E(o[s],e))return;o.push(e)}}},getTracksFor:g,getCurrentTrackFor:p,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return r[n]&&r[n][t]&&E(r[n][t].current,e)},setTrack:m,selectInitialTrack:L,setInitialSettings:v,getInitialSettings:y,getTracksWithHighestBitrate:D,getTracksWithHighestEfficiency:C,getTracksWithWidestRange:N,isTracksEqual:E,matchSettings:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var n=!1;if(e.lang){if(e.lang instanceof RegExp)n=t.lang.match(e.lang);else if(""!==t.lang){var i=cr()(e.lang);i&&(n=(0,fr.extendedFilter)(t.lang,i).length>0)}}else n=!0;var o=void 0===e.index||null===e.index||t.index===e.index,s=!e.viewpoint||e.viewpoint===t.viewpoint,l=!e.role||!!t.roles.filter((function(t){return t===e.role}))[0],u=!e.accessibility||!!t.accessibility.filter((function(t){return t===e.accessibility}))[0],c=!e.audioChannelConfiguration||!!t.audioChannelConfiguration.filter((function(t){return t===e.audioChannelConfiguration}))[0];return n&&o&&s&&(l||t.type===a.Z.AUDIO&&r)&&u&&c}catch(e){return!1}},matchSettingsLang:S,matchSettingsIndex:A,matchSettingsViewPoint:b,matchSettingsRole:R,matchSettingsAccessibility:I,matchSettingsAudioChannelConfig:w,saveTextSettingsDisabled:function(){c.setSavedMediaSettings(a.Z.TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(c=e.domStorage),e.settings&&(n=e.settings),e.customParametersModel&&(s=e.customParametersModel))},reset:T},t=(0,f.Z)(d).getInstance().getLogger(e),T(),e}dr.__dashjs_factory_name="MediaController";var hr=c.Z.getSingletonFactory(dr);c.Z.updateSingletonFactory(dr.__dashjs_factory_name,hr);const gr=hr;var pr=NaN,mr=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={baseUrls:t||null,selectedIdx:r||pr},this.children=[]};function vr(){var e,t,r,n,i=this.context,a=De(i).getInstance();function o(e,t,r){var n=s(r);e[t]?a.areEqual(n,e[t].data.baseUrls)||(e[t].data.baseUrls=n,e[t].data.selectedIdx=pr):e[t]=new mr(n)}function s(e){var t=r.getBaseURLsFromElement(e),i=n.getSynthesizedBaseUrlElements(t);return i&&i.length>0&&(t=t.concat(i)),t}function l(e,r){var n=r||t;e(n.data),n.children&&n.children.forEach((function(t){return l(e,t)}))}function u(){t=new mr}return e={reset:u,update:function(e){!function(e){!function(){if(!r||!r.hasOwnProperty("getBaseURLsFromElement")||!r.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var n=s(e);a.areEqual(n,t.data.baseUrls)||(t.data.baseUrls=n,t.data.selectedIdx=pr),e&&e.Period_asArray&&e.Period_asArray.forEach((function(e,n){o(t.children,n,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach((function(e,i){o(t.children[n].children,i,e),e.Representation_asArray&&e.Representation_asArray.sort(r.getRepresentationSortFunction()).forEach((function(e,r){o(t.children[n].children[i].children,r,e)}))}))}))}(e)},getForPath:function(e){var r=t,n=[r.data];return e&&e.forEach((function(e){(r=r.children[e])&&n.push(r.data)})),n.filter((function(e){return e.baseUrls.length}))},invalidateSelectedIndexes:function(e){l((function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=pr)}))},setConfig:function(e){e.adapter&&(r=e.adapter),e.contentSteeringController&&(n=e.contentSteeringController)},getBaseUrls:function(e){return s(e)}},u(),e}vr.__dashjs_factory_name="BaseURLTreeModel";const yr=c.Z.getClassFactory(vr);function Er(e){var t=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var t,r,n=0,i=[],a=0;if((r=e.sort((function(e,t){var r=e.dvb_priority-t.dvb_priority;return isNaN(r)?0:r})).filter((function(e,t,r){return!t||r[0].dvb_priority&&e.dvb_priority&&r[0].dvb_priority===e.dvb_priority}))).length)return r.length>1&&(r.forEach((function(e){n+=e.dvb_weight,i.push(n)})),t=Math.floor(Math.random()*(n-1)),i.every((function(e,r){return a=r,!(t<e)}))),r[a]}((r=[],e.filter((function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&r.push(e.dvb_priority),!1)})).filter((function(e){return!r.length||!e.dvb_priority||-1===r.indexOf(e.dvb_priority)}))));var r}}}Er.__dashjs_factory_name="DVBSelector";const Tr=c.Z.getClassFactory(Er);function _r(e){var t=(e=e||{}).blacklistController;return{select:function(e){var r,n=0;return e&&e.some((function(e,r){return n=r,!t.contains(e.serviceLocation)}))&&(r=e[n]),r}}}_r.__dashjs_factory_name="BasicSelector";const Sr=c.Z.getClassFactory(_r);function Ar(){var e,t,r,n=this.context;function i(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=0,i=NaN,a=function(){var a=e[n],o=t.findIndex((function(e){return e.serviceLocation&&e.serviceLocation===a}));if(-1!==o&&!r.contains(t[o].serviceLocation))return i=o,"break";n+=1};n<e.length&&"break"!==a(););return i}return e={selectBaseUrlIndex:function(e){var r=NaN;if(isNaN(e.selectedIdx)){var n=t.getSteeringDataFromManifest();n&&n.defaultServiceLocationArray.length>0&&(r=i(n.defaultServiceLocationArray,e.baseUrls))}var a=t.getCurrentSteeringResponseData();return e.baseUrls&&e.baseUrls.length&&a&&a.pathwayPriority&&a.pathwayPriority.length&&(r=i(a.pathwayPriority,e.baseUrls)),r},setConfig:function(e){e.blacklistController&&(r=e.blacklistController),e.contentSteeringController&&(t=e.contentSteeringController)}},t=Ut(n).getInstance(),e}Ar.__dashjs_factory_name="ContentSteeringSelector";const br=c.Z.getClassFactory(Ar);function Rr(){var e,t,r,n,i,a,o=this.context,s=(0,l.Z)(o).getInstance(),c=(0,w.Z)(o).getInstance();function f(){t.reset()}return e={chooseSelector:function(e){(0,j.PS)(e,"boolean"),a=e?n:r},select:function(e){if(e){if(c.get().streaming.applyContentSteering){var t=i.selectBaseUrlIndex(e);isNaN(t)||-1===t||(e.selectedIdx=t)}if(!isNaN(e.selectedIdx))return e.baseUrls[e.selectedIdx];var n=a.select(e.baseUrls);return n?(e.selectedIdx=e.baseUrls.indexOf(n),n):(s.trigger(u.Z.URL_RESOLUTION_FAILED,{error:new S.Z(I.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,I.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(a===r&&f()))}},reset:f,setConfig:function(e){e.selector&&(a=e.selector),e.contentSteeringSelector&&(i=e.contentSteeringSelector)}},t=Lt(o).create({updateEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,addBlacklistEventName:u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_ADD}),r=Sr(o).create({blacklistController:t}),n=Tr(o).create({blacklistController:t}),(i=br(o).create()).setConfig({blacklistController:t}),a=r,e}Rr.__dashjs_factory_name="BaseURLSelector";const Ir=c.Z.getClassFactory(Rr);function wr(){var e,t,r,n,i,a=this.context,o=(0,l.Z)(a).getInstance(),s=(0,X.Z)(a).getInstance();function c(e){r.update(e),n.chooseSelector(t.getIsDVB(e)),o.trigger(d.Z.BASE_URLS_UPDATED,{baseUrls:f(e)})}function f(e){return r.getBaseUrls(e)}return e={reset:function(){r.reset(),n.reset()},initialize:function(e){r.setConfig({adapter:t,contentSteeringController:i}),c(e)},resolve:function(e){var t=r.getForPath(e).reduce((function(e,t){var r=n.select(t);return r?(s.isRelative(r.url)?e.url=s.resolve(r.url,e.url):(e.url=r.url,e.serviceLocation=r.serviceLocation),e.availabilityTimeOffset=r.availabilityTimeOffset,e.availabilityTimeComplete=r.availabilityTimeComplete,e.queryParams=r.queryParams,e):new Te}),new Te);if(!s.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(r=e.baseURLTreeModel),e.baseURLSelector&&(n=e.baseURLSelector),e.adapter&&(t=e.adapter),e.contentSteeringController&&(i=e.contentSteeringController)},getBaseUrls:f,update:c},r=yr(a).create(),n=Ir(a).create(),o.on(u.Z.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,(function(e){r.invalidateSelectedIndexes(e.entry)}),e),e}wr.__dashjs_factory_name="BaseURLController";const Dr=c.Z.getClassFactory(wr);function Cr(e){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cr(e)}function Nr(e,t){return Nr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Nr(e,t)}function Lr(e){return Lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Lr(e)}const Or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nr(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=Lr(t);if(r){var i=Lr(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==Cr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(r=n.call(this)).url=e||null,r.type=t||null,r.mediaType=a.Z.STREAM,r.responseType="",r}return i}(p.Z);function Pr(e){e=e||{};var t=this.context,r=(0,l.Z)(t).getInstance(),n=gt(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:I});return{load:function(e,t,i){var a=function(n,a){t.resolved=!0,t.resolvedContent=n||null,r.trigger(u.Z.XLINK_ELEMENT_LOADED,{element:t,resolveObject:i,error:n||a?null:new S.Z(I.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,I.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+e)})};if("urn:mpeg:dash:resolve-to-zero:2013"===e)a(null,!0);else{var o=new Or(e,D.w.XLINK_EXPANSION_TYPE);n.load({request:o,success:function(e){a(e)},error:function(){a(null)}})}},reset:function(){n&&(n.abort(),n=null)}}}Pr.__dashjs_factory_name="XlinkLoader";const Mr=c.Z.getClassFactory(Pr),kr=function(e){function t(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function n(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==n)break}else if(a instanceof RegExp){if(a.test(n))break}else if("function"==typeof a&&a(t,r,n))break}return i!=e.length}function i(t,r,i){"property"===e.arrayAccessForm&&(t[r]instanceof Array?t[r+"_asArray"]=t[r]:t[r+"_asArray"]=[t[r]]),!(t[r]instanceof Array)&&e.arrayAccessFormPaths.length>0&&n(e.arrayAccessFormPaths,t,r,i)&&(t[r]=[t[r]])}function a(e){var t=e.split(/[-T:+Z]/g),r=new Date(t[0],t[1]-1,t[2]),n=t[5].split(".");if(r.setHours(t[3],t[4],n[0]),n.length>1&&r.setMilliseconds(n[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),r.setMinutes(r.getMinutes()-i-r.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(r=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())));return r}function o(t,r,i,a){return!(1==r&&e.xmlElementsFilter.length>0)||n(e.xmlElementsFilter,t,i,a)}function s(r,l){if(9==r.nodeType){for(var u=new Object,c=r.childNodes,f=0;f<c.length;f++)1==(h=c[f]).nodeType&&(e.ignoreRoot?u=s(h):(u={})[g=t(h)]=s(h));return u}if(1==r.nodeType){(u=new Object).__cnt=0;var d=[];for(c=r.childNodes,f=0;f<c.length;f++){var h,g=t(h=c[f]);if(8!=h.nodeType){var p=l+"."+g;if(o(u,h.nodeType,g,p))if(u.__cnt++,null==u[g]){var m=s(h,p);("#text"!=g||/[^\s]/.test(m))&&((v={})[g]=m,d.push(v)),u[g]=m,i(u,g,p)}else{var v;null!=u[g]&&(u[g]instanceof Array||(u[g]=[u[g]],i(u,g,p))),m=s(h,p),("#text"!=g||/[^\s]/.test(m))&&((v={})[g]=m,d.push(v)),u[g][u[g].length]=m}}}u.__children=d;for(var y=t(r),E=0;E<r.attributes.length;E++){var T=r.attributes[E];u.__cnt++;for(var _=T.value,S=0,A=e.matchers.length;S<A;S++){var b=e.matchers[S];b.test(T,y)&&(_=b.converter(T.value))}u[e.attributePrefix+T.name]=_}var R=function(e){return e.prefix}(r);return null!=R&&""!=R&&(u.__cnt++,u.__prefix=R),null!=u["#text"]&&(u.__text=u["#text"],u.__text instanceof Array&&(u.__text=u.__text.join("\n")),e.stripWhitespaces&&(u.__text=u.__text.trim()),delete u["#text"],"property"==e.arrayAccessForm&&delete u["#text_asArray"],u.__text=function(t,r,i){if(e.datetimeAccessFormPaths.length>0){var o=i.split(".#")[0];return n(e.datetimeAccessFormPaths,t,r,o)?a(t):t}return t}(u.__text,g,l+"."+g)),null!=u["#cdata-section"]&&(u.__cdata=u["#cdata-section"],delete u["#cdata-section"],"property"==e.arrayAccessForm&&delete u["#cdata-section_asArray"]),0==u.__cnt&&"text"==e.emptyNodeForm?u="":1==u.__cnt&&null!=u.__text?u=u.__text:1!=u.__cnt||null==u.__cdata||e.keepCData?u.__cnt>1&&null!=u.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==u.__text||""==u.__text.trim())&&delete u.__text:u=u.__cdata,delete u.__cnt,!e.enableToStringFunc||null==u.__text&&null==u.__cdata||(u.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),u}if(3==r.nodeType||4==r.nodeType)return r.nodeValue}function l(t,n,i,a){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=i)for(var s=0;s<i.length;s++){var l=i[s],u=t[l];e.escapeMode&&(u=r(u)),o+=" "+l.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+u+'"':o+="'"+u+"'"}return o+(a?"/>":">")}function u(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function c(t,r){return"property"==e.arrayAccessForm&&(i="_asArray",-1!==(n=r.toString()).indexOf(i,n.length-8))||0==r.toString().indexOf(e.attributePrefix)||0==r.toString().indexOf("__")||t[r]instanceof Function;var n,i}function f(e){var t=0;if(e instanceof Object)for(var r in e)c(e,r)||t++;return t}function d(t,r,i){return 0==e.jsonPropertiesFilter.length||""==i||n(e.jsonPropertiesFilter,t,r,i)}function h(t){var r=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(e.attributePrefix)&&r.push(n);return r}function g(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=r(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=r(t):n+=t),n}function p(e,t){return""===e?t:e+"."+t}function m(e,t,r,n){var i="";if(0==e.length)i+=l(e,t,r,!0);else for(var a=0;a<e.length;a++)i+=l(e[a],t,h(e[a]),!1),i+=v(e[a],p(n,t)),i+=u(e[a],t);return i}function v(e,t){var r="";if(f(e)>0)for(var n in e)if(!c(e,n)&&(""==t||d(e,n,p(t,n)))){var i=e[n],a=h(i);null==i||null==i?r+=l(i,n,a,!0):i instanceof Object?i instanceof Array?r+=m(i,n,a,t):i instanceof Date?(r+=l(i,n,a,!1),r+=i.toISOString(),r+=u(i,n)):f(i)>0||null!=i.__text||null!=i.__cdata?(r+=l(i,n,a,!1),r+=v(i,p(t,n)),r+=u(i,n)):r+=l(i,n,a,!0):(r+=l(i,n,a,!1),r+=g(i),r+=u(i,n))}return r+g(e)}void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1),this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var r=new window.DOMParser;try{(t=r.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?a(e):e},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return v(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}};var xr="onLoad";function Fr(e){e=e||{};var t,r,n,i,a,s,c=this.context,f=(0,l.Z)(c).getInstance(),d=(0,X.Z)(c).getInstance();function h(e,t,r){var n,i,a={};a.elements=e,a.type=t,a.resolveType=r,0===a.elements.length&&p(a);for(var o=0;o<a.elements.length;o++)n=a.elements[o],i=d.isHTTPURL(n.url)?n.url:n.originalContent.BaseURL+n.url,s.load(i,n,a)}function g(e){var t,r,n="";if(t=e.element,r=e.resolveObject,t.resolvedContent){var i=0;0===t.resolvedContent.indexOf("<?xml")&&(i=t.resolvedContent.indexOf("?>")+2),n=t.resolvedContent.substr(0,i)+"<response>"+t.resolvedContent.substr(i)+"</response>",t.resolvedContent=a.xml_str2json(n)}(function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0})(r)&&p(r)}function p(e){var t,r,a=[];if(function(e){var t,r,a,o,s,l,u=[];for(o=e.elements.length-1;o>=0;o--){if(r=(t=e.elements[o]).type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(s=0;s<t.resolvedContent[r].length;s++)a=t.resolvedContent[r][s],u.push(a)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],u.push(t.originalContent);for(t.parentElement[r].splice(t.index,1),l=0;l<u.length;l++)t.parentElement[r].splice(t.index+l,0,u[l]);u=[]}e.elements.length>0&&n.run(i)}(e),"onActuate"===e.resolveType&&f.trigger(u.Z.XLINK_READY,{manifest:i}),e.resolveType===xr)switch(e.type){case o.Z.PERIOD:for(t=0;t<i[o.Z.PERIOD+"_asArray"].length;t++)(r=i[o.Z.PERIOD+"_asArray"][t]).hasOwnProperty(o.Z.ADAPTATION_SET+"_asArray")&&(a=a.concat(m(r[o.Z.ADAPTATION_SET+"_asArray"],r,o.Z.ADAPTATION_SET,xr))),r.hasOwnProperty(o.Z.EVENT_STREAM+"_asArray")&&(a=a.concat(m(r[o.Z.EVENT_STREAM+"_asArray"],r,o.Z.EVENT_STREAM,xr)));h(a,o.Z.ADAPTATION_SET,xr);break;case o.Z.ADAPTATION_SET:f.trigger(u.Z.XLINK_READY,{manifest:i})}}function m(e,t,r,n){var i,a,o,s=[];for(a=e.length-1;a>=0;a--)(i=e[a]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===i["xlink:href"]&&e.splice(a,1);for(a=0;a<e.length;a++)(i=e[a]).hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===n&&(o=v(i["xlink:href"],t,r,a,n,i),s.push(o));return s}function v(e,t,r,n,i,a){return{url:e,parentElement:t,type:r,index:n,resolveType:i,originalContent:a,resolvedContent:null,resolved:!1}}return t={resolveManifestOnLoad:function(e){a=new kr({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:r}),(i=e).Period_asArray?h(m(i.Period_asArray,i,o.Z.PERIOD,xr),o.Z.PERIOD,xr):f.trigger(u.Z.XLINK_READY,{manifest:i})},setMatchers:function(e){e&&(r=e)},setIron:function(e){e&&(n=e)},reset:function(){f.off(u.Z.XLINK_ELEMENT_LOADED,g,t),s&&(s.reset(),s=null)}},f.on(u.Z.XLINK_ELEMENT_LOADED,g,t),s=Mr(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t}Fr.__dashjs_factory_name="XlinkController";const Ur=c.Z.getClassFactory(Fr);function Br(e){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Br(e)}function Zr(e){function t(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function r(e,r,n){for(var i=0,a=e.length;i<a;++i){var o=e[i];if(r[o.name])if(n[o.name]){if(o.merge){var s=r[o.name],l=n[o.name];"object"===Br(s)&&"object"===Br(l)?t(s,l):n[o.name]=s+l}}else n[o.name]=r[o.name]}}function n(e,t){for(var i=0,a=e.children.length;i<a;++i){var o=e.children[i],s=t[o.name+"_asArray"];if(s)for(var l=0,u=s.length;l<u;++l){var c=s[l];r(e.properties,t,c),n(o,c)}}}return{run:function(t){if(null===t||"object"!==Br(t))return t;if(t.Period_asArray&&"period"in e)for(var r=e.period,i=t.Period_asArray,a=0,o=i.length;a<o;++a){var s=i[a];if(n(r,s),"adaptationset"in e){var l=s.AdaptationSet_asArray;if(l)for(var u=e.adaptationset,c=0,f=l.length;c<f;++c)n(u,l[c])}}return t}}}Zr.__dashjs_factory_name="ObjectIron";const Gr=c.Z.getClassFactory(Zr),Kr=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._test=t,this._converter=r}var t;return(t=[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function Hr(e){return Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hr(e)}function Yr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vr(e,t){return Vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Vr(e,t)}function qr(e){return qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},qr(e)}const jr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vr(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=qr(t);if(r){var i=qr(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==Hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,(function(e,t){var r,n=(Yr(r={},o.Z.MPD,[o.Z.ID,o.Z.PROFILES]),Yr(r,o.Z.PERIOD,[o.Z.ID]),Yr(r,o.Z.BASE_URL,[o.Z.SERVICE_LOCATION,o.Z.BYTE_RANGE]),Yr(r,o.Z.SEGMENT_BASE,[o.Z.INDEX_RANGE]),Yr(r,o.Z.INITIALIZATION,[o.Z.RANGE]),Yr(r,o.Z.REPRESENTATION_INDEX,[o.Z.RANGE]),Yr(r,o.Z.SEGMENT_LIST,[o.Z.INDEX_RANGE]),Yr(r,o.Z.BITSTREAM_SWITCHING,[o.Z.RANGE]),Yr(r,o.Z.SEGMENT_URL,[o.Z.MEDIA_RANGE,o.Z.INDEX_RANGE]),Yr(r,o.Z.SEGMENT_TEMPLATE,[o.Z.INDEX_RANGE,o.Z.MEDIA,o.Z.INDEX,o.Z.INITIALIZATION_MINUS,o.Z.BITSTREAM_SWITCHING_MINUS]),Yr(r,o.Z.ASSET_IDENTIFIER,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.EVENT_STREAM,[o.Z.VALUE]),Yr(r,o.Z.ADAPTATION_SET,[o.Z.PROFILES,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.CONTENT_TYPE]),Yr(r,o.Z.FRAME_PACKING,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.AUDIO_CHANNEL_CONFIGURATION,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.CONTENT_PROTECTION,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.ESSENTIAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.SUPPLEMENTAL_PROPERTY,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.INBAND_EVENT_STREAM,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.ACCESSIBILITY,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.ROLE,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.RATING,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.VIEWPOINT,[o.Z.VALUE,o.Z.ID]),Yr(r,o.Z.CONTENT_COMPONENT,[o.Z.CONTENT_TYPE]),Yr(r,o.Z.REPRESENTATION,[o.Z.ID,o.Z.DEPENDENCY_ID,o.Z.MEDIA_STREAM_STRUCTURE_ID]),Yr(r,o.Z.SUBSET,[o.Z.ID]),Yr(r,o.Z.METRICS,[o.Z.METRICS_MINUS]),Yr(r,o.Z.REPORTING,[o.Z.VALUE,o.Z.ID]),r);if(n.hasOwnProperty(t)){var i=n[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1}),(function(e){return String(e)}))}return i}(Kr);function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}function Wr(e,t){return Wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wr(e,t)}function Xr(e){return Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Xr(e)}var Qr=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/;const Jr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wr(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=Xr(t);if(r){var i=Xr(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,(function(e){for(var t=[o.Z.MIN_BUFFER_TIME,o.Z.MEDIA_PRESENTATION_DURATION,o.Z.MINIMUM_UPDATE_PERIOD,o.Z.TIMESHIFT_BUFFER_DEPTH,o.Z.MAX_SEGMENT_DURATION,o.Z.MAX_SUBSEGMENT_DURATION,o.Z.SUGGESTED_PRESENTATION_DELAY,o.Z.START,a.Z.START_TIME,o.Z.DURATION],r=t.length,n=0;n<r;n++)if(e.nodeName===t[n])return Qr.test(e.value);return!1}),(function(e){var t=Qr.exec(e),r=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(r=-r),r}))}return i}(Kr);function $r(e){return $r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$r(e)}function en(e,t){return en=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},en(e,t)}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},tn(e)}var rn=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/;const nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&en(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=tn(t);if(r){var i=tn(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==$r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,(function(e){return rn.test(e.value)}),(function(e){var t,r=rn.exec(e);if(t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&parseInt(r[6],10)||0,r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]){var n=60*parseInt(r[9],10)+parseInt(r[10],10);t+=("+"===r[8]?-1:1)*n*60*1e3}return new Date(t)}))}return i}(Kr);function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}function on(e,t){return on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},on(e,t)}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}var ln=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/;const un=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&on(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=sn(t);if(r){var i=sn(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==an(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,(function(e){return ln.test(e.value)}),(function(e){return parseFloat(e)}))}return i}(Kr);function cn(e){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cn(e)}function fn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dn(e,t){return dn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},dn(e,t)}function hn(e){return hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hn(e)}const gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dn(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=hn(t);if(r){var i=hn(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,(function(e,t){var r,n=(fn(r={},o.Z.ADAPTATION_SET,[o.Z.LANG]),fn(r,o.Z.REPRESENTATION,[o.Z.LANG]),fn(r,o.Z.CONTENT_COMPONENT,[o.Z.LANG]),fn(r,o.Z.LABEL,[o.Z.LANG]),fn(r,o.Z.GROUP_LABEL,[o.Z.LANG]),r);if(n.hasOwnProperty(t)){var i=n[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1}),(function(e){var t=cr()(e);return void 0!==t?t:String(e)}))}return i}(Kr),pn=function(){function e(t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t,this._merge=(r=t)&&r.length&&r.charAt(0)===r.charAt(0).toUpperCase()}var t;return(t=[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),mn=function(){function e(t,r,n){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=t||"",this._properties=[],this._children=n||[],Array.isArray(r)&&r.forEach((function(e){i._properties.push(new pn(e))}))}var t;return(t=[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function vn(e){return vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vn(e)}function yn(e,t){return yn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},yn(e,t)}function En(e){return En=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},En(e)}const Tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yn(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=En(t);if(r){var i=En(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==vn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=[o.Z.PROFILES,o.Z.WIDTH,o.Z.HEIGHT,o.Z.SAR,o.Z.FRAMERATE,o.Z.AUDIO_SAMPLING_RATE,o.Z.MIME_TYPE,o.Z.SEGMENT_PROFILES,o.Z.CODECS,o.Z.MAXIMUM_SAP_PERIOD,o.Z.START_WITH_SAP,o.Z.MAX_PLAYOUT_RATE,o.Z.CODING_DEPENDENCY,o.Z.SCAN_TYPE,o.Z.FRAME_PACKING,o.Z.AUDIO_CHANNEL_CONFIGURATION,o.Z.CONTENT_PROTECTION,o.Z.ESSENTIAL_PROPERTY,o.Z.ESSENTIAL_PROPERTY+"_asArray",o.Z.SUPPLEMENTAL_PROPERTY,o.Z.INBAND_EVENT_STREAM];return n.call(this,o.Z.ADAPTATION_SET,e,[new mn(o.Z.REPRESENTATION,e,[new mn(o.Z.SUB_REPRESENTATION,e)])])}return i}(mn);function _n(e){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_n(e)}function Sn(e,t){return Sn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Sn(e,t)}function An(e){return An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},An(e)}const bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sn(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=An(t);if(r){var i=An(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var e=[o.Z.SEGMENT_BASE,o.Z.SEGMENT_TEMPLATE,o.Z.SEGMENT_LIST];return n.call(this,o.Z.PERIOD,e,[new mn(o.Z.ADAPTATION_SET,e,[new mn(o.Z.REPRESENTATION,e)])])}return i}(mn);function Rn(e){e=e||{};var t,r,n,i,a,o=this.context,s=e.debug;return t={parse:function(e){var t,n=window.performance.now();if(!(t=i.xml_str2json(e)))throw new Error("parsing the manifest failed");var o=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach((function(e){return a.run(e)})),t.replace_asArray&&t.replace_asArray.forEach((function(e){return a.run(e)}))):(t=t.MPD,a.run(t));var s=window.performance.now();return r.info("Parsing complete: ( xml2json: "+(o-n).toPrecision(3)+"ms, objectiron: "+(s-o).toPrecision(3)+"ms, total: "+((s-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return n},getIron:function(){return a}},r=s.getLogger(t),n=[new Jr,new nn,new un,new gn,new jr],i=new kr({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:n}),a=Gr(o).create({adaptationset:new Tn,period:new bn}),t}Rn.__dashjs_factory_name="DashParser";const In=c.Z.getClassFactory(Rn);function wn(e){e=e||{};var t,r,n,i,s,c=this.context,f=e.debug,d=e.settings,h=(0,l.Z)(c).getInstance(),g=(0,X.Z)(c).getInstance(),p=e.mssHandler,m=e.errHandler;function v(e){h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}function y(e){var t=null;return e.indexOf("SmoothStreamingMedia")>-1?(p&&(t=p.createMssParser(),p.createMssFragmentProcessor(),p.registerEvents()),t):e.indexOf("MPD")>-1||e.indexOf("Patch")>-1?In(c).create({debug:f}):t}return t={load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new Date,l=new Or(e,D.w.MPD_TYPE);t&&(l.serviceLocation=t),a&&(l.queryParams=a),l.requestStartDate||(l.requestStartDate=o),h.trigger(u.Z.MANIFEST_LOADING_STARTED,{request:l}),n.load({request:l,success:function(t,n,a){var o,l,c;if(i)if(a&&a!==e?(l=g.parseBaseUrl(a),o=a):(g.isRelative(e)&&(e=g.resolve(e,window.location.href)),l=g.parseBaseUrl(e)),"No Content"!=n)if(null===s&&(s=y(t)),null!==s){i.setMatchers(s.getMatchers()),i.setIron(s.getIron());try{c=s.parse(t)}catch(t){return void h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}if(c){if(c.url=o||e,c.originalUrl||(c.originalUrl=c.url),d&&d.get().streaming.enableManifestDurationMismatchFix&&c.mediaPresentationDuration&&c.Period_asArray.length>1){var f=c.Period_asArray.reduce((function(e,t){return e+t.duration}),0);!isNaN(f)&&c.mediaPresentationDuration>f&&(r.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),c.mediaPresentationDuration=f)}c.baseUri=l,c.loadedTime=new Date,i.resolveManifestOnLoad(c),h.trigger(u.Z.ORIGINAL_MANIFEST_LOADED,{originalManifest:t})}else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))})}else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,I.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(e))});else h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(t,r,n){h.trigger(u.Z.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new S.Z(I.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,I.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(e,", ").concat(n))})}})},reset:function(){h.off(u.Z.XLINK_READY,v,t),p&&p.reset(),i&&(i.reset(),i=null),n&&(n.abort(),n=null)}},r=f.getLogger(t),h.on(u.Z.XLINK_READY,v,t),n=gt(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:g,constants:a.Z,dashConstants:o.Z,errors:I,requestTimeout:e.settings.get().streaming.manifestRequestTimeout}),i=Ur(c).create({errHandler:m,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),s=null,t}wn.__dashjs_factory_name="ManifestLoader";const Dn=c.Z.getClassFactory(wn);function Cn(){var e=this.context,t=(0,l.Z)(e).getInstance();return{error:function(e){t.trigger(u.Z.ERROR,{error:e})}}}Cn.__dashjs_factory_name="ErrorHandler";const Nn=c.Z.getSingletonFactory(Cn);var Ln=r(1715);function On(){var e,t,r,n,i,o,s=this.context,c=(0,l.Z)(s).getInstance();function d(e,n){if(!n||!n.Period_asArray||0===n.Period_asArray.length)return Promise.resolve();var i=[];return n.Period_asArray.forEach((function(n){i.push(function(e,n){return new Promise((function(i){if(e&&e.AdaptationSet_asArray&&0!==e.AdaptationSet_asArray.length){var s=[];e.AdaptationSet_asArray.forEach((function(e){t.getIsTypeOf(e,n)&&s.push(function(e,n){return new Promise((function(i){if(e.Representation_asArray&&0!==e.Representation_asArray.length){var s=[],l=[];e.Representation_asArray.forEach((function(i,o){var u=t.getCodec(e,o,!1),c=function(e,t,r){switch(e){case a.Z.VIDEO:return function(e,t){return{codec:t,width:e.width||null,height:e.height||null,framerate:e.frameRate||null,bitrate:e.bandwidth||null}}(t,r);case a.Z.AUDIO:return function(e,t){var r=e.audioSamplingRate||null;return{codec:t,bitrate:e.bandwidth||null,samplerate:r}}(t,r);default:return null}}(n,i,u);l.push(c),s.push(r.supportsCodec(c,n))})),Promise.all(s).then((function(t){e.Representation_asArray=e.Representation_asArray.filter((function(e,r){return t[r]||o.debug("[Stream] Codec ".concat(l[r].codec," not supported ")),t[r]})),i()})).catch((function(){i()}))}else i()}))}(e,n))})),Promise.all(s).then((function(){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){var t=e.Representation_asArray&&e.Representation_asArray.length>0;return t||(c.trigger(u.Z.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:e}),o.warn("AdaptationSet has been removed because of no supported Representation")),t})),i()})).catch((function(){i()}))}else i()}))}(n,e))})),Promise.all(i)}return e={setConfig:function(e){e&&(e.adapter&&(t=e.adapter),e.capabilities&&(r=e.capabilities),e.settings&&(n=e.settings),e.customParametersModel&&(i=e.customParametersModel))},filterUnsupportedFeatures:function(e){return new Promise((function(s){var l=[];l.push(d(a.Z.VIDEO,e)),l.push(d(a.Z.AUDIO,e)),Promise.all(l).then((function(){n.get().streaming.capabilities.filterUnsupportedEssentialProperties&&function(e){e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach((function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){var n=t.getEssentialPropertiesForRepresentation(e);if(n&&n.length>0)for(var i=0;i<n.length;){if(!r.supportsEssentialProperty(n[i]))return o.debug("[Stream] EssentialProperty not supported: "+n[i].schemeIdUri),!1;i+=1}return!0})),e.Representation_asArray&&e.Representation_asArray.length>0)}))}))}(e),function(e){var t=i.getCustomCapabilitiesFilters();t&&0!==t.length&&e&&e.Period_asArray&&0!==e.Period_asArray.length&&e.Period_asArray.forEach((function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter((function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter((function(e){return!t.some((function(t){return!t(e)}))})),e.Representation_asArray&&e.Representation_asArray.length>0)}))}))}(e),s()})).catch((function(){s()}))}))}},o=(0,f.Z)(s).getInstance().getLogger(e),e}On.__dashjs_factory_name="CapabilitiesFilter";const Pn=c.Z.getSingletonFactory(On),Mn=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};function kn(){var e;return{initialize:function(t){if(e=new Mn,!t)return null;var r=t.indexOf("#");if(-1!==r)for(var n=t.substr(r+1).split("&"),i=0,a=n.length;i<a;++i){var o=n[i],s=o.indexOf("=");if(-1!==s){var l=o.substring(0,s);e.hasOwnProperty(l)&&(e[l]=o.substr(s+1))}}},getURIFragmentData:function(){return e}}}kn.__dashjs_factory_name="URIFragmentModel";const xn=c.Z.getSingletonFactory(kn);function Fn(){var e,t=this.context,r=(0,l.Z)(t).getInstance();return{getValue:function(){return e},setValue:function(t){e=t,t&&r.trigger(u.Z.MANIFEST_LOADED,{data:t})}}}Fn.__dashjs_factory_name="ManifestModel";const Un=c.Z.getSingletonFactory(Fn);var Bn=-.5;function Zn(){var e,t,r,n,i=this.context,a=(0,w.Z)(i).getInstance();function o(e,r){return isNaN(e)?0:e>0?(r&&t.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e<Bn?(r&&t.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(Bn,": ").concat(-50,"% playback speed.")),Bn):e}function s(e,r){return isNaN(e)?0:e<0?(r&&t.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):e>1?(r&&t.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(1,": ").concat(200,"% playback speed.")),1):e}function l(){var e=a.get().streaming.buffer.stableBufferTime>0?a.get().streaming.buffer.stableBufferTime:a.get().streaming.buffer.fastSwitchEnabled?20:12,t=r.getLiveDelay();return!isNaN(t)&&t>0?Math.min(e,t):e}return e={getCatchupMaxDrift:function(){if(!isNaN(a.get().streaming.liveCatchup.maxDrift)&&a.get().streaming.liveCatchup.maxDrift>0)return a.get().streaming.liveCatchup.maxDrift;var e=n.getServiceDescriptionSettings();return e&&e.liveCatchup&&!isNaN(e.liveCatchup.maxDrift)&&e.liveCatchup.maxDrift>0?e.liveCatchup.maxDrift:12},getCatchupModeEnabled:function(){return null!==a.get().streaming.liveCatchup.enabled?a.get().streaming.liveCatchup.enabled:r.getInitialCatchupModeActivated()},getStableBufferTime:l,getInitialBufferLevel:function(){var e=a.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(l(),e)},getRetryAttemptsForType:function(e){var t=isNaN(a.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:a.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return r.getLowLatencyModeEnabled()?a.get().streaming.retryAttempts[e]*t:a.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(a.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:a.get().streaming.retryIntervals.lowLatencyReductionFactor;return r.getLowLatencyModeEnabled()?a.get().streaming.retryIntervals[e]/t:a.get().streaming.retryIntervals[e]},getCatchupPlaybackRates:function(e){var t=a.get().streaming.liveCatchup.playbackRate;if(!isNaN(t.min)||!isNaN(t.max))return{min:o(t.min,e),max:s(t.max,e)};var r=n.getServiceDescriptionSettings();if(r&&r.liveCatchup&&(!isNaN(r.liveCatchup.playbackRate.min)||!isNaN(r.liveCatchup.playbackRate.max))){var i=r.liveCatchup.playbackRate;return{min:o(i.min,e),max:s(i.max,e)}}return{min:-.5,max:.5}},getAbrBitrateParameter:function(e,t){try{var r=a.get().streaming.abr[e][t];if(!isNaN(r)&&-1!==r)return r;var i=n.getServiceDescriptionSettings();return i&&i[e]&&!isNaN(i[e][t])?i[e][t]:-1}catch(e){return-1}},setConfig:function(e){e.playbackController&&(r=e.playbackController),e.serviceDescriptionController&&(n=e.serviceDescriptionController)},reset:function(){}},t=(0,f.Z)(i).getInstance().getLogger(e),e}Zn.__dashjs_factory_name="MediaPlayerModel";const Gn=c.Z.getSingletonFactory(Zn);var Kn=r(1767);function Hn(e){var t=(e=e||{}).abrController,r=e.switchHistory,n=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,l=e.streamProcessor?e.streamProcessor.getScheduleController():null,u=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function f(){return u?u.mediaInfo:null}return{getMediaType:function(){var e=f();return e?e.type:null},getMediaInfo:f,getDroppedFramesHistory:function(){return n},getCurrentRequest:function(){return i},getSwitchHistory:function(){return r},getStreamInfo:function(){var e=f();return e?e.streamInfo:null},getScheduleController:function(){return l},getAbrController:function(){return t},getRepresentationInfo:function(){return u},useBufferOccupancyABR:function(){return a},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}Hn.__dashjs_factory_name="RulesContext";const Yn=c.Z.getClassFactory(Hn);var Vn=r(2068);function qn(){var e=[],t=[];return{push:function(r){r.newValue===Vn.Z.NO_CHANGE&&(r.newValue=r.oldValue),e[r.oldValue]||(e[r.oldValue]={noDrops:0,drops:0,dropSize:0});var n=r.newValue-r.oldValue,i=n<0?1:0,a=i?-n:0,o=i?0:1;if(e[r.oldValue].drops+=i,e[r.oldValue].dropSize+=a,e[r.oldValue].noDrops+=o,t.push({idx:r.oldValue,noDrop:o,drop:i,dropSize:a}),t.length>8){var s=t.shift();e[s.idx].drops-=s.drop,e[s.idx].dropSize-=s.dropSize,e[s.idx].noDrops-=s.noDrop}},getSwitchRequests:function(){return e},reset:function(){e=[],t=[]}}}qn.__dashjs_factory_name="SwitchRequestHistory";const jn=c.Z.getClassFactory(qn);function zn(){var e={},t={},r={};return{push:function(n,i,a){if(i){e[n]||(e[n]=[],t[n]=0,r[n]=0);var o=a&&a.droppedVideoFrames?a.droppedVideoFrames:0,s=a&&a.totalVideoFrames?a.totalVideoFrames:0,l=o-t[n];t[n]=o;var u=s-r[n];r[n]=s;var c=e[n];isNaN(i)||(c[i]?(c[i].droppedVideoFrames+=l,c[i].totalVideoFrames+=u):c[i]={droppedVideoFrames:l,totalVideoFrames:u})}},getFrameHistory:function(t){return e[t]},clearForStream:function(n){try{delete e[n],delete t[n],delete r[n]}catch(e){}},reset:function(){e={},t={},r={}}}}zn.__dashjs_factory_name="DroppedFramesHistory";const Wn=c.Z.getClassFactory(zn);function Xn(e){var t,r,n,i,o,s=this.context,u=(e=e||{}).settings,c=(0,l.Z)(s).getInstance();function f(e,t,r,n){var i=Math.pow(.5,r/n.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,r/n.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=r}function h(e,s,l){return u.get().streaming.abr.movingAverageMethod!==a.Z.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var r=e?o.throughputHalfLife:o.latencyHalfLife,a=e?n[t]:i[t];if(!a||a.totalWeight<=0)return NaN;var s=a.fastEstimate/(1-Math.pow(.5,a.totalWeight/r.fast)),l=a.slowEstimate/(1-Math.pow(.5,a.totalWeight/r.slow));return e?Math.min(s,l):Math.max(s,l)}(e,s):function(e,n,i){var a=function(e,n,i){var a,o;if(e?(a=t[n],o=i?3:4):(a=r[n],o=4),a){if(o>=a.length)o=a.length;else if(e)for(var s=1;s<o;++s){var l=a[a.length-s]/a[a.length-s-1];if((l>=1.3||l<=1/1.3)&&(o+=1)===a.length)break}}else o=0;return o}(e,n,i),o=(e?t:r)[n];return 0!==a&&o&&0!==o.length?(o=o.slice(-a)).reduce((function(e,t){return e+t}))/o.length:NaN}(e,s,l)}function g(e,t){return h(!0,e,t)}function p(e){t[e]=t[e]||[],r[e]=r[e]||[],n[e]=n[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},i[e]=i[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function m(){t={},r={},n={},i={}}var v={push:function(e,s,l){if(s.trace&&s.trace.length){var h,g=s.tresponse.getTime()-s.trequest.getTime()||1,m=s._tfinish.getTime()-s.tresponse.getTime()||1,v=s.trace.reduce((function(e,t){return e+t.b[0]}),0),y=0;if(0!==(h=s._fileLoaderType&&s._fileLoaderType===a.Z.FILE_LOADER_TYPES.FETCH?s.trace.reduce((function(e,t){return e+t.d}),0):l?m:g+m)&&(y=Math.round(8*v/h)),s.cmsd){var E=s.cmsd.dynamic&&s.cmsd.dynamic.etp?s.cmsd.dynamic.etp:null;if(E){var T=u.get().streaming.cmsd.abr.etpWeightRatio;T>0&&T<=1&&(y=y*(1-T)+E*T)}}if(p(e),function(e,t,r){return e===a.Z.VIDEO?r<u.get().streaming.cacheLoadThresholds[a.Z.VIDEO]:e===a.Z.AUDIO?r<u.get().streaming.cacheLoadThresholds[a.Z.AUDIO]:void 0}(e,0,m)){if(t[e].length>0&&!t[e].hasCachedEntries)return;t[e].hasCachedEntries=!0}else t[e]&&t[e].hasCachedEntries&&function(e){delete t[e],delete r[e],delete n[e],delete i[e],p(e)}(e);t[e].push(y),c.trigger(d.Z.THROUGHPUT_MEASUREMENT_STORED,{throughput:y,mediaType:e,httpRequest:s}),t[e].length>20&&t[e].shift(),r[e].push(g),r[e].length>20&&r[e].shift(),f(n[e],y,.001*m,o.throughputHalfLife),f(i[e],g,1,o.latencyHalfLife)}},getAverageThroughput:g,getSafeAverageThroughput:function(e,t){var r=g(e,t);return isNaN(r)||(r*=u.get().streaming.abr.bandwidthSafetyFactor),r},getAverageLatency:function(e){return h(!1,e)},reset:m};return o={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},m(),v}Xn.__dashjs_factory_name="ThroughputHistory";const Qn=c.Z.getClassFactory(Xn);function Jn(){var e,t,r,n,i,o,c,h,g,p,m,v,y,E,T,S,A,b,R,I,w,C,N,L,O,P,M,k=this.context,x=(0,f.Z)(k).getInstance(),F=(0,l.Z)(k).getInstance();function U(){i={},o={},h={},c={},I={},N={},L={},O={},void 0===p&&(p=!1),w&&w.reset(),R=void 0,w=void 0,C=void 0,clearTimeout(g),g=null}function B(t){var i=t.request.mediaType,a=t.streamId;if(i&&a&&c[a]&&M.get().streaming.abr.autoSwitchBitrate[i]){var o=c[a][i];if(o){var l=Yn(k).create({abrController:e,streamProcessor:o,currentRequest:t.request,useBufferOccupancyABR:N[i],useL2AABR:L[i],useLoLPABR:O[i],videoModel:E}),u=r.shouldAbandonFragment(l,a);u.quality>Vn.Z.NO_CHANGE&&o.getFragmentModel().getRequests({state:_.FRAGMENT_MODEL_LOADING,index:t.request.index})[0]&&(h[a][i].state=s.Z.ABANDON_LOAD,I[a][i].reset(),I[a][i].push({oldValue:Y(i,a),newValue:u.quality,confidence:1,reason:u.reason}),V(i,n.getActiveStreamInfo(),u.quality,u.reason),clearTimeout(g),g=setTimeout((function(){h[a][i].state=s.Z.ALLOW_LOAD,g=null}),M.get().streaming.abandonLoadTimeout))}}}function Z(e){e.mediaType===a.Z.VIDEO&&(void 0!==R&&w.push(e.streamId,R,E.getPlaybackQuality()),R=e.newQuality)}function G(e){var r,n;e.metric!==s.Z.HTTP_REQUEST||!e.value||e.value.type!==D.w.MEDIA_SEGMENT_TYPE||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||C.push(e.mediaType,e.value,M.get().streaming.abr.useDeadTimeLatency),e.metric!==s.Z.BUFFER_LEVEL||e.mediaType!==a.Z.AUDIO&&e.mediaType!==a.Z.VIDEO||(r=e.mediaType,n=.001*e.value.level,M.get().streaming.abr.ABRStrategy===a.Z.ABR_STRATEGY_DYNAMIC&&function(e,r){try{var n=T.getStableBufferTime(),i=n,a=.5*n,o=N[e],s=r>(o?a:i);N[e]=s,s!==o&&(s?t.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+r.toFixed(3)+")."):t.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+r.toFixed(3)+")."))}catch(e){t.error(e)}}(r,n))}function K(e,r){try{var n;return i[r]=i[r]||{},i[r].hasOwnProperty(e)||(i[r][e]=0),n=function(e,t){var r=i[t][e],n=r;if(!c[t]||!c[t][e])return n;var a=H(e,t);void 0!==a&&(n=Math.max(r,a));var o=function(e,t){try{var r=T.getAbrBitrateParameter("maxBitrate",e);return r>-1?W(c[t][e].getMediaInfo(),r,t):void 0}catch(e){return}}(e,t);return void 0!==o&&(n=Math.min(n,o)),n}(e,r),n=function(e,t,r){var n=i[r][t],a=M.get().streaming.abr.maxRepresentationRatio[t];return isNaN(a)||a>=1||a<0?e:Math.min(e,Math.round(n*a))}(n,e,r),n=function(e,t,r){if(t!==a.Z.VIDEO||!M.get().streaming.abr.limitBitrateByPortal||!c[r]||!c[r][t])return e;p||Q();var n=c[r][t].getStreamInfo(),i=y.getAdaptationForType(n.index,t,n).Representation_asArray,o=e;if(m>0&&v>0){for(;o>0&&i[o]&&m<i[o].width&&m-i[o-1].width<i[o].width-m;)o-=1;for(;o<i.length-1&&i[o].width===i[o+1].width;)o+=1}return o}(n,e,r),M.get().streaming.cmsd.enabled&&M.get().streaming.cmsd.abr.applyMb&&(n=function(e,r,n){if("video"!==r)return e;var i=A.getMaxBitrate(r);if(i<0)return e;var a=z(n,"audio",Y("audio",n));i-=a?a.bitrate/1e3:0;var o=W(c[n][r].getMediaInfo(),i,n);return t.debug("Stream ID: "+n+" ["+r+"] Apply max bit rate from CMSD: "+i),Math.min(e,o)}(n,e,r)),n}catch(e){return}}function H(e,t){try{return function(e,t){try{var r=T.getAbrBitrateParameter("minBitrate",e);if(r>-1){var n=c[t][e].getMediaInfo(),i=X(n),a=W(n,r,t);return i[a]&&a<i.length-1&&i[a].bitrate<1e3*r&&a++,a}return}catch(e){return}}(e,t)}catch(e){return}}function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return t||(t=n.getActiveStreamInfo().id),e&&c[t]&&c[t][e]&&t?(o[t]=o[t]||{},o[t].hasOwnProperty(e)||(o[t][e]=0),o[t][e]):0}catch(e){return 0}}function V(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t&&t.id&&e){var i=t.id,a=Y(e,i);(0,j.SE)(r);var o=K(e,i);r!==a&&r>=0&&r<=o&&q(e,a,r,o,n,i)}}function q(e,r,n,i,a,s){if(e&&c[s]&&c[s][e]){var l=c[s][e].getStreamInfo(),f=l&&l.manifestInfo&&l.manifestInfo.isDynamic,d=P.getCurrentBufferLevel(e);t.info("Stream ID: "+s+" ["+e+"] switch from "+r+" to "+n+"/"+i+" (buffer: "+d+") "+(a?JSON.stringify(a):".")),o[s]=o[s]||{},o[s][e]=n;var h=z(s,e,n);F.trigger(u.Z.QUALITY_CHANGE_REQUESTED,{oldQuality:r,newQuality:n,reason:a,streamInfo:l,bitrateInfo:h,maxIdx:i,mediaType:e},{streamId:l.id,mediaType:e});var g=C.getAverageThroughput(e,f);isNaN(g)||b.setSavedBitrateSettings(e,g)}}function z(e,t,r){if(t&&c&&c[e]&&c[e][t]){var n=X(c[e][t].getMediaInfo());return n[r]?n[r]:null}return null}function W(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e&&e.type?c[r][e.type].getRepresentationInfo():null;if(M.get().streaming.abr.useDeadTimeLatency&&n&&i&&i.fragmentDuration){n/=1e3;var a=i.fragmentDuration;if(n>a)return 0;t*=1-n/a}for(var o=X(e),s=o.length-1;s>=0;s--)if(1e3*t>=o[s].bitrate)return s;return 0}function X(e){var t=[];if(!e||!e.bitrateList)return t;for(var r,n=e.bitrateList,i=e.type,a=0,o=n.length;a<o;a++)(r=new It).mediaType=i,r.qualityIndex=a,r.bitrate=n[a].bandwidth,r.width=n[a].width,r.height=n[a].height,r.scanType=n[a].scanType,t.push(r);return t}function Q(){if(E){var e=M.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;m=E.getClientWidth()*e,v=E.getClientHeight()*e}}return e={initialize:function(){w=Wn(k).create(),C=Qn(k).create({settings:M}),(r=(0,Kn.Z)(k).create({dashMetrics:P,customParametersModel:S,mediaPlayerModel:T,settings:M})).initialize(),F.on(d.Z.QUALITY_CHANGE_RENDERED,Z,e),F.on(d.Z.METRIC_ADDED,G,e),F.on(u.Z.LOADING_PROGRESS,B,e)},isPlayingAtTopQuality:function(e){var t=e?e.id:null,r=Y(a.Z.AUDIO,t),n=Y(a.Z.VIDEO,t);return r===K(a.Z.AUDIO,t)&&n===K(a.Z.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,r=e.streamInfo.id,n=e.representationCount-1;return i[r]=i[r]||{},i[r][t]=n,n},clearDataForStream:function(e){w&&w.clearForStream(e),c[e]&&delete c[e],I[e]&&delete I[e],h[e]&&delete h[e]},getThroughputHistory:function(){return C},getBitrateList:X,getQualityForBitrate:W,getTopBitrateInfoFor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=n.getActiveStreamInfo().id),e&&c&&c[t]&&c[t][e]){var r=K(e,t),i=X(c[t][e].getMediaInfo());return i[r]?i[r]:null}return null},getMinAllowedIndexFor:H,getMaxAllowedIndexFor:K,getInitialBitrateFor:function(e,t){if(function(){if(!b||!b.hasOwnProperty("getSavedBitrateSettings"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}(),e===a.Z.TEXT)return NaN;var r=b.getSavedBitrateSettings(e),n=T.getAbrBitrateParameter("initialBitrate",e),i=M.get().streaming.abr.initialRepresentationRatio[e];if(-1===n)if(i>-1){var o=c[t][e].getStreamInfo(),s=y.getAdaptationForType(o.index,e,o).Representation_asArray;n=Array.isArray(s)?s[Math.max(Math.round(s.length*i)-1,0)].bandwidth/1e3:0}else n=isNaN(r)?e===a.Z.VIDEO?1e3:100:r;return n},getQualityFor:Y,getAbandonmentStateFor:function(e,t){return h[e]&&h[e][t]?h[e][t].state:null},setPlaybackQuality:V,checkPlaybackQuality:function(t,n){try{if(!(t&&c&&c[n]&&c[n][t]))return!1;if(w){var i=E.getPlaybackQuality();i&&w.push(n,R,i)}if(!M.get().streaming.abr.autoSwitchBitrate[t])return!1;var a=Y(t,n),o=Yn(k).create({abrController:e,switchHistory:I[n][t],droppedFramesHistory:w,streamProcessor:c[n][t],currentValue:a,useBufferOccupancyABR:N[t],useL2AABR:L[t],useLoLPABR:O[t],videoModel:E}),l=H(t,n),u=K(t,n),f=r.getMaxQuality(o),d=f.quality;return void 0!==l&&(d>Vn.Z.NO_CHANGE?d:a)<l&&(d=l),d>u&&(d=u),I[n][t].push({oldValue:a,newValue:d}),d>Vn.Z.NO_CHANGE&&d!==a&&(h[n][t].state===s.Z.ALLOW_LOAD||d<a)&&(q(t,a,d,u,f.reason,n),!0)}catch(e){return!1}},setElementSize:Q,setWindowResizeEventCalled:function(e){p=e},registerStreamType:function(e,t){var r=t.getStreamInfo().id;c[r]||(c[r]={}),I[r]||(I[r]={}),h[r]||(h[r]={}),I[r][e]=jn(k).create(),c[r][e]=t,h[r][e]={},h[r][e].state=s.Z.ALLOW_LOAD,function(e){var t=M.get().streaming.abr.ABRStrategy;t===a.Z.ABR_STRATEGY_L2A?(N[e]=!1,O[e]=!1,L[e]=!0):t===a.Z.ABR_STRATEGY_LoLP?(N[e]=!1,O[e]=!0,L[e]=!1):t===a.Z.ABR_STRATEGY_BOLA?(N[e]=!0,O[e]=!1,L[e]=!1):t===a.Z.ABR_STRATEGY_THROUGHPUT?(N[e]=!1,O[e]=!1,L[e]=!1):t===a.Z.ABR_STRATEGY_DYNAMIC&&(N[e]=!(!N||!N[e])&&N[e],O[e]=!1,L[e]=!1)}(e),e===a.Z.VIDEO&&Q()},unRegisterStreamType:function(e,t){try{c[e]&&c[e][t]&&delete c[e][t],I[e]&&I[e][t]&&delete I[e][t],h[e]&&h[e][t]&&delete h[e][t]}catch(e){}},setConfig:function(e){e&&(e.streamController&&(n=e.streamController),e.domStorage&&(b=e.domStorage),e.mediaPlayerModel&&(T=e.mediaPlayerModel),e.customParametersModel&&(S=e.customParametersModel),e.cmsdModel&&(A=e.cmsdModel),e.dashMetrics&&(P=e.dashMetrics),e.adapter&&(y=e.adapter),e.videoModel&&(E=e.videoModel),e.settings&&(M=e.settings))},reset:function(){U(),F.off(u.Z.LOADING_PROGRESS,B,e),F.off(d.Z.QUALITY_CHANGE_RENDERED,Z,e),F.off(d.Z.METRIC_ADDED,G,e),r&&r.reset()}},t=x.getLogger(e),U(),e}Jn.__dashjs_factory_name="AbrController";var $n=c.Z.getSingletonFactory(Jn);$n.QUALITY_DEFAULT=0,c.Z.updateSingletonFactory(Jn.__dashjs_factory_name,$n);const ei=$n;var ti=new Map([[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function ri(){var e,t,r,n,i,o,s=this.context,c=(0,l.Z)(s).getInstance(),d=[];function h(){r&&(r.playbackRate=1,r.removeEventListener("canplay",h))}function g(){return d.length>0}function p(){if(r&&g()&&0===r.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),r.dispatchEvent(e)}}function m(e,t){r&&r.addEventListener(e,t)}function v(e,t){r&&r.removeEventListener(e,t)}function y(){return r?r.readyState:NaN}function E(){return r?r.buffered:null}function T(e,t,n,i,a){if(r)for(var o=0;o<r.textTracks.length;o++)if(r.textTracks[o].kind===e&&(!t||r.textTracks[o].label==t)&&r.textTracks[o].language===n&&r.textTracks[o].isTTML===i&&r.textTracks[o].isEmbedded===a)return r.textTracks[o];return null}function _(e,t){e===a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||y()>=e?t():function(e,t){m(e,(function r(){v(e,r),t(e)}))}(ti.get(e),t)}return e={initialize:function(){c.on(u.Z.PLAYBACK_PLAYING,p,this)},setCurrentTime:function(e,t){r&&(n=e,_(a.Z.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,(function(){if(r.currentTime!==n)try{n=t?function(e){var t=E(),r=e,n=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),l=Math.abs(o-e);if(e>=a&&e<=o)return e;s<n&&(n=s,r=a),l<n&&(n=l,r=o)}return r}(n):n,r.currentTime=n,n=NaN}catch(e){0===r.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout((function(){r.currentTime=n,n=NaN}),400)}else n=NaN})))},play:function(){if(r){r.autoplay=!0;var e=r.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch((function(e){"NotAllowedError"===e.name&&c.trigger(u.Z.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"))}))}},isPaused:function(){return r?r.paused:null},pause:function(){r&&(r.pause(),r.autoplay=!1)},isStalled:g,isSeeking:function(){return r?r.seeking||!isNaN(n):null},getTime:function(){return r?isNaN(n)?r.currentTime:n:null},getPlaybackRate:function(){return r?r.playbackRate:null},setPlaybackRate:function(e){r&&(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&r.readyState<=2&&e>0?r.addEventListener("canplay",h):r.playbackRate=e)},getPlayedRanges:function(){return r?r.played:null},getEnded:function(){return r?r.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){null!==e&&r&&!r.seeking&&-1===d.indexOf(e)&&d.push(e)}(e):function(e){var t=d.indexOf(e);null!==e&&-1!==t&&d.splice(t,1)}(e)}(e,t)},getElement:function(){return r},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw"element is not video or audio DOM type!";(r=e)&&(r.preload="auto")},setSource:function(e){r&&(e?r.src=e:(r.removeAttribute("src"),r.load()))},getSource:function(){return r?r.src:null},getTTMLRenderingDiv:function(){return i},setTTMLRenderingDiv:function(e){(i=e).style.position="absolute",i.style.display="flex",i.style.overflow="hidden",i.style.pointerEvents="none",i.style.top=0,i.style.left=0},getVttRenderingDiv:function(){return o},setVttRenderingDiv:function(e){o=e},getPlaybackQuality:function(){if(!r)return null;var e="webkitDroppedFrameCount"in r&&"webkitDecodedFrameCount"in r,t=null;return"getVideoPlaybackQuality"in r?t=r.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:r.webkitDroppedFrameCount,totalVideoFrames:r.webkitDroppedFrameCount+r.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:m,removeEventListener:v,getReadyState:y,getBufferRange:E,getClientWidth:function(){return r?r.clientWidth:NaN},getClientHeight:function(){return r?r.clientHeight:NaN},getTextTracks:function(){return r?r.textTracks:[]},getTextTrack:T,addTextTrack:function(e,t,n,i,a){if(!r)return null;var o=T(e,t,n,i,a);return o||((o=r.addTextTrack(e,t,n)).isEmbedded=a,o.isTTML=i),o},appendChild:function(e){r&&(r.appendChild(e),void 0!==e.isTTML&&(r.textTracks[r.textTracks.length-1].isTTML=e.isTTML,r.textTracks[r.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){r&&r.removeChild(e)},getVideoWidth:function(){return r?r.videoWidth:NaN},getVideoHeight:function(){return r?r.videoHeight:NaN},getVideoRelativeOffsetTop:function(){if(r){var e=r.parentNode.host||r.parentNode;return e?r.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN}return NaN},getVideoRelativeOffsetLeft:function(){if(r){var e=r.parentNode.host||r.parentNode;return e?r.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN}return NaN},waitForReadyState:_,reset:function(){c.off(u.Z.PLAYBACK_PLAYING,p,this)}},t=(0,f.Z)(s).getInstance().getLogger(e),n=NaN,e}ri.__dashjs_factory_name="VideoModel";const ni=c.Z.getSingletonFactory(ri);var ii=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],ai="dashjs_?_bitrate",oi="dashjs_?_settings",si="localStorage",li="lastBitrate",ui="lastMediaSettings";function ci(e){e=e||{};var t,r,n,i=this.context,o=e.settings;function s(e){if(void 0!==n)return n;var t;n=!1;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return r.warn("DOMStorage access denied: "+e.message),n}if(!t||e!==si&&"sessionStorage"!==e)return n;try{t.setItem("1","1"),t.removeItem("1"),n=!0}catch(e){r.warn("DOMStorage is supported, but cannot be used: "+e.message)}return n}function l(){var e=6e5;return Math.round((new Date).getTime()/e)*e}function u(e,t){return s(e)&&o.get().streaming[t+"CachingInfo"].enabled}function c(){if(!o)throw new Error(a.Z.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){if(c(),!o.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var t=NaN;if(u(si,li)){var n=ai.replace(/\?/,e);try{var i=JSON.parse(localStorage.getItem(n))||{},a=(new Date).getTime()-parseInt(i.timestamp,10)>=o.get().streaming.lastBitrateCachingInfo.ttl||!1,s=parseFloat(i.bitrate);isNaN(s)||a?a&&localStorage.removeItem(n):(t=s,r.debug("Last saved bitrate for "+e+" was "+s))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(u(si,li)&&t){var n=ai.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:l()}))}catch(e){r.error(e.message)}}},getSavedMediaSettings:function(e){if(c(),!o.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var t=null;if(u(si,ui)){var r=oi.replace(/\?/,e);try{var n=JSON.parse(localStorage.getItem(r))||{},i=(new Date).getTime()-parseInt(n.timestamp,10)>=o.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=n.settings,i&&(localStorage.removeItem(r),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(u(si,ui)){var n=oi.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:l()}))}catch(e){r.error(e.message)}}}},r=(0,f.Z)(i).getInstance().getLogger(t),s(si)&&ii.forEach((function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){r.error(e.message)}}})),t}ci.__dashjs_factory_name="DOMStorage";const fi=c.Z.getSingletonFactory(ci);var di=r(2032),hi=r(2011);function gi(){var e,t,r,n,i,a,o,s,l,u,c,f,d,h=this.context;function g(e,r,i,a){var o=null,l=e?d.resolve(e.path):null,u=a||{init:!0,url:l?l.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:r};t.debug("Start searching for initialization.");var c=y(u);s.load({request:c,success:function(t){if(u.bytesLoaded=u.range.end,!(o=n.findInitRange(t)))return u.range.end=u.bytesLoaded+u.bytesToLoad,g(e,r,i,u);e.range=o,i(e)},error:function(){i(e)}}),t.debug("Perform init search: "+u.url)}function m(e,r,i,a,o,l){if(i&&(void 0===i.start||void 0===i.end)){var u=i?i.toString().split("-"):null;i=u?{start:parseFloat(u[0]),end:parseFloat(u[1])}:null}o=o||v;var c=null,f=null,h=!!i,g=e?d.resolve(e.path):null,p={init:!1,url:g?g.url:void 0,range:h?i:{start:0,end:1500},searching:!h,bytesLoaded:l?l.bytesLoaded:0,bytesToLoad:1500,mediaType:r},E=y(p);s.load({request:E,success:function(i){var s=p.bytesToLoad,l=i.byteLength;if(p.bytesLoaded=p.range.end-p.range.start,c=n.parse(i),(f=c.getBox("sidx"))&&f.isComplete){var u,d,h=f.references;if(null!=h&&h.length>0&&(u=1===h[0].reference_type),u){var g,v,y,E;t.debug("Initiate multiple SIDX load."),p.range.end=p.range.start+f.size;var T=[],_=0,S=(f.offset||p.range.start)+f.size,A=function(t){t?(T=T.concat(t),++_>=v&&(T.sort((function(e,t){return e.startTime-t.startTime<0?-1:0})),o(T,e,a))):o(null,e,a)};for(g=0,v=h.length;g<v;g++)y=S,E=S+h[g].referenced_size-1,S+=h[g].referenced_size,m(e,r,{start:y,end:E},a,A,p)}else t.debug("Parsing segments from SIDX. representation "+r+" - id: "+e.id+" for range : "+p.range.start+" - "+p.range.end),d=function(e,t){for(var r,n,i,a,o=e.references,s=o.length,l=e.timescale,u=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,f=[],d=0;d<s;d++)i=o[d].subsegment_duration,a=o[d].referenced_size,(r=new hi.Z).duration=i,r.startTime=u,r.timescale=l,n=c+a-1,r.mediaRange=c+"-"+n,f.push(r),u+=i,c+=a;return f}(f,p),o(d,e,a)}else{if(f)p.range.start=f.offset||p.range.start,p.range.end=p.range.start+(f.size||s);else{if(l<p.bytesLoaded)return void o(null,e,a);var b=c.getLastBox();b&&b.size?(p.range.start=b.offset+b.size,p.range.end=p.range.start+s):p.range.end+=s}m(e,r,p.range,a,null,p)}},error:function(){o(null,e,a)}}),t.debug("Perform SIDX load for type ".concat(r," : ").concat(p.url," with range ").concat(p.range.start," - ").concat(p.range.end))}function v(e,t,r){r({segments:e,representation:t,error:e?void 0:new S.Z(l.SEGMENT_BASE_LOADER_ERROR_CODE,l.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function y(e){if(e.url){var t=new p.Z;return t.setInfo(e),t}}return e={setConfig:function(s){s.baseURLController&&(d=s.baseURLController),s.dashMetrics&&(a=s.dashMetrics),s.mediaPlayerModel&&(o=s.mediaPlayerModel),s.errHandler&&(r=s.errHandler),s.boxParser&&(n=s.boxParser),s.debug&&(t=s.debug.getLogger(e)),s.requestModifier&&(i=s.requestModifier),s.errors&&(l=s.errors),s.urlUtils&&(f=s.urlUtils),s.constants&&(u=s.constants),s.dashConstants&&(c=s.dashConstants)},initialize:function(){s=gt(h).create({errHandler:r,dashMetrics:a,mediaPlayerModel:o,requestModifier:i,boxParser:n,errors:l,urlUtils:f,constants:u,dashConstants:c})},loadInitialization:function(e,t){return new Promise((function(r){g(e,t,r)}))},loadSegments:function(e,t,r){return new Promise((function(n){m(e,t,r,n)}))},reset:function(){s&&(s.abort(),s=null)}}}gi.__dashjs_factory_name="SegmentBaseLoader";const pi=c.Z.getSingletonFactory(gi);function mi(e){var t;e=e||{};var r=new DataView(e.data),n=0;function i(e,t){var i=!0,a=0;if(void 0===t&&(t=!1),e.tag>16777215?(r.getUint32(n)!==e.tag&&(i=!1),a=4):e.tag>65535?(256*r.getUint16(n)+r.getUint8(n+2)!==e.tag&&(i=!1),a=3):e.tag>255?(r.getUint16(n)!==e.tag&&(i=!1),a=2):(r.getUint8(n)!==e.tag&&(i=!1),a=1),!i&&e.required&&!t)throw new Error("required tag not found");return i&&(n+=a),i}function a(e){var t=1,i=128,a=-1,o=0,s=r.getUint8(n),l=0;for(l=0;l<8;l+=1){if((s&i)===i){o=void 0===e?s&~i:s,a=l;break}i>>=1}for(l=0;l<a;l+=1,t+=1)o=o<<8|255&r.getUint8(n+t);return n+=t,o}return t={getPos:function(){return n},setPos:function(e){n=e},consumeTag:i,consumeTagAndSize:function(e,t){var r=i(e,t);return r&&a(),r},parseTag:function(e){var r;return i(e),r=a(),t[e.parse](r)},skipOverElement:function(e,t){var r,o=i(e,t);return o&&(r=a(),n+=r),o},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t;switch(e){case 4:t=r.getFloat32(n),n+=4;break;case 8:t=r.getFloat64(n),n+=8}return t},getMatroskaUint:function(e){if(e>4)return function(e){for(var t=Math.floor(Number.MAX_SAFE_INTEGER/256),i=0,a=0;a<e;a+=1){if(i>t)throw new Error("Value exceeds safe integer limit");i*=256;var o=r.getUint8(n+a);if(i>Number.MAX_SAFE_INTEGER-o)throw new Error("Value exceeds safe integer limit");i+=o}return n+=e,i}(e);for(var t=0,i=0;i<e;i+=1)t<<=8,t|=255&r.getUint8(n+i);return n+=e,t>>>0},moreData:function(){return n<r.byteLength}}}mi.__dashjs_factory_name="EBMLParser";const vi=c.Z.getClassFactory(mi);function yi(){var e,t,r,n,i,o,s,l,u,c,f=this.context;function d(e){var t=new p.Z;return t.setInfo(e),t}return e={setConfig:function(r){if(!(r.baseURLController&&r.dashMetrics&&r.mediaPlayerModel&&r.errHandler))throw new Error(a.Z.MISSING_CONFIG_ERROR);c=r.baseURLController,o=r.dashMetrics,s=r.mediaPlayerModel,n=r.errHandler,u=r.errors,t=r.debug.getLogger(e),i=r.requestModifier},initialize:function(){l=gt(f).create({errHandler:n,dashMetrics:o,mediaPlayerModel:s,requestModifier:i,errors:u})},loadInitialization:function(e,r){return new Promise((function(n){var i=null,a=e?c.resolve(e.path):null,o=e?e.range.split("-"):null,s={range:{start:o?parseFloat(o[0]):null,end:o?parseFloat(o[1]):null},request:i,url:a?a.url:void 0,init:!0,mediaType:r};t.info("Start loading initialization."),i=d(s),l.load({request:i,success:function(){n(e)},error:function(){n(e)}}),t.debug("Perform init load: "+s.url)}))},loadSegments:function(e,n,i){return new Promise((function(a){var o=null,s=e?c.resolve(e.path):null,h=s?s.url:void 0;o=d({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:o,url:h,init:!1,mediaType:n}),t.debug("Parsing ebml header"),l.load({request:o,success:function(n){!function(e,n,i,a){if(e&&0!==e.byteLength){var o,s,u,c,h=vi(f).create({data:e}),g=i?i.split("-"):null,p=null,m={url:n,range:{start:g?parseFloat(g[0]):null,end:g?parseFloat(g[1]):null},request:p};for(t.debug("Parse EBML header: "+m.url),h.skipOverElement(r.EBML),h.consumeTag(r.Segment),u=h.getMatroskaCodedNum(),u+=h.getPos(),c=h.getPos();h.moreData()&&!h.consumeTagAndSize(r.Segment.Info,!0);)if(!(h.skipOverElement(r.Segment.SeekHead,!0)||h.skipOverElement(r.Segment.Tracks,!0)||h.skipOverElement(r.Segment.Cues,!0)||h.skipOverElement(r.Void,!0)))throw new Error("no valid top level element found");for(;void 0===o;){var v=h.getMatroskaCodedNum(!0),y=h.getMatroskaCodedNum();v===r.Segment.Info.Duration.tag?o=h[r.Segment.Info.Duration.parse](y):h.setPos(h.getPos()+y)}p=d(m),l.load({request:p,success:function(e){s=function(e,n,i,a){var o,s,l,u,c,d,h,g;for(l=[],c=0,d=(s=function(e){var t,n,i=[],a=vi(f).create({data:e});for(a.consumeTagAndSize(r.Segment.Cues);a.moreData()&&a.consumeTagAndSize(r.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=a.parseTag(r.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];a.moreData()&&a.consumeTag(r.Segment.Cues.CuePoint.CueTrackPositions,!0);){var o=a.getMatroskaCodedNum(),s=a.getPos();if((n={}).Track=a.parseTag(r.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===n.Track)throw new Error("Cue track cannot be 0");n.ClusterPosition=a.parseTag(r.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(n),a.setPos(s+o)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");i.push(t)}if(0===i.length)throw new Error("mandatory cuepoint not found");return i}(e)).length;c<d;c+=1)u=new hi.Z,o=c<s.length-1?s[c+1].CueTime-s[c].CueTime:a-s[c].CueTime,u.duration=o,u.startTime=s[c].CueTime,u.timescale=1e3,h=s[c].CueTracks[0].ClusterPosition+n,g=c<s.length-1?s[c+1].CueTracks[0].ClusterPosition+n-1:i-1,u.mediaRange=h+"-"+g,l.push(u);return t.debug("Parsed cues: "+l.length+" cues."),l}(e,c,u,o),a(s)},error:function(){t.error("Download Error: Cues "+m.url),a(null)}}),t.debug("Perform cues load: "+m.url+" bytes="+m.range.start+"-"+m.range.end)}else a(null)}(n,h,i,(function(t){a({segments:t,representation:e,error:t?void 0:new S.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}))},error:function(){a({representation:e,error:new S.Z(u.SEGMENT_BASE_LOADER_ERROR_CODE,u.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})}))},reset:function(){l&&(l.abort(),l=null)}},r={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},e}yi.__dashjs_factory_name="WebmSegmentBaseLoader";const Ei=c.Z.getSingletonFactory(yi);function Ti(e){e=e||{};var t,r,n,i=this.context,a=e.eventBus,o=e.events,s=e.dashMetrics,l=e.mediaPlayerModel,u=e.errHandler,c=e.baseURLController,f=e.debug,d=e.boxParser,h=e.requestModifier,g=e.errors;function p(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}return t={initialize:function(){r.initialize(),n.initialize()},getSegmentBaseInitSegment:function(e){return p(e.representation.mimeType)?n.loadInitialization(e.representation,e.mediaType):r.loadInitialization(e.representation,e.mediaType)},getSegmentList:function(e){return p(e.mimeType)?n.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null):r.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null)},reset:function(){r.reset(),n.reset()}},r=pi(i).getInstance(),n=Ei(i).getInstance(),r.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:g,debug:f,boxParser:d,requestModifier:h}),n.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:g,debug:f,requestModifier:h}),t}Ti.__dashjs_factory_name="SegmentBaseController";const _i=c.Z.getSingletonFactory(Ti),Si=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null},Ai=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.viewpointsWithSchemeIdUri=null,this.accessibility=null,this.accessibilitiesWithSchemeIdUri=null,this.audioChannelConfiguration=null,this.audioChannelConfigurationsWithSchemeIdUri=null,this.roles=null,this.rolesWithSchemeIdUri=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.isText=!1,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={},this.supplementalPropertiesAsArray=[],this.segmentAlignment=!1,this.subSegmentAlignment=!1},bi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0},Ri=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null,this.serviceDescriptions=[],this.protocol=null},Ii=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valid="/"==t[0],this.path=t.split("/").filter((function(e){return 0!==e.length})).map((function(e){var t={name:e},n=e.indexOf("[");if(-1!=n){t.name=e.substring(0,n);var i=e.substring(n+1,e.length-1);r.valid=r.valid&&-1==i.indexOf("[");var a=i.indexOf("=");-1!=a?(t.attribute={name:i.substring(1,a),value:i.substring(a+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(i,10)-1}return t}))}var t;return(t=[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(e,t){for(var r=null,n=e,i=1,a="MPD";i<this.path.length&&null!==n;){r=n;var o=this.path[i];if(a=o.name,i!==this.path.length-1||!a.startsWith("@")){var s=r[a+"_asArray"]||[];0===s.length&&r[a]&&s.push(r[a]),o.position?n=s[o.position]||null:o.attribute?function(){var e=o.attribute;n=s.filter((function(t){return t[e.name]==e.value}))[0]||null}():n=s[0]||null}i++}return null===n?null:a.startsWith("@")?{name:a.substring(1),leaf:n,target:n}:{name:a,leaf:n,target:t?r:n}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),wi=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=t,this.xpath=r,this.value=n,this.position=null}var t;return(t=[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function Di(){var e,t,r=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.PUBLISH_TIME)?new Date(e[o.Z.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(o.Z.ORIGINAL_PUBLISH_TIME)?new Date(e[o.Z.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[o.Z.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map((function(e){var r=Object.keys(e)[0];if("add"!==r&&"remove"!==r&&"replace"!==r)return t.warn("Ignoring node of invalid action: ".concat(r)),null;var n=e[r],i=n.sel;if("add"===r&&n.type){if(!n.type.startsWith("@"))return t.warn("Ignoring add action for prefixed namespace declaration: ".concat(n.type,"=").concat(n.__text)),null;i="".concat(i,"/").concat(n.type)}var a=new Ii(i);if(!a.isValid())return t.warn("Ignoring action with invalid selector: ".concat(r," - ").concat(i)),null;var o=null;a.findsAttribute()?o=n.__text||"":"remove"!==r&&(o=n.__children.reduce((function(e,t){var r=Object.keys(t)[0];return"#text"!==r&&(e[r]=e[r]||[],e[r].push(t[r])),e}),{}));var s=new wi(r,a,o);return"add"===r&&(s.position=n.pos),s})).filter((function(e){return!!e})):[]}},t=(0,f.Z)(r).getInstance().getLogger(e),e}Di.__dashjs_factory_name="PatchManifestModel";const Ci=c.Z.getSingletonFactory(Di);function Ni(){var e,t,r,n,i,a,s,l=this.context;function u(e,r,a){var s,l=t.getAdaptationsForType(n[0].mpd.manifest,e,r);if(!l||0===l.length)return null;if(l.length>1&&a){var u=d(a,r);if(i[a.id]&&i[a.id][r])for(var f=0,h=l.length;f<h;f++)if(c(i[a.id][r],u[f]))return l[f];for(var g=0,p=l.length;g<p;g++)if(s=l[g],t.getRolesForAdaptation(s).filter((function(e){return e.value===o.Z.MAIN}))[0])return l[g]}return l[0]}function c(e,t){if(!e||!t)return!1;var r=e.id===t.id,n=e.codec===t.codec,i=e.viewpoint===t.viewpoint,a=JSON.stringify(e.viewpointsWithSchemeIdUri)===JSON.stringify(t.viewpointsWithSchemeIdUri),o=e.lang===t.lang,s=e.roles.toString()===t.roles.toString(),l=JSON.stringify(e.rolesWithSchemeIdUri)===JSON.stringify(t.rolesWithSchemeIdUri),u=e.accessibility.toString()===t.accessibility.toString(),c=JSON.stringify(e.accessibilitiesWithSchemeIdUri)===JSON.stringify(t.accessibilitiesWithSchemeIdUri),f=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString(),d=JSON.stringify(e.audioChannelConfigurationsWithSchemeIdUri)===JSON.stringify(t.audioChannelConfigurationsWithSchemeIdUri);return r&&n&&i&&a&&o&&s&&l&&u&&c&&f&&d}function f(e,r,n,i,o,s){var l,u,c,f,d,h,g=[];if(!i||0===i.length)return[];var p=t.getAdaptationsForPeriod(r);for(f=0,h=i.length;f<h;f++)if(l=i[f],u=E(p[c=t.getIndexForAdaptation(l,e,n.index)]),s){var m=u.accessibility.length;for(d=0;d<m;d++)if(u){var v=u.accessibility[d];if(0===v.indexOf("cea-608:")){var y=v.substring(8).split(";");if("CC"===y[0].substring(0,2))for(d=0;d<y.length;d++)u||(u=E.call(this,p[c])),T(u,y[d].substring(0,3),y[d].substring(4)),g.push(u),u=null;else for(d=0;d<y.length;d++)u||(u=E.call(this,p[c])),T(u,"CC"+(d+1),y[d]),g.push(u),u=null}else 0===v.indexOf("cea-608")&&(T(u,a.CC1,"eng"),g.push(u),u=null)}}else o===a.IMAGE?(u.type=a.IMAGE,g.push(u),u=null):u&&g.push(u);return g}function d(e,r,i){var o=n,s=i,l=[];if(s)S(),o=h(s);else{if(!(n.length>0))return l;s=n[0].mpd.manifest}var u=y(e,o),c=t.getAdaptationsForType(s,e?e.index:null,r);return l=f(s,u,e,c,r),r===a.TEXT&&(c=t.getAdaptationsForType(s,e?e.index:null,a.VIDEO),l=l.concat(f(s,u,e,c,r,!0))),l}function h(e){var r=g(e);return t.getRegularPeriods(r)}function g(e){var r=m(e);return t.getMpd(r)}function p(){n=[],i={}}function m(e){return e||(n.length>0?n[0].mpd.manifest:null)}function v(e){try{var r=y(e.streamInfo,n),i=t.getAdaptationsForPeriod(r);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&i?i[e.index]:null}catch(e){return null}}function y(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n];if(e&&e.id===i.id)return i}return null}function E(e){if(!e)return null;var r,n,i,a,o,l=new Ai,u=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];if(l.id=e.id,l.index=e.index,l.type=e.type,l.streamInfo=_(e.period),l.representationCount=t.getRepresentationCount(u),l.labels=t.getLabelsForAdaptation(u),l.lang=t.getLanguageForAdaptation(u),l.segmentAlignment=t.getSegmentAlignment(u),l.subSegmentAlignment=t.getSubSegmentAlignment(u),r=t.getViewpointForAdaptation(u),l.viewpoint=r.length?r[0].value:void 0,l.viewpointsWithSchemeIdUri=r,o=t.getAccessibilityForAdaptation(u),l.accessibility=o.map((function(e){var t=e.value,r=t;return e.schemeIdUri&&e.schemeIdUri.search("cea-608")>=0&&void 0!==s&&(r=t?"cea-608:"+t:"cea-608",l.embeddedCaptions=!0),r})),l.accessibilitiesWithSchemeIdUri=o,n=t.getAudioChannelConfigurationForAdaptation(u),l.audioChannelConfiguration=n.map((function(e){return e.value})),l.audioChannelConfigurationsWithSchemeIdUri=n,0===l.audioChannelConfiguration.length&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0&&(i=t.getAudioChannelConfigurationForRepresentation(u.Representation_asArray[0]),l.audioChannelConfiguration=i.map((function(e){return e.value})),l.audioChannelConfigurationsWithSchemeIdUri=i),a=t.getRolesForAdaptation(u),l.roles=a.map((function(e){return e.value})),l.rolesWithSchemeIdUri=a,l.codec=t.getCodec(u),l.mimeType=t.getMimeType(u),l.contentProtection=t.getContentProtectionData(u),l.bitrateList=t.getBitrateListForAdaptation(u),l.selectionPriority=t.getSelectionPriority(u),l.contentProtection){var c=l.contentProtection.map((function(e){return t.getKID(e)})).filter((function(e){return null!==e}));if(c.length){var f=c[0];l.contentProtection.forEach((function(e){e.keyId=f}))}}if(l.isText=t.getIsText(u),l.supplementalProperties=t.getSupplementalPropertiesForAdaptation(u),(!l.supplementalProperties||0===Object.keys(l.supplementalProperties).length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var d=u.Representation_asArray.map((function(e){return t.getSupplementalPropertiesForRepresentation(e)}));d.every((function(e){return JSON.stringify(e)===JSON.stringify(d[0])}))&&(l.supplementalProperties=d[0])}if(l.supplementalPropertiesAsArray=t.getSupplementalPropertiesAsArrayForAdaptation(u),(!l.supplementalPropertiesAsArray||0===l.supplementalPropertiesAsArray.length)&&Array.isArray(u.Representation_asArray)&&u.Representation_asArray.length>0){var h=u.Representation_asArray.map((function(e){return t.getSupplementalPropertiesAsArrayForRepresentation(e)}));h.every((function(e){return JSON.stringify(e)===JSON.stringify(h[0])}))&&(l.supplementalPropertiesAsArray=h[0])}return l.isFragmented=t.getIsFragmented(u),l.isEmbedded=!1,l}function T(e,t,r){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=a.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1,e.lang=cr()(r),e.roles=["caption"],e.rolesWithSchemeIdUri=[{schemeIdUri:"urn:mpeg:dash:role:2011",value:"caption"}]}function _(e){var r,n,i=new bi;return i.id=e.id,i.index=e.index,i.start=e.start,i.duration=e.duration,i.manifestInfo=(r=e.mpd,(n=new Ri).dvrWindowSize=r.timeShiftBufferDepth,n.loadedTime=r.manifest.loadedTime,n.availableFrom=r.availabilityStartTime,n.minBufferTime=r.manifest.minBufferTime,n.maxFragmentDuration=r.maxSegmentDuration,n.duration=t.getDuration(r.manifest),n.isDynamic=t.getIsDynamic(r.manifest),n.serviceDescriptions=t.getServiceDescriptions(r.manifest),n.protocol=r.manifest.protocol,n),i.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(i.start+i.duration-i.manifestInfo.duration)<1,i}function S(){if(!a)throw new Error("setConfig function has to be called previously")}function A(e){return n.length>0?n[0].mpd.manifest.Period_asArray[e]:null}function b(e,t,r){var n,i,a,o,s;if(e)for(n=e.AdaptationSet_asArray,o=0;o<n.length;o+=1)for(a=n[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return r?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var r;return(r=b(A(t),e))?r.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var r=b(e,t,!0);return null!==r?r:-1}(A(t),e)},getMaxIndexForBufferType:function(e,r){return function(e,r){var n,i,a,o;if(!e||!r)return-1;for(i=e.AdaptationSet_asArray,o=0;o<i.length;o+=1)if(a=(n=i[o]).Representation_asArray,t.getIsTypeOf(n,r))return a.length;return-1}(A(r),e)},convertRepresentationToRepresentationInfo:function(e){if(e){var r=new Si,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],i=t.getRepresentationFor(e.index,n);return r.id=e.id,r.quality=e.index,r.bandwidth=t.getBandwidth(i),r.fragmentDuration=e.segmentDuration||(e.segments&&e.segments.length>0?e.segments[0].duration:NaN),r.MSETimeOffset=e.MSETimeOffset,r.mediaInfo=E(e.adaptation),r}return null},getStreamsInfo:function(e,t){var r=[],i=n;if(e&&(S(),i=h(e)),i.length>0){(!t||t>i.length)&&(t=i.length);for(var a=0;a<t;a++)r.push(_(i[a]))}return r},getMediaInfoForType:function(e,r){if(0===n.length||!e)return null;var i=y(e,n);if(!i)return null;var a=t.getAdaptationsForPeriod(i),o=u(e.index,r,e);return o?E(a[t.getIndexForAdaptation(o,n[0].mpd.manifest,e.index)]):null},getAllMediaInfoForType:d,getAdaptationForType:u,getRealAdaptation:function(e,r){var i,a,o=y(e,n);return i=r?r.id:null,n.length>0&&o&&(a=i?t.getAdaptationForId(i,n[0].mpd.manifest,o.index):t.getAdaptationForIndex(r?r.index:null,n[0].mpd.manifest,o.index)),a},getProducerReferenceTimes:function(e,r){var i,a,o=y(e,n);return i=r?r.id:null,n.length>0&&o&&(a=i?t.getAdaptationForId(i,n[0].mpd.manifest,o.index):t.getAdaptationForIndex(r?r.index:null,n[0].mpd.manifest,o.index)),a?t.getProducerReferenceTimesForAdaptation(a):[]},getRealPeriodByIndex:function(e){return t.getRealPeriodForIndex(e,n[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return t.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){var r=v(e);return t.getRepresentationsForAdaptation(r)},getEventsFor:function(e,r,i){var a=[];if(n.length>0){var o=n[0].mpd.manifest;if(e instanceof bi){var s=y(e,n);a=t.getEventsForPeriod(s)}else if(e instanceof Ai){var l=y(i,n);a=t.getEventStreamForAdaptationSet(o,v(e),l)}else if(e instanceof Si){var u=y(i,n);a=t.getEventStreamForRepresentation(o,r,u)}}return a},getEvent:function(e,t,r,n){try{if(!e||!t||isNaN(r)||!n)return null;var i=e.scheme_id_uri,a=e.value;if(!t[i+"/"+a])return null;var o,s=new ye,l=e.timescale||1,u=n.adaptation.period.start,c=t[i+"/"+a],f=isNaN(n.presentationTimeOffset)?isNaN(c.presentationTimeOffset)?0:c.presentationTimeOffset:n.presentationTimeOffset,d=e.presentation_time_delta/l;o=0===e.version?u+r-f+d:u-f+d;var h=e.event_duration/l,g=e.id,p=e.message_data;return s.eventStream=c,s.eventStream.value=a,s.eventStream.timescale=l,s.duration=h,s.id=g,s.calculatedPresentationTime=o,s.messageData=p,s.presentationTimeDelta=d,s}catch(e){return null}},getMpd:g,setConfig:function(e){e&&(e.constants&&(a=e.constants),e.cea608parser&&(s=e.cea608parser),e.errHandler&&t.setConfig({errHandler:e.errHandler}),e.BASE64&&t.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;S(),n=h(e)},getIsTextTrack:function(e){return t.getIsText(e)},getUTCTimingSources:function(){var e=m();return t.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=n.length>0?n[0].mpd:null;return t.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var r=g(e);return t.getAvailabilityStartTime(r)},getIsTypeOf:function(e,r){return t.getIsTypeOf(e,r)},getIsDynamic:function(e){var r=m(e);return t.getIsDynamic(r)},getDuration:function(e){var r=m(e);return t.getDuration(r)},getRegularPeriods:h,getContentSteering:function(e){return t.getContentSteering(e)},getLocation:function(e){return t.getLocation(e)},getPatchLocation:function(e){var r=t.getPatchLocation(e),n=t.getPublishTime(e);return r&&0!==r.length&&n?r.filter((function(e){return isNaN(e.ttl)||n.getTime()+e.ttl>(new Date).getTime()})):[]},getManifestUpdatePeriod:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.getManifestUpdatePeriod(e,r)},getPublishTime:function(e){return t.getPublishTime(e)},getIsDVB:function(e){return t.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return r.getIsPatch(e)},getBaseURLsFromElement:function(e){return t.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return t.getRepresentationSortFunction()},getCodec:function(e,r,n){return t.getCodec(e,r,n)},getPeriodById:function(e){if(!e||0===n.length)return null;var t=n.filter((function(t){return t.id===e}));return t&&t.length>0?t[0]:null},setCurrentMediaInfo:function(e,t,r){i[e]=i[e]||{},i[e][t]=i[e][t]||{},i[e][t]=r},isPatchValid:function(e,n){var i=t.getId(e),a=r.getMpdId(n),o=t.getPublishTime(e),s=r.getPublishTime(n),l=r.getOriginalPublishTime(n);return!!(i&&a&&i==a&&o&&l&&o.getTime()==l.getTime()&&s&&o.getTime()<s.getTime())},applyPatchToManifest:function(e,t){r.getPatchOperations(t).forEach((function(t){var r=t.getMpdTarget(e);if(null!==r){var n=r.name,i=r.target,a=r.leaf;if(t.xpath.findsAttribute())switch(t.action){case"add":case"replace":i[n]=t.value;break;case"remove":delete i[n]}else{var o=(i[n+"_asArray"]||[]).indexOf(a),s="prepend"===t.position||"before"===t.position;if(("remove"===t.action||"replace"===t.action)&&(delete i[n],-1!=o)){var l=i[n+"_asArray"];l.splice(o,1),l.length>1?i[n]=l:1==l.length?i[n]=l[0]:delete i[n+"_asArray"]}"add"!==t.action&&"replace"!==t.action||Object.keys(t.value).forEach((function(e){var r=t.value[e],a=i[e+"_asArray"]||[];if(0===a.length&&i[e]&&a.push(i[e]),0===a.length)a=r;else{var l=a.length;l=e==n&&-1!=o?o+(s?0:1)+("replace"==t.action?-1:0):s?0:a.length,a.splice.apply(a,[l,0].concat(r))}i[e+"_asArray"]=a,i[e]=1==a.length?a[0]:a}))}}}))},areMediaInfosEqual:c,reset:p},t=xe(l).getInstance(),r=Ci(l).getInstance(),p(),e}Ni.__dashjs_factory_name="DashAdapter";const Li=c.Z.getSingletonFactory(Ni);var Oi=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"round10",value:function(e,t){return function(e,t,r){return void 0===r||0==+r?Math[e](t):(r=+r,null===(t=+t)||isNaN(t)||"number"!=typeof r||r%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-r:-r)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+r:r))))}("round",e,t)}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e,t),e}();const Pi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]},Mi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null},ki=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null},xi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=s.Z.BUFFER_EMPTY},Fi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null},Ui=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null};function Bi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Zi=function e(){Bi(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},Gi=function e(){Bi(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},Ki=function e(){Bi(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null};const Hi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null},Yi=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]};function Vi(e){var t,r,n=(e=e||{}).settings,i=this.context,o=(0,l.Z)(i).getInstance();function c(){o.trigger(u.Z.METRICS_CHANGED)}function f(e){o.trigger(u.Z.METRIC_CHANGED,{mediaType:e}),c()}function d(e,t,r){o.trigger(u.Z.METRIC_UPDATED,{mediaType:e,metric:t,value:r}),f(e)}function h(e,t,r){o.trigger(u.Z.METRIC_ADDED,{mediaType:e,metric:t,value:r}),f(e)}function g(e,t){var n=null;return e?(r.hasOwnProperty(e)?n=r[e]:t||(n=new Pi,r[e]=n),n):n}function p(e,t,r){var i=g(e);null!==i&&(i[t].push(r),i[t].length>n.get().streaming.metrics.maxListDepth&&i[t].shift())}function m(e,t,r){p(e,t,r),h(e,t,r)}return t={clearCurrentMetricsForType:function(e){delete r[e],f(e)},clearAllCurrentMetrics:function(){r={},c()},getMetricsFor:g,addHttpRequest:function e(t,r,n,i,a,o,l,u,c,f,d,h,g,p,v,y,E){var T=new D.w;o&&o!==i&&(e(t,null,n,i,a,null,null,u,c,null,null,null,g,null,null,y,E),T.actualurl=o),T.tcpid=r,T.type=n,T.url=i,T.range=u,T.trequest=c,T.tresponse=f,T.responsecode=h,T.cmsd=E,T._tfinish=d,T._stream=t,T._mediaduration=g,T._quality=a,T._responseHeaders=p,T._serviceLocation=l,T._fileLoaderType=y,v?v.forEach((function(e){!function(e,t,r,n){var i=new D.O;i.s=t,i.d=r,i.b=n,e.trace.push(i),e.interval||(e.interval=0),e.interval+=r}(T,e.s,e.d,e.b)})):(delete T.interval,delete T.trace),m(t,s.Z.HTTP_REQUEST,T)},addRepresentationSwitch:function(e,t,r,n,i){var a=new Mi;a.t=t,a.mt=r,a.to=n,i?a.lto=i:delete a.lto,m(e,s.Z.TRACK_SWITCH,a)},addBufferLevel:function(e,t,r){var n=new ki;n.t=t,n.level=r,m(e,s.Z.BUFFER_LEVEL,n)},addBufferState:function(e,t,r){var n=new xi;n.target=r,n.state=t,m(e,s.Z.BUFFER_STATE,n)},addDVRInfo:function(e,t,r,n){var i=new Fi;i.time=t,i.range=n,i.manifestInfo=r,m(e,s.Z.DVR_INFO,i)},addDroppedFrames:function(e,t){var r=new Ui,n=g(e).DroppedFrames;t&&(r.time=t.creationTime,r.droppedFrames=t.droppedVideoFrames,n.length>0&&n[n.length-1]==r||m(e,s.Z.DROPPED_FRAMES,r))},addSchedulingInfo:function(e,t,r,n,i,a,o,l,u){var c=new Hi;c.mediaType=e,c.t=t,c.type=r,c.startTime=n,c.availabilityStartTime=i,c.duration=a,c.quality=o,c.range=l,c.state=u,m(e,s.Z.SCHEDULING_INFO,c)},addRequestsQueue:function(e,t,r){var n=new Yi;n.loadingRequests=t,n.executedRequests=r,g(e).RequestsQueue=n,h(e,s.Z.REQUESTS_QUEUE,n)},addManifestUpdate:function(e,t,r,n,i,o,l,u,c,f){var d=new Zi;d.mediaType=e,d.type=t,d.requestTime=r,d.fetchTime=n,d.availabilityStartTime=i,d.presentationStartTime=o,d.clientTimeOffset=l,d.currentTime=u,d.buffered=c,d.latency=f,p(a.Z.STREAM,s.Z.MANIFEST_UPDATE,d),h(e,s.Z.MANIFEST_UPDATE,d)},updateManifestUpdateInfo:function(e,t){if(e){for(var r in t)e[r]=t[r];d(e.mediaType,s.Z.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,r,n,i){if(e){var a=new Gi;a.id=t,a.index=r,a.start=n,a.duration=i,e.streamInfo.push(a),d(e.mediaType,s.Z.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,r,n,i,a,o,l){if(e&&e.representationInfo){var u=new Ki;u.id=t,u.index=r,u.streamIndex=n,u.mediaType=i,u.startNumber=o,u.fragmentInfoType=l,u.presentationTimeOffset=a,e.representationInfo.push(u),d(e.mediaType,s.Z.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach((function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel})):delete e.trace,m(a.Z.STREAM,s.Z.PLAY_LIST,e)},addDVBErrors:function(e){m(a.Z.STREAM,s.Z.DVB_ERRORS,e)}},r={},t}Vi.__dashjs_factory_name="MetricsModel";const qi=c.Z.getSingletonFactory(Vi);function ji(e){e=e||{};var t,r,n,i,o=this.context,l=e.metricsModel;function u(e){var t=l.getMetricsFor(e,!0);if(!t)return null;var r,n=t.HttpList,i=null;if(!n||n.length<=0)return null;for(r=n.length-1;r>=0;){if(n[r].responsecode){i=n[r];break}r--}return i}function c(e){var t=l.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function f(e,t){if(!e)return null;var r=e[t];return r&&0!==r.length?r[r.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return f(l.getMetricsFor(e,!0),s.Z.TRACK_SWITCH)},getCurrentBufferState:function(e){return f(l.getMetricsFor(e,!0),s.Z.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=f(l.getMetricsFor(e,!0),s.Z.BUFFER_LEVEL);return t?Oi.round10(t.level/1e3,-3):0},getCurrentHttpRequest:u,getHttpRequests:c,getCurrentDroppedFrames:function(){return f(l.getMetricsFor(a.Z.VIDEO,!0),s.Z.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return f(l.getMetricsFor(e,!0),s.Z.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return f(e?l.getMetricsFor(e,!0):l.getMetricsFor(a.Z.VIDEO,!0)||l.getMetricsFor(a.Z.AUDIO,!0),s.Z.DVR_INFO)},getCurrentManifestUpdate:function(){return f(l.getMetricsFor(a.Z.STREAM),s.Z.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var r={},n=u(e);n&&(r=Fe.Z.parseHttpHeaders(n._responseHeaders));var i=r[t.toLowerCase()];return void 0===i?null:i},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;var t,r,n,i={};for(n=(t=c(a.Z.STREAM)).length-1;n>=0;n--)if((r=t[n]).type===D.w.MPD_TYPE){i=Fe.Z.parseHttpHeaders(r._responseHeaders);break}var o=i[e.toLowerCase()];return void 0===o?null:o},addRepresentationSwitch:function(e,t,r,n,i){l.addRepresentationSwitch(e,t,r,n,i)},addDVRInfo:function(e,t,r,n){l.addDVRInfo(e,t,r,n)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();l.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();l.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var r=this.getCurrentManifestUpdate();l.addManifestUpdateRepresentationInfo(r,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){l.addManifestUpdate(a.Z.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,r,n,i,a){l.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,r,e.duration,n,i,e.fileLoaderType,a)},addSchedulingInfo:function(e,t){l.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,r){l.addRequestsQueue(e,t,r)},addBufferLevel:function(e,t,r){l.addBufferLevel(e,t,r)},addBufferState:function(e,t,r){l.addBufferState(e,t,r)},addDroppedFrames:function(e){l.addDroppedFrames(a.Z.VIDEO,e)},addPlayList:function(){i&&(l.addPlayList(i),i=null)},addDVBErrors:function(e){l.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(i=new J).start=new Date,i.mstart=e,i.starttype=t},createPlaylistTraceMetrics:function(e,t,i){!0===r&&(r=!1,(n=new $).representationid=e,n.start=new Date,n.mstart=t,n.playbackspeed=null!==i?i.toString():null)},updatePlayListTraceMetrics:function(e){if(n)for(var t in n)n[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===r&&i&&n&&n.start){var a=n.start,o=e.getTime()-a.getTime();n.duration=o,n.stopreason=t,i.trace.push(n),r=!0}},clearAllCurrentMetrics:function(){l.clearAllCurrentMetrics()}},l=l||qi(o).getInstance({settings:e.settings}),r=!0,n=null,i=null,t}ji.__dashjs_factory_name="DashMetrics";const zi=c.Z.getSingletonFactory(ji);function Wi(){var e,t,r,n,i=this.context,s=(0,l.Z)(i).getInstance(),c=(0,w.Z)(i).getInstance();function f(e){n=e}function h(e,t,r,n){var i,a=t.adaptation.period.mpd,o=a.availabilityStartTime;if(n)i=r&&a.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(o.getTime()+1e3*(e+a.timeShiftBufferDepth)):a.availabilityEndTime;else if(r){var s=t.availabilityTimeOffset;i=new Date(o.getTime()+1e3*(e-s))}else i=o;return i}function g(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*n)/1e3}function p(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function m(e){var r={start:NaN,end:NaN},n=e[0].getAdapter().getRegularPeriods()[0],i=g(new Date,n);if(!e||0===e.length)return{range:r,now:i};e.forEach((function(e){var n=e.getAdapter(),s=n.getMediaInfoForType(e.getStreamInfo(),a.Z.VIDEO)||n.getMediaInfoForType(e.getStreamInfo(),a.Z.AUDIO),l=n.getVoRepresentations(s)[0],u={start:NaN,end:NaN};if(l)if(l.segmentInfoType===o.Z.SEGMENT_TIMELINE)u=function(e){var r,n,i,a,o=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],s=t.getRepresentationFor(e.index,o),l=s.SegmentTemplate||s.SegmentList,u=l.SegmentTimeline,c=l.timescale,f=u.S_asArray,d={start:0,end:0},h=f[0].t,g=!isNaN(h),m=g?h:0,v=0;for(g&&(d.start=p(m/c,e)),i=0,a=f.length;i<a;i++)n=0,(r=f[i]).hasOwnProperty("r")&&(n=r.r),v+=r.d*(1+n);return d.end=p((m+v)/c,e),d}(l);else{var c=l.adaptation.period;u.start=c.start,u.end=Math.max(i,c.start+c.duration)}!isNaN(u.start)&&(isNaN(r.start)||r.start>u.start)&&(r.start=u.start),!isNaN(u.end)&&(isNaN(r.end)||r.end<u.end)&&(r.end=u.end)})),r.end=Math.min(i,r.end);var s=y(e,r.end,!0);return r.end=isNaN(s)?r.end:s,r.start=n&&n.mpd&&n.mpd.timeShiftBufferDepth&&!isNaN(n.mpd.timeShiftBufferDepth)&&!isNaN(r.end)?Math.max(r.end-n.mpd.timeShiftBufferDepth,r.start):r.start,r.start=y(e,r.start),{range:r,now:i}}function v(e,t){r=e-t.end}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{for(var n=0,i=!1,a=NaN;!i&&n<e.length;){var o=e[n].getStreamInfo();o.start<=t&&(!isFinite(o.duration)||o.start+o.duration>=t)?(a=t,i=!0):!r&&o.start>t&&(isNaN(a)||o.start<a)?a=o.start:r&&o.start+o.duration<t&&(isNaN(a)||o.start+o.duration>a)&&(a=o.start+o.duration),n+=1}return a}catch(e){return t}}function E(e){void 0===e.offset||isNaN(e.offset)||f(e.offset/1e3)}function T(){n=0,r=0}function _(){s.off(u.Z.UPDATE_TIME_SYNC_OFFSET,E,this),T()}return e={initialize:function(){T(),s.on(u.Z.UPDATE_TIME_SYNC_OFFSET,E,this)},getClientTimeOffset:function(){return n},setClientTimeOffset:f,getClientReferenceTime:function(){return Date.now()-1e3*r+1e3*n},calcAvailabilityStartTimeFromPresentationTime:function(e,t,r){return h(e,t,r)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,r){return h(e,t,r,!0)},calcPresentationTimeFromWallTime:g,calcPresentationTimeFromMediaTime:p,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcWallTimeForSegment:function(e,t){var r,n,i;return t&&(r=e.representation.adaptation.period.mpd.suggestedPresentationDelay,n=e.presentationStartTime+r,i=new Date(e.availabilityStartTime.getTime()+1e3*n)),i},calcTimeShiftBufferWindow:function(e,t){if(!t)return function(e){var t={start:NaN,end:NaN},r=0,n=NaN;return e.forEach((function(e){var t=e.getStreamInfo();r+=t.duration,(isNaN(n)||t.start<n)&&(n=t.start)})),t.start=n,t.end=n+r,t}(e);if(c.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var r=m(e);return v(r.now,r.range),r.range}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var r=e[0].getAdapter().getRegularPeriods()[0],n=g(new Date,r),i=r.mpd.timeShiftBufferDepth,a=isNaN(i)?0:n-i;if(t.start=y(e,a),t.end=!isNaN(t.start)&&n<t.start?n:y(e,n,!0),!isNaN(i)&&t.end<n-i&&(t.end=NaN),c.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var o=m(e);if(o.range.end<t.start)return s.trigger(d.Z.CONFORMANCE_VIOLATION,{level:Xt.LEVELS.WARNING,event:Xt.EVENTS.INVALID_DVR_WINDOW}),v(o.now,o.range),o.range}return t}(e)},reset:_},t=xe(i).getInstance(),_(),e}Wi.__dashjs_factory_name="TimelineConverter";const Xi=c.Z.getSingletonFactory(Wi);var Qi=r(4593),Ji=r(6934);function $i(e){return $i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$i(e)}function ea(e,t){return ea=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ea(e,t)}function ta(e){return ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ta(e)}const ra=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ea(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=ta(t);if(r){var i=ta(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==$i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=n.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e}return i}(Ai);var na=r(2295);function ia(){var e=0;function t(e){for(var t="",r=0;r<e.length;++r)t+=e[r].uchar;return t.length-t.replace(/^\s+/,"").length}function r(e){return"left: "+3.125*e.x+"%; top: "+6.66*e.y1+"%; width: "+(100-3.125*e.x)+"%; height: "+6.66*Math.max(e.y2-1-e.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function n(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function i(e,t){var r=e.videoHeight/15;return t?"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?n(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?n(t.background):"transparent")+";":"font-size: "+r+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function a(e){return e.replace(/^\s+/g,"")}function o(e){return e.replace(/\s+$/g,"")}return{createHTMLCaptionsFromScreen:function(n,s,l,u){var c,f,d=null,h=!1,g=-1,p={start:s,end:l,spans:[]},m="style_cea608_white_black",v={},y={},E=[];for(c=0;c<15;++c){var T=u.rows[c],_="",S=null;if(!1===T.isEmpty()){var A=t(T.chars);null===d&&(d={x:A,y1:c,y2:c+1,p:[]}),A!==g&&h&&(d.p.push(p),p={start:s,end:l,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===v.hasOwnProperty(d.name)?(E.push(d),v[d.name]=d):v[d.name].p.contat(d.p),d={x:A,y1:c,y2:c+1,p:[]});for(var b=0;b<T.chars.length;++b){var R=T.chars[b],I=R.penState;if(null===S||!I.equals(S)){_.trim().length>0&&(p.spans.push({name:m,line:_,row:c}),_="");var w="style_cea608_"+I.foreground+"_"+I.background;I.underline&&(w+="_underline"),I.italics&&(w+="_italics"),y.hasOwnProperty(w)||(y[w]=JSON.parse(JSON.stringify(I))),S=I,m=w}_+=R.uchar}_.trim().length>0&&p.spans.push({name:m,line:_,row:c}),h=!0,g=A}else h=!1,g=-1,d&&(d.p.push(p),p={start:s,end:l,spans:[]},d.y2=c,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===v.hasOwnProperty(d.name)?(E.push(d),v[d.name]=d):v[d.name].p.contat(d.p),d=null)}d&&(d.p.push(p),d.y2=c+1,d.name="region_"+d.x+"_"+d.y1+"_"+d.y2,!1===v.hasOwnProperty(d.name)?(E.push(d),v[d.name]=d):v[d.name].p.contat(d.p),d=null);var D=[];for(c=0;c<E.length;++c){var C=E[c],N="sub_cea608_"+e++,L=document.createElement("div");L.id=N;var O=r(C);L.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+O;var P=document.createElement("div");P.className="paragraph bodyStyle",P.style.cssText=i(n);var M=document.createElement("div");M.className="cueUniWrapper",M.style.cssText="unicode-bidi: normal; direction: ltr;";for(var k=0;k<C.p.length;++k){var x=C.p[k],F=0;for(f=0;f<x.spans.length;++f){var U=x.spans[f];if(U.line.length>0){if(0!==f&&F!=U.row){var B=document.createElement("br");B.className="lineBreak",M.appendChild(B)}var Z=!1;F===U.row&&(Z=!0),F=U.row;var G=y[U.name],K=document.createElement("span");K.className="spanPadding "+U.name+" customSpanColor",K.style.cssText=i(n,G),0!==f&&Z?f===x.spans.length-1?K.textContent=o(U.line):K.textContent=U.line:x.spans.length>1&&f<x.spans.length-1&&U.row===x.spans[f+1].row?K.textContent=a(U.line):K.textContent=U.line.trim(),M.appendChild(K)}}}P.appendChild(M),L.appendChild(P);var H={bodyStyle:["%",90]};for(var Y in y)y.hasOwnProperty(Y)&&(H[Y]=["%",90]);D.push({type:"html",start:s,end:l,cueHTMLElement:L,cueID:N,cellResolution:[32,15],isFromCEA608:!0,fontSize:H,lineHeight:{},linePadding:{}})}return D}}}ia.__dashjs_factory_name="EmbeddedTextHtmlRender";const aa=c.Z.getSingletonFactory(ia);function oa(e){var t,r,n,o,s,c,d,h,g,p,m,v,y,E,T,_,A=e.errHandler,b=e.manifestModel,R=e.mediaController,w=e.videoModel,C=e.textTracks,N=e.vttParser,L=e.vttCustomRenderingParser,O=e.ttmlParser,P=e.streamInfo,M=e.settings,k=this.context,x=(0,l.Z)(k).getInstance(),F=!1;function U(){c=null,h=NaN,g=[],p=null,d=!1,s=[],o=null}function B(e){var t=new ra;for(var r in e)t[r]=e[r];t.labels=e.labels,t.defaultTrack=function(e){var t=!1;return v.length>1&&e.isEmbedded?t=e.id&&e.id===a.Z.CC1:1===v.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===v.length&&(t=e.index===s[0].index),t}(e),t.isFragmented=e.isFragmented,t.isEmbedded=!!e.isEmbedded,t.isTTML=function(e){return e.codec&&e.codec.search(a.Z.STPP)>=0||e.mimeType&&e.mimeType.search(a.Z.TTML)>=0}(e),t.kind=function(e,t){var r=e.roles&&e.roles.length>0?t[e.roles[0]]:t.caption;return r===t.caption||r===t.subtitle?r:t.caption}(e,{subtitle:"subtitles",caption:"captions"}),C.addTextTrack(t)}function Z(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&K(t.bytes,t)}function G(e){m=e}function K(e,s){var l=s.mediaInfo,u=l.type,f=l.mimeType,g=l.codec||f;g?-1!==l.codec.indexOf("application/mp4")?function(e,i,s){var l;if("InitializationSegment"===i.segmentType)d=!0,h=n.getMediaTimescaleFromMoov(e);else{if(!d)return;(l=n.getSamplesInfo(e).sampleList).length>0&&(p=l[0].cts-i.start*h),s.search(a.Z.STPP)>=0?function(e,n,i){var s,l;for(o=null!==o?o:V(i),s=0;s<n.length;s++){var u=n[s],f=u.cts,d=Y(),g=d+f/h,p=g+u.duration/h;t.buffered.add(g,p);var v=new DataView(e,u.offset,u.subSizes[0]),y=Ji.Utils.dataViewToString(v,a.Z.UTF8),E=[],T=u.offset+u.subSizes[0];for(l=1;l<u.subSizes.length;l++){var _=new Uint8Array(e,T,u.subSizes[l]),S=String.fromCharCode.apply(null,_);E.push(S),T+=u.subSizes[l]}try{var A=b.getValue().ttmlTimeIsRelative?f/h:0,R=o.parse(y,A,f/h,(f+u.duration)/h,E);C.addCaptions(m,d,R)}catch(e){c.removeExecutedRequestsBeforeTime(),this.remove(),r.error("TTML parser error: "+e.message)}}}(e,l,s):function(e,n){var i,a,o,s=[];for(i=0;i<n.length;i++){var l=n[i];l.cts-=p;var u=Y()+l.cts/h,c=u+l.duration/h;t.buffered.add(u,c);var f=e.slice(l.offset,l.offset+l.size),d=Ji.parseBuffer(f);for(a=0;a<d.boxes.length;a++){var g=d.boxes[a];if(r.debug("VTT box1: "+g.type),"vtte"!==g.type&&"vttc"===g.type){r.debug("VTT vttc boxes.length = "+g.boxes.length);var v={styles:{}};for(o=0;o<g.boxes.length;o++){var y=g.boxes[o];if(r.debug("VTT box2: "+y.type),"payl"===y.type)v.start=l.cts/h,v.end=(l.cts+l.duration)/h,v.data=y.cue_text;else if("sttg"===y.type&&y.settings&&""!==y.settings)try{var E=y.settings.split(" ");v.styles=N.getCaptionStyles(E)}catch(e){}}v&&v.data&&(s.push(v),r.debug("VTT  ".concat(v.start," - ").concat(v.end," :  ").concat(v.data)))}}}s.length>0&&C.addCaptions(m,0,s)}(e,l)}}(e,s,g):u===a.Z.VIDEO?function(e,t){var a,o;if(t.segmentType===D.w.INIT_SEGMENT_TYPE)0===y&&(y=n.getMediaTimescaleFromMoov(e));else if(t.segmentType===D.w.MEDIA_SEGMENT_TYPE){if(0===y)return void r.warn("CEA-608: No timescale for embeddedTextTrack yet");var s=(o=n.getSamplesInfo(e)).lastSequenceNumber;if(T[0]||T[1]||function(){for(var e,t=0;t<v.length;t++){if(-1===(e=C.getTrackIdxForId(v[t].id)))return void r.warn("CEA-608: data before track is ready.");var n=H(e);T[t]=new(i().Cea608Parser)(t+1,{newCue:n},null)}}(),y){if(null!==E&&s!==E+o.numSequences)for(a=0;a<T.length;a++)T[a]&&T[a].reset();for(var l=function(e,t){if(0===t.length)return null;for(var r={splits:[],fields:[[],[]]},n=new DataView(e),a=0;a<t.length;a++)for(var o=t[a],s=i().findCea608Nalus(n,o.offset,o.size),l=null,u=0,c=0;c<s.length;c++)for(var f=i().extractCea608DataFromRange(n,s[c]),d=0;d<2;d++)if(f[d].length>0){o.cts!==l?u=0:u+=1;var h=Y();r.fields[d].push([o.cts+h*y,f[d],u]),l=o.cts}return r.fields.forEach((function(e){e.sort((function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]}))})),r}(e,o.sampleList),u=0;u<T.length;u++){var c=l.fields[u],f=T[u];if(f)for(a=0;a<c.length;a++)f.addData(c[a][0]/y,c[a][1])}E=s}}}(e,s):function(e,r,n){var i,o,s=new DataView(e,0,e.byteLength);o=Ji.Utils.dataViewToString(s,a.Z.UTF8);try{i=V(n).parse(o,0),C.addCaptions(C.getCurrentTrackIdx(),0,i),t.buffered&&t.buffered.add(r.start,r.end)}catch(e){A.error(new S.Z(I.TIMED_TEXT_ERROR_ID_PARSE_CODE,I.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,o))}}(e,s,g):r.error("No text type defined")}function H(e){return function(t,r,n){var i;(i=w.getTTMLRenderingDiv()?_.createHTMLCaptionsFromScreen(w.getElement(),t,r,n):[{start:t,end:r,data:n.getDisplayText(),styles:{}}])&&C.addCaptions(e,0,i)}}function Y(){return isNaN(t.timestampOffset)?0:t.timestampOffset}function V(e){var t;return e.search(a.Z.VTT)>=0?t=M.get().streaming.text.webvtt.customRenderingEnabled&&L?L:N:(e.search(a.Z.TTML)>=0||e.search(a.Z.STPP)>=0)&&(t=O),t}function q(e){v.forEach((function(t){var r=C.getTrackIdxForId(t.id);r>=0&&C.deleteCuesFromTrackIdx(r,e.from,e.to)}))}return t={initialize:function(){F||(v=[],m=null,y=0,T=[],E=null,F=!0,_=aa(k).getInstance(),x.on(u.Z.VIDEO_CHUNK_RECEIVED,Z,t),x.on(u.Z.BUFFER_CLEARED,q,t))},addMediaInfos:function(e,r,n){if(s=s.concat(r),e===a.Z.TEXT&&r[0].isFragmented&&!r[0].isEmbedded){c=n,t.buffered=(0,na.Z)(k).create(),g=R.getTracksFor(a.Z.TEXT,P.id).filter((function(e){return e.isFragmented}));for(var i=R.getCurrentTrackFor(a.Z.TEXT,P.id),o=0;o<g.length;o++)if(g[o]===i){G(o);break}}for(var l=0;l<r.length;l++)B(r[l])},resetMediaInfos:function(){s=[]},getStreamId:function(){return P.id},append:K,abort:function(){},addEmbeddedTrack:function(e){if(F&&e)if(e.id===a.Z.CC1||e.id===a.Z.CC3){for(var t=0;t<v.length;t++)if(v[t].id===e.id)return;v.push(e)}else r.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){x.off(u.Z.VIDEO_CHUNK_RECEIVED,Z,t),x.off(u.Z.BUFFER_CLEARED,q,t),C&&C.deleteAllTextTracks(),F=!1,v=[],T=[null,null],E=null},getConfig:function(){return{fragmentModel:c,fragmentedTracks:g,videoModel:w}},setCurrentFragmentedTrackIdx:G,remove:function(e,r){void 0===e&&e===r&&(e=t.buffered.start(0),r=t.buffered.end(t.buffered.length-1)),t.buffered.remove(e,r),C.deleteCuesFromTrackIdx(m,e,r)},reset:function(){U(),s=[],n=null}},r=(0,f.Z)(k).getInstance().getLogger(t),n=(0,Ct.Z)(k).getInstance(),U(),t}oa.__dashjs_factory_name="TextSourceBuffer";const sa=c.Z.getClassFactory(oa);var la=r(4403);function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ca=["text","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function fa(e){var t,r,n,i,o,s,c,h,g,p,m,v,y,E,T,_,S,A,b=this.context,R=(0,l.Z)(b).getInstance(),I=e.videoModel,w=e.streamInfo,D=e.settings;function C(e,t,r,n,i,a){var o=0,s=0;e/t>r/n?o=(s=t)/n*r:s=(o=e)/r*n;var l,u,c=0,f=0;return o/s>i?(f=s,c=s*i):(c=o,f=o/i),l=(e-c)/2,u=(t-f)/2,a?{x:l+.1*c,y:u+.1*f,w:.8*c,h:.8*f}:{x:l,y:u,w:c,h:f}}function N(e,t){var r=I.getClientWidth(),n=I.getClientHeight(),i=I.getVideoWidth(),a=I.getVideoHeight(),o=I.getVideoRelativeOffsetTop(),s=I.getVideoRelativeOffsetLeft();if(0!==i&&0!==a){var l=i/a,u=!1;e.isFromCEA608&&(l=3.5/3,u=!0);var f=C.call(this,r,n,i,a,l,u),v=f.w,y=f.h,_=f.x,A=f.y;if(v!=g||y!=p||_!=c||A!=h||t){if(c=_+s,h=A+o,g=v,p=y,m){var b=m.style;b&&(b.left=c+"px",b.top=h+"px",b.width=g+"px",b.height=p+"px",b.zIndex=E&&document[E]||T?S:null,R.trigger(d.Z.CAPTION_CONTAINER_RESIZE))}var w=e.activeCues;if(w)for(var D=w.length,N=0;N<D;++N){var L=w[N];L.scaleCue(L)}}}}function L(e){var t,r,n,i,a,o=g,s=p;if(e.cellResolution){var l=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){r=(e.linePadding[t]*l[0]).toString();for(var u=document.getElementsByClassName("spanPadding"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r),u[c].style.cssText=u[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?n=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(n=e.fontSize[t][1]),r=(n*l[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var f=0;f<a.length;f++)a[f].style.cssText=a[f].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),r=(i*l[1]).toString(),a=document.getElementsByClassName(t);for(var d=0;d<a.length;d++)a[d].style.cssText=a[d].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+r)}}}if(e.isd){var h=document.getElementById(e.cueID);h&&m.removeChild(h),P(e)}}function O(e,t){var r=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,n=/^#(.*)$/;if(r.test(t)){var i=r.exec(t),a=parseInt(i[4],10)-1;return"data:image/png;base64,"+btoa(e.images[a])}if(n.test(t)){var o=n.exec(t)[1];return"data:image/png;base64,"+e.embeddedImages[o]}return t}function P(e){if(m){var t=document.createElement("div");m.appendChild(t),_=(0,la.renderHTML)(e.isd,t,(function(t){return O(e,t)}),m.clientHeight,m.clientWidth,!1,(function(e){r.info("renderCaption :",e)}),_,!0),t.id=e.cueID,R.trigger(d.Z.CAPTION_RENDERED,{captionDiv:t,currentTrackIdx:s})}}function M(e,t){if(!D.get().streaming.text.extendSegmentedCues)return!1;if(!t.cues||0===t.cues.length)return!1;var r=t.cues[t.cues.length-1];return!(r.endTime<e.startTime||!function(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];if(JSON.stringify(e[i])!==JSON.stringify(t[i]))return!1}return!0}(r,e,ca)||(r.endTime=Math.max(r.endTime,e.endTime),0))}function k(e,t){t&&t.forEach((function(t){t.kind&&"image"===t.kind&&(t.src=O(e,t.src)),k(e,t.contents)}))}function x(e,t,n){var i=Z(e);if(i&&Array.isArray(n)&&0!==n.length)for(var a=0;a<n.length;a++){var o=void 0,s=n[a];i.cellResolution=s.cellResolution,i.isFromCEA608=s.isFromCEA608,isNaN(s.start)||isNaN(s.end)||(o="html"===s.type&&m?F(s,t,i):s.data?U(s,t,i):null);try{o?H(i,o)||(D.get().streaming.text.webvtt.customRenderingEnabled?(i.manualCueList||(i.manualCueList=[]),i.manualCueList.push(o)):M(o,i)||i.addCue(o)):r.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(e){throw V(i),i.addCue(o),e}}}function F(e,t,i){var o=this,l=new n(e.start+t,e.end+t,"");return l.cueHTMLElement=e.cueHTMLElement,l.isd=e.isd,l.images=e.images,l.embeddedImages=e.embeddedImages,l.cueID=e.cueID,l.scaleCue=L.bind(o),l.cellResolution=e.cellResolution,l.lineHeight=e.lineHeight,l.linePadding=e.linePadding,l.fontSize=e.fontSize,m.style.left=c+"px",m.style.top=h+"px",m.style.width=g+"px",m.style.height=p+"px",l.isd&&k(l,l.isd.contents),l.onenter=function(){i.mode===a.Z.TEXT_SHOWING&&(this.isd?(P(this),r.debug("Cue enter id:"+this.cueID)):(m.appendChild(this.cueHTMLElement),L.call(o,this),R.trigger(d.Z.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:s})))},l.onexit=function(){if(m)for(var e=m.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(r.debug("Cue exit id:"+e[t].id),m.removeChild(e[t]),--t)},l}function U(e,t,i){var o=new n(e.start-t,e.end-t,e.data);if(o.cueID="".concat(o.startTime,"_").concat(o.endTime),o.isActive=!1,e.styles)try{void 0!==e.styles.align&&"align"in o&&(o.align=e.styles.align),void 0!==e.styles.line&&"line"in o&&(o.line=e.styles.line),void 0!==e.styles.snapToLines&&"snapToLines"in o&&(o.snapToLines=e.styles.snapToLines),void 0!==e.styles.position&&"position"in o&&(o.position=e.styles.position),void 0!==e.styles.size&&"size"in o&&(o.size=e.styles.size)}catch(e){r.error(e)}return o.onenter=function(){i.mode===a.Z.TEXT_SHOWING&&R.trigger(d.Z.CAPTION_RENDERED,{currentTrackIdx:s})},o}function B(){var e,t=[],r=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ua(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ua(e,t):void 0}}(e))){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}(I.getTextTracks());try{for(r.s();!(e=r.n()).done;){var n=e.value;n.manualMode===a.Z.TEXT_SHOWING&&t.push(n)}}catch(e){r.e(e)}finally{r.f()}return t}function Z(e){return e>=0&&i[e]?I.getTextTrack(i[e].kind,i[e].id,i[e].lang,i[e].isTTML,i[e].isEmbedded):null}function G(e){var t=this;if(e!==s){var r=Z(s=e);K.call(this,r),y&&(clearInterval(y),y=null),r&&"html"===r.renderingType&&(N.call(this,r,!0),window.ResizeObserver?(A=new window.ResizeObserver((function(){N.call(t,r,!0)}))).observe(I.getElement()):y=setInterval(N.bind(this,r),500))}}function K(e){z.call(this),e&&"html"===e.renderingType?q.call(this):j.call(this)}function H(e,t){if(!e.cues)return!1;for(var r=0;r<e.cues.length;r++)if(e.cues[r].startTime===t.startTime&&e.cues[r].endTime===t.endTime)return!0;return!1}function Y(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(isNaN(t)||(n?e.startTime:e.endTime)>=t)&&(isNaN(r)||(n?e.endTime:e.startTime)<=r)}function V(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.cues)for(var i=e.cues,a=i.length-1;a>=0;a--)Y(i[a],t,r,n)&&(i[a].onexit&&i[a].onexit(),e.removeCue(i[a]))}function q(){var e=document.getElementById("native-cue-style");if(!e){(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=I.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){r.info(""+e.message)}}}function j(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function z(){if(m)for(;m.firstChild;)m.removeChild(m.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(n=window.VTTCue||window.TextTrackCue,i=[],o=[],s=-1,c=0,h=0,g=0,p=0,m=null,v=null,y=null,T=!1,S=2147483647,_=null,void 0!==document.fullscreenElement?E="fullscreenElement":void 0!==document.webkitIsFullScreen?E="webkitIsFullScreen":document.msFullscreenElement?E="msFullscreenElement":document.mozFullScreen&&(E="mozFullScreen"))},getStreamId:function(){return w.id},addTextTrack:function(e){i.push(e)},addCaptions:x,createTracks:function(){i.sort((function(e,t){return e.index-t.index})),m=I.getTTMLRenderingDiv(),v=I.getVttRenderingDiv();for(var e,t,r,n,l,c,f=-1,h=0;h<i.length;h++){var g=(t=(e=i[h]).kind,r=void 0!==e.id?e.id:e.lang,n=e.lang,l=e.isTTML,c=e.isEmbedded,I.addTextTrack(t,r,n,l,c));o.push(g),i[h].defaultTrack&&(g.default=!0,f=h);var p=Z(h);p&&(p.mode=a.Z.TEXT_SHOWING,m&&(i[h].isTTML||i[h].isEmbedded)?p.renderingType="html":p.renderingType="default"),x(h,0,i[h].captionData),R.trigger(d.Z.TEXT_TRACK_ADDED)}if(G.call(this,f),f>=0){R.on(d.Z.PLAYBACK_METADATA_LOADED,(function e(){var t=Z(f);t&&"html"===t.renderingType&&N.call(this,t,!0),R.off(d.Z.PLAYBACK_METADATA_LOADED,e,this)}),this);for(var y=0;y<i.length;y++){var E=Z(y);E&&(E.mode=y===f?a.Z.TEXT_SHOWING:a.Z.TEXT_HIDDEN,E.manualMode=y===f?a.Z.TEXT_SHOWING:a.Z.TEXT_HIDDEN)}}R.trigger(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,{index:s,tracks:i,streamId:w.id})},getCurrentTrackIdx:function(){return s},setCurrentTrackIdx:G,getTrackIdxForId:function(e){for(var t=-1,r=0;r<i.length;r++)if(i[r].id===e){t=r;break}return t},getCurrentTrackInfo:function(){return i[s]},setModeForTrackIdx:function(e,t){var r=Z(e);r&&r.mode!==t&&(r.mode=t),r&&r.manualMode!==t&&(r.manualMode=t)},deleteCuesFromTrackIdx:function(e,t,r){var n=Z(e);n&&V(n,t,r)},deleteAllTextTracks:function(){for(var e=o?o.length:0,t=0;t<e;t++){var r=Z(t);r&&V.call(this,r,w.start,w.start+w.duration,!1)}o=[],i=[],y&&(clearInterval(y),y=null),A&&I&&(A.unobserve(I.getElement()),A=null),s=-1,z.call(this)},deleteTextTrack:function(e){I.removeChild(o[e]),o.splice(e,1)},manualCueProcessing:function(e){var t=B();if(t&&t.length>0){var r=t[0].manualCueList;r&&r.length>0&&r.forEach((function(t){if(t.startTime<=e&&t.endTime>=e&&!t.isActive)t.isActive=!0,WebVTT.processCues(window,[t],v,t.cueID);else if(t.isActive&&(t.startTime>e||t.endTime<e)&&(t.isActive=!1,v))for(var r=v.childNodes,n=0;n<r.length;++n)r[n].id===t.cueID&&(v.removeChild(r[n]),--n)}))}},disableManualTracks:function(){var e=B();if(e&&e.length>0){var t=e[0].manualCueList;t&&t.length>0&&t.forEach((function(e){if(e.isActive&&(e.isActive=!1,v))for(var t=v.childNodes,r=0;r<t.length;++r)t[r].id===e.cueID&&(v.removeChild(t[r]),--r)}))}}},r=(0,f.Z)(b).getInstance().getLogger(t),t}fa.__dashjs_factory_name="TextTracks";const da=c.Z.getClassFactory(fa);function ha(){var e,t,r,n,i,a,o=this.context;function s(e){var t=e.split(":"),r=t.length-1;return e=60*parseInt(t[r-1],10)+parseFloat(t[r]),2===r&&(e+=3600*parseInt(t[0],10)),e}function l(e){var t=e.split(n),r=t[1].split(a);return r.shift(),t[1]=r[0],r.shift(),{cuePoints:t,styles:u(r)}}function u(e){var t={};return e.forEach((function(e){if(e.split(/:/).length>1){var r=e.split(/:/)[1],n=!1;r&&-1!=r.search(/%/)&&(n=!0,r=parseInt(r.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(t.align=r),(e.match(/line/)||e.match(/L/))&&(t.line="auto"===r?r:parseInt(r,10),n&&(t.snapToLines=!1)),(e.match(/position/)||e.match(/P/))&&(t.position=r),(e.match(/size/)||e.match(/S/))&&(t.size=r)}})),t}function c(e,t){for(var r,i=t,a="",o="";""!==e[i]&&i<e.length;)i++;if((r=i-t)>1)for(var s=0;s<r;s++){if((o=e[t+s]).match(n)){a="";break}a+=o,s!==r-1&&(a+="\n")}else(o=e[t]).match(n)||(a=o);return a}return e={parse:function(e){var a,o,u=[];if(!e)return u;a=(e=e.split(r)).length,o=-1;for(var f=0;f<a;f++){var d=e[f];if(d.length>0&&"WEBVTT"!==d&&d.match(n)){var h=l(d),g=h.cuePoints,p=h.styles,m=c(e,f+1),v=s(g[0].replace(i,"")),y=s(g[1].replace(i,""));!isNaN(v)&&!isNaN(y)&&v>=o&&y>v?""!==m?(o=v,u.push({start:v,end:y,data:m,styles:p})):t.error("Skipping cue due to empty/malformed cue text"):t.error("Skipping cue due to incorrect cue timing")}}return u},getCaptionStyles:u},t=(0,f.Z)(o).getInstance().getLogger(e),r=/(?:\r\n|\r|\n)/gm,n=/-->/,i=/(^[\s]+|[\s]+$)/g,a=/\s\b/g,e}ha.__dashjs_factory_name="VTTParser";const ga=c.Z.getSingletonFactory(ha);function pa(){var e,t;return e={parse:function(e){var r=[];return t.oncue=function(e){e.start=e.startTime,e.end=e.endTime,e.data=e.text,e.styles={align:e.align,line:e.line,position:e.position,size:e.size},r.push(e)},t.parse(e),r}},function(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(t=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch(e){}}(),e}pa.__dashjs_factory_name="VttCustomRenderingParser";const ma=c.Z.getSingletonFactory(pa);function va(){var e,t,r=this.context,n=(0,l.Z)(r).getInstance(),i=0;return e={parse:function(e,r,a,o,s){var l,c,f,h="",g=[],p={},m={},v="",y="",E={onOpenTag:function(e,r,i){if(i[" imagetype"]&&!i[" imageType"]&&(n.trigger(d.Z.CONFORMANCE_VIOLATION,{level:Xt.LEVELS.ERROR,event:Xt.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),i[" imageType"]=i[" imagetype"]),"image"===r&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!i[" imageType"]||"PNG"!==i[" imageType"].value)return void t.warn("smpte-tt imageType != PNG. Discarded");v=i["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){v&&(m[v]=y.trim()),y="",v=""},onText:function(e){v&&(y+=e)}};if(!e)throw h="no ttml data to parse",new Error(h);p.data=e,n.trigger(u.Z.TTML_TO_PARSE,p);var T=(0,la.fromXML)(p.data,(function(e){h=e}),E);n.trigger(u.Z.TTML_PARSED,{ttmlString:p.data,ttmlDoc:T});var _,S=T.getMediaTimeEvents();for(f=0;f<S.length;f++){var A=(0,la.generateISD)(T,S[f],(function(e){h=e}));A.contents.some((function(e){return e.contents.length}))&&(l=S[f]+r)<(c=S[f+1]+r)&&g.push({start:l,end:c,type:"html",cueID:(_="cue_TTML_"+i,i++,_),isd:A,images:s,embeddedImages:m})}if(""!==h)throw t.error(h),new Error(h);return g}},t=(0,f.Z)(r).getInstance().getLogger(e),e}va.__dashjs_factory_name="TTMLParser";const ya=c.Z.getSingletonFactory(va);function Ea(e){var t,r,n,i,o,s,c,f,h,g,p,m,v=this.context,y=e.adapter,E=e.errHandler,T=e.manifestModel,_=e.mediaController,S=e.videoModel,A=e.settings;function b(e){var t=e.tracks,n=e.index,i=e.streamId;if(!1===A.get().streaming.text.defaultEnabled&&!w()||m)D(i,-1);else{var o=_.getCurrentTrackFor(a.Z.TEXT,i);if(o){var s={lang:o.lang,role:o.roles[0],index:o.index,codec:o.codec,accessibility:o.accessibility[0]};t.some((function(e,t){if(_.matchSettings(s,e))return D(i,t),n=t,!0}))}h=!1}r[i].lastEnabledIndex=n,f.trigger(d.Z.TEXT_TRACKS_ADDED,{enabled:w(),index:n,tracks:t,streamId:i}),p=!0}function R(e){try{var t=e.streamId;if(!i[t]||isNaN(e.time))return;i[t].manualCueProcessing(e.time)}catch(e){}}function I(e){try{var t=e.streamId;if(!i[t])return;i[t].disableManualTracks()}catch(e){}}function w(){var e=!0;return h&&!g&&(e=!1),e}function D(e,t){(h=-1===t)&&_&&_.saveTextSettingsDisabled();var r=C(e);if(r!==t&&i[e]){i[e].disableManualTracks(),i[e].setModeForTrackIdx(r,a.Z.TEXT_HIDDEN),i[e].setCurrentTrackIdx(t),i[e].setModeForTrackIdx(t,a.Z.TEXT_SHOWING);var o=i[e].getCurrentTrackInfo();o&&o.isFragmented&&!o.isEmbedded?function(e,t,r){if(n[e])for(var o=n[e].getConfig().fragmentedTracks,s=0;s<o.length;s++){var l=o[s];if(t.lang===l.lang&&(l.id?t.id===l.id:t.index===l.index)){var c=_.getCurrentTrackFor(a.Z.TEXT,e);(l.id?c.id!==l.id:c.index!==l.index)?(i[e].deleteCuesFromTrackIdx(r),n[e].setCurrentFragmentedTrackIdx(s)):-1===r&&f.trigger(u.Z.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:a.Z.TEXT})}}}(e,o,r):o&&!o.isFragmented&&function(e,t){f.trigger(u.Z.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:t},{streamId:e,mediaType:a.Z.TEXT})}(e,o),_.setTrack(o)}}function C(e){return i[e].getCurrentTrackIdx()}function N(){n={},i={},r={},h=!0,p=!1,m=!1}return t={deactivateStream:function(e){if(e){var t=e.id;n[t]&&n[t].resetMediaInfos(),i[t]&&i[t].deleteAllTextTracks()}},initialize:function(){f.on(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,b,t),A.get().streaming.text.webvtt.customRenderingEnabled&&(f.on(u.Z.PLAYBACK_TIME_UPDATED,R,t),f.on(u.Z.PLAYBACK_SEEKING,I,t))},initializeForStream:function(e){var t=e.id,a=da(v).create({videoModel:S,settings:A,streamInfo:e});a.initialize(),i[t]=a;var l=sa(v).create({errHandler:E,adapter:y,manifestModel:T,mediaController:_,videoModel:S,textTracks:a,vttParser:o,vttCustomRenderingParser:s,ttmlParser:c,streamInfo:e,settings:A});l.initialize(),n[t]=l,r[t]={},r[t].lastEnabledIndex=-1},createTracks:function(e){var t=e.id;i[t]&&i[t].createTracks()},getTextSourceBuffer:function(e){var t=e.id;if(n&&n[t])return n[t]},getAllTracksAreDisabled:function(){return h},addEmbeddedTrack:function(e,t){var r=e.id;n[r]&&n[r].addEmbeddedTrack(t)},enableText:function(e,t){return(0,j.PS)(t,"boolean"),w()!==t&&(t&&D(e,r[e].lastEnabledIndex),t||(r[e].lastEnabledIndex=C(e),p?D(e,-1):m=!0)),!0},isTextEnabled:w,setTextTrack:D,getCurrentTrackIdx:C,enableForcedTextStreaming:function(e){return(0,j.PS)(e,"boolean"),g=e,!0},addMediaInfosToBuffer:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=e.id;n[a]&&n[a].addMediaInfos(t,r,i)},reset:function(){N(),f.off(u.Z.TEXT_TRACKS_QUEUE_INITIALIZED,b,t),A.get().streaming.text.webvtt.customRenderingEnabled&&(f.off(u.Z.PLAYBACK_TIME_UPDATED,R,t),f.off(u.Z.PLAYBACK_SEEKING,I,t)),Object.keys(n).forEach((function(e){n[e].resetEmbedded(),n[e].reset()}))}},g=!1,p=!1,m=!1,o=ga(v).getInstance(),s=ma(v).getInstance(),c=ya(v).getInstance(),f=(0,l.Z)(v).getInstance(),N(),t}Ea.__dashjs_factory_name="TextController";const Ta=c.Z.getClassFactory(Ea);function _a(){var e,t,r,n,h,p,m,v,y,E,T,_,A,b,R,C,N,L,O,P,M,k,x,F,U,B,Z,G,K,H,Y,V,q,z,Q,J,$,ee,te,re="You must first call initialize() and set a source before calling this method",ne="You must first call initialize() and set a valid source and view before calling this method",ie="You must first call attachView() to set the video element before calling this method",ae="You must first call attachSource() with a valid source before calling this method",oe="MediaPlayer not initialized!",se=this.context,le=(0,l.Z)(se).getInstance(),ue=(0,w.Z)(se).getInstance(),ce=(0,f.Z)(se).getInstance({settings:ue});function fe(){Re(null),Ae(null),n=null,b&&(b.reset(),b=null),R&&(R.reset(),R=null),P&&P.reset(),ue.reset(),N&&(N.reset(),N=null)}function de(){return!!r&&!!J.getElement()}function he(){return(0,di.e)()}function ge(){if(!m)throw ne;return G.isPaused()}function pe(){if(!m)throw ne;return G.getIsDynamic()}function me(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,r=V.getCurrentDVRInfo(t);if(!r)return 0;var n=G.getOriginalLiveDelay(),i=r.range.start+e;return i>r.range.end-n&&(i=r.range.end-n),i}function ve(e){if(!m)throw ne;var t=Se().currentTime;if(void 0!==e)t=U.getTimeRelativeToStreamId(t,e);else if(G.getIsDynamic()){var r=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,n=V.getCurrentDVRInfo(r);t=null===n||0===t?0:Math.max(0,t-n.range.start)}return t}function ye(){if(!m)throw ne;var e=Se().duration;if(G.getIsDynamic()){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,r=V.getCurrentDVRInfo(t);e=r?r.range.end-r.range.start:0}return e}function Ee(e){(0,j.PS)(e,"boolean"),v=e}function Te(){P.restoreDefaultUTCTimingSources()}function _e(){return V}function Se(){if(!J.getElement())throw ie;return J.getElement()}function Ae(e){if(!h)throw oe;J.setElement(e),e&&(Ce(),function(){if(!R){var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(se).create();R=t.createMetricsReporting({debug:ce,eventBus:le,mediaElement:Se(),adapter:L,dashMetrics:V,mediaPlayerModel:O,events:u.Z,constants:a.Z,metricsConstants:s.Z})}}}(),function(){if(!C){var e=dashjs.MssHandler;"function"==typeof e&&(I.extend(e.errors),C=e(se).create({eventBus:le,mediaPlayerModel:O,dashMetrics:V,manifestModel:q,playbackController:G,streamController:U,protectionController:b,baseURLController:k,errHandler:M,events:u.Z,constants:a.Z,debug:ce,initSegmentType:D.w.INIT_SEGMENT_TYPE,BASE64:Qi,ISOBoxer:Ji,settings:ue}))}}(),U&&U.switchToVideoElement(y)),m&&we(),Oe(y)}function be(e){if(!p)throw re;var t=U.getActiveStreamInfo();return t?A.getTracksFor(e,t.id):[]}function Re(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:NaN;if(!h)throw oe;"string"==typeof e&&$.initialize(e),null==t&&(t=NaN),isNaN(t)||(t=Math.max(0,t)),y=t,r=e,(p||m)&&we(),de()&&Oe(y)}function Ie(){if(!p)throw re;var e=U.getActiveStreamInfo();return e?U.getStreamById(e.id):null}function we(){m=!1,p=!1,L.reset(),U.reset(),Z.reset(),Y.reset(),G.reset(),K.reset(),H.reset(),E.reset(),A.reset(),te.reset(),b&&(ue.get().streaming.protection.keepProtectionMediaKeys?b.stop():(b.reset(),b=null,Ce())),B.reset(),z.reset(),Q.reset()}function De(){return Dn(se).create({debug:ce,errHandler:M,dashMetrics:V,mediaPlayerModel:O,requestModifier:(0,W.Z)(se).getInstance(),mssHandler:C,settings:ue})}function Ce(){if(b)return b;var e=dashjs.Protection;if("function"==typeof e){var t=e(se).create();return u.Z.extend(e.events),d.Z.extend(e.events,{publicOnly:!0}),I.extend(e.errors),x||(x=(0,Ln.Z)(se).getInstance()),b=t.createProtectionSystem({debug:ce,errHandler:M,videoModel:J,customParametersModel:P,capabilities:x,eventBus:le,events:u.Z,BASE64:Qi,constants:a.Z,cmcdModel:z,settings:ue})}return null}function Ne(){if(!h)throw oe;if(N)return N;var e=dashjs.OfflineController;if("function"==typeof e){u.Z.extend(e.events),d.Z.extend(e.events,{publicOnly:!0}),I.extend(e.errors);var t=De(),r=Kt(se).create();return r.setConfig({manifestModel:q,adapter:L,manifestLoader:t,errHandler:M,contentSteeringController:H}),N=e(se).create({debug:ce,manifestUpdater:r,baseURLController:k,manifestLoader:t,manifestModel:q,mediaPlayerModel:O,abrController:E,playbackController:G,adapter:L,errHandler:M,dashMetrics:V,timelineConverter:_,segmentBaseController:te,schemeLoaderFactory:T,eventBus:le,events:u.Z,errors:I,constants:a.Z,settings:ue,dashConstants:o.Z,urlUtils:(0,X.Z)(se).getInstance()})}return null}function Le(e){var t=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,r=V.getCurrentDVRInfo(t);return r?e+(r.manifestInfo.availableFrom.getTime()/1e3+r.range.start):0}function Oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:NaN;N&&N.resetRecords(),!p&&r&&(p=!0,t.info("Streaming Initialized"),function(){var e=De();U||(U=$t(se).getInstance()),B||(B=Ta(se).create({errHandler:M,manifestModel:q,adapter:L,mediaController:A,videoModel:J,settings:ue})),F.setConfig({capabilities:x,customParametersModel:P,adapter:L,settings:ue,manifestModel:q,errHandler:M}),U.setConfig({capabilities:x,capabilitiesFilter:F,manifestLoader:e,manifestModel:q,mediaPlayerModel:O,customParametersModel:P,protectionController:b,textController:B,adapter:L,dashMetrics:V,errHandler:M,timelineConverter:_,videoModel:J,playbackController:G,serviceDescriptionController:K,contentSteeringController:H,abrController:E,mediaController:A,settings:ue,baseURLController:k,uriFragmentModel:$,segmentBaseController:te}),Z.setConfig({settings:ue,playbackController:G,streamController:U,videoModel:J,timelineConverter:_,adapter:L}),G.setConfig({streamController:U,serviceDescriptionController:K,dashMetrics:V,adapter:L,videoModel:J,timelineConverter:_,settings:ue}),Y.setConfig({streamController:U,playbackController:G,mediaPlayerModel:O,videoModel:J,settings:ue}),E.setConfig({streamController:U,domStorage:ee,mediaPlayerModel:O,customParametersModel:P,cmsdModel:Q,dashMetrics:V,adapter:L,videoModel:J,settings:ue}),z.setConfig({abrController:E,dashMetrics:V,playbackController:G}),Q.setConfig({}),E.initialize(),U.initialize(v,n),B.initialize(),Z.initialize(),Y.initialize(),z.initialize(),Q.initialize(),H.initialize(),te.initialize()}(),"string"==typeof r?U.load(r,e):U.loadWithManifest(r,e)),!m&&de()&&(m=!0,t.info("Playback Initialized"))}return e={initialize:function(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:NaN;x||(x=(0,Ln.Z)(se).getInstance()).setConfig({settings:ue}),M||(M=Nn(se).getInstance()),x.supportsMediaSource()?(h||(h=!0,_=Xi(se).getInstance(),E||(E=ei(se).getInstance()).setConfig({settings:ue}),T||(T=dt(se).getInstance()),G||(G=g(se).getInstance()),A||(A=gr(se).getInstance()),U||(U=$t(se).getInstance()),Z||(Z=tr(se).getInstance()),Y||(Y=nr(se).getInstance()),K||(K=lr(se).getInstance()),H||(H=Ut(se).getInstance()),F||(F=Pn(se).getInstance()),L=Li(se).getInstance(),q=Un(se).getInstance(),z=Ge(se).getInstance(),Q=it(se).getInstance(),V=zi(se).getInstance({settings:ue}),ee=fi(se).getInstance({settings:ue}),L.setConfig({constants:a.Z,cea608parser:i(),errHandler:M,BASE64:Qi}),k||(k=Dr(se).create()),k.setConfig({adapter:L,contentSteeringController:H}),K.setConfig({adapter:L}),te||(te=_i(se).getInstance({dashMetrics:V,mediaPlayerModel:O,errHandler:M,baseURLController:k,events:u.Z,eventBus:le,debug:ce,boxParser:(0,Ct.Z)(se).getInstance(),requestModifier:(0,W.Z)(se).getInstance(),errors:I})),A.setConfig({domStorage:ee,settings:ue,customParametersModel:P}),O.setConfig({playbackController:G,serviceDescriptionController:K}),H.setConfig({adapter:L,errHandler:M,dashMetrics:V,mediaPlayerModel:O,manifestModel:q,serviceDescriptionController:K,eventBus:le,requestModifier:(0,W.Z)(se).getInstance()}),Te(),Ee(void 0===n||n),Ne()),e&&Ae(e),r&&Re(r,o),t.info("[dash.js "+he()+"] MediaPlayer has been initialized")):M.error(new S.Z(I.CAPABILITY_MEDIASOURCE_ERROR_CODE,I.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(x=e.capabilities),e.capabilitiesFilter&&(F=e.capabilitiesFilter),e.streamController&&(U=e.streamController),e.textController&&(B=e.textController),e.gapController&&(Z=e.gapController),e.playbackController&&(G=e.playbackController),e.serviceDescriptionController&&(K=e.serviceDescriptionController),e.contentSteeringController&&(H=e.contentSteeringController),e.catchupController&&(Y=e.catchupController),e.mediaPlayerModel&&(O=e.mediaPlayerModel),e.customParametersModel&&(P=e.customParametersModel),e.abrController&&(E=e.abrController),e.schemeLoaderFactory&&(T=e.schemeLoaderFactory),e.mediaController&&(A=e.mediaController),e.settings&&(ue=e.settings))},on:function(e,t,r,n){le.on(e,t,r,n)},off:function(e,t,r){le.off(e,t,r)},extend:function(e,t,r){c.Z.extend(e,t,r,se)},attachView:Ae,attachSource:Re,isReady:de,preload:function(){if(!J.getElement()&&!p){if(!r)throw ae;Oe(y)}},play:function(){if(!m)throw ne;(!v||ge()&&m)&&G.play(!0)},isPaused:ge,pause:function(){if(!m)throw ne;G.pause()},isSeeking:function(){if(!m)throw ne;return G.isSeeking()},isDynamic:pe,getLowLatencyModeEnabled:function(){if(!m)throw ne;return G.getLowLatencyModeEnabled()},seek:function(e){if(!m)throw ne;if((0,j.PS)(e,"number"),isNaN(e))throw a.Z.BAD_ARGUMENT_ERROR;e<0&&(e=0);var t=G.getIsDynamic()?me(e):e,r=Se();!G.getIsDynamic()&&r.duration&&(t=Math.min(r.duration,t)),G.seek(t,!1,!1,!0)},seekToOriginalLive:function(){m&&pe()&&G.seekToOriginalLive()},setPlaybackRate:function(e){Se().playbackRate=e},getPlaybackRate:function(){return Se().playbackRate},setMute:function(e){(0,j.PS)(e,"boolean"),Se().muted=e},isMuted:function(){return Se().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw a.Z.BAD_ARGUMENT_ERROR;Se().volume=e},getVolume:function(){return Se().volume},time:ve,duration:ye,timeAsUTC:function(){if(!m)throw ne;return ve()<0?NaN:Le(ve())},durationAsUTC:function(){if(!m)throw ne;return Le(ye())},getActiveStream:Ie,getDVRWindowSize:function(){var e=U&&U.hasVideoTrack()?a.Z.VIDEO:a.Z.AUDIO,t=V.getCurrentDVRInfo(e);return t?t.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:me,getAvailableBaseUrls:function(){var e=q.getValue();return e?k.getBaseUrls(e):[]},getAvailableLocations:function(){var e=q.getValue();if(!e)return[];var t=L.getLocation(e),r=H.getSynthesizedLocationElements(t);return t.concat(r)},getTargetLiveDelay:function(){if(!m)throw ne;return G.getOriginalLiveDelay()},convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(r<10?"0"+r.toString():r.toString())+":"+(n<10?"0"+n.toString():n.toString())},formatUTC:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:r});return n?o+" "+a:o},getVersion:he,getDebug:function(){return ce},getBufferLength:function(e){var r=[a.Z.VIDEO,a.Z.AUDIO,a.Z.TEXT];if(e)return-1!==r.indexOf(e)?_e().getCurrentBufferLevel(e)||NaN:(t.warn("getBufferLength requested for invalid type"),NaN);var n=r.map((function(e){return be(e).length>0?_e().getCurrentBufferLevel(e):Number.MAX_VALUE})).reduce((function(e,t){return Math.min(e,t)}));return n===Number.MAX_VALUE?NaN:n},getTTMLRenderingDiv:function(){return J?J.getTTMLRenderingDiv():null},getVideoElement:Se,getSource:function(){if(!r)throw ae;return r},updateSource:function(e){r=e,U.load(r)},getCurrentLiveLatency:function(){if(!h)throw oe;return m?G.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!p)throw re;return E.getTopBitrateInfoFor(e)},setAutoPlay:Ee,getAutoPlay:function(){return v},getDashMetrics:_e,getQualityFor:function(e){if(!p)throw re;if(e===a.Z.IMAGE){var t=Ie();if(!t)return-1;var r=t.getThumbnailController();return r?r.getCurrentTrackIndex():-1}return E.getQualityFor(e)},setQualityFor:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!p)throw re;if(e===a.Z.IMAGE){var n=Ie();if(!n)return;var i=n.getThumbnailController();i&&i.setTrackByIndex(t)}E.setPlaybackQuality(e,U.getActiveStreamInfo(),t,{forceReplace:r})},updatePortalSize:function(){E.setElementSize(),E.setWindowResizeEventCalled(!0)},enableText:function(e){var t=U.getActiveStreamInfo();return!(!t||!B)&&B.enableText(t.id,e)},enableForcedTextStreaming:function(e){return!(!U.getActiveStreamInfo()||!B)&&B.enableForcedTextStreaming(e)},isTextEnabled:function(){var e=U.getActiveStreamInfo();return!(!e||!B)&&B.isTextEnabled(e)},setTextTrack:function(e){if(!m)throw ne;var t=U.getActiveStreamInfo();t&&B&&B.setTextTrack(t.id,e)},getBitrateInfoListFor:function(e){if(!p)throw re;var t=Ie();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!p)throw re;return L.getStreamsInfo(e)},getTracksFor:be,getTracksForTypeFromManifest:function(e,t,r){if(!p)throw re;return(r=r||L.getStreamsInfo(t,1)[0])?L.getAllMediaInfoForType(r,e,t):[]},getCurrentTrackFor:function(e){if(!p)throw re;var t=U.getActiveStreamInfo();return A.getCurrentTrackFor(e,t.id)},setInitialMediaSettingsFor:function(e,t){if(!h)throw oe;A.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!h)throw oe;return A.getInitialSettings(e)},setCurrentTrack:function(e){if(!p)throw re;A.setTrack(e)},addABRCustomRule:function(e,t,r){P.addAbrCustomRule(e,t,r)},removeABRCustomRule:function(e){P.removeAbrCustomRule(e)},removeAllABRCustomRule:function(){P.removeAllAbrCustomRule()},getABRCustomRules:function(){return P.getAbrCustomRules()},getAverageThroughput:function(e){var t=E.getThroughputHistory(),r=G.getIsDynamic();return t?t.getAverageThroughput(e,r):0},retrieveManifest:function(e,t){var r=De(),n=this;le.on(u.Z.INTERNAL_MANIFEST_LOADED,(function e(i){i.error?t(null,i.error):t(i.manifest),le.off(u.Z.INTERNAL_MANIFEST_LOADED,e,n),r.reset()}),n),$.initialize(e),r.load(e)},addUTCTimingSource:function(e,t){P.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){P.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){P.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:Te,setXHRWithCredentialsForType:function(e,t){P.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return P.getXHRWithCredentialsForType(e)},getProtectionController:function(){return Ce()},attachProtectionController:function(e){b=e},setProtectionData:function(e){n=e,U&&U.setProtectionData(n)},registerLicenseRequestFilter:function(e){P.registerLicenseRequestFilter(e)},registerLicenseResponseFilter:function(e){P.registerLicenseResponseFilter(e)},unregisterLicenseRequestFilter:function(e){P.unregisterLicenseRequestFilter(e)},unregisterLicenseResponseFilter:function(e){P.unregisterLicenseResponseFilter(e)},registerCustomCapabilitiesFilter:function(e){P.registerCustomCapabilitiesFilter(e)},unregisterCustomCapabilitiesFilter:function(e){P.unregisterCustomCapabilitiesFilter(e)},setCustomInitialTrackSelectionFunction:function(e){P.setCustomInitialTrackSelectionFunction(e)},resetCustomInitialTrackSelectionFunction:function(){P.resetCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(e){if(!J.getElement())throw ie;J.setTTMLRenderingDiv(e)},attachVttRenderingDiv:function(e){if(!J.getElement())throw ie;J.setVttRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=U.getActiveStreamInfo();if(e&&B)return B.getCurrentTrackIdx(e.id)},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var r=G.getIsDynamic()?me(e):e,n=U.getStreamForTime(r);if(null!==n){var i=n.getThumbnailController();if(i)return i.provide(r,t);t(null)}else t(null)}},getDashAdapter:function(){return L},getOfflineController:function(){return Ne()},triggerSteeringRequest:function(){if(H)return H.loadSteeringData()},getCurrentSteeringResponseData:function(){if(H)return H.getCurrentSteeringResponseData()},getSettings:function(){return ue.get()},updateSettings:function(e){ue.update(e)},resetSettings:function(){ue.reset()},reset:fe,destroy:function(){fe(),c.Z.deleteSingletonInstances(se)}},t=ce.getLogger(e),h=!1,m=!1,p=!1,v=!0,y=NaN,b=null,N=null,n=null,L=null,te=null,u.Z.extend(d.Z),O=Gn(se).getInstance(),P=(0,st.Z)(se).getInstance(),J=ni(se).getInstance(),$=xn(se).getInstance(),e}_a.__dashjs_factory_name="MediaPlayer";var Sa=c.Z.getClassFactory(_a);Sa.events=d.Z,Sa.errors=I,c.Z.updateClassFactory(_a.__dashjs_factory_name,Sa);const Aa=Sa},8825:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}r.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=o(t);if(r){var i=o(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=n.call(this)).AST_IN_FUTURE="astInFuture",e.BASE_URLS_UPDATED="baseUrlsUpdated",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADING_STARTED="manifestLoadingStarted",e.MANIFEST_LOADING_FINISHED="manifestLoadingFinished",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.THROUGHPUT_MEASUREMENT_STORED="throughputMeasurementStored",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",e.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",e.INBAND_PRFT="inbandPrft",e}return s}(r(8342).Z))},3393:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}())},3860:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}())},8080:(e,t,r)=>{"use strict";r.d(t,{default:()=>q});var n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};n.SSL_CONNECTION_FAILED_PREFIX="SSL",n.DNS_RESOLUTION_FAILED="C00",n.HOST_UNREACHABLE="C01",n.CONNECTION_REFUSED="C02",n.CONNECTION_ERROR="C03",n.CORRUPT_MEDIA_ISOBMFF="M00",n.CORRUPT_MEDIA_OTHER="M01",n.BASE_URL_CHANGED="F00",n.BECAME_REPORTER="S00";const i=n;var a=r(1180);function o(e){var t,r,n=(e=e||{}).eventBus,o=e.dashMetrics,s=e.metricsConstants,l=e.events;function u(e){var t=new i;if(r){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=r.originalUrl||r.url),t.terror||(t.terror=new Date),o.addDVBErrors(t)}}function c(e){e.error||(r=e.manifest)}function f(e){u({errorcode:i.BASE_URL_CHANGED,servicelocation:e.entry})}function d(){u({errorcode:i.BECAME_REPORTER})}function h(e){var t;e.metric===s.HTTP_REQUEST&&(0===(t=e.value).responsecode||null==t.responsecode||t.responsecode>=400||t.responsecode<100||t.responsecode>=600)&&u({errorcode:t.responsecode||i.CONNECTION_ERROR,url:t.url,terror:t.tresponse,servicelocation:t._serviceLocation})}function g(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=i.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=i.CORRUPT_MEDIA_OTHER;break;default:return}u({errorcode:t})}return t={initialize:function(){n.on(l.MANIFEST_UPDATED,c,t),n.on(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,t),n.on(l.METRIC_ADDED,h,t),n.on(l.METRIC_UPDATED,h,t),n.on(l.PLAYBACK_ERROR,g,t),n.on(a.Z.BECAME_REPORTING_PLAYER,d,t)},reset:function(){n.off(l.MANIFEST_UPDATED,c,t),n.off(l.SERVICE_LOCATION_BASE_URL_BLACKLIST_CHANGED,f,t),n.off(l.METRIC_ADDED,h,t),n.off(l.METRIC_UPDATED,h,t),n.off(l.PLAYBACK_ERROR,g,t),n.off(a.Z.BECAME_REPORTING_PLAYER,d,t)}}}o.__dashjs_factory_name="DVBErrorsTranslator";const s=dashjs.FactoryMaker.getSingletonFactory(o);var l=r(2295);function u(e){e=e||{};var t,r,n=!1,i=this.context,a=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach((function(e){var t=e.starttime,n=t+e.duration;r.add(t,n)})),n=!!e[0]._useWallClockTime)},reset:function(){r.clear()},isEnabled:function(){var e,t=r.length;if(!t)return!0;e=n?(new Date).getTime()/1e3:a.currentTime;for(var i=0;i<t;i+=1){var o=r.start(i),s=r.end(i);if(o<=e&&e<s)return!0}return!1}},r=(0,l.Z)(i).create(),t}u.__dashjs_factory_name="RangeController";const c=dashjs.FactoryMaker.getClassFactory(u);function f(){return{serialise:function e(t){var r,n,i=[],a=[];for(r in t)if(t.hasOwnProperty(r)&&0!==r.indexOf("_")){if(null==(n=t[r])&&(n=""),Array.isArray(n)){if(!n.length)continue;a=[],n.forEach((function(t){var r="Object"!==Object.prototype.toString.call(t).slice(8,-1);a.push(r?t:e(t))})),n=a.map(encodeURIComponent).join(",")}else"string"==typeof n?n=encodeURIComponent(n):n instanceof Date?n=n.toISOString():"number"==typeof n&&(n=Math.round(n));i.push(r+"="+n)}return i.join("&")}}}f.__dashjs_factory_name="MetricSerialiser";const d=dashjs.FactoryMaker.getSingletonFactory(f);function h(){var e,t,r,n=window.crypto||window.msCrypto,i=Uint32Array,a=Math.pow(2,8*i.BYTES_PER_ELEMENT)-1;function o(){n&&(e||(e=new i(10)),n.getRandomValues(e),t=0)}return r={random:function(r,i){var s;return r||(r=0),i||(i=1),n?(t===e.length&&o(),s=e[t]/a,t+=1):s=Math.random(),s*(i-r)+r}},o(),r}h.__dashjs_factory_name="RNG";const g=dashjs.FactoryMaker.getSingletonFactory(h);var p=r(5717);function m(e){var t;e=e||{};var r,n,i,a,o,s,l,u=this.context,c=[],f=e.metricsConstants;function h(){a=!1,o=!1,s=null,l=null}return t={report:function(e,t){Array.isArray(t)||(t=[t]),o&&l.isEnabled()&&t.forEach((function(t){var i=r.serialise(t);e!==f.DVB_ERRORS&&(i="metricname=".concat(e,"&").concat(i)),function(e,t,r){var i=new XMLHttpRequest;i.withCredentials=n.getXHRWithCredentialsForType(f.HTTP_REQUEST_DVB_REPORTING_TYPE);var a=function(){var e=c.indexOf(i);-1!==e&&(c.splice(e,1),!(i.status>=200&&i.status<300)&&r&&r())};c.push(i);try{i.open("GET",e),i.onloadend=a,i.onerror=a,i.send()}catch(e){i.onerror()}}(i="".concat(s,"?").concat(i),0,(function(){o=!1}))}))},initialize:function(e,t){var r;if(l=t,!(s=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");a||((r=e.dvb_probability)&&(1e3===r||r/1e3>=i.random())&&(o=!0),a=!0)},reset:function(){h()}},r=d(u).getInstance(),i=g(u).getInstance(),n=(0,p.Z)(u).getInstance(),h(),t}m.__dashjs_factory_name="DVBReporting";const v=dashjs.FactoryMaker.getClassFactory(m);function y(e){e=e||{};var t={"urn:dvb:dash:reporting:2014":v},r=this.context,n=e.debug?e.debug.getLogger(void 0):{},i=e.metricsConstants,a=e.mediaPlayerModel||{};return{create:function(e,o){var s;try{(s=t[e.schemeIdUri](r).create({metricsConstants:i,mediaPlayerModel:a})).initialize(e,o)}catch(o){s=null,n.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(e.schemeIdUri," (").concat(o.message,")"))}return s},register:function(e,r){t[e]=r},unregister:function(e){delete t[e]}}}y.__dashjs_factory_name="ReportingFactory";const E=dashjs.FactoryMaker.getSingletonFactory(y);function T(e){var t=[],r=E(this.context).getInstance(e);return{initialize:function(e,n){e.some((function(e){var i=r.create(e,n);if(i)return t.push(i),!0}))},reset:function(){t.forEach((function(e){return e.reset()})),t=[]},report:function(e,r){t.forEach((function(t){return t.report(e,r)}))}}}T.__dashjs_factory_name="ReportingController";const _=dashjs.FactoryMaker.getClassFactory(T);function S(){return{reconstructFullMetricName:function(e,t,r){var n=e;return t&&(n+="("+t,r&&r.length&&(n+=","+r),n+=")"),n},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}S.__dashjs_factory_name="HandlerHelpers";const A=dashjs.FactoryMaker.getSingletonFactory(S);function b(e){var t,r,n,i,a;e=e||{};var o=this.context,s=A(o).getInstance(),l=[],u=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map((function(e){return l[e]})).reduce((function(e,t){return e.level<t.level?e:t}))}catch(e){return}}();e&&a!==e.t&&(a=e.t,t.report(n,e))}return{initialize:function(e,a,o){a&&(r=s.validateN(o),t=a,n=s.reconstructFullMetricName(e,o),i=setInterval(c,r))},reset:function(){clearInterval(i),i=null,r=0,t=null,a=null},handleNewMetric:function(e,t,r){e===u.BUFFER_LEVEL&&(l[r]=t)}}}b.__dashjs_factory_name="BufferLevelHandler";const R=dashjs.FactoryMaker.getClassFactory(b),I=dashjs.FactoryMaker.getClassFactory((function(e){var t,r=(e=e||{}).eventBus,n=e.metricsConstants;function i(){r.off(a.Z.METRICS_INITIALISATION_COMPLETE,i,this),r.trigger(a.Z.BECAME_REPORTING_PLAYER)}return{initialize:function(e,n){n&&(t=n,r.on(a.Z.METRICS_INITIALISATION_COMPLETE,i,this))},reset:function(){t=null},handleNewMetric:function(e,r){e===n.DVB_ERRORS&&t&&t.report(e,r)}}}));function w(e){var t,r,n,i,a;e=e||{};var o=[],s=A(this.context).getInstance(),l=e.metricsConstants;function u(){var e=o;e.length&&t&&t.report(i,e),o=[]}return{initialize:function(e,o,l,c){o&&(r=s.validateN(l),t=o,c&&c.length&&(n=c),i=s.reconstructFullMetricName(e,l,c),a=setInterval(u,r))},reset:function(){clearInterval(a),a=null,r=null,n=null,o=[],t=null},handleNewMetric:function(e,t){e===l.HTTP_REQUEST&&(n&&n!==t.type||o.push(t))}}}w.__dashjs_factory_name="HttpListHandler";const D=dashjs.FactoryMaker.getClassFactory(w);function C(){var e,t;return{initialize:function(r,n){e=r,t=n},reset:function(){t=null,e=void 0},handleNewMetric:function(r,n){r===e&&t&&t.report(e,n)}}}C.__dashjs_factory_name="GenericMetricHandler";const N=dashjs.FactoryMaker.getClassFactory(C);function L(e){var t=(e=e||{}).debug?e.debug.getLogger(void 0):{},r=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,n=this.context,i={BufferLevel:R,DVBErrors:I,HttpList:D,PlayList:N,RepSwitchList:N,TcpList:N};return{create:function(a,o){var s,l=a.match(r);if(l){try{(s=i[l[1]](n).create({eventBus:e.eventBus,metricsConstants:e.metricsConstants})).initialize(l[1],o,l[3],l[5])}catch(e){s=null,t.error("MetricsHandlerFactory: Could not create handler for type ".concat(l[1]," with args ").concat(l[3],", ").concat(l[5]," (").concat(e.message,")"))}return s}},register:function(e,t){i[e]=t},unregister:function(e){delete i[e]}}}L.__dashjs_factory_name="MetricsHandlerFactory";const O=dashjs.FactoryMaker.getSingletonFactory(L);function P(e){e=e||{};var t,r=[],n=this.context,i=e.eventBus,a=e.events,o=O(n).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function s(e){r.forEach((function(t){t.handleNewMetric(e.metric,e.value,e.mediaType)}))}return t={initialize:function(e,n){e.split(",").forEach((function(e,t,i){var a;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var s=i[t+1];s&&-1===s.indexOf("(")&&-1!==s.indexOf(")")&&(e+=","+s,delete i[t+1])}(a=o.create(e,n))&&r.push(a)})),i.on(a.METRIC_ADDED,s,t),i.on(a.METRIC_UPDATED,s,t)},reset:function(){i.off(a.METRIC_ADDED,s,t),i.off(a.METRIC_UPDATED,s,t),r.forEach((function(e){return e.reset()})),r=[]}}}P.__dashjs_factory_name="MetricsHandlersController";const M=dashjs.FactoryMaker.getClassFactory(P);function k(e){var t,r,n;e=e||{};var i=this.context;function a(){t&&t.reset(),r&&r.reset(),n&&n.reset()}return{initialize:function(o){try{(n=c(i).create({mediaElement:e.mediaElement})).initialize(o.Range),(r=_(i).create({debug:e.debug,metricsConstants:e.metricsConstants,mediaPlayerModel:e.mediaPlayerModel})).initialize(o.Reporting,n),(t=M(i).create({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants,events:e.events})).initialize(o.metrics,r)}catch(e){throw a(),e}},reset:a}}k.__dashjs_factory_name="MetricsController";const x=dashjs.FactoryMaker.getClassFactory(k),F=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]},U=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1},B=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3};function Z(e){var t=(e=e||{}).adapter,r=e.constants;return{getMetrics:function(e){var n=[];return e&&e.Metrics_asArray&&e.Metrics_asArray.forEach((function(i){var a=new F,o=t.getIsDynamic(e);i.hasOwnProperty("metrics")&&(a.metrics=i.metrics,i.Range_asArray&&i.Range_asArray.forEach((function(n){var i=new U;i.starttime=function(e,n,i){var a,o,s=0;return n?s=t.getAvailabilityStartTime(e)/1e3:(a=t.getRegularPeriods(e)).length&&(s=a[0].start),o=s,i&&i.hasOwnProperty(r.START_TIME)&&(o+=i.starttime),o}(e,o,n),n.hasOwnProperty("duration")?i.duration=n.duration:i.duration=t.getDuration(e),i._useWallClockTime=o,a.Range.push(i)})),i.Reporting_asArray&&(i.Reporting_asArray.forEach((function(e){var t=new B;e.hasOwnProperty(r.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(r.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[r.DVB_REPORTING_URL]),e.hasOwnProperty(r.DVB_PROBABILITY)&&(t.dvb_probability=e[r.DVB_PROBABILITY]),a.Reporting.push(t))})),n.push(a)))})),n}}}Z.__dashjs_factory_name="ManifestParsing";const G=dashjs.FactoryMaker.getSingletonFactory(Z);function K(e){var t;e=e||{};var r={},n=this.context,i=e.eventBus,o=e.events;function s(t){if(!t.error){var o=Object.keys(r);G(n).getInstance({adapter:e.adapter,constants:e.constants}).getMetrics(t.manifest).forEach((function(t){var i=JSON.stringify(t);if(r.hasOwnProperty(i))o.splice(i,1);else try{var a=x(n).create(e);a.initialize(t),r[i]=a}catch(e){}})),o.forEach((function(e){r[e].reset(),delete r[e]})),i.trigger(a.Z.METRICS_INITIALISATION_COMPLETE)}}function l(){Object.keys(r).forEach((function(e){r[e].reset()})),r={}}return t={reset:function(){i.off(o.MANIFEST_UPDATED,s,t),i.off(o.STREAM_TEARDOWN_COMPLETE,l,t)}},i.on(o.MANIFEST_UPDATED,s,t),i.on(o.STREAM_TEARDOWN_COMPLETE,l,t),t}K.__dashjs_factory_name="MetricsCollectionController";const H=dashjs.FactoryMaker.getClassFactory(K);function Y(){var e=this.context;return{createMetricsReporting:function(t){return s(e).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}).initialize(),H(e).create(t)},getReportingFactory:function(){return E(e).getInstance()},getMetricsHandlerFactory:function(){return O(e).getInstance()}}}Y.__dashjs_factory_name="MetricsReporting";var V=dashjs.FactoryMaker.getClassFactory(Y);V.events=a.Z,dashjs.FactoryMaker.updateClassFactory(Y.__dashjs_factory_name,V);const q=V},1180:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}r.d(t,{Z:()=>s});const s=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(s,e);var t,r,n=(t=s,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=o(t);if(r){var i=o(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return a(this,e)});function s(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(e=n.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return s}(r(8342).Z))},5717:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(2610),i=r(5448),a=r(1264),o=r(3106),s=r(1767),l=r(3393);function u(){var e,t,r,i,u,c,f,d,h=this.context,g=(0,a.Z)(h).getInstance();function p(){i=[],u=[],c=[],d=[],f=null,t=[]}function m(e,t){var r=-1;e.some((function(e,n){if(e===t)return r=n,!0})),r<0||e.splice(r,1)}function v(e){var t;for(t=0;t<d.length;t++)if(d[t].rulename===e)return t;return-1}function y(e,r){E(e,r);var i=new n.Z;i.schemeIdUri=e,i.value=r,t.push(i)}function E(e,r){(0,o.PS)(e,"string"),(0,o.PS)(r,"string"),t.forEach((function(n,i){n.schemeIdUri===e&&n.value===r&&t.splice(i,1)}))}return e={getCustomInitialTrackSelectionFunction:function(){return f},setCustomInitialTrackSelectionFunction:function(e){f=e},resetCustomInitialTrackSelectionFunction:function(){f=null},getLicenseResponseFilters:function(){return u},getLicenseRequestFilters:function(){return i},getCustomCapabilitiesFilters:function(){return c},registerCustomCapabilitiesFilter:function(e){c.push(e)},registerLicenseResponseFilter:function(e){u.push(e)},registerLicenseRequestFilter:function(e){i.push(e)},unregisterCustomCapabilitiesFilter:function(e){m(c,e)},unregisterLicenseResponseFilter:function(e){m(u,e)},unregisterLicenseRequestFilter:function(e){m(i,e)},addAbrCustomRule:function(e,t,r){if("string"!=typeof e||e!==s.Z.ABANDON_FRAGMENT_RULES&&e!==s.Z.QUALITY_SWITCH_RULES||"string"!=typeof t)throw l.Z.BAD_ARGUMENT_ERROR;var n=v(t);-1===n?d.push({type:e,rulename:t,rule:r}):(d[n].type=e,d[n].rule=r)},removeAllAbrCustomRule:function(){d=[]},removeAbrCustomRule:function(e){if(e){var t=v(e);-1!==t&&d.splice(t,1)}else d=[]},getAbrCustomRules:function(){return d},addUTCTimingSource:y,removeUTCTimingSource:E,getUTCTimingSources:function(){return t},clearDefaultUTCTimingSources:function(){t=[]},restoreDefaultUTCTimingSources:function(){var e=g.get().streaming.utcSynchronization.defaultTimingSource;y(e.scheme,e.value)},setXHRWithCredentialsForType:function e(t,n){t?r[t]=!!n:Object.keys(r).forEach((function(t){e(t,n)}))},getXHRWithCredentialsForType:function(e){var t=r[e];return void 0===t?r.default:t},setConfig:function(){},reset:function(){p()}},r={default:!1},p(),e}u.__dashjs_factory_name="CustomParametersModel";const c=i.Z.getSingletonFactory(u)},9032:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(7473);function a(e){var t=(e=e||{}).requestModifier;function r(e){var r=new Date,n=e.request,i=new XMLHttpRequest;if(i.open(e.method,e.url,!0),n.responseType&&(i.responseType=n.responseType),n.range&&i.setRequestHeader("Range","bytes="+n.range),n.requestStartDate||(n.requestStartDate=r),t&&t.modifyRequestHeader&&(i=t.modifyRequestHeader(i,{url:e.url})),e.headers)for(var a in e.headers){var o=e.headers[a];o&&i.setRequestHeader(a,o)}i.withCredentials=e.withCredentials,i.onload=e.onload,i.onloadend=e.onend,i.onerror=e.onerror,i.onprogress=e.progress,i.onabort=e.onabort,i.ontimeout=e.ontimeout,i.timeout=e.timeout,i.send(),e.response=i}return{load:function(e){t&&t.modifyRequest?(0,i.k)(e,t).then((function(){return r(e)})):r(e)},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}a.__dashjs_factory_name="XHRLoader";const o=n.Z.getClassFactory(a)},1737:(e,t,r)=>{"use strict";r.d(t,{default:()=>ye});var n={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]};const i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t;return t=[{key:"findCencContentProtection",value:function(e){for(var t=null,r=0;r<e.length;++r){var n=e[r];"urn:mpeg:dash:mp4protection:2011"!==n.schemeIdUri.toLowerCase()||"cenc"!==n.value.toLowerCase()&&"cbcs"!==n.value.toLowerCase()||(t=n)}return t}},{key:"getPSSHData",value:function(e){var t=8,r=new DataView(e),n=r.getUint8(t);return t+=20,n>0&&(t+=4+16*r.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(t,r){var n=e.parsePSSHList(r);return t&&n.hasOwnProperty(t.uuid.toLowerCase())?n[t.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),r={},n=0;;){var i,a,o=void 0,s=n;if(n>=t.buffer.byteLength)break;if(i=n+t.getUint32(n),n+=4,1886614376===t.getUint32(n))if(n+=4,0===(a=t.getUint8(n))||1===a){n++,n+=3,o="";var l=void 0,u=void 0;for(l=0;l<4;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=4,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;for(n+=2,o+="-",l=0;l<6;l++)o+=1===(u=t.getUint8(n+l).toString(16)).length?"0"+u:u;n+=6,n+=4,r[o=o.toLowerCase()]=t.buffer.slice(s,i),n=i}else n=i;else n=i}return r}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var r=0,i=null;r<e.length&&!i;){var a=e[r];if(a&&a.contentProtection&&a.contentProtection.length>0){var o=a.contentProtection.filter((function(e){return e.schemeIdUri&&e.schemeIdUri===t}));if(o&&o.length>0)for(var s=0;s<o.length&&!i;){for(var l=o[s],u=0;u<n.attributes.length&&!i;){for(var c=0,f=n.attributes[u];c<n.prefixes.length&&!i;){var d=n.prefixes[c];l[f]&&l[f].__prefix&&l[f].__prefix===d&&l[f].__text&&(i=l[f].__text),c+=1}u+=1}s+=1}}r+=1}return i}catch(e){return null}}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e,t),e}(),a=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=r},o=function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),r&&r.length&&(this.videoCapabilities=r),this.distinctiveIdentifier=n,this.persistentState=i,this.sessionTypes=a};function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}const c=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=u(t);if(r){var i=u(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=n.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return i}(r(2230).Z));var f=r(5459);const d=function e(t,r,n,i,a,o,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.method=r,this.responseType=n,this.headers=i,this.withCredentials=a,this.messageType=o,this.sessionId=s,this.data=l},h=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.headers=r,this.data=n};var g=r(7855),p=r(703),m=r(3393),v=r(5448);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function E(e){var t,r,n,s,l,u,v,E,T,_,S,A=(e=e||{}).protectionKeyController,b=e.protectionModel,R=e.eventBus,I=e.events,w=e.debug,D=e.BASE64,C=e.constants,N=[],L=e.cmcdModel,O=e.settings,P=e.customParametersModel;function M(){if(!(R&&R.hasOwnProperty("on")&&A&&A.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function k(e,t){E||T?E&&x():function(e,t){if(!T){T=!0;var n,i=[];e=e.sort((function(t,r){return(l&&l[t.ks.systemString]&&l[t.ks.systemString].priority>=0?l[t.ks.systemString].priority:e.length)-(l&&l[r.ks.systemString]&&l[r.ks.systemString].priority>=0?l[r.ks.systemString].priority:e.length)}));for(var a=0;a<e.length;a++){var o=H(e[a]);i.push({ks:e[a].ks,configs:[o],protData:e[a].protData})}b.requestKeySystemAccess(i).then((function(e){var t=(n=e.data).mksa&&n.mksa.selectedSystemString?n.mksa.selectedSystemString:n.keySystem.systemString;return r.info("DRM: KeySystem Access Granted for system string ("+t+")!  Selecting key system..."),b.selectKeySystem(n)})).then((function(e){if(E=e,T=!1,b){R.trigger(I.KEY_SYSTEM_SELECTED,{data:n});var t=Z(E);t&&t.serverCertificate&&t.serverCertificate.length>0&&b.setServerCertificate(D.decodeArray(t.serverCertificate).buffer),x()}})).catch((function(e){E=null,T=!1,t||R.trigger(I.KEY_SYSTEM_SELECTED,{data:null,error:new f.Z(c.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,c.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)})}))}}(e,t)}function x(){for(var e,t=0;t<n.length;t++)for(e=0;e<n[t].length;e++)if(E===n[t][e].ks){F(n[t][e]);break}n=[]}function F(e){if(A.isClearKey(E)&&e.protData&&e.protData.hasOwnProperty("clearkeys")&&0!==Object.keys(e.protData.clearkeys).length){var t={kids:Object.keys(e.protData.clearkeys)};e.initData=(new TextEncoder).encode(JSON.stringify(t))}e.sessionId?U(e):null!==e.initData&&B(e)}function U(e){M(),b.loadKeySession(e)}function B(e){var t=i.getPSSHForKeySystem(E,e?e.initData:null);if(t){if(function(e){if(!e)return!1;try{for(var t=b.getSessions(),r=0;r<t.length;r++)if(t[r].getKeyId()===e)return!0;return!1}catch(e){return!1}}(e.keyId))return;if(G(t))return;try{e.initData=t,b.createKeySession(e)}catch(e){R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new f.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e&&e.initData?b.createKeySession(e):R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new f.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(E?E.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function Z(e){if(e){var t=e.systemString;if(l)return t in l?l[t]:null}return null}function G(e){if(!e)return!1;try{for(var t=b.getAllInitData(),n=0;n<t.length;n++)if(A.initDataEquals(e,t[n]))return r.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch(e){return!1}}function K(e){M(),e?(b.setMediaElement(e),R.on(I.NEED_KEY,J,t)):null===e&&(b.setMediaElement(e),R.off(I.NEED_KEY,J,t))}function H(e){var t=e.protData,r=[],n=[],i=t&&t.audioRobustness&&t.audioRobustness.length>0?t.audioRobustness:v,l=t&&t.videoRobustness&&t.videoRobustness.length>0?t.videoRobustness:v,u=e.sessionType,c=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",f=t&&t.persistentState?t.persistentState:"temporary"===u?"optional":"required";return s.forEach((function(e){e.type===C.AUDIO?r.push(new a(e.codec,i)):e.type===C.VIDEO&&n.push(new a(e.codec,l))})),new o(r,n,c,f,[u])}function Y(e){e.error?R.trigger(I.KEY_STATUSES_CHANGED,{data:null,error:e.error}):r.debug("DRM: key status = "+e.status)}function V(e){r.debug("DRM: onKeyMessage");var t=e.data;R.trigger(I.KEY_MESSAGE,{data:t});var n=t.messageType?t.messageType:"license-request",a=t.message,o=t.sessionToken,l=Z(E),u=A.getLicenseServerModelInstance(E,l,n),m={sessionToken:o,messageType:n};if(a&&0!==a.byteLength){if(!u)return r.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+o.getSessionId()),void q(m);if(A.isClearKey(E)){var v=A.processClearKeyLicenseRequest(E,l,a);if(v&&v.keyPairs&&v.keyPairs.length>0)return r.debug("DRM: ClearKey license request handled by application!"),q(m),void b.updateKeySession(o,v)}!function(e,t,r){var n=e.sessionToken,a=e.messageType?e.messageType:"license-request",o={sessionToken:n,messageType:a},l=E?E.systemString:null,u=function(e,t,r,n,a){var o=null,l=n.message;if(e&&e.serverURL){var u=e.serverURL;"string"==typeof u&&""!==u?o=u:"object"===y(u)&&u.hasOwnProperty(t)&&(o=u[t])}else if(e&&e.laURL&&""!==e.laURL)o=e.laURL;else if(!(o=i.getLicenseServerUrlFromMediaInfo(s,E.schemeIdURI))&&!A.isClearKey(E)){var c=i.getPSSHData(r.initData);(o=E.getLicenseServerURLFromInitData(c))||(o=n.laURL)}return a.getServerURLFromMessage(o,l,t)}(r,a,n,e,t);if(u){var m={},v=!1;r&&W(m,r.httpRequestHeaders);var T=e.message;W(m,E.getRequestHeadersFromMessage(T)),Object.keys(m).forEach((function(e){"authorization"===e.toLowerCase()&&(v=!0)})),r&&"boolean"==typeof r.withCredentials&&(v=r.withCredentials);var _=function(e){if(b)if(e.status>=200&&e.status<=299){var r=p.Z.parseHttpHeaders(e.getAllResponseHeaders?e.getAllResponseHeaders():null),i=new h(e.responseURL,r,e.response);Q(P.getLicenseResponseFilters(),i).then((function(){var r=t.getLicenseMessage(i.data,l,a);null!==r?(q(o),b.updateKeySession(n,r)):X(e,o,l,a,t)}))}else X(e,o,l,a,t)},S=function(e){q(o,new f.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},R=function(e){q(o,new f.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+l+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))},I=E.getLicenseRequestFromMessage(T),w=t.getHTTPMethod(a),D=t.getResponseType(l,a),C=r&&!isNaN(r.httpTimeout)?r.httpTimeout:8e3,N=n.getSessionId()||null,L=new d(u,w,D,m,v,a,N,I),M=isNaN(O.get().streaming.retryAttempts[g.w.LICENSE])?3:O.get().streaming.retryAttempts[g.w.LICENSE];Q(P.getLicenseRequestFilters(),L).then((function(){j(L,M,C,_,S,R)}))}else q(o,new f.Z(c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,c.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE))}(t,u,l)}else q(m,new f.Z(c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,c.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function q(e,t){R.trigger(I.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function j(e,t,n,i,a,o){var s=new XMLHttpRequest;if(O.get().streaming.cmcd&&O.get().streaming.cmcd.enabled&&O.get().streaming.cmcd.mode===m.Z.CMCD_MODE_QUERY){var l=L.getQueryParameter({url:e.url,type:g.w.LICENSE});l&&(e.url=p.Z.addAditionalQueryParameterToUrl(e.url,[l]))}for(var u in s.open(e.method,e.url,!0),s.responseType=e.responseType,s.withCredentials=e.withCredentials,n>0&&(s.timeout=n),e.headers)s.setRequestHeader(u,e.headers[u]);if(O.get().streaming.cmcd&&O.get().streaming.cmcd.enabled&&O.get().streaming.cmcd.mode===m.Z.CMCD_MODE_HEADER){var c=L.getHeaderParameters({url:e.url,type:g.w.LICENSE});if(c)for(var f in c){var d=c[f];d&&s.setRequestHeader(f,d)}}var h=function(){t--;var r=isNaN(O.get().streaming.retryIntervals[g.w.LICENSE])?1e3:O.get().streaming.retryIntervals[g.w.LICENSE];S=setTimeout((function(){j(e,t,n,i,a,o)}),r)};s.onload=function(){_=null,this.status>=200&&this.status<=299||t<=0?i(this):(r.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+t),h())},s.ontimeout=s.onerror=function(){_=null,t<=0?o(this):(r.warn("License request network request failed . Retrying it... Pending retries: "+t),h())},s.onabort=function(){a(this)},R.trigger(I.LICENSE_REQUEST_SENDING,{url:e.url,headers:e.headers,payload:e.data,sessionId:e.sessionId}),_=s,s.send(e.data)}function z(){_&&(_.onloadend=_.onerror=_.onprogress=void 0,_.abort(),_=null),S&&(clearTimeout(S),S=null)}function W(e,t){if(t)for(var r in t)e[r]=t[r]}function X(e,t,r,n,i){var a="NONE",o=null;e.response&&(a=i.getErrorResponse(e.response,r,n),o={serverResponse:e.response||null,responseCode:e.status||null,responseText:e.statusText||null}),q(t,new f.Z(c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,c.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+r+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+a,o))}function Q(e,t){return e?e.reduce((function(e,r){return e.then((function(){return r(t)}))}),Promise.resolve()):Promise.resolve()}function J(e,t){if(!O.get().streaming.protection.ignoreEmeEncryptedEvent){if(r.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void r.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===s.length&&(r.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))return void N.push(setTimeout((function(){J(e,t)}),500));var a=e.key.initData;if(ArrayBuffer.isView(a)&&(a=a.buffer),E){var o=i.getPSSHForKeySystem(E,a);if(o&&G(o))return}r.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(a)));var c=A.getSupportedKeySystemsFromSegmentPssh(a,l,u);if(0===c.length)return void r.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");!function(e){n.push(e),k(e,!1)}(c)}}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");M(),s.push(e)},clearMediaInfoArray:function(){s=[]},handleKeySystemFromManifest:function(){if(s&&0!==s.length){var e=[];s.forEach((function(t){var r=A.getSupportedKeySystemsFromContentProtection(t.contentProtection,l,u);r.length>0&&(0===e.length&&(e=r),n.push(r))})),e&&e.length>0&&k(e,!0)}},createKeySession:B,loadKeySession:U,removeKeySession:function(e){M(),b.removeKeySession(e)},closeKeySession:function(e){M(),b.closeKeySession(e)},setServerCertificate:function(e){M(),b.setServerCertificate(e)},setMediaElement:K,setSessionType:function(e){u=e},setRobustnessLevel:function(e){v=e},setProtectionData:function(e){l=e,A.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return M(),A.getSupportedKeySystemsFromContentProtection(e,l,u)},getKeySystems:function(){return A?A.getKeySystems():[]},setKeySystems:function(e){A&&A.setKeySystems(e)},stop:function(){z(),b&&b.stop()},reset:function(){R.off(I.INTERNAL_KEY_MESSAGE,V,t),R.off(I.INTERNAL_KEY_STATUS_CHANGED,Y,t),M(),z(),K(null),E=null,T=!1,b&&(b.reset(),b=null),N.forEach((function(e){return clearTimeout(e)})),N=[],s=[],n=[]}},r=w.getLogger(t),n=[],s=[],u="temporary",v="",_=null,S=null,R.on(I.INTERNAL_KEY_MESSAGE,V,t),R.on(I.INTERNAL_KEY_STATUS_CHANGED,Y,t),t}E.__dashjs_factory_name="ProtectionController";const T=v.Z.getClassFactory(E),_=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=r},S=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r&&"persistent"!==r&&"temporary"!==r)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=t,this.type=r}var t;return(t=[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,r={keys:[]};for(e=0;e<t;e++){var n={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};r.keys.push(n)}this.type&&(r.type=this.type);var i=JSON.stringify(r),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),A=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}var t;return(t=[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}());var b="e2719d58-a985-b3c9-781a-b030af78d30e",R=A.CLEARKEY_KEYSTEM_STRING,I="urn:uuid:"+b;function w(e){var t=(e=e||{}).BASE64;return{uuid:b,schemeIdURI:I,systemString:R,getInitData:function(e,r){try{var n=i.parseInitDataFromContentProtection(e,t);if(!n&&r){var a={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join(""))).replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch(e){return null}}(r["cenc:default_KID"])]};n=(new TextEncoder).encode(JSON.stringify(a))}return n}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e))))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var r=null;if(e){for(var n=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<n.kids.length;a++){var o=n.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new _(o,s))}r=new S(i)}return r}}}w.__dashjs_factory_name="KeySystemClearKey";const D=dashjs.FactoryMaker.getSingletonFactory(w);var C="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",N=A.CLEARKEY_KEYSTEM_STRING,L="urn:uuid:"+C;function O(e){var t=e.BASE64,r=e.debug.getLogger(void 0);return{uuid:C,schemeIdURI:L,systemString:N,getInitData:function(e){return i.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var i=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),a=[],o=0;o<i.kids.length;o++){var s=i.kids[o],l=e.clearkeys&&e.clearkeys.hasOwnProperty(s)?e.clearkeys[s]:null;if(!l)throw new Error("DRM: ClearKey keyID ("+s+") is not known!");a.push(new _(s,l))}n=new S(a),r.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}O.__dashjs_factory_name="KeySystemW3CClearKey";const P=dashjs.FactoryMaker.getSingletonFactory(O);var M="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",k=A.WIDEVINE_KEYSTEM_STRING,x="urn:uuid:"+M;function F(e){var t=(e=e||{}).BASE64;return{uuid:M,schemeIdURI:x,systemString:k,getInitData:function(e){return i.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}F.__dashjs_factory_name="KeySystemWidevine";const U=dashjs.FactoryMaker.getSingletonFactory(F);var B="9a04f079-9840-4286-ab92-e65be0885f95",Z=A.PLAYREADY_KEYSTEM_STRING,G="urn:uuid:"+B;function K(e){var t="utf-16",r=(e=e||{}).BASE64,n=e.settings;function a(){if(!r||!r.hasOwnProperty("decodeArray")||!r.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:B,schemeIdURI:G,systemString:Z,getInitData:function(e){var t,n,o,s,l,u=new Uint8Array([112,115,115,104,0,0,0,0]),c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),f=0,d=null;if(a(),!e)return null;if("pssh"in e)return i.parseInitDataFromContentProtection(e,r);if("pro"in e)d=r.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;d=r.decodeArray(e.prheader.__text)}return t=d.length,n=4+u.length+c.length+4+t,o=new ArrayBuffer(n),s=new Uint8Array(o),(l=new DataView(o)).setUint32(f,n),f+=4,s.set(u,f),f+=u.length,s.set(c,f),f+=c.length,l.setUint32(f,t),f+=4,s.set(d,f),f+=t,s.buffer},getRequestHeadersFromMessage:function(e){var r,i,a={},o=new DOMParser;if(n&&n.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return a["Content-Type"]="text/xml; charset=utf-8",a;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);r=String.fromCharCode.apply(null,s);for(var l=(i=o.parseFromString(r,"application/xml")).getElementsByTagName("name"),u=i.getElementsByTagName("value"),c=0;c<l.length;c++)a[l[c].childNodes[0].nodeValue]=u[c].childNodes[0].nodeValue;return a.hasOwnProperty("Content")&&(a["Content-Type"]=a.Content,delete a.Content),a.hasOwnProperty("Content-Type")||(a["Content-Type"]="text/xml; charset=utf-8"),a},getLicenseRequestFromMessage:function(e){var i=null,o=new DOMParser;if(n&&n.get().streaming.protection.detectPlayreadyMessageFormat&&"utf-16"===t&&e&&e.byteLength%2==1)return e;var s="utf-16"===t?new Uint16Array(e):new Uint8Array(e);a();var l=String.fromCharCode.apply(null,s),u=o.parseFromString(l,"application/xml");if(!u.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var c=u.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return c&&(i=r.decode(c)),i},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),r=t.getUint16(4,!0),n=6,i=new DOMParser,a=0;a<r;a++){var o=t.getUint16(n,!0);n+=2;var s=t.getUint16(n,!0);if(n+=2,1===o){var l=e.slice(n,n+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),c=i.parseFromString(u,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var f=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(f)return f}if(c.getElementsByTagName("LUI_URL")[0]){var d=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(d)return d}}else n+=s}return null},getCDMData:function(e){var t,n,i,o;if(a(),!e)return null;for(t=[],o=0;o<e.length;++o)t.push(e.charCodeAt(o)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=r.encode(t),n='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),i=[],o=0;o<n.length;++o)i.push(n.charCodeAt(o)),i.push(0);return new Uint8Array(i).buffer},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');t=e}}}K.__dashjs_factory_name="KeySystemPlayReady";const H=dashjs.FactoryMaker.getSingletonFactory(K);function Y(e){var t=(e=e||{}).BASE64,r={};return r[A.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return t.decodeArray(e.license)},getErrorResponse:function(e){return e}},r[A.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return r[e].responseType},getLicenseMessage:function(e,n){return function(){if(!t||!t.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),r[n].getLicenseMessage(e)},getErrorResponse:function(e,t){return r[t].getErrorResponse(e)}}}Y.__dashjs_factory_name="DRMToday";const V=dashjs.FactoryMaker.getSingletonFactory(Y);function q(){var e="http://schemas.xmlsoap.org/soap/envelope/";function t(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}function r(r){if(window.DOMParser){var n=t(r),i=(new window.DOMParser).parseFromString(n,"text/xml"),a=i?i.getElementsByTagNameNS(e,"Envelope")[0]:null,o=a?a.getElementsByTagNameNS(e,"Body")[0]:null;if(o&&o.getElementsByTagNameNS(e,"Fault")[0])return null}return r}function n(r){var n="",i="",a="",o=-1,s=-1;if(window.DOMParser){var l=t(r),u=(new window.DOMParser).parseFromString(l,"text/xml"),c=u?u.getElementsByTagNameNS(e,"Envelope")[0]:null,f=c?c.getElementsByTagNameNS(e,"Body")[0]:null,d=f?f.getElementsByTagNameNS(e,"Fault")[0]:null,h=d?d.getElementsByTagName("detail")[0]:null,g=h?h.getElementsByTagName("Exception")[0]:null,p=null;if(null===d)return l;n=(p=d.getElementsByTagName("faultstring")[0].firstChild)?p.nodeValue:null,null!==g&&(i=(p=g.getElementsByTagName("StatusCode")[0])?p.firstChild.nodeValue:null,o=(a=(p=g.getElementsByTagName("Message")[0])?p.firstChild.nodeValue:null)?a.lastIndexOf("[")+1:-1,s=a?a.indexOf("]"):-1,a=a?a.substring(o,s):"")}var m="code: ".concat(i,", name: ").concat(n);return a&&(m+=", message: ".concat(a)),m}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return r.call(this,e)},getErrorResponse:function(e){return n.call(this,e)}}}q.__dashjs_factory_name="PlayReady";const j=v.Z.getSingletonFactory(q);function z(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}z.__dashjs_factory_name="Widevine";const W=dashjs.FactoryMaker.getSingletonFactory(z);function X(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],r=0;r<e.keys.length;r++){var n=e.keys[r],i=n.kid.replace(/=/g,""),a=n.k.replace(/=/g,"");t.push(new _(i,a))}return new S(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}X.__dashjs_factory_name="ClearKey";const Q=dashjs.FactoryMaker.getSingletonFactory(X);function J(){var e,t,r,n,a,o,s,l,u=this.context;function c(e,t){return t&&e in t?t[e]:null}function f(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null}function d(e,t){return e&&e.sessionType?e.sessionType:t}return e={initialize:function(){var e;n=[],e=H(u).getInstance({BASE64:a,settings:o}),n.push(e),e=U(u).getInstance({BASE64:a}),n.push(e),e=D(u).getInstance({BASE64:a}),n.push(e),s=e,e=P(u).getInstance({BASE64:a,debug:t}),n.push(e),l=e},setProtectionData:function(e){for(var t,r,i=0;i<n.length;i++){var a=n[i];a.hasOwnProperty("init")&&a.init((t=a.systemString,r=void 0,r=null,e&&(r=t in e?e[t]:null),r))}},isClearKey:function(e){return e===s||e===l},initDataEquals:function(e,t){if(e.byteLength===t.byteLength){for(var r=new Uint8Array(e),n=new Uint8Array(t),i=0;i<r.length;i++)if(r[i]!==n[i])return!1;return!0}return!1},getKeySystems:function(){return n},setKeySystems:function(e){n=e},getKeySystemBySystemString:function(e){for(var t=0;t<n.length;t++)if(n[t].systemString===e)return n[t];return null},getSupportedKeySystemsFromContentProtection:function(e,t,r){var a,o,s,l,u=[];if(e){var h=i.findCencContentProtection(e);for(s=0;s<n.length;++s){var g=c((o=n[s]).systemString,t);for(l=0;l<e.length;++l)if((a=e[l]).schemeIdUri.toLowerCase()===o.schemeIdURI){var p=o.getInitData(a,h);u.push({ks:n[s],keyId:a.keyId,initData:p,protData:g,cdmData:o.getCDMData(g?g.cdmData:null),sessionId:f(g,a),sessionType:d(g,r)})}}}return u},getSupportedKeySystemsFromSegmentPssh:function(e,t,r){for(var a,o=[],s=i.parsePSSHList(e),l=0;l<n.length;++l){var u=c((a=n[l]).systemString,t);a.uuid in s&&o.push({ks:a,initData:s[a.uuid],protData:u,cdmData:a.getCDMData(u?u.cdmData:null),sessionId:f(u),sessionType:d(u,r)})}return o},getLicenseServerModelInstance:function(e,t,r){if("license-release"===r||"individualization-request"===r)return null;var n=null;return t&&t.hasOwnProperty("drmtoday")?n=V(u).getInstance({BASE64:a}):e.systemString===A.WIDEVINE_KEYSTEM_STRING?n=W(u).getInstance():e.systemString===A.PLAYREADY_KEYSTEM_STRING?n=j(u).getInstance():e.systemString===A.CLEARKEY_KEYSTEM_STRING&&(n=Q(u).getInstance()),n},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return r.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(n){n&&(n.debug&&(t=n.debug,r=t.getLogger(e)),n.BASE64&&(a=n.BASE64),n.settings&&(o=n.settings))}},e}J.__dashjs_factory_name="ProtectionKeyController";const $=dashjs.FactoryMaker.getSingletonFactory(J);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){return te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},te(e,t)}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}const ne=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(i,e);var t,r,n=(t=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=re(t);if(r){var i=re(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,e)});function i(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(e=n.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e}return i}(r(8342).Z)),ie=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=r},ae=function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=r,this.defaultURL=n,this.messageType=i||"license-request"},oe=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=r};var se={};function le(e){e=e||{};var t,r,n,i,a,o,s,l,u=this.context,d=e.eventBus,h=e.events,g=e.debug;function p(e,t,r,n){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var i="Insecure origins are not allowed";return d.trigger(h.KEY_SYSTEM_ACCESS_COMPLETE,{error:i}),void n({error:i})}var a=e[t].protData&&e[t].protData.systemStringPriority?e[t].protData.systemStringPriority:null,o=e[t].configs,s=e[t].ks,l=s.systemString;(function(e,t){return new Promise((function(r,n){m(e,t,0,r,n)}))})(a||(se[l]?se[l]:[l]),o).then((function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new oe(s,t);n.mksa=e,d.trigger(h.KEY_SYSTEM_ACCESS_COMPLETE,{data:n}),r({data:n})})).catch((function(i){if(t+1<e.length)p(e,t+1,r,n);else{var a="Key system access denied! ";d.trigger(h.KEY_SYSTEM_ACCESS_COMPLETE,{error:a+i.message}),n({error:a+i.message})}}))}function m(e,t,n,i,a){var o=e[n];r.debug("Requesting key system access for system string ".concat(o)),navigator.requestMediaKeySystemAccess(o,t).then((function(e){e.selectedSystemString=o,i(e)})).catch((function(r){n+1<e.length?m(e,t,n+1,i,a):a(r)}))}function v(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function y(e){for(var t=0;t<o.length;t++)if(o[t]===e){o.splice(t,1);break}}function E(e){var t,r;return e&&e.length>0&&(e[0]&&("string"==typeof e[0]?t=e[0]:r=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:r=e[1])),{status:t,keyId:r}}function T(e,t){var n={session:e,keyId:t.keyId,initData:t.initData,sessionId:t.sessionId,sessionType:t.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":d.trigger(h.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach((function(){var e=E(arguments);"expired"===e.status?d.trigger(h.INTERNAL_KEY_STATUS_CHANGED,{error:new f.Z(c.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,c.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)}):d.trigger(h.INTERNAL_KEY_STATUS_CHANGED,e)}));break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;d.trigger(h.INTERNAL_KEY_MESSAGE,{data:new ae(this,t,void 0,e.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return e.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return e.expiration},getKeyStatuses:function(){return e.keyStatuses},getUsable:function(){var t=!1;return e.keyStatuses.forEach((function(){"usable"===E(arguments).status&&(t=!0)})),t}};return e.addEventListener("keystatuseschange",n),e.addEventListener("message",n),e.closed.then((function(){y(n),r.debug("DRM: Session closed.  SessionID = "+n.getSessionId()),d.trigger(h.KEY_SESSION_CLOSED,{data:n.getSessionId()})})),o.push(n),n}return t={getAllInitData:function(){for(var e=[],t=0;t<o.length;t++)o[t].initData&&e.push(o[t].initData);return e},getSessions:function(){return o},requestKeySystemAccess:function(e){return new Promise((function(t,r){p(e,0,t,r)}))},selectKeySystem:function(e){return new Promise((function(t,r){e.mksa.createMediaKeys().then((function(t){return n=e.keySystem,a=t,i?i.setMediaKeys(a):Promise.resolve()})).then((function(){t(n)})).catch((function(){r({error:"Error selecting keys system ("+e.keySystem.systemString+")! Could not create MediaKeys -- TODO"})}))}))},setMediaElement:function(e){i!==e&&(i&&(i.removeEventListener("encrypted",s),i.setMediaKeys&&i.setMediaKeys(null)),(i=e)&&(i.addEventListener("encrypted",s),i.setMediaKeys&&a&&i.setMediaKeys(a)))},setServerCertificate:function(e){if(!n||!a)throw new Error("Can not set server certificate until you have selected a key system");a.setServerCertificate(e).then((function(){r.info("DRM: License server certificate successfully updated."),d.trigger(h.SERVER_CERTIFICATE_UPDATED)})).catch((function(e){d.trigger(h.SERVER_CERTIFICATE_UPDATED,{error:new f.Z(c.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,c.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})}))},createKeySession:function(e){if(!n||!a)throw new Error("Can not create sessions until you have selected a key system");var t=a.createSession(e.sessionType),i=T(t,e),o=n.systemString===A.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?A.INITIALIZATION_DATA_TYPE_KEYIDS:A.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(o,e.initData).then((function(){r.debug("DRM: Session created.  SessionID = "+i.getSessionId()),d.trigger(h.KEY_SESSION_CREATED,{data:i})})).catch((function(e){y(i),d.trigger(h.KEY_SESSION_CREATED,{data:null,error:new f.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})}))},updateKeySession:function(e,t){var r=e.session;l.isClearKey(n)&&(t=t.toJWK()),r.update(t).then((function(){d.trigger(h.KEY_SESSION_UPDATED)})).catch((function(t){d.trigger(h.KEY_ERROR,{error:new f.Z(c.MEDIA_KEYERR_CODE,"Error sending update() message! "+t.name,e)})}))},loadKeySession:function(e){if(!n||!a)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,i=0;i<o.length;i++)if(t===o[i].sessionId)return void r.warn("DRM: Ignoring session ID because we have already seen it!");var s=a.createSession(e.sessionType),l=T(s,e);s.load(t).then((function(e){e?(r.debug("DRM: Session loaded.  SessionID = "+l.getSessionId()),d.trigger(h.KEY_SESSION_CREATED,{data:l})):(y(l),d.trigger(h.KEY_SESSION_CREATED,{data:null,error:new f.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))})).catch((function(e){y(l),d.trigger(h.KEY_SESSION_CREATED,{data:null,error:new f.Z(c.KEY_SESSION_CREATED_ERROR_CODE,c.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)})}))},removeKeySession:function(e){e.session.remove().then((function(){r.debug("DRM: Session removed.  SessionID = "+e.getSessionId()),d.trigger(h.KEY_SESSION_REMOVED,{data:e.getSessionId()})}),(function(t){d.trigger(h.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+e.getSessionId()+"). "+t.name})}))},closeKeySession:function(e){v(e).catch((function(t){y(e),d.trigger(h.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.getSessionId()+") "+t.name})}))},stop:function(){for(var e,t=0;t<o.length;t++)(e=o[t]).getUsable()||v(e).catch((function(){y(e)}))},reset:function(){var e,t=o.length;0!==t?function(){for(var r=function(e){y(e),0===o.length&&(i?(i.removeEventListener("encrypted",s),i.setMediaKeys(null).then((function(){d.trigger(h.TEARDOWN_COMPLETE)}))):d.trigger(h.TEARDOWN_COMPLETE))},n=0;n<t;n++)!function(t){e.session.closed.then((function(){r(t)})),v(e).catch((function(){r(t)}))}(e=o[n])}():d.trigger(h.TEARDOWN_COMPLETE)}},r=g.getLogger(t),n=null,i=null,a=null,o=[],l=$(u).getInstance(),s={handleEvent:function(e){if("encrypted"===e.type&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;d.trigger(h.NEED_KEY,{key:new ie(t,e.initDataType)})}}},t}se[A.PLAYREADY_KEYSTEM_STRING]=[A.PLAYREADY_KEYSTEM_STRING,A.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],se[A.WIDEVINE_KEYSTEM_STRING]=[A.WIDEVINE_KEYSTEM_STRING],se[A.CLEARKEY_KEYSTEM_STRING]=[A.CLEARKEY_KEYSTEM_STRING],le.__dashjs_factory_name="ProtectionModel_21Jan2015";const ue=dashjs.FactoryMaker.getClassFactory(le);function ce(e){e=e||{};var t,r,n,i,a,s,l,u,d,h=this.context,g=e.eventBus,p=e.events,m=e.debug,v=e.api;function y(){try{for(var e=0;e<l.length;e++)E(l[e]);n&&n.removeEventListener(v.needkey,u),g.trigger(p.TEARDOWN_COMPLETE)}catch(e){g.trigger(p.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function E(e){var t=e.session;t.removeEventListener(v.error,e),t.removeEventListener(v.message,e),t.removeEventListener(v.ready,e),t.removeEventListener(v.close,e);for(var r=0;r<l.length;r++)if(l[r]===e){l.splice(r,1);break}t[v.release]()}function T(){var e=null,t=function(){n.removeEventListener("loadedmetadata",e),n[v.setMediaKeys](a),g.trigger(p.VIDEO_ELEMENT_SELECTED)};n.readyState>=1?t():(e=t.bind(this),n.addEventListener("loadedmetadata",e))}return t={getAllInitData:function(){for(var e=[],t=0;t<l.length;t++)e.push(l[t].initData);return e},getSessions:function(){return l},requestKeySystemAccess:function(e){return new Promise((function(t,r){for(var n=!1,i=0;i<e.length;i++)for(var a=e[i].ks.systemString,s=e[i].configs,l=null,u=null,c=0;c<s.length;c++){var f=s[c].audioCapabilities,h=s[c].videoCapabilities;if(f&&0!==f.length){l=[];for(var m=0;m<f.length;m++)window[v.MediaKeys].isTypeSupported(a,f[m].contentType)&&l.push(f[m])}if(h&&0!==h.length){u=[];for(var y=0;y<h.length;y++)window[v.MediaKeys].isTypeSupported(a,h[y].contentType)&&u.push(h[y])}if(!(!l&&!u||l&&0===l.length||u&&0===u.length)){n=!0;var E=new o(l,u),T=d.getKeySystemBySystemString(a),_=new oe(T,E);g.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:_}),t({data:_});break}}if(!n){var S="Key system access denied! -- No valid audio/video content configurations detected!";g.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:S}),r({error:S})}}))},selectKeySystem:function(e){return new Promise((function(t,r){try{a=e.mediaKeys=new window[v.MediaKeys](e.keySystem.systemString),i=e.keySystem,s=e,n&&T(),t(i)}catch(e){r({error:"Error selecting keys system ("+i.systemString+")! Could not create MediaKeys -- TODO"})}}))},setMediaElement:function(e){n!==e&&(n&&n.removeEventListener(v.needkey,u),(n=e)&&(n.addEventListener(v.needkey,u),a&&T()))},createKeySession:function(e){if(!i||!a||!s)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(s.ksConfiguration.videoCapabilities&&s.ksConfiguration.videoCapabilities.length>0&&(t=s.ksConfiguration.videoCapabilities[0]),null===t&&s.ksConfiguration.audioCapabilities&&s.ksConfiguration.audioCapabilities.length>0&&(t=s.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var n=t.contentType,o=a.createSession(n,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),u=function(e,t){return{session:e,keyId:t.keyId,initData:t.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case v.error:g.trigger(p.KEY_ERROR,{error:new f.Z(c.MEDIA_KEYERR_CODE,"KeyError",this)});break;case v.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;g.trigger(p.INTERNAL_KEY_MESSAGE,{data:new ae(this,t,e.destinationURL)});break;case v.ready:r.debug("DRM: Key added."),g.trigger(p.KEY_ADDED);break;case v.close:r.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),g.trigger(p.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}}}(o,e);o.addEventListener(v.error,u),o.addEventListener(v.message,u),o.addEventListener(v.ready,u),o.addEventListener(v.close,u),l.push(u),r.debug("DRM: Session created.  SessionID = "+u.getSessionId()),g.trigger(p.KEY_SESSION_CREATED,{data:u})},updateKeySession:function(e,t){var r=e.session;d.isClearKey(i)?r.update(new Uint8Array(t.toJWK())):r.update(new Uint8Array(t)),g.trigger(p.KEY_SESSION_UPDATED)},closeKeySession:E,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:y,reset:y},r=m.getLogger(t),n=null,i=null,a=null,s=null,l=[],d=$(h).getInstance(),u={handleEvent:function(e){if(e.type===v.needkey&&e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;g.trigger(p.NEED_KEY,{key:new ie(t,"cenc")})}}},t}ce.__dashjs_factory_name="ProtectionModel_3Feb2014";const fe=dashjs.FactoryMaker.getClassFactory(ce);function de(e){e=e||{};var t,r,n,i,a,s,l,u,d,h=this.context,g=e.eventBus,p=e.events,m=e.debug,v=e.api,y=e.errHandler;function E(){n&&S();for(var e=0;e<l.length;e++)T(l[e]);g.trigger(p.TEARDOWN_COMPLETE)}function T(e){try{n[v.cancelKeyRequest](i.systemString,e.sessionId)}catch(t){g.trigger(p.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+e.sessionId+") "+t.message})}}function _(e,t){if(t&&e){for(var r=e.length,n=0;n<r;n++)if(e[n].sessionId==t)return e[n];return null}return null}function S(){n.removeEventListener(v.keyerror,d),n.removeEventListener(v.needkey,d),n.removeEventListener(v.keymessage,d),n.removeEventListener(v.keyadded,d)}return t={getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)e.push(s[t].initData);for(var r=0;r<l.length;r++)e.push(l[r].initData);return e},getSessions:function(){return l.concat(s)},requestKeySystemAccess:function(e){return new Promise((function(t,r){var i=n;i||(i=document.createElement("video"));for(var s=!1,l=0;l<e.length;l++)for(var u=e[l].ks.systemString,c=e[l].configs,f=null,d=0;d<c.length;d++){var h=c[d].videoCapabilities;if(h&&0!==h.length){f=[];for(var m=0;m<h.length;m++)""!==i.canPlayType(h[m].contentType,u)&&f.push(h[m])}if(f&&(!f||0!==f.length)){s=!0;var v=new o(null,f),y=a.getKeySystemBySystemString(u),E=new oe(y,v);g.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{data:E}),t({data:E});break}}if(!s){var T="Key system access denied! -- No valid audio/video content configurations detected!";g.trigger(p.KEY_SYSTEM_ACCESS_COMPLETE,{error:T}),r({error:T})}}))},selectKeySystem:function(e){return i=e.keySystem,Promise.resolve(i)},setMediaElement:function(e){if(n!==e){if(n){S();for(var t=0;t<l.length;t++)T(l[t]);l=[]}(n=e)&&(n.addEventListener(v.keyerror,d),n.addEventListener(v.needkey,d),n.addEventListener(v.keymessage,d),n.addEventListener(v.keyadded,d),g.trigger(p.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!i)throw new Error("Can not create sessions until you have selected a key system");if(u||0===l.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return s.push(t),n[v.generateKeyRequest](i.systemString,new Uint8Array(e.initData)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var r=e.sessionId;if(a.isClearKey(i))for(var o=0;o<t.keyPairs.length;o++)n[v.addKey](i.systemString,t.keyPairs[o].key,t.keyPairs[o].keyID,r);else n[v.addKey](i.systemString,new Uint8Array(t),new Uint8Array(e.initData),r);g.trigger(p.KEY_SESSION_UPDATED)},closeKeySession:T,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:E,reset:E},r=m.getLogger(t),n=null,i=null,s=[],l=[],a=$(h).getInstance(),d={handleEvent:function(e){var t=null;switch(e.type){case v.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;g.trigger(p.NEED_KEY,{key:new ie(n,"cenc")});break;case v.keyerror:if((t=_(l,e.sessionId))||(t=_(s,e.sessionId)),t){var i=c.MEDIA_KEYERR_CODE,a="";switch(e.errorCode.code){case 1:i=c.MEDIA_KEYERR_UNKNOWN_CODE,a+="MEDIA_KEYERR_UNKNOWN - "+c.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:i=c.MEDIA_KEYERR_CLIENT_CODE,a+="MEDIA_KEYERR_CLIENT - "+c.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:i=c.MEDIA_KEYERR_SERVICE_CODE,a+="MEDIA_KEYERR_SERVICE - "+c.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:i=c.MEDIA_KEYERR_OUTPUT_CODE,a+="MEDIA_KEYERR_OUTPUT - "+c.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:i=c.MEDIA_KEYERR_HARDWARECHANGE_CODE,a+="MEDIA_KEYERR_HARDWARECHANGE - "+c.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:i=c.MEDIA_KEYERR_DOMAIN_CODE,a+="MEDIA_KEYERR_DOMAIN - "+c.MEDIA_KEYERR_DOMAIN_MESSAGE}a+="  System Code = "+e.systemCode,g.trigger(p.KEY_ERROR,{error:new f.Z(i,a,t)})}else r.error("No session token found for key error");break;case v.keyadded:(t=_(l,e.sessionId))||(t=_(s,e.sessionId)),t?(r.debug("DRM: Key added."),g.trigger(p.KEY_ADDED,{data:t})):r.debug("No session token found for key added");break;case v.keymessage:if((u=null!==e.sessionId&&void 0!==e.sessionId)?!(t=_(l,e.sessionId))&&s.length>0&&(t=s.shift(),l.push(t),t.sessionId=e.sessionId,g.trigger(p.KEY_SESSION_CREATED,{data:t})):s.length>0&&(t=s.shift(),l.push(t),0!==s.length&&y.error(new f.Z(c.MEDIA_KEY_MESSAGE_ERROR_CODE,c.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var o=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=o,g.trigger(p.INTERNAL_KEY_MESSAGE,{data:new ae(t,o,e.defaultURL)})}else r.warn("No session token found for key message")}}},t}de.__dashjs_factory_name="ProtectionModel_01b";const he=dashjs.FactoryMaker.getClassFactory(de);var ge=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],pe=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function me(){var e,t=this.context;function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];if("function"==typeof e[n[Object.keys(n)[0]]])return n}return null}return e={createProtectionSystem:function(n){var i=null,a=$(t).getInstance();a.setConfig({debug:n.debug,BASE64:n.BASE64,settings:n.settings}),a.initialize();var o=function(n){var i=n.debug,a=i.getLogger(e),o=n.eventBus,s=n.errHandler,l=n.videoModel?n.videoModel.getElement():null;return l&&void 0===l.onencrypted||l&&void 0===l.mediaKeys?r(l,pe)?(a.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),fe(t).create({debug:i,eventBus:o,events:n.events,api:r(l,pe)})):r(l,ge)?(a.info("EME detected on this user agent! (ProtectionModel_01b)"),he(t).create({debug:i,eventBus:o,errHandler:s,events:n.events,api:r(l,ge)})):(a.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(a.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),ue(t).create({debug:i,eventBus:o,events:n.events}))}(n);return!i&&o&&(i=T(t).create({protectionModel:o,protectionKeyController:a,eventBus:n.eventBus,debug:n.debug,events:n.events,BASE64:n.BASE64,constants:n.constants,cmcdModel:n.cmcdModel,customParametersModel:n.customParametersModel,settings:n.settings}),n.capabilities.setEncryptedMediaSupported(!0)),i}}}me.__dashjs_factory_name="Protection";var ve=dashjs.FactoryMaker.getClassFactory(me);ve.events=ne,ve.errors=c,dashjs.FactoryMaker.updateClassFactory(me.__dashjs_factory_name,ve);const ye=ve},2068:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i={DEFAULT:.5,STRONG:1,WEAK:0};function a(e,t,r){var n,a;return n=void 0===e?-1:e,a=function(e){var t=i.DEFAULT;return e!==i.DEFAULT&&e!==i.STRONG&&e!==i.WEAK||(t=e),t}(r),{quality:n,reason:void 0===t?null:t,priority:a}}a.__dashjs_factory_name="SwitchRequest";var o=n.Z.getClassFactory(a);o.NO_CHANGE=-1,o.PRIORITY=i,n.Z.updateClassFactory(a.__dashjs_factory_name,o);const s=o},1767:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(5628),i=r(6535),a=r(7423),o=r(895),s=r(6070),l=r(3112),u=r(1914),c=r(5435),f=r(5448),d=r(2068),h=r(3393),g="qualitySwitchRules",p="abandonFragmentRules";function m(e){e=e||{};var t,r,f=this.context,m=e.mediaPlayerModel,v=e.customParametersModel,y=e.dashMetrics,E=e.settings;function T(e){return e.filter((function(e){return e.quality>d.Z.NO_CHANGE}))}function _(e){var t,r,n,i,a,o={},s=null;if(0!==e.length){for(o[d.Z.PRIORITY.STRONG]={quality:d.Z.NO_CHANGE,reason:null},o[d.Z.PRIORITY.WEAK]={quality:d.Z.NO_CHANGE,reason:null},o[d.Z.PRIORITY.DEFAULT]={quality:d.Z.NO_CHANGE,reason:null},t=0,r=e.length;t<r;t+=1)(n=e[t]).quality!==d.Z.NO_CHANGE&&(o[n.priority].quality===d.Z.NO_CHANGE||o[n.priority].quality>n.quality)&&(o[n.priority].quality=n.quality,o[n.priority].reason=n.reason||null);return o[d.Z.PRIORITY.WEAK].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.WEAK]),o[d.Z.PRIORITY.DEFAULT].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.DEFAULT]),o[d.Z.PRIORITY.STRONG].quality!==d.Z.NO_CHANGE&&(s=o[d.Z.PRIORITY.STRONG]),s&&(i=s.quality,a=s.reason),(0,d.Z)(f).create(i,a)}}return{initialize:function(){t=[],r=[],E.get().streaming.abr.useDefaultABRRules&&(E.get().streaming.abr.ABRStrategy===h.Z.ABR_STRATEGY_L2A?t.push((0,u.Z)(f).create({dashMetrics:y,settings:E})):E.get().streaming.abr.ABRStrategy===h.Z.ABR_STRATEGY_LoLP?t.push((0,c.Z)(f).create({dashMetrics:y})):(t.push((0,l.Z)(f).create({dashMetrics:y,mediaPlayerModel:m,settings:E})),t.push((0,n.Z)(f).create({dashMetrics:y})),E.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&t.push((0,i.Z)(f).create({dashMetrics:y,settings:E})),E.get().streaming.abr.additionalAbrRules.switchHistoryRule&&t.push((0,s.Z)(f).create()),E.get().streaming.abr.additionalAbrRules.droppedFramesRule&&t.push((0,o.Z)(f).create()),E.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&r.push((0,a.Z)(f).create({dashMetrics:y,mediaPlayerModel:m,settings:E})))),v.getAbrCustomRules().forEach((function(e){e.type===g&&t.push(e.rule(f).create()),e.type===p&&r.push(e.rule(f).create())}))},reset:function(){[t,r].forEach((function(e){e&&e.length&&e.forEach((function(e){return e.reset&&e.reset()}))})),t=[],r=[]},getMaxQuality:function(e){return _(T(t.map((function(t){return t.getMaxIndex(e)}))))||(0,d.Z)(f).create()},getMinSwitchRequest:_,shouldAbandonFragment:function(e,t){return _(T(r.map((function(r){return r.shouldAbandon(e,t)}))))||(0,d.Z)(f).create()},getQualitySwitchRules:function(){return t}}}m.__dashjs_factory_name="ABRRulesCollection";var v=f.Z.getClassFactory(m);v.QUALITY_SWITCH_RULES=g,v.ABANDON_FRAGMENT_RULES=p,f.Z.updateSingletonFactory(m.__dashjs_factory_name,v);const y=v},7423:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(2068),i=r(5448),a=r(6398);function o(e){e=e||{};var t,r,i,s,l,u=this.context,c=e.mediaPlayerModel,f=e.dashMetrics,d=e.settings;function h(){i={},s={},l=[]}return t={shouldAbandon:function(e){var t=(0,n.Z)(u).create(n.Z.NO_CHANGE,{name:o.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var a,h,g=e.getMediaInfo(),p=e.getMediaType(),m=e.getStreamInfo(),v=m?m.id:null,y=e.getCurrentRequest();if(!isNaN(y.index)){a=p,h=y.index,i[a]=i[a]||{},i[a][h]=i[a][h]||{};var E=c.getStableBufferTime();if(f.getCurrentBufferLevel(p)>E)return t;var T=i[p][y.index];if(null===T||null===y.firstByteDate||s.hasOwnProperty(T.id))return t;if(void 0===T.firstByteTime&&(l[p]=[],T.firstByteTime=y.firstByteDate.getTime(),T.segmentDuration=y.duration,T.bytesTotal=y.bytesTotal,T.id=y.index),T.bytesLoaded=y.bytesLoaded,T.elapsedTime=(new Date).getTime()-T.firstByteTime,T.bytesLoaded>0&&T.elapsedTime>0&&function(e,t){l[e]=l[e]||[],l[e].push(t)}(p,Math.round(8*T.bytesLoaded/T.elapsedTime)),l[p].length>=5&&T.elapsedTime>500&&T.bytesLoaded<T.bytesTotal){var _=l[p].reduce((function(e,t){return e+t}),0);if(T.measuredBandwidthInKbps=Math.round(_/l[p].length),T.estimatedTimeOfDownload=+(8*T.bytesTotal/T.measuredBandwidthInKbps/1e3).toFixed(2),T.estimatedTimeOfDownload<1.8*T.segmentDuration||0===e.getRepresentationInfo().quality)return t;if(!s.hasOwnProperty(T.id)){var S=e.getAbrController(),A=T.bytesTotal-T.bytesLoaded,b=S.getBitrateList(g),R=S.getQualityForBitrate(g,T.measuredBandwidthInKbps*d.get().streaming.abr.bandwidthSafetyFactor,v),I=S.getMinAllowedIndexFor(p,v),w=void 0!==I?Math.max(I,R):R;A>T.bytesTotal*b[w].bitrate/b[S.getQualityFor(p,v)].bitrate&&(t.quality=w,t.reason.throughput=T.measuredBandwidthInKbps,t.reason.fragmentID=T.id,t.reason.rule=this.getClassName(),s[T.id]=T,r.debug("["+p+"] frag id",T.id," is asking to abandon and switch to quality to ",w," measured bandwidth was",T.measuredBandwidthInKbps),delete i[p][T.id])}}else T.bytesLoaded===T.bytesTotal&&delete i[p][T.id]}return t},reset:h},r=(0,a.Z)(u).getInstance().getLogger(t),h(),t}o.__dashjs_factory_name="AbandonRequestsRule";const s=i.Z.getClassFactory(o)},3112:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(3860),i=r(2068),a=r(5448),o=r(7855),s=r(5595),l=r(8512),u=r(6398),c=r(8825),f=r(3393),d=10;function h(e){e=e||{};var t,r,a,h=this.context,g=e.dashMetrics,p=e.mediaPlayerModel,m=(0,s.Z)(h).getInstance();function v(e,t,r){var n=r.reduce((function(e,t,n){return t>r[e]?n:e}),0);if(0===n)return null;var i=Math.max(e,d+2*t.length),a=(r[n]-1)/(i/d-1);return{gp:a,Vp:d/a}}function y(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function E(e,t){var r=p.getStableBufferTime();if(e.stableBufferTime!==r){var n=v(r,e.bitrates,e.utilities);if(n.Vp!==e.Vp||n.gp!==e.gp){var i=g.getCurrentBufferLevel(t),a=i+e.placeholderBuffer;a-=d,a*=n.Vp/e.Vp,a+=d,e.stableBufferTime=r,e.Vp=n.Vp,e.gp=n.gp,e.placeholderBuffer=Math.max(0,a-i)}}}function T(e,t){return e.Vp*(e.utilities[t]+e.gp)}function _(e,t){for(var r=e.bitrates[t],n=e.utilities[t],i=0,a=t-1;a>=0;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],l=e.Vp*(e.gp+(r*s-o*n)/(r-o));i=Math.max(i,l)}return i}function S(e){var t=e.mediaType===f.Z.AUDIO?[f.Z.AUDIO]:a;for(var r in t)a.hasOwnProperty(r)&&2===a[r].state&&(a[r].placeholderBuffer=0)}function A(){for(var e in a)if(a.hasOwnProperty(e)){var t=a[e];0!==t.state&&(t.state=1,y(t))}}function b(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,I(t,e.chunk.mediaInfo.type)}}}function R(e){if(e&&e.metric===n.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),I(t,e.mediaType))}}function I(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var r=g.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),n=T(e,e.lastQuality),i=Math.max(0,n-r);e.placeholderBuffer=Math.min(i,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function w(e){if(e){var t=a[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function D(e){if(e){var t=a[e.mediaType];if(t&&0!==t.state){var r,n=g.getCurrentBufferLevel(e.mediaType);r=t.abrQuality>0?_(t,t.abrQuality):d;var i=Math.max(0,r-n);t.placeholderBuffer=Math.min(t.placeholderBuffer,i)}}}function C(){a={}}return t={getMaxIndex:function(e){var t=(0,i.Z)(h).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var n=e.getMediaInfo(),o=e.getMediaType(),s=e.getScheduleController(),l=e.getStreamInfo(),u=e.getAbrController(),c=u.getThroughputHistory(),f=l?l.id:null,d=l&&l.manifestInfo&&l.manifestInfo.isDynamic,m=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!m)return t;s.setTimeToLoadDelay(0);var S=function(e){var t=e.getMediaType(),r=a[t];return r?0!==r.state&&E(r,t):(r=function(e){var t={},r=e.getMediaInfo().bitrateList.map((function(e){return e.bandwidth})),n=function(e){return e.map((function(e){return Math.log(e)}))}(r);n=n.map((function(e){return e-n[0]+1}));var i=p.getStableBufferTime(),a=v(i,r,n);return a?(t.state=1,t.bitrates=r,t.utilities=n,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,y(t)):t.state=0,t}(e),a[t]=r),r}(e);if(0===S.state)return t;var A,b=g.getCurrentBufferLevel(o),R=c.getAverageThroughput(o,d),I=c.getSafeAverageThroughput(o,d),w=c.getAverageLatency(o);if(t.reason.state=S.state,t.reason.throughput=R,t.reason.latency=w,isNaN(R))return t;switch(S.state){case 1:A=u.getQualityForBitrate(n,I,f,w),t.quality=A,t.reason.throughput=I,S.placeholderBuffer=Math.max(0,_(S,A)-b),S.lastQuality=A,!isNaN(S.lastSegmentDurationS)&&b>=S.lastSegmentDurationS&&(S.state=2);break;case 2:!function(e,t){var r=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var n=.001*(r-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,n)}}else{var i=.001*(r-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=r,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,E(e,t)}(S,o),A=function(e,t){for(var r=e.bitrates.length,n=NaN,i=NaN,a=0;a<r;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||o>=i)&&(i=o,n=a)}return n}(S,b+S.placeholderBuffer);var D=u.getQualityForBitrate(n,I,f,w);A>S.lastQuality&&A>D&&(A=Math.max(D,S.lastQuality));var C=Math.max(0,b+S.placeholderBuffer-T(S,A));C<=S.placeholderBuffer?(S.placeholderBuffer-=C,C=0):(C-=S.placeholderBuffer,S.placeholderBuffer=0,A<u.getMaxAllowedIndexFor(o,f)?s.setTimeToLoadDelay(1e3*C):C=0),t.quality=A,t.reason.throughput=R,t.reason.latency=w,t.reason.bufferLevel=b,t.reason.placeholderBuffer=S.placeholderBuffer,t.reason.delay=C,S.lastQuality=A;break;default:r.debug("BOLA ABR rule invoked in bad state."),t.quality=u.getQualityForBitrate(n,I,f,w),t.reason.state=S.state,t.reason.throughput=I,t.reason.latency=w,S.state=1,y(S)}return t},reset:function(){C(),m.off(c.Z.BUFFER_EMPTY,S,t),m.off(c.Z.PLAYBACK_SEEKING,A,t),m.off(c.Z.METRIC_ADDED,R,t),m.off(c.Z.QUALITY_CHANGE_REQUESTED,w,t),m.off(c.Z.FRAGMENT_LOADING_ABANDONED,D,t),m.off(l.Z.MEDIA_FRAGMENT_LOADED,b,t)}},r=(0,u.Z)(h).getInstance().getLogger(t),C(),m.on(c.Z.BUFFER_EMPTY,S,t),m.on(c.Z.PLAYBACK_SEEKING,A,t),m.on(c.Z.METRIC_ADDED,R,t),m.on(c.Z.QUALITY_CHANGE_REQUESTED,w,t),m.on(c.Z.FRAGMENT_LOADING_ABANDONED,D,t),m.on(l.Z.MEDIA_FRAGMENT_LOADED,b,t),t}h.__dashjs_factory_name="BolaRule";const g=a.Z.getClassFactory(h)},895:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(2068),a=r(6398);function o(){var e,t,r=this.context;return e={getMaxIndex:function(e){var n=(0,i.Z)(r).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return n;var a=e.getDroppedFramesHistory(),o=e.getStreamInfo().id;if(a){var s=a.getFrameHistory(o);if(!s||0===s.length)return n;for(var l=0,u=0,c=i.Z.NO_CHANGE,f=1;f<s.length;f++)if(s[f]&&(l=s[f].droppedVideoFrames,(u=s[f].totalVideoFrames)>375&&l/u>.15)){c=f-1,t.debug("index: "+c+" Dropped Frames: "+l+" Total Frames: "+u);break}return(0,i.Z)(r).create(c,{droppedFrames:l})}return n}},t=(0,a.Z)(r).getInstance().getLogger(e),e}o.__dashjs_factory_name="DroppedFramesRule";const s=n.Z.getClassFactory(o)},6535:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(5595),i=r(8512),a=r(5448),o=r(6398),s=r(2068),l=r(3393),u=r(3860),c=r(8825);function f(e){e=e||{};var t,r,a,f=this.context,d=(0,n.Z)(f).getInstance(),h=e.dashMetrics;function g(){(a={})[l.Z.VIDEO]={ignoreCount:2},a[l.Z.AUDIO]={ignoreCount:2}}function p(){g()}function m(e){isNaN(e.startTime)||e.mediaType!==l.Z.AUDIO&&e.mediaType!==l.Z.VIDEO||a[e.mediaType].ignoreCount>0&&a[e.mediaType].ignoreCount--}return t={getMaxIndex:function(e){var t=(0,s.Z)(f).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!h||!h.hasOwnProperty("getCurrentBufferLevel")||!h.hasOwnProperty("getCurrentBufferState"))throw new Error(l.Z.MISSING_CONFIG_ERROR)}();var n=e.getMediaType(),i=h.getCurrentBufferState(n),o=e.getRepresentationInfo().fragmentDuration,c=e.getStreamInfo(),d=c?c.id:null,g=e.getScheduleController(),p=c&&c.manifestInfo&&c.manifestInfo.isDynamic;if(function(e,t){return!e&&a[t].ignoreCount>0}(g.getPlaybackController().getLowLatencyModeEnabled(),n)||!o)return t;if(i&&i.state===u.Z.BUFFER_EMPTY)r.debug("["+n+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty";else{var m=e.getMediaInfo(),v=e.getAbrController(),y=v.getThroughputHistory(),E=h.getCurrentBufferLevel(n),T=y.getAverageThroughput(n,p),_=y.getAverageLatency(n),S=T*(E/o)*.5;t.quality=v.getQualityForBitrate(m,S,d,_),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return t},reset:function(){g(),d.off(c.Z.PLAYBACK_SEEKING,p,t),d.off(i.Z.BYTES_APPENDED_END_FRAGMENT,m,t)}},r=(0,o.Z)(f).getInstance().getLogger(t),g(),d.on(c.Z.PLAYBACK_SEEKING,p,t),d.on(i.Z.BYTES_APPENDED_END_FRAGMENT,m,t),t}f.__dashjs_factory_name="InsufficientBufferRule";const d=a.Z.getClassFactory(f)},1914:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(3860),i=r(2068),a=r(5448),o=r(7855),s=r(5595),l=r(8512),u=r(6398),c=r(3393);function f(e){e=e||{};var t,r,a,f,d=this.context,h=e.dashMetrics,g=(0,s.Z)(d).getInstance();function p(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,e.lastSegmentUrl=""}function m(){for(var e in r)if(r.hasOwnProperty(e)){var t=r[e];0!==t.state&&(t.state=1,p(t))}}function v(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=r[e.chunk.mediaInfo.type],n=a[e.chunk.mediaInfo.type];if(t&&0!==t.state){var i=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||i>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=i,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=i,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,E(t,n)}}}function y(e){if(e&&e.metric===n.Z.HTTP_REQUEST&&e.value&&e.value.type===o.w.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=r[e.mediaType],i=a[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),E(t,i))}}function E(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function T(e){if(e&&e.mediaType){var t=r[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function _(e,t){if(e.length!==t.length)return-1;for(var r=0,n=0;n<e.length;n++)r+=e[n]*t[n];return r}function S(){r={},a={}}return t={getMaxIndex:function(e){var t,n=(0,i.Z)(d).create(),s=Math.pow(4,.99),l=Math.max(Math.pow(4,1),s*Math.sqrt(4)),u=e.getMediaInfo(),g=e.getMediaType(),m=u.bitrateList.map((function(e){return e.bandwidth})),v=m.length,y=e.getScheduleController(),E=e.getStreamInfo(),T=e.getAbrController(),S=T.getThroughputHistory(),A=E&&E.manifestInfo&&E.manifestInfo.isDynamic,b=e.useL2AABR(),R=h.getCurrentBufferLevel(g,!0),I=S.getSafeAverageThroughput(g,A),w=S.getAverageThroughput(g,A),D=S.getAverageLatency(g),C=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return n;if(n.reason=n.reason||{},!b||g===c.Z.AUDIO)return n;y.setTimeToLoadDelay(0);var N=function(e){var t=e.getMediaType(),n=r[t];return n||(n=function(e){var t={},r=e.getMediaInfo(),n=r.bitrateList.map((function(e){return e.bandwidth/1e3}));return t.state=1,t.bitrates=n,t.lastQuality=0,function(e){e&&e.type&&(a[e.type]={},a[e.type].w=[],a[e.type].prev_w=[],a[e.type].Q=0,a[e.type].segment_request_start_s=0,a[e.type].segment_download_finish_s=0,a[e.type].B_target=1.5)}(r),p(t),t}(e),r[t]=n),n}(e);if(0===N.state)return n;var L=a[g];if(!L)return n;if(n.reason.state=N.state,n.reason.throughput=w,n.reason.latency=D,isNaN(w))return n;switch(N.state){case 1:if(t=T.getQualityForBitrate(u,I,E.id,D),n.quality=t,n.reason.throughput=I,N.lastQuality=t,!isNaN(N.lastSegmentDurationS)&&R>=L.B_target){N.state=2,L.Q=s;for(var O=0;O<v;++O)O===N.lastQuality?L.prev_w[O]=1:L.prev_w[O]=0}break;case 2:var P=[],M=h.getCurrentHttpRequest(g).trace.reduce((function(e,t){return e+t.d}),0),k=h.getCurrentHttpRequest(g).trace.reduce((function(e,t){return e+t.b[0]}),0),x=Math.round(8*k/M),F=h.getCurrentHttpRequest(g);if(x<1&&(x=1),F.url===N.lastSegmentUrl||F.type===o.w.INIT_SEGMENT_TYPE)t=N.lastQuality;else{for(var U=N.lastSegmentDurationS,B=1,Z=0;Z<v;++Z)m[Z]=m[Z]/1e3,C*m[Z]>x&&(B=-1),L.w[Z]=L.prev_w[Z]+B*(U/(2*l))*((L.Q+s)*(C*m[Z]/x));L.w=function(e){for(var t=e.length,r=!1,n=[],i=0;i<t;++i)n[i]=e[i];for(var a=e.sort((function(e,t){return t-e})),o=0,s=0,l=[],u=0;u<t-1;++u)if((s=((o+=a[u])-1)/(u+1))>=a[u+1]){r=!0;break}r||(s=(o+a[t-1]-1)/t);for(var c=0;c<t;++c)l[c]=Math.max(n[c]-s,0);return l}(L.w);for(var G=0;G<v;++G)P[G]=L.w[G]-L.prev_w[G],L.prev_w[G]=L.w[G];L.Q=Math.max(0,L.Q-U+U*C*((_(m,L.prev_w)+_(m,P))/x));for(var K=[],H=0;H<v;++H)K[H]=Math.abs(m[H]-_(L.w,m));(t=K.indexOf(Math.min.apply(Math,K)))>N.lastQuality&&m[N.lastQuality+1]<=x&&(t=N.lastQuality+1),m[t]>=x&&(L.Q=2*Math.max(s,L.Q)),N.lastSegment.url=F.url}n.quality=t,n.reason.throughput=w,n.reason.latency=D,n.reason.bufferLevel=R,N.lastQuality=n.quality;break;default:f.debug("L2A ABR rule invoked in bad state."),n.quality=T.getQualityForBitrate(u,I,E.id,D),n.reason.state=N.state,n.reason.throughput=I,n.reason.latency=D,N.state=1,p(N)}return n},reset:function(){S(),g.off(l.Z.PLAYBACK_SEEKING,m,t),g.off(l.Z.MEDIA_FRAGMENT_LOADED,v,t),g.off(l.Z.METRIC_ADDED,y,t),g.off(l.Z.QUALITY_CHANGE_REQUESTED,T,t)}},f=(0,u.Z)(d).getInstance().getLogger(t),S(),g.on(l.Z.PLAYBACK_SEEKING,m,t),g.on(l.Z.MEDIA_FRAGMENT_LOADED,v,t),g.on(l.Z.METRIC_ADDED,y,t),g.on(l.Z.QUALITY_CHANGE_REQUESTED,T,t),t}f.__dashjs_factory_name="L2ARule";const d=a.Z.getClassFactory(f)},6070:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(5448),i=r(6398),a=r(2068);function o(){var e,t,r=this.context;return e={getMaxIndex:function(e){for(var n=e?e.getSwitchHistory():null,i=n?n.getSwitchRequests():[],o=0,s=0,l=0,u=(0,a.Z)(r).create(),c=0;c<i.length;c++)if(void 0!==i[c]&&(o+=i[c].drops,s+=i[c].noDrops,l+=i[c].dropSize,o+s>=6&&o/s>.075)){u.quality=c>0&&i[c].drops>0?c-1:c,u.reason={index:u.quality,drops:o,noDrops:s,dropSize:l},t.debug("Switch history rule index: "+u.quality+" samples: "+(o+s)+" drops: "+o);break}return u}},t=(0,i.Z)(r).getInstance().getLogger(e),e}o.__dashjs_factory_name="SwitchHistoryRule";const s=n.Z.getClassFactory(o)},5628:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var n=r(5448),i=r(2068),a=r(3393),o=r(3860);function s(e){e=e||{};var t=this.context,r=e.dashMetrics;return{getMaxIndex:function(e){var n=(0,i.Z)(t).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return n;!function(){if(!r||!r.hasOwnProperty("getCurrentBufferState"))throw new Error(a.Z.MISSING_CONFIG_ERROR)}();var s=e.getMediaInfo(),l=e.getMediaType(),u=r.getCurrentBufferState(l),c=e.getScheduleController(),f=e.getAbrController(),d=e.getStreamInfo(),h=d?d.id:null,g=d&&d.manifestInfo?d.manifestInfo.isDynamic:null,p=f.getThroughputHistory(),m=p.getSafeAverageThroughput(l,g),v=p.getAverageLatency(l),y=e.useBufferOccupancyABR();return isNaN(m)||!u||y||f.getAbandonmentStateFor(h,l)!==o.Z.ABANDON_LOAD&&(u.state===o.Z.BUFFER_LOADED||g)&&(n.quality=f.getQualityForBitrate(s,m,h,v),c.setTimeToLoadDelay(0),n.reason={throughput:m,latency:v}),n},reset:function(){}}}s.__dashjs_factory_name="ThroughputRule";const l=n.Z.getClassFactory(s)},4722:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(6398);function a(){var e,t,r,n,a,o,s,l,u,c=this.context;function f(){r=null,n=1,a=100,o=0,s=null,l=null,u="dynamic_weight_selection"}function d(){var e=0;if(r)for(var t=0;t<r.length;t++){var n=r[t];n.state.throughput>e&&(e=n.state.throughput)}return e}function h(e,t,r){var n=e.map((function(e,n){return r[n]*Math.pow(e-t[n],2)})).reduce((function(e,t){return e+t}));return(n<0?-1:1)*Math.sqrt(Math.abs(n))}function g(e,t){return h([e.state.throughput,e.state.latency,e.state.rebuffer,e.state.switch],[t.state.throughput,t.state.latency,t.state.rebuffer,t.state.switch],[1,1,1,1])}function p(e,t,r){for(var n=0;n<t.length;n++){var i=t[n],a=g(i,e);m(i,r,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))))}}function m(e,t,r){var n=e.state,i=[.01,.01,.01,.01];n.throughput=n.throughput+(t[0]-n.throughput)*i[0]*r,n.latency=n.latency+(t[1]-n.latency)*i[1]*r,n.rebuffer=n.rebuffer+(t[2]-n.rebuffer)*i[2]*r,n.switch=n.switch+(t[3]-n.switch)*i[3]*r}return e={getNextQuality:function(e,i,c,f,g,m,v){var y=c,E=f,T=i,_=function(e){if(!r){r=[];var t=e.bitrateList,i=[];o=t[0].bandwidth,t.forEach((function(e){i.push(e.bandwidth),e.bandwidth<o&&(o=e.bandwidth)})),u=i.map((function(e){return Math.pow(e,2)})).reduce((function(e,t){return e+t})),n=Math.sqrt(u);for(var a=0;a<t.length;a++){var s={qualityIndex:a,bitrate:t[a].bandwidth,state:{throughput:t[a].bandwidth/n,latency:0,rebuffer:0,switch:0}};r.push(s)}l=function(e){var t=[],r=function(e){for(var t=[],r=0;r<e;r++){var n=[Math.random()*d(),Math.random(),Math.random(),Math.random()];t.push(n)}return t}(Math.pow(e.length,2));t.push(r[0]);for(var n=[1,1,1,1],i=1;i<e.length;i++){for(var a=null,o=null,s=0;s<r.length;s++){for(var l=r[s],u=null,c=0;c<t.length;c++){var f=h(l,t[c],n);(null===u||f<u)&&(u=f)}(null===o||u>o)&&(a=l,o=u)}t.push(a)}for(var g=null,p=null,m=0;m<t.length;m++){for(var v=0,y=0;y<t.length;y++)m!==y&&(v+=h(t[m],t[y],n));(null===g||v>g)&&(g=v,p=m)}var E=[];for(E.push(t[p]),t.splice(p,1);t.length>0;){for(var T=null,_=null,S=0;S<t.length;S++){var A=h(E[0],t[S],n);(null===T||A<T)&&(T=A,_=S)}E.push(t[_]),t.splice(_,1)}return E}(r)}var u;return r}(e),S=i/n;S>1&&(S=d()),c/=a,t.debug("getNextQuality called throughput:".concat(S," latency:").concat(c," bufferSize:").concat(f," currentQualityIndex:").concat(m," playbackRate:").concat(g));var A=_[m],b=A.bitrate*v.getSegmentDuration()/T,R=Math.max(0,b-E);if(E-b<v.getMinBuffer())return t.debug("Buffer is low for bitrate= ".concat(A.bitrate," downloadTime=").concat(b," currentBuffer=").concat(E," rebuffer=").concat(R)),function(e,t){var n=0,i=e;if(r)for(var a=0;a<r.length;a++){var o=r[a];o.bitrate<e.bitrate&&o.bitrate>n&&t>o.bitrate&&(n=o.bitrate,i=o)}return i}(A,T).qualityIndex;switch(u){case"manual_weight_selection":s=[.4,.4,.4,.4];break;case"random_weight_selection":!function(e){s=function(e,t){for(var r=[],n=Math.sqrt(2/e),i=0;i<4;i++)r.push(Math.random()*n);return s=r}(e.length)}(_);break;default:!function(e,t,r,n,i,a,o){s||(s=l[l.length-1]);var u=e.findWeightVector(t,r,n,i,a,o);null!==u&&-1!==u&&(s=u)}(v,_,y,E,R,T,g)}for(var I=null,w=null,D=null,C=0;C<_.length;C++){var N=_[C],L=N.state,O=[L.throughput,L.latency,L.rebuffer,L.switch],P=s.slice(),M=v.getNextBufferWithBitrate(N.bitrate,E,T),k=M<v.getMinBuffer();k&&t.debug("Buffer is low for bitrate=".concat(N.bitrate," downloadTime=").concat(b," currentBuffer=").concat(E," nextBuffer=").concat(M)),(N.bitrate>i-1e4||k)&&N.bitrate!==o&&(P[0]=100);var x=h(O,[S,0,0,0],P);(null===I||x<I)&&(I=x,w=N.qualityIndex,D=N)}var F=Math.abs(A.bitrate-D.bitrate)/n;return p(A,_,[S,c,R,F]),p(D,_,[S,0,0,F]),w},reset:function(){f()}},t=(0,i.Z)(c).getInstance().getLogger(e),f(),e}a.__dashjs_factory_name="LearningAbrController";const o=n.Z.getClassFactory(a)},5317:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(2298);function a(){var e,t,r,n,a;function o(){t=null,r=null,n=null,a=null}function s(e,t,r,n){var a=new i.Z;return a.type=e,a.weights.bitrateReward=t||1,a.weights.bitrateSwitchPenalty=1,a.weights.rebufferPenalty=r||1e3,a.weights.latencyPenalty=[],a.weights.latencyPenalty.push({threshold:1.1,penalty:.05*n}),a.weights.latencyPenalty.push({threshold:1e8,penalty:.1*r}),a.weights.playbackSpeedPenalty=n||200,a}function l(e,t,r,n,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var a=0;a<i.weights.latencyPenalty.length;a++){var o=i.weights.latencyPenalty[a];if(r<=o.threshold){i.latencyWSum+=o.penalty*r;break}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-n),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,i,o){t=s("segment",e,i,o),r=e,n=i,a=o},logSegmentMetrics:function(e,r,n,i){t&&l(e,r,n,i,t)},getPerSegmentQoe:function(){return t},calculateSingleUseQoe:function(e,t,i,o){var u=null;return r&&n&&a&&(u=s("segment",r,n,a)),u?(l(e,t,i,o,u),u.totalQoe):0},reset:function(){o()}},o(),e}a.__dashjs_factory_name="LoLpQoeEvaluator";const o=n.Z.getClassFactory(a)},5435:(e,t,r)=>{"use strict";r.d(t,{Z:()=>d});var n=r(6398),i=r(5448),a=r(4722),o=r(5317),s=r(2068),l=r(3860),u=r(6523),c=r(3393);function f(e){var t,r,i,f,d=(e=e||{}).dashMetrics,h=this.context;return r={getMaxIndex:function(e){try{var r=(0,s.Z)(h).create(),n=e.getMediaInfo().type,a=e.getAbrController(),o=e.getStreamInfo(),g=a.getQualityFor(n,o.id),p=e.getMediaInfo(),m=d.getCurrentBufferState(n),v=e.getScheduleController(),y=d.getCurrentBufferLevel(n,!0),E=o&&o.manifestInfo?o.manifestInfo.isDynamic:null,T=v.getPlaybackController(),_=T.getCurrentLiveLatency();if(!e.useLoLPABR()||n===c.Z.AUDIO)return r;_||(_=0);var S=T.getPlaybackRate(),A=a.getThroughputHistory().getSafeAverageThroughput(n,E);if(t.debug("Throughput ".concat(Math.round(A)," kbps")),isNaN(A)||!m)return r;if(a.getAbandonmentStateFor(o.id,n)===l.Z.ABANDON_LOAD)return r;for(var b=p.bitrateList,R=e.getRepresentationInfo().fragmentDuration,I=b[0].bandwidth/1e3,w=b[b.length-1].bandwidth/1e3,D=0;D<b.length;D++){var C=b[D].bandwidth/1e3;C>w?w=C:C<I&&(I=C)}var N=b[g].bandwidth/1e3,L=d.getCurrentHttpRequest(n,!0),O=(L.tresponse.getTime()-L.trequest.getTime())/1e3,P=O>R?O-R:0;f.setupPerSegmentQoe(R,w,I),f.logSegmentMetrics(N,P,_,S);var M=(0,u.Z)(h).create({targetLatency:1.5,bufferMin:.3,segmentDuration:R,qoeEvaluator:f});return r.quality=i.getNextQuality(p,1e3*A,_,y,S,g,M),r.reason={throughput:A,latency:_},r.priority=s.Z.PRIORITY.STRONG,v.setTimeToLoadDelay(0),r.quality!==g&&t.debug("[TgcLearningRule]["+n+"] requesting switch to index: ",r.quality,"Average throughput",Math.round(A),"kbps"),r}catch(e){throw e}},reset:function(){i.reset(),f.reset()}},t=(0,n.Z)(h).getInstance().getLogger(r),i=(0,a.Z)(h).create(),f=(0,o.Z)(h).create(),r}f.__dashjs_factory_name="LoLPRule";const d=i.Z.getClassFactory(f)},6523:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(5448);function i(e){var t,r,n,i,a=e.targetLatency,o=e.bufferMin,s=e.segmentDuration,l=e.qoeEvaluator;function u(){return s}function c(e,t){var r=u();return t>r?e-r:e+r-t}return t={getMinBuffer:function(){return o},getSegmentDuration:u,getNextBufferWithBitrate:function(e,t,r){return c(t,e*s/r)},getNextBuffer:c,findWeightVector:function(e,t,i,u,f,d){var h=null,g=null,p=null,m=Math.abs(t-n);return e.forEach((function(e){r.forEach((function(r){r[0];var n=r[1],u=r[2],v=(r[3],e.bitrate*s/f),y=c(i,v),E=(0===u?10:1/u)*Math.max(1e-5,v-y),T=(0===n?10:1/n)*e.state.latency,_=l.calculateSingleUseQoe(e.bitrate,E,T,d);(null===h||_>h)&&function(e,t,r){return!(e>a+r)&&t>=o}(t,y,m)&&(h=_,g=r,p=e.bitrate)}))})),null===g&&null===p&&(g=-1),n=t,g}},r=function e(t,r,n){if(n===r)return t;for(var a=t.length,o=0;o<a;o++)for(var s=t.shift(),l=0;l<i.length;l++)t.push(s.concat(i[l]));return e(t,r,n+1)}((i=[.2,.4,.6,.8,1]).map((function(e){return[e]})),4,1),n=0,t}i.__dashjs_factory_name="LoLpWeightSelector";const a=n.Z.getClassFactory(i)},2298:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},7803:(e,t,r)=>{"use strict";r.d(t,{Y:()=>h,Z:()=>p});var n=r(3393),i=r(1553),a=r(5448),o=r(2128),s=r(2594),l=r(7387),u=r(7417),c=r(9032),f=r(9326),d=r(7802),h=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function g(e){var t,r,a,g,p,m,v,y,E=this.context,T=e.adapter,_=e.baseURLController,S=e.streamInfo,A=e.timelineConverter,b=e.debug,R=e.eventBus,I=e.events,w=e.dashConstants,D=(0,s.Z)(E).getInstance();function C(e,t){var n=new o.Z;n.id=e.id,n.bitrate=e.bandwidth,n.width=e.width,n.height=e.height,n.tilesHor=1,n.tilesVert=1,e.essentialProperties&&e.essentialProperties.forEach((function(e){if(h.indexOf(e.schemeIdUri)>=0&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}})),t?m.updateSegmentData(e).then((function(t){!function(e,t,r){var n=[],i=function(e,t){var r,n,i,a,o=[],s=0;for(r=0,n=e.segments.length;r<n;r++)i=e.segments[r],(a=(0,l.TJ)(A,T.getIsDynamic(),t,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,s))&&(o.push(a),a=null,s++);return o}(r,t);t.segments=i,e.segmentDuration=t.segments[0].duration,e.readThumbnail=function(e,r){var i=null;n.some((function(t){if(t.start<=e&&t.end>e)return i=t.url,!0})),i?r(i):t.segments.some((function(i){if(i.mediaStartTime<=e&&i.mediaStartTime+i.duration>e){var a=_.resolve(t.path);return v.load({method:"get",url:a.url,request:{range:i.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=y.getSamplesInfo(e.target.response),a=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),o=window.URL.createObjectURL(a);n.push({start:i.mediaStartTime,end:i.mediaStartTime+i.duration,url:o}),r&&r(o)}}),!0}}))}}(n,e,t)})):(n.startNumber=e.startNumber,n.segmentDuration=e.segmentDuration,n.timescale=e.timescale,n.templateUrl=function(e){var t=D.isRelative(e.media)?D.resolve(e.media,_.resolve(e.path).url):e.media;return t?(0,l.Aj)(t,e.id):""}(e)),n.tilesHor>0&&n.tilesVert>0&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,r.push(n))}function N(){r=[],g=-1,p=null}return t={getTracks:function(){return r},addTracks:function(){if(S&&T&&(p=T.getMediaInfoForType(S,n.Z.IMAGE))){var e=T.getVoRepresentations(p);e&&e.length>0&&e.forEach((function(e){(e.segmentInfoType===i.Z.SEGMENT_TEMPLATE&&e.segmentDuration>0&&e.media||e.segmentInfoType===i.Z.SEGMENT_TIMELINE)&&C(e),e.segmentInfoType===i.Z.SEGMENT_BASE&&C(e,!0)})),r.length>0&&r.sort((function(e,t){return e.bitrate-t.bitrate}))}},reset:N,setTrackByIndex:function(e){r&&0!==r.length&&(e>=r.length&&(e=r.length-1),g=e)},getCurrentTrack:function(){return g<0?null:r[g]},getCurrentTrackIndex:function(){return g},getThumbnailRequestForTime:function(e){for(var t,n=T.getVoRepresentations(p),i=0;i<n.length;i++)if(r[g].id===n[i].id){t=n[i];break}return a.getSegmentRequestForTime(p,t,e)}},N(),v=(0,c.Z)(E).create({}),y=(0,u.Z)(E).getInstance(),m=(0,d.Z)(E).create({events:I,eventBus:R,streamInfo:S,timelineConverter:A,dashConstants:w,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:n.Z.IMAGE}),(a=(0,f.Z)(E).create({streamInfo:S,type:n.Z.IMAGE,timelineConverter:A,segmentsController:m,baseURLController:_,debug:b,eventBus:R,events:I,dashConstants:w,urlUtils:D})).initialize(!!T&&T.getIsDynamic()),t}g.__dashjs_factory_name="ThumbnailTracks";const p=a.Z.getClassFactory(g)},7417:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(6398),i=r(8260),a=r(5448),o=r(6934),s=r(9597);function l(){var e,t,r=this.context;function a(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=o.parseBuffer(e),n=(0,i.Z)(r).create();return n.setData(t),n}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return t={parse:a,findLastTopIsoBoxCompleted:function(e,t,r){if(void 0===r&&(r=0),!t||r+8>=t.byteLength)return new s.Z(0,!1);for(var n,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;r<i.byteLength;){var o=l(i,r),c=u(i,r+4);if(0===o)break;r+o<=i.byteLength&&(e.indexOf(c)>=0?n=new s.Z(r,!0,o):a=r+o),r+=o}return n||new s.Z(a,!1)},getMediaTimescaleFromMoov:function(e){var t=a(e),r=t?t.getBox("mdhd"):void 0;return r?r.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,r,n,i,o,s,l,u,c,f,d,h,g,p,m,v,y=a(e),E=y.getBoxes("moof"),T=y.getBoxes("mfhd");m=y.getBoxes("moof").length,p=T[T.length-1].sequence_number,r=0,o=[];var _=-1,S=-1;for(f=0;f<E.length;f++){var A=E[f],b=A.getChildBoxes("traf");for(u=0;u<b.length;u++){var R=b[u],I=R.getChildBox("tfhd"),w=R.getChildBox("tfdt");i=w.baseMediaDecodeTime;var D=R.getChildBoxes("trun"),C=R.getChildBoxes("subs");for(c=0;c<D.length;c++){var N=D[c];for(r=N.sample_count,g=(I.base_data_offset||0)+(N.data_offset||0),l=0;l<r;l++){t=void 0!==(s=N.samples[l]).sample_duration?s.sample_duration:I.default_sample_duration,n=void 0!==s.sample_size?s.sample_size:I.default_sample_size;var L={dts:i,cts:i+(void 0!==s.sample_composition_time_offset?s.sample_composition_time_offset:0),duration:t,offset:A.offset+g,size:n,subSizes:[n]};if(C)for(d=0;d<C.length;d++){var O=C[d];if(_<O.entry_count-1&&l>S&&(_++,S+=O.entries[_].sample_delta),l==S){L.subSizes=[];var P=O.entries[_];for(h=0;h<P.subsample_count;h++)L.subSizes.push(P.subsamples[h].subsample_size)}}o.push(L),g+=n,i+=t}}v=i-w.baseMediaDecodeTime}}return{sampleList:o,lastSequenceNumber:p,totalDuration:v,numSequences:m}},findInitRange:function(t){var r=null,n=a(t);if(!n)return r;var i=n.getBox("ftyp"),o=n.getBox("moov");return e.debug("Searching for initialization."),o&&o.isComplete&&(r=(i?i.offset:o.offset)+"-"+(o.offset+o.size-1),e.debug("Found the initialization.  Range: "+r)),r},parsePayload:function(e,t,r){if(void 0===r&&(r=0),!t||r+8>=t.byteLength)return new s.Z(0,!1);for(var n,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;r<i.byteLength;){var o=l(i,r),c=u(i,r+4);if(0===o)break;r+o<=i.byteLength&&(e.indexOf(c)>=0?n=new s.Z(r,!0,o,c):a=r+o),r+=o}return n||new s.Z(a,!1)}},e=(0,n.Z)(r).getInstance().getLogger(t),t}l.__dashjs_factory_name="BoxParser";const u=a.Z.getSingletonFactory(l)},1715:(e,t,r)=>{"use strict";r.d(t,{B:()=>s,Z:()=>u});var n=r(5448),i=r(7803),a=r(3393),o=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function l(){var e,t,r;return e={setConfig:function(e){e&&e.settings&&(t=e.settings)},supportsMediaSource:s,supportsEncryptedMedia:function(){return r},supportsCodec:function(e,r){return r!==a.Z.AUDIO&&r!==a.Z.VIDEO?Promise.resolve(!0):function(e,r){return t.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(e.codec&&r===a.Z.AUDIO||r===a.Z.VIDEO&&e.codec&&e.width&&e.height&&e.bitrate&&e.framerate)}(e,r)?function(e,t){return new Promise((function(r){if(e&&e.codec){var n={type:"media-source"};n[t]={},n[t].contentType=e.codec,n[t].width=e.width,n[t].height=e.height,n[t].bitrate=parseInt(e.bitrate),n[t].framerate=parseFloat(e.framerate),navigator.mediaCapabilities.decodingInfo(n).then((function(e){r(e.supported)})).catch((function(){r(!1)}))}else r(!1)}))}(e,r):function(e){return new Promise((function(t){if(e&&e.codec){var r=e.codec;e.width&&e.height&&(r+=';width="'+e.width+'";height="'+e.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(r)||"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(r)?t(!0):t(!1)}else t(!1)}))}(e)},setEncryptedMediaSupported:function(e){r=e},supportsEssentialProperty:function(e){try{return-1!==i.Y.indexOf(e.schemeIdUri)}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var r,n=e.split(".")[0],i=0===t.indexOf(n),a=0;a<o.length;a++)if(o[a].codec===n){r=o[a];break}return r?i||r.compatibleCodecs.some((function(e){return 0===t.indexOf(e)})):i}},r=!1,e}l.__dashjs_factory_name="Capabilities";const u=n.Z.getSingletonFactory(l)},2295:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(3106);function a(){return{customTimeRangeArray:[],length:0,add:function(e,t){var r;for(r=0;r<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[r].start;r++);for(this.customTimeRangeArray.splice(r,0,{start:e,end:t}),r=0;r<this.customTimeRangeArray.length-1;r++)this.mergeRanges(r,r+1)&&r--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var r=0;r<this.customTimeRangeArray.length;r++)if(e<=this.customTimeRangeArray[r].start&&t>=this.customTimeRangeArray[r].end)this.customTimeRangeArray.splice(r,1),r--;else{if(e>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end){this.customTimeRangeArray.splice(r+1,0,{start:t,end:this.customTimeRangeArray[r].end}),this.customTimeRangeArray[r].end=e;break}e>this.customTimeRangeArray[r].start&&e<this.customTimeRangeArray[r].end?this.customTimeRangeArray[r].end=e:t>this.customTimeRangeArray[r].start&&t<this.customTimeRangeArray[r].end&&(this.customTimeRangeArray[r].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var r=this.customTimeRangeArray[e],n=this.customTimeRangeArray[t];return r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(r.end=n.end,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(r.start=n.start,this.customTimeRangeArray.splice(t,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end?(this.customTimeRangeArray.splice(e,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return(0,i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return(0,i.SE)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}a.__dashjs_factory_name="CustomTimeRanges";const o=n.Z.getClassFactory(a)},5:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(5448);function i(){var e,t=/^[a-z][a-z0-9+\-_.]*:/i,r=/^https?:\/\//i,n=/^https:\/\//i,i=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new window.URL(e,t).toString()}catch(t){return e}},o=function(e,t){var r=s;if(!t)return e;if(!c(e))return e;f(e)&&(r=l),d(e)&&(r=u);var n=r(t),i="/"!==n.charAt(n.length-1)&&"/"!==e.charAt(0)?"/":"";return[n,e].join(i)};function s(e){var t=e.indexOf("/"),r=e.lastIndexOf("/");return-1!==t?r===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,r+1)):""}function l(e){var t=e.match(i);return t?t[1]:""}function u(e){var r=e.match(t);return r?r[0]:""}function c(e){return!t.test(e)}function f(e){return c(e)&&"/"===e.charAt(0)}function d(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:f,isSchemeRelative:d,isHTTPURL:function(e){return r.test(e)},isHTTPS:function(e){return n.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(t,r){return e(t,r)}}}i.__dashjs_factory_name="DefaultURLUtils";const a=n.Z.getSingletonFactory(i)},8260:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(2839),i=r(5448);function a(){var e;function t(t){var n=[];if(!t||!e||"function"!=typeof e.fetchAll)return n;for(var i,a=e.fetchAll(t),o=0,s=a.length;o<s;o++)(i=r(a[o]))&&n.push(i);return n}function r(e){if(!e)return null;var t=new n.Z(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(t){return t&&e&&e.boxes&&0!==e.boxes.length&&"function"==typeof e.fetch?r(e.fetch(t)):null},getBoxes:t,setData:function(t){e=t},getLastBox:function(){if(!e||!e.boxes||!e.boxes.length)return null;var r=t(e.boxes[e.boxes.length-1].type);return r.length>0?r[r.length-1]:null}}}a.__dashjs_factory_name="IsoFile";const o=i.Z.getClassFactory(a)},7473:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o,k:()=>i});var n=r(5448);function i(e,t){var r={url:e.url,method:e.method,headers:Object.assign({},e.headers),credentials:e.withCredentials?"include":void 0};return Promise.resolve(t.modifyRequest(r)).then((function(){return Object.assign(e,r,{withCredentials:"include"===r.credentials})}))}function a(){return{modifyRequest:null,modifyRequestURL:function(e){return e},modifyRequestHeader:function(e,t){return t.url,e}}}a.__dashjs_factory_name="RequestModifier";const o=n.Z.getSingletonFactory(a)},3106:(e,t,r)=>{"use strict";r.d(t,{PS:()=>a,SE:()=>o});var n=r(3393);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,t){if(i(e)!==t)throw n.Z.BAD_ARGUMENT_ERROR}function o(e){if(null===e||isNaN(e)||e%1!=0)throw n.Z.BAD_ARGUMENT_ERROR+" : argument is not an integer"}},2594:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(5448),i=r(5);function a(){var e,t=[],r=this.context;function n(r,n,i){var a=function(r){var n;for(n=0;n<t.length;n++)if(t[n].regex.test(r))return t[n].utils;return e}(i||n);return a&&"function"==typeof a[r]?a[r](n,i):e[r](n,i)}return e=(0,i.Z)(r).getInstance(),{registerUrlRegex:function(e,r){t.push({regex:e,utils:r})},parseBaseUrl:function(e){return n("parseBaseUrl",e)},parseOrigin:function(e){return n("parseOrigin",e)},parseScheme:function(e){return n("parseScheme",e)},isRelative:function(e){return n("isRelative",e)},isPathAbsolute:function(e){return n("isPathAbsolute",e)},isSchemeRelative:function(e){return n("isSchemeRelative",e)},isHTTPURL:function(e){return n("isHTTPURL",e)},isHTTPS:function(e){return n("isHTTPS",e)},removeHostname:function(e){return n("removeHostname",e)},resolve:function(e,t){return n("resolve",e,t)}}}a.__dashjs_factory_name="URLUtils";const o=n.Z.getSingletonFactory(a)},5459:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=r||null,this.data=n||null}},3186:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(7855),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.action=e.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=t||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}var t;return(t=[{key:"isInitializationRequest",value:function(){return this.type&&this.type===n.w.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?n.w.INIT_SEGMENT_TYPE:n.w.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();i.ACTION_DOWNLOAD="download",i.ACTION_COMPLETE="complete";const a=i},2839:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offset=t._offset,this.type=t.type,this.size=t.size,this.boxes=[],t.boxes)for(var r=0;r<t.boxes.length;r++)this.boxes.push(new e(t.boxes[r]));switch(this.isComplete=!0,t.type){case"sidx":if(this.timescale=t.timescale,this.earliest_presentation_time=t.earliest_presentation_time,this.first_offset=t.first_offset,this.references=t.references,t.references){this.references=[];for(var n=0;n<t.references.length;n++){var i={reference_type:t.references[n].reference_type,referenced_size:t.references[n].referenced_size,subsegment_duration:t.references[n].subsegment_duration};this.references.push(i)}}break;case"emsg":this.id=t.id,this.version=1===t.version?1:0,this.value=t.value,this.timescale=t.timescale,this.scheme_id_uri=t.scheme_id_uri,this.presentation_time_delta=1===t.version?t.presentation_time:t.presentation_time_delta,this.event_duration=t.event_duration,this.message_data=t.message_data;break;case"mdhd":this.timescale=t.timescale;break;case"mfhd":this.sequence_number=t.sequence_number;break;case"subs":this.entry_count=t.entry_count,this.entries=t.entries;break;case"tfhd":this.base_data_offset=t.base_data_offset,this.sample_description_index=t.sample_description_index,this.default_sample_duration=t.default_sample_duration,this.default_sample_size=t.default_sample_size,this.default_sample_flags=t.default_sample_flags,this.flags=t.flags;break;case"tfdt":this.version=t.version,this.baseMediaDecodeTime=t.baseMediaDecodeTime,this.flags=t.flags;break;case"trun":if(this.sample_count=t.sample_count,this.first_sample_flags=t.first_sample_flags,this.data_offset=t.data_offset,this.flags=t.flags,this.samples=t.samples,t.samples){this.samples=[];for(var a=0,o=t.samples.length;a<o;a++){var s={sample_size:t.samples[a].sample_size,sample_duration:t.samples[a].sample_duration,sample_composition_time_offset:t.samples[a].sample_composition_time_offset};this.samples.push(s)}}break;case"prft":this.version=t.version,this.reference_track_ID=t.reference_track_ID,this.ntp_timestamp_sec=t.ntp_timestamp_sec,this.ntp_timestamp_frac=t.ntp_timestamp_frac,this.media_time=t.media_time,this.flags=t.flags}}var t;return(t=[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],r=0;r<this.boxes.length;r++)this.boxes[r].type===e&&t.push(this.boxes[r]);return t}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}()},9597:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=r,this.size=n}},2128:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});const n=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},7855:(e,t,r)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{O:()=>a,w:()=>i});var i=function e(){n(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},a=function e(){n(this,e),this.s=null,this.d=null,this.b=[]};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",i.DVB_REPORTING_TYPE="DVBReporting",i.LICENSE="license",i.CONTENT_STEERING_TYPE="ContentSteering",i.OTHER_TYPE="other"},3039:(e,t)=>{"use strict";function r(e,t){return function(r,i){for(var a,o,s,l=n(r,"tag"),u=n(null==i?"*":i,"range"),c=[],f=-1;++f<u.length;)if(a=u[f].toLowerCase(),t||"*"!==a){for(o=-1,s=[];++o<l.length;)if(e(l[o].toLowerCase(),a)){if(!t)return l[o];c.push(l[o])}else s.push(l[o]);l=s}return t?c:void 0}}function n(e,t){var r=e&&"string"==typeof e?[e]:e;if(!r||"object"!=typeof r||!("length"in r))throw new Error("Invalid "+t+" `"+r+"`, expected non-empty string");return r}t.basicFilter=r((function(e,t){return"*"===t||e===t||e.indexOf(t+"-")>-1}),!0),t.extendedFilter=r((function(e,t){var r=e.split("-"),n=t.split("-"),i=0,a=0;if("*"!==n[a]&&r[i]!==n[a])return!1;for(i++,a++;a<n.length;)if("*"!==n[a]){if(!r[i])return!1;if(r[i]!==n[a]){if(1===r[i].length)return!1;i++}else i++,a++}else a++;return!0}),!0),t.lookup=r((function(e,t){for(var r,n=t;;){if("*"===n||e===n)return!0;if((r=n.lastIndexOf("-"))<0)return!1;"-"===n.charAt(r-2)&&(r-=2),n=n.slice(0,r)}}))},3973:(e,t,r)=>{"use strict";e.exports=r(3854)},3854:(e,t,r)=>{"use strict";var n=r(2415),i=r(3039),a=r(7778),o=r(5813),s=r(3165),l=r(9460);e.exports=function(e,t){var r,c=t||{},m=n.parse(String(e||"").toLowerCase(),c),v=n.stringify(m),y=-1;if(!v)return v;for(;++y<a.length;)i.extendedFilter(v,a[y].from).length&&(d(m,a[y].from,a[y].to),v=n.stringify(m));for(y=-1;++y<o.length;)h(m,o[y].from.field,o[y].from.value)&&g(m,o[y].to.field,o[y].to.value);for(v=n.stringify(Object.assign({},m,f)),y=-1;++y<s.length;)v===s[y]&&(d(m,s[y],s[y].split("-").slice(0,-1).join("-")),v=n.stringify(Object.assign({},m,f)));if(m.extensions.sort(p),c.warning)for(r in l)u.call(l[r],m[r])&&c.warning("Deprecated "+r+" `"+m[r]+"`, expected one of `"+l[r][m[r]].join("`, `")+"`",null,7);return m.script&&(m.script=m.script.charAt(0).toUpperCase()+m.script.slice(1)),m.region&&(m.region=m.region.toUpperCase()),n.stringify(m)};var u={}.hasOwnProperty,c=new Intl.Collator,f={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function d(e,t,r){var i,a=n.parse(t),o=n.parse(r),s=[];for(i in a)a[i]&&a[i].length&&h(e,i,a[i])&&s.push(i);for(i in o)o[i]&&o[i].length&&(s.indexOf(i)>-1||!e[i]||!e[i].length)&&g(e,i,o[i])}function h(e,t,r){var n,i,a,o,s=!1;if(r){if(i=n=e[t],n&&"object"==typeof n)for(i=[],a=-1;++a<n.length;)o=n[a],r.indexOf(o)<0?i.push(o):s=!0;else n===r&&(i=null,s=!0);e[t]=i}return s}function g(e,t,r){var n,i,a,o=e[t];if(o&&"object"==typeof o)for(n=[].concat(r),i=-1;++i<n.length;)a=n[i],o.indexOf(a)<0&&o.push(a);else e[t]=r}function p(e,t){return c.compare(e.singleton,t.singleton)}},2415:(e,t,r)=>{"use strict";t.parse=r(6903),t.stringify=r(6713)},6903:(e,t,r)=>{"use strict";var n=r(2219),i=r(3516),a=r(395),o=r(858),s=r(8589);e.exports=function e(t,r){var u,c,f,d=r||{},h={language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null},g=String(t),p=g.toLowerCase(),m=0;if(null==t)throw new Error("Expected string, got `"+t+"`");if(l.call(s,p))return(null==d.normalize||d.normalize)&&s[p]?e(s[p]):(h[-1===o.indexOf(p)?"irregular":"regular"]=g,h);for(;i(p.charCodeAt(m))&&m<9;)m++;if(m>1&&m<9){if(h.language=g.slice(0,m),m<4)for(c=0;45===p.charCodeAt(m)&&i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&i(p.charCodeAt(m+3))&&!i(p.charCodeAt(m+4));){if(c>2)return v(m,3,"Too many extended language subtags, expected at most 3 subtags");h.extendedLanguageSubtags.push(g.slice(m+1,m+4)),m+=4,c++}for(45===p.charCodeAt(m)&&i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&i(p.charCodeAt(m+3))&&i(p.charCodeAt(m+4))&&!i(p.charCodeAt(m+5))&&(h.script=g.slice(m+1,m+5),m+=5),45===p.charCodeAt(m)&&(i(p.charCodeAt(m+1))&&i(p.charCodeAt(m+2))&&!i(p.charCodeAt(m+3))?(h.region=g.slice(m+1,m+3),m+=3):a(p.charCodeAt(m+1))&&a(p.charCodeAt(m+2))&&a(p.charCodeAt(m+3))&&!a(p.charCodeAt(m+4))&&(h.region=g.slice(m+1,m+4),m+=4));45===p.charCodeAt(m);){for(f=u=m+1;n(p.charCodeAt(f));){if(f-u>7)return v(f,1,"Too long variant, expected at most 8 characters");f++}if(!(f-u>4||f-u>3&&a(p.charCodeAt(u))))break;h.variants.push(g.slice(u,f)),m=f}for(;45===p.charCodeAt(m)&&120!==p.charCodeAt(m+1)&&n(p.charCodeAt(m+1))&&45===p.charCodeAt(m+2)&&n(p.charCodeAt(m+3));){for(f=m+2,c=0;45===p.charCodeAt(f)&&n(p.charCodeAt(f+1))&&n(p.charCodeAt(f+2));)for(f=(u=f+1)+2,c++;n(p.charCodeAt(f));){if(f-u>7)return v(f,2,"Too long extension, expected at most 8 characters");f++}if(!c)return v(f,4,"Empty extension, extensions must have at least 2 characters of content");h.extensions.push({singleton:g.charAt(m+1),extensions:g.slice(m+3,f).split("-")}),m=f}}else m=0;if(0===m&&120===p.charCodeAt(m)||45===p.charCodeAt(m)&&120===p.charCodeAt(m+1))for(f=m=m?m+2:1;45===p.charCodeAt(f)&&n(p.charCodeAt(f+1));){for(f=u=m+1;n(p.charCodeAt(f));){if(f-u>7)return v(f,5,"Too long private-use area, expected at most 8 characters");f++}h.privateuse.push(g.slice(m+1,f)),m=f}return m!==g.length?v(m,6,"Found superfluous content after tag"):h;function v(e,t,r){return d.warning&&d.warning(r,t,e),d.forgiving?h:{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}};var l={}.hasOwnProperty},6713:e=>{"use strict";e.exports=function(e){var t,r,n,i=e||{},a=[];if(i.irregular||i.regular)return i.irregular||i.regular;if(i.language)for(a=a.concat(i.language,i.extendedLanguageSubtags||[],i.script||[],i.region||[],i.variants||[]),t=i.extensions||[],r=-1;++r<t.length;)(n=t[r]).singleton&&n.extensions&&n.extensions.length&&(a=a.concat(n.singleton,n.extensions));return i.privateuse&&i.privateuse.length&&(a=a.concat("x",i.privateuse)),a.join("-")}},1549:(e,t,r)=>{"use strict";var n=r(6693),i=r(2165),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50;var o=2147483647;function s(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|p(e,t),n=s(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){var t=new Uint8Array(e);return h(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return h(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return h(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);var i=function(e){if(l.isBuffer(e)){var t=0|g(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function f(e){return c(e),s(e<0?0:0|g(e))}function d(e){for(var t=e.length<0?0:0|g(e.length),r=s(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function g(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return B(e).length;default:if(i)return n?-1:U(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return R(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),K(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){var a,o=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,l/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(a=r;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(r+l>s&&(r=s-l),a=r;a>=0;a--){for(var f=!0,d=0;d<l;d++)if(u(e,a+d)!==u(t,d)){f=!1;break}if(f)return a}return-1}function T(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var a=t.length;n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(K(s))return o;e[r+o]=s}return o}function _(e,t,r,n){return Z(U(t,e.length-r),e,r,n)}function S(e,t,r,n){return Z(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function A(e,t,r,n){return Z(B(t),e,r,n)}function b(e,t,r,n){return Z(function(e,t){for(var r,n,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,i=r%256,a.push(i),a.push(n);return a}(t,e.length-r),e,r,n)}function R(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function I(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a,o,s,l,u=e[i],c=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=r)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[i+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(l=(15&u)<<12|(63&a)<<6|63&o)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&l<1114112&&(c=l)}null===c?(c=65533,f=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=f}return function(e){var t=e.length;if(t<=w)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=w));return r}(n)}t.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)}(e,t,r)},l.allocUnsafe=function(e){return f(e)},l.allocUnsafeSlow=function(e){return f(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(G(a,Uint8Array))i+a.length>n.length?l.from(a).copy(n,i):Uint8Array.prototype.set.call(n,a,i);else{if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i)}i+=a.length}return n},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(G(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(a,o),u=this.slice(n,i),c=e.slice(t,r),f=0;f<s;++f)if(u[f]!==c[f]){a=u[f],o=c[f];break}return a<o?-1:o<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return T(this,e,t,r);case"utf8":case"utf-8":return _(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return A(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function N(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",a=t;a<r;++a)i+=H[e[a]];return i}function L(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length-1;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function O(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function M(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,a){return t=+t,r>>>=0,a||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function x(e,t,r,n,a){return t=+t,r>>>=0,a||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||O(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||O(e,t,this.length);for(var n=t,i=1,a=this[e+--n];n>0&&(i*=256);)a+=this[e+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||O(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||O(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||O(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||P(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||P(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,e,t,r,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<r&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);P(this,e,t,r,i-1,-i)}var a=r-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return x(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return x(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=l.isBuffer(e)?e:l.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=o[a%s]}return this};var F=/[^+/0-9A-Za-z-_]/g;function U(e,t){var r;t=t||1/0;for(var n=e.length,i=null,a=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function B(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Z(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var H=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},6693:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,a=s(e),o=a[0],l=a[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,l)),c=0,f=l>0?o-4:o;for(r=0;r<f;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===l&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===l&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=16383,s=0,u=n-i;s<u;s+=o)a.push(l(e,s,s+o>u?u:s+o));return 1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=a[o],n[a.charCodeAt(o)]=o;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},2165:(e,t)=>{t.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?i-1:0,d=r?-1:1,h=e[t+f];for(f+=d,a=h&(1<<-c)-1,h>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=d,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+f],f+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,n),a-=u}return(h?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,f=c>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:a-1,g=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+f>=1?d/l:d*Math.pow(2,1-f))*l>=2&&(o++,l/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*l-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[r+h]=255&s,h+=g,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[r+h]=255&o,h+=g,o/=256,u-=8);e[r+h-g]|=128*p}},6934:(e,t)=>{var r={parseBuffer:function(e){return new n(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(i.prototype._boxProcessors[e]=t)},createFile:function(){return new n},createBox:function(e,t,r){var n=i.create(e);return t&&t.append(n,r),n},createFullBox:function(e,t,n){var i=r.createBox(e,t,n);return i.version=0,i.flags=0,i},Utils:{}};r.Utils.dataViewToString=function(e,t){var r=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(r).decode(e);var n=[],i=0;if("utf-8"===r)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?(a=(31&a)<<6,a|=63&e.getUint8(i++)):a<240?(a=(15&a)<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++)):(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12,a|=(63&e.getUint8(i++))<<6,a|=63&e.getUint8(i++))),n.push(String.fromCharCode(a))}else for(;i<e.byteLength;)n.push(String.fromCharCode(e.getUint8(i++)));return n.join("")},r.Utils.utf8ToByteArray=function(e){var t,r;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?(t.push(192|n>>6),t.push(128|63&n)):n<65536?(t.push(224|n>>12),t.push(128|63&n>>6),t.push(128|63&n)):(t.push(240|n>>18),t.push(128|63&n>>12),t.push(128|63&n>>6),t.push(128|63&n))}return t},r.Utils.appendBox=function(e,t,r){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==r)if(null!=r){var n,i=-1;if("number"==typeof r)i=r;else{if("string"==typeof r)n=r;else{if("object"!=typeof r||!r.type)return void e.boxes.push(t);n=r.type}for(var a=0;a<e.boxes.length;a++)if(n===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=r.parseBuffer,t.addBoxProcessor=r.addBoxProcessor,t.createFile=r.createFile,t.createBox=r.createBox,t.createFullBox=r.createFullBox,t.Utils=r.Utils,r.Cursor=function(e){this.offset=void 0===e?0:e};var n=function(e){this._cursor=new r.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};n.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},n.prototype.fetchAll=function(e,t){var r=[];return n._sweep.call(this,e,r,t),r},n.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=i.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},n._sweep=function(e,t,r){for(var i in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&r)return;n._sweep.call(this.boxes[i],e,t,r)}},n.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var r=new Uint8Array(t);for(this._rawo=new DataView(r.buffer),this.bytes=r,this._cursor.offset=0,e=0;e<this.boxes.length;e++)this.boxes[e].write();return r.buffer},n.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)};var i=function(){this._cursor=new r.Cursor};i.parse=function(e){var t=new i;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},i.create=function(e){var t=new i;return t.type=e,t.boxes=[],t},i.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],i.prototype._boxProcessors={},i.prototype._procField=function(e,t,r){this._parsing?this[e]=this._readField(t,r):this._writeField(t,r,this[e])},i.prototype._procFieldArray=function(e,t,r,n){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(r,n);else for(i=0;i<this[e].length;i++)this._writeField(r,n,this[e][i])},i.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},i.prototype._procEntries=function(e,t,r){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push({}),r.call(this,this[e][n]);else for(n=0;n<t;n++)r.call(this,this[e][n])},i.prototype._procSubEntries=function(e,t,r,n){var i;if(this._parsing)for(e[t]=[],i=0;i<r;i++)e[t].push({}),n.call(this,e[t][i]);else for(i=0;i<r;i++)n.call(this,e[t][i])},i.prototype._procEntryField=function(e,t,r,n){this._parsing?e[t]=this._readField(r,n):this._writeField(r,n,e[t])},i.prototype._procSubBoxes=function(e,t){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push(i.parse(this));else for(r=0;r<t;r++)this._rawo?this[e][r].write():this.size+=this[e][r].getLength()},i.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},i.prototype._readInt=function(e){var t=null,r=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(r);break;case 16:t=this._raw.getInt16(r);break;case 32:t=this._raw.getInt32(r);break;case 64:var n=this._raw.getInt32(r),i=this._raw.getInt32(r+4);t=n*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},i.prototype._readUint=function(e){var t,r,n=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:n=this._raw.getUint8(i);break;case 16:n=this._raw.getUint16(i);break;case 24:n=((t=this._raw.getUint16(i))<<8)+(r=this._raw.getUint8(i+2));break;case 32:n=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),r=this._raw.getUint32(i+4),n=t*Math.pow(2,32)+r}return this._cursor.offset+=e>>3,n},i.prototype._readString=function(e){for(var t="",r=0;r<e;r++){var n=this._readUint(8);t+=String.fromCharCode(n)}return t},i.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},i.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},i.prototype._readData=function(e){var t=e>0?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(t>0){var r=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,r}return null},i.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return e>0&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?r.Utils.dataViewToString(t):t},i.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},i.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},i.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(i.parse(this))},i.prototype.append=function(e,t){r.Utils.appendBox(this,e,t)},i.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},i.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},i.prototype._writeInt=function(e,t){if(this._rawo){var r=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(r,t);break;case 16:this._rawo.setInt16(r,t);break;case 32:this._rawo.setInt32(r,t);break;case 64:var n=Math.floor(t/Math.pow(2,32)),i=t-n*Math.pow(2,32);this._rawo.setUint32(r,n),this._rawo.setUint32(r+4,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeUint=function(e,t){if(this._rawo){var r,n,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:r=(16776960&t)>>8,n=255&t,this._rawo.setUint16(i,r),this._rawo.setUint8(i+2,n);break;case 32:this._rawo.setUint32(i,t);break;case 64:n=t-(r=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,r),this._rawo.setUint32(i+4,n)}this._cursor.offset+=e>>3}else this.size+=e>>3},i.prototype._writeString=function(e,t){for(var r=0;r<e;r++)this._writeUint(8,t.charCodeAt(r))},i.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},i.prototype._writeTemplate=function(e,t){var r=Math.floor(t),n=(t-r)*Math.pow(2,e/2);this._writeUint(e/2,r),this._writeUint(e/2,n)},i.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,r=0;r<e.length;r++)this._rawo.setInt8(t+r,e[r]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},i.prototype._writeUTF8String=function(e){var t=r.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),i=0;i<t.length;i++)n.setUint8(i,t[i]);else this.size+=t.length},i.prototype._writeField=function(e,t,r){switch(e){case"uint":this._writeUint(t,r);break;case"int":this._writeInt(t,r);break;case"template":this._writeTemplate(t,r);break;case"string":-1==t?this._writeTerminatedString(r):this._writeString(t,r);break;case"data":this._writeData(r);break;case"utf8":this._writeUTF8String(r)}},i.prototype._boxProcessors.avc1=i.prototype._boxProcessors.avc2=i.prototype._boxProcessors.avc3=i.prototype._boxProcessors.avc4=i.prototype._boxProcessors.hvc1=i.prototype._boxProcessors.hev1=i.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},i.prototype._boxProcessors.ctts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_offset",1===this.version?"int":"uint",32)}))},i.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)}))},i.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},i.prototype._boxProcessors.free=i.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},i.prototype._boxProcessors.ftyp=i.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},i.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},i.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},i.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},i.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},i.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},i.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},i.prototype._boxProcessors.mp4a=i.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},i.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},i.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},i.prototype._boxProcessors.prft=function(){this._procFullBox(),this._procField("reference_track_ID","uint",32),this._procField("ntp_timestamp_sec","uint",32),this._procField("ntp_timestamp_frac","uint",32),this._procField("media_time","uint",1==this.version?64:32)},i.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},i.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},i.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},i.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,(function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)}))},i.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},i.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,(function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,(function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)}))}))},i.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},i.prototype._boxProcessors.sttg=function(){this._procField("settings","utf8")},i.prototype._boxProcessors.stts=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_count","uint",32),this._procEntryField(e,"sample_delta","uint",32)}))},i.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,(function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,(function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)}))}))},i.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},i.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},i.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,(function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))}))},i.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},i.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},i.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,(function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)}))},i.prototype._boxProcessors["url "]=i.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},i.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},i.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},i.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},i.prototype._boxProcessors.vtte=function(){}},5530:(e,t,r)=>{"use strict";e.exports=r(6146).polyfill()},6146:function(e,t,r){e.exports=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,i=void 0,a=void 0,o=function(e,t){h[n]=e,h[n+1]=t,2===(n+=2)&&(a?a(g):E())},s="undefined"!=typeof window?window:void 0,l=s||{},u=l.MutationObserver||l.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(g,1)}}var h=new Array(1e3);function g(){for(var e=0;e<n;e+=2)(0,h[e])(h[e+1]),h[e]=void 0,h[e+1]=void 0;n=0}var p,m,v,y,E=void 0;function T(e,t){var r=this,n=new this.constructor(A);void 0===n[S]&&M(n);var i=r._state;if(i){var a=arguments[i-1];o((function(){return O(i,n,a,r._result)}))}else N(r,n,e,t);return n}function _(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return I(t,e),t}E=c?function(){return process.nextTick(g)}:u?(m=0,v=new u(g),y=document.createTextNode(""),v.observe(y,{characterData:!0}),function(){y.data=m=++m%2}):f?((p=new MessageChannel).port1.onmessage=g,function(){return p.port2.postMessage(0)}):void 0===s?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(g)}:d()}catch(e){return d()}}():d();var S=Math.random().toString(36).substring(2);function A(){}var b=void 0;function R(t,r,n){r.constructor===t.constructor&&n===T&&r.constructor.resolve===_?function(e,t){1===t._state?D(e,t._result):2===t._state?C(e,t._result):N(t,void 0,(function(t){return I(e,t)}),(function(t){return C(e,t)}))}(t,r):void 0===n?D(t,r):e(n)?function(e,t,r){o((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?I(e,r):D(e,r))}),(function(t){n||(n=!0,C(e,t))}),e._label);!n&&i&&(n=!0,C(e,i))}),e)}(t,r,n):D(t,r)}function I(e,t){if(e===t)C(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)D(e,t);else{var r=void 0;try{r=t.then}catch(t){return void C(e,t)}R(e,t,r)}var n,i}function w(e){e._onerror&&e._onerror(e._result),L(e)}function D(e,t){e._state===b&&(e._result=t,e._state=1,0!==e._subscribers.length&&o(L,e))}function C(e,t){e._state===b&&(e._state=2,e._result=t,o(w,e))}function N(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+1]=r,i[a+2]=n,0===a&&e._state&&o(L,e)}function L(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?O(r,n,i,a):i(a);e._subscribers.length=0}}function O(t,r,n,i){var a=e(n),o=void 0,s=void 0,l=!0;if(a){try{o=n(i)}catch(e){l=!1,s=e}if(r===o)return void C(r,new TypeError("A promises callback cannot return that same promise."))}else o=i;r._state!==b||(a&&l?I(r,o):!1===l?C(r,s):1===t?D(r,o):2===t&&C(r,o))}var P=0;function M(e){e[S]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}var k=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(A),this.promise[S]||M(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&D(this.promise,this._result))):C(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===b&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===_){var i=void 0,a=void 0,o=!1;try{i=e.then}catch(e){o=!0,a=e}if(i===T&&e._state!==b)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===x){var s=new r(A);o?C(s,a):R(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===b&&(this._remaining--,2===e?C(n,r):this._result[t]=r),0===this._remaining&&D(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;N(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),x=function(){function t(e){this[S]=P++,this._result=this._state=void 0,this._subscribers=[],A!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){I(e,t)}),(function(t){C(e,t)}))}catch(t){C(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this,n=r.constructor;return e(t)?r.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):r.then(t,t)},t}();return x.prototype.then=T,x.all=function(e){return new k(this,e).promise},x.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var i=e.length,a=0;a<i;a++)r.resolve(e[a]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},x.resolve=_,x.reject=function(e){var t=new this(A);return C(t,e),t},x._setScheduler=function(e){a=e},x._setAsap=function(e){o=e},x._asap=o,x.polyfill=function(){var e=void 0;if(void 0!==r.g)e=r.g;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=x},x.Promise=x,x}()},1159:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&p(e,"error",t,{once:!0})}(e,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var o=10;function s(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){var i,a,o,u;if(s(r),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),o=a[t]),void 0===o)o=a[t]=r,++e._eventsCount;else if("function"==typeof o?o=a[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=l(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,u=c,console&&console.warn&&console.warn(u)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=c.bind(n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):g(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(a){n.once&&e.removeEventListener(t,i),r(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var u=l.length,c=g(l,u);for(r=0;r<u;++r)n(c[r],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return s(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var r,n,i,a,o;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},3101:e=>{"use strict";var t=Array.isArray,r=Object.keys,n=Object.prototype.hasOwnProperty;e.exports=function e(i,a){if(i===a)return!0;if(i&&a&&"object"==typeof i&&"object"==typeof a){var o,s,l,u=t(i),c=t(a);if(u&&c){if((s=i.length)!=a.length)return!1;for(o=s;0!=o--;)if(!e(i[o],a[o]))return!1;return!0}if(u!=c)return!1;var f=i instanceof Date,d=a instanceof Date;if(f!=d)return!1;if(f&&d)return i.getTime()==a.getTime();var h=i instanceof RegExp,g=a instanceof RegExp;if(h!=g)return!1;if(h&&g)return i.toString()==a.toString();var p=r(i);if((s=p.length)!==r(a).length)return!1;for(o=s;0!=o--;)if(!n.call(a,p[o]))return!1;for(o=s;0!=o--;)if(!e(i[l=p[o]],a[l]))return!1;return!0}return i!=i&&a!=a}},3362:(e,t,r)=>{!function(e,t,r,n,i){function a(e){if("contents"in e)for(var t=("styleAttrs"in e?e.styleAttrs[n.byName.ruby.qname]:null),r="span"===e.kind&&("container"===t||"textContainer"===t||"baseContainer"===t),i=e.contents.length-1;i>=0;i--)!r||"styleAttrs"in e.contents[i]&&n.byName.ruby.qname in e.contents[i].styleAttrs?a(e.contents[i]):delete e.contents[i]}function o(e,t,r,n){var i=n&&"seq"===n.timeContainer,a=0;n&&(a=i&&r?r.end:n.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var s=t.begin,l=null;if("sets"in t)for(var u=0;u<t.sets.length;u++)o(e,t.sets[u],l,t),s="seq"===t.timeContainer?t.sets[u].end:Math.max(s,t.sets[u].end),l=t.sets[u];if("contents"in t){if("contents"in t)for(var c=0;c<t.contents.length;c++)o(e,t.contents[c],l,t),s="seq"===t.timeContainer?t.contents[c].end:Math.max(s,t.contents[c].end),l=t.contents[c]}else s=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=s,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function s(e){this.node=e}function l(){this.events=[],this.head=new u,this.body=null}function u(){this.styling=new c,this.layout=new h}function c(){this.styles={},this.initials={}}function f(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function d(){this.styleAttrs=null}function h(){this.regions={}}function g(e,t){p.call(this,"image"),this.src=e,this.type=t}function p(e){this.kind=e}function m(e){this.id=e}function v(e){this.regionID=e}function y(e){this.styleAttrs=e}function E(e){this.sets=e}function T(e){this.contents=e}function _(e,t,r){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=r}function S(){p.call(this,"body")}function A(){p.call(this,"div")}function b(){p.call(this,"p")}function R(){p.call(this,"span")}function I(){p.call(this,"span")}function w(){p.call(this,"br")}function D(){}function C(){}function N(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function L(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function O(e,t){var r={};if(null!==e)for(var i in e.attributes){var a=e.attributes[i].uri+" "+e.attributes[i].local,o=n.byQName[a];if(void 0!==o){var s=o.parse(e.attributes[i].value);null!==s?(r[a]=s,o===n.byName.zIndex&&U(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):B(t,"Cannot parse styling attribute "+a+" --\x3e "+e.attributes[i].value)}}return r}function P(e,t,r){for(var n in e.attributes)if(e.attributes[n].uri===t&&e.attributes[n].local===r)return e.attributes[n].value;return null}function M(e,t,r){var n,i=null;return null!==(n=/^(\d+(?:\.\d+)?)f$/.exec(r))?null!==t&&(i=parseFloat(n[1])/t):null!==(n=/^(\d+(?:\.\d+)?)t$/.exec(r))?null!==e&&(i=parseFloat(n[1])/e):null!==(n=/^(\d+(?:\.\d+)?)ms$/.exec(r))?i=parseFloat(n[1])/1e3:null!==(n=/^(\d+(?:\.\d+)?)s$/.exec(r))?i=parseFloat(n[1]):null!==(n=/^(\d+(?:\.\d+)?)h$/.exec(r))?i=3600*parseFloat(n[1]):null!==(n=/^(\d+(?:\.\d+)?)m$/.exec(r))?i=60*parseFloat(n[1]):null!==(n=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(r))?i=3600*parseInt(n[1])+60*parseInt(n[2])+parseFloat(n[3]):null!==(n=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(r))&&null!==t&&(i=3600*parseInt(n[1])+60*parseInt(n[2])+parseInt(n[3])+(null===n[4]?0:parseInt(n[4])/t)),i}function k(e,t,r){for(;t.styleRefs.length>0;){var n=t.styleRefs.pop();n in e.styles?(k(e,e.styles[n],r),F(e.styles[n].styleAttrs,t.styleAttrs)):B(r,"Non-existant style id referenced")}}function x(e,t,r,n){for(var i=t.length-1;i>=0;i--){var a=t[i];a in e.styles?F(e.styles[a].styleAttrs,r):B(n,"Non-existant style id referenced")}}function F(e,t){for(var r in e)e.hasOwnProperty(r)&&(r in t||(t[r]=e[r]))}function U(e,t){if(e&&e.warn&&e.warn(t))throw t}function B(e,t){if(e&&e.error&&e.error(t))throw t}function Z(e,t){throw e&&e.fatal&&e.fatal(t),t}function G(e,t){for(var r,n=0,i=e.length-1;n<=i;){var a=e[r=Math.floor((n+i)/2)];if(a<t)n=r+1;else{if(!(a>t))return{found:!0,index:r};i=r-1}}return{found:!1,index:n}}e.fromXML=function(e,i,p){var m=t.parser(!0,{xmlns:!0}),v=[],y=[],E=[],T=0,_=null;m.onclosetag=function(e){if(v[0]instanceof D)null!==_.head&&null!==_.head.styling&&x(_.head.styling,v[0].styleRefs,v[0].styleAttrs,i),delete v[0].styleRefs;else if(v[0]instanceof c)for(var t in v[0].styles)v[0].styles.hasOwnProperty(t)&&k(v[0],v[0].styles[t],i);else if(v[0]instanceof b||v[0]instanceof R){if(v[0].contents.length>1){var n,a=[v[0].contents[0]];for(n=1;n<v[0].contents.length;n++)v[0].contents[n]instanceof I&&a[a.length-1]instanceof I?a[a.length-1].text+=v[0].contents[n].text:a.push(v[0].contents[n]);v[0].contents=a}v[0]instanceof R&&1===v[0].contents.length&&v[0].contents[0]instanceof I&&(v[0].text=v[0].contents[0].text,delete v[0].contents)}else v[0]instanceof s&&(v[0].node.uri===r.ns_tt&&"metadata"===v[0].node.local?T--:T>0&&p&&"onCloseTag"in p&&p.onCloseTag());E.shift(),y.shift(),v.shift()},m.ontext=function(e){if(void 0===v[0]);else if(v[0]instanceof R||v[0]instanceof b){if(v[0]instanceof R){var t=v[0].styleAttrs[n.byName.ruby.qname];if("container"===t||"textContainer"===t||"baseContainer"===t)return}var r=new I;r.initFromText(_,v[0],e,y[0],E[0],i),v[0].contents.push(r)}else v[0]instanceof s&&T>0&&p&&"onText"in p&&p.onText(e)},m.onopentag=function(e){var t=e.attributes["xml:space"];t?E.unshift(t.value):0===E.length?E.unshift("default"):E.unshift(E[0]);var a=e.attributes["xml:lang"];if(a?y.unshift(a.value):0===y.length?y.unshift(""):y.unshift(y[0]),e.uri===r.ns_tt)if("tt"===e.local)null!==_&&Z(i,"Two <tt> elements at ("+this.line+","+this.column+")"),(_=new l).initFromNode(e,y[0],i),v.unshift(_);else if("head"===e.local)v[0]instanceof l||Z(i,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),v.unshift(_.head);else if("styling"===e.local)v[0]instanceof u||Z(i,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),v.unshift(_.head.styling);else if("style"===e.local){var o;v[0]instanceof c?((o=new f).initFromNode(e,i),o.id?_.head.styling.styles[o.id]=o:B(i,"<style> element missing @id attribute"),v.unshift(o)):v[0]instanceof D?((o=new f).initFromNode(e,i),F(o.styleAttrs,v[0].styleAttrs),v.unshift(o)):Z(i,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("initial"===e.local){var m;if(v[0]instanceof c){for(var I in(m=new d).initFromNode(e,i),m.styleAttrs)m.styleAttrs.hasOwnProperty(I)&&(_.head.styling.initials[I]=m.styleAttrs[I]);v.unshift(m)}else Z(i,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")")}else if("layout"===e.local)v[0]instanceof u||Z(i,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),v.unshift(_.head.layout);else if("region"===e.local){v[0]instanceof h||Z(i,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var N=new D;N.initFromNode(_,e,y[0],i),!N.id||N.id in _.head.layout.regions?B(i,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):_.head.layout.regions[N.id]=N,v.unshift(N)}else if("body"===e.local){v[0]instanceof l||Z(i,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==_.body&&Z(i,"Second <body> element at "+this.line+","+this.column+")");var L=new S;L.initFromNode(_,e,y[0],i),_.body=L,v.unshift(L)}else if("div"===e.local){v[0]instanceof A||v[0]instanceof S||Z(i,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var O=new A;O.initFromNode(_,v[0],e,y[0],i);var P=O.styleAttrs[n.byName.backgroundImage.qname];P&&(O.contents.push(new g(P)),delete O.styleAttrs[n.byName.backgroundImage.qname]),v[0].contents.push(O),v.unshift(O)}else if("image"===e.local){v[0]instanceof A||Z(i,"Parent of <image> element is not <div> at "+this.line+","+this.column+")");var M=new g;M.initFromNode(_,v[0],e,y[0],i),v[0].contents.push(M),v.unshift(M)}else if("p"===e.local){v[0]instanceof A||Z(i,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var k=new b;k.initFromNode(_,v[0],e,y[0],i),v[0].contents.push(k),v.unshift(k)}else if("span"===e.local){v[0]instanceof R||v[0]instanceof b||Z(i,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var x=new R;x.initFromNode(_,v[0],e,y[0],E[0],i),v[0].contents.push(x),v.unshift(x)}else if("br"===e.local){v[0]instanceof R||v[0]instanceof b||Z(i,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var U=new w;U.initFromNode(_,v[0],e,y[0],i),v[0].contents.push(U),v.unshift(U)}else if("set"===e.local){v[0]instanceof R||v[0]instanceof b||v[0]instanceof A||v[0]instanceof S||v[0]instanceof D||v[0]instanceof w||Z(i,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var G=new C;G.initFromNode(_,v[0],e,i),v[0].sets.push(G),v.unshift(G)}else v.unshift(new s(e));else v.unshift(new s(e));if(v[0]instanceof s)if(e.uri===r.ns_tt&&"metadata"===e.local)T++;else if(T>0&&p&&"onOpenTag"in p){var K=[];for(var H in e.attributes)K[e.attributes[H].uri+" "+e.attributes[H].local]={uri:e.attributes[H].uri,local:e.attributes[H].local,value:e.attributes[H].value};p.onOpenTag(e.uri,e.local,K)}},m.write(e).close(),delete _.head.styling.styles;var N=!1;for(var L in _.head.layout.regions)if(_.head.layout.regions.hasOwnProperty(L)){N=!0;break}if(!N){var O=D.prototype.createDefaultRegion(_.lang);_.head.layout.regions[O.id]=O}for(var P in _.head.layout.regions)_.head.layout.regions.hasOwnProperty(P)&&o(_,_.head.layout.regions[P],null,null);return _.body&&o(_,_.body,null,null),_.body&&a(_.body),_},l.prototype.initFromNode=function(e,t,n){var a=function(e,t){var n=P(e,r.ns_ttp,"cellResolution"),i=15,a=32;if(null!==n){var o=/(\d+) (\d+)/.exec(n);null!==o?(a=parseInt(o[1]),i=parseInt(o[2])):U(t,"Malformed cellResolution value (using initial value instead)")}return{w:a,h:i}}(e,n);this.cellLength={h:new i.ComputedLength(0,1/a.h),w:new i.ComputedLength(1/a.w,0)};var o=function(e,t){var n,i=P(e,r.ns_ttp,"frameRate"),a=30;null!==i&&(null!==(n=/(\d+)/.exec(i))?a=parseInt(n[1]):U(t,"Malformed frame rate attribute (using initial value instead)"));var o=P(e,r.ns_ttp,"frameRateMultiplier"),s=1;null!==o&&(null!==(n=/(\d+) (\d+)/.exec(o))?s=parseInt(n[1])/parseInt(n[2]):U(t,"Malformed frame rate multiplier attribute (using initial value instead)"));var l=s*a,u=1,c=P(e,r.ns_ttp,"tickRate");return null===c?null!==i&&(u=l):null!==(n=/(\d+)/.exec(c))?u=parseInt(n[1]):U(t,"Malformed tick rate attribute (using initial value instead)"),{effectiveFrameRate:l,tickRate:u}}(e,n);this.effectiveFrameRate=o.effectiveFrameRate,this.tickRate=o.tickRate,this.aspectRatio=function(e,t){var n=P(e,r.ns_ittp,"aspectRatio");null===n&&(n=P(e,r.ns_ttp,"displayAspectRatio"));var i=null;if(null!==n){var a=/(\d+)\s+(\d+)/.exec(n);if(null!==a){var o=parseInt(a[1]),s=parseInt(a[2]);0!==o&&0!==s?i=o/s:B(t,"Illegal aspectRatio values (ignoring)")}else B(t,"Malformed aspectRatio attribute (ignoring)")}return i}(e,n);var s=P(e,r.ns_ttp,"timeBase");null!==s&&"media"!==s&&Z(n,"Unsupported time base");var l=function(e,t){var n=P(e,r.ns_tts,"extent");if(null===n)return null;var a=n.split(" ");if(2!==a.length)return U(t,"Malformed extent (ignoring)"),null;var o=i.parseLength(a[0]),s=i.parseLength(a[1]);return s&&o?{h:s,w:o}:(U(t,"Malformed extent values (ignoring)"),null)}(e,n);null===l?this.pxLength={h:null,w:null}:("px"===l.h.unit&&"px"===l.w.unit||Z(n,"Extent on TT must be in px or absent"),this.pxLength={h:new i.ComputedLength(0,1/l.h.value),w:new i.ComputedLength(1/l.w.value,0)}),this.dimensions={h:new i.ComputedLength(0,1),w:new i.ComputedLength(1,0)},this.lang=t},l.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=G(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var r=G(this.events,e.end);r.found||this.events.splice(r.index,0,e.end)}}},l.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},l.prototype.getMediaTimeEvents=function(){return this.events},f.prototype.initFromNode=function(e,t){this.id=N(e),this.styleAttrs=O(e,t),this.styleRefs=L(e)},d.prototype.initFromNode=function(e,t){for(var n in this.styleAttrs={},e.attributes)if(e.attributes[n].uri===r.ns_itts||e.attributes[n].uri===r.ns_ebutts||e.attributes[n].uri===r.ns_tts){var i=e.attributes[n].uri+" "+e.attributes[n].local;this.styleAttrs[i]=e.attributes[n].value}},g.prototype.initFromNode=function(e,t,r,n,i){this.src="src"in r.attributes?r.attributes.src.value:null,this.src||B(i,"Invalid image@src attribute"),this.type="type"in r.attributes?r.attributes.type.value:null,this.type||B(i,"Invalid image@type attribute"),y.prototype.initFromNode.call(this,e,t,r,i),_.prototype.initFromNode.call(this,e,t,r,i),E.prototype.initFromNode.call(this,e,t,r,i),v.prototype.initFromNode.call(this,e,t,r,i),this.lang=n},m.prototype.initFromNode=function(e,t,r,n){this.id=N(r)},v.prototype.initFromNode=function(e,t,r,n){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(r)},y.prototype.initFromNode=function(e,t,r,n){this.styleAttrs=O(r,n),null!==e.head&&null!==e.head.styling&&x(e.head.styling,L(r),this.styleAttrs,n)},E.prototype.initFromNode=function(e,t,r,n){this.sets=[]},T.prototype.initFromNode=function(e,t,r,n){this.contents=[]},_.prototype.initFromNode=function(e,t,r,n){var i=function(e,t,r,n){var i=null;r&&"begin"in r.attributes&&null===(i=M(e.tickRate,e.effectiveFrameRate,r.attributes.begin.value))&&U(n,"Malformed begin value "+r.attributes.begin.value+" (using 0)");var a=null;r&&"dur"in r.attributes&&null===(a=M(e.tickRate,e.effectiveFrameRate,r.attributes.dur.value))&&U(n,"Malformed dur value "+r.attributes.dur.value+" (ignoring)");var o=null;return r&&"end"in r.attributes&&null===(o=M(e.tickRate,e.effectiveFrameRate,r.attributes.end.value))&&U(n,"Malformed end value (ignoring)"),{explicit_begin:i,explicit_end:o,explicit_dur:a}}(e,0,r,n);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var r=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return r&&"par"!==r?"seq"===r?"seq":(B(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(r,n)},S.prototype.initFromNode=function(e,t,r,n){y.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),v.prototype.initFromNode.call(this,e,null,t,n),T.prototype.initFromNode.call(this,e,null,t,n),this.lang=r},A.prototype.initFromNode=function(e,t,r,n,i){y.prototype.initFromNode.call(this,e,t,r,i),_.prototype.initFromNode.call(this,e,t,r,i),E.prototype.initFromNode.call(this,e,t,r,i),v.prototype.initFromNode.call(this,e,t,r,i),T.prototype.initFromNode.call(this,e,t,r,i),this.lang=n},b.prototype.initFromNode=function(e,t,r,n,i){y.prototype.initFromNode.call(this,e,t,r,i),_.prototype.initFromNode.call(this,e,t,r,i),E.prototype.initFromNode.call(this,e,t,r,i),v.prototype.initFromNode.call(this,e,t,r,i),T.prototype.initFromNode.call(this,e,t,r,i),this.lang=n},R.prototype.initFromNode=function(e,t,r,n,i,a){y.prototype.initFromNode.call(this,e,t,r,a),_.prototype.initFromNode.call(this,e,t,r,a),E.prototype.initFromNode.call(this,e,t,r,a),v.prototype.initFromNode.call(this,e,t,r,a),T.prototype.initFromNode.call(this,e,t,r,a),this.space=i,this.lang=n},I.prototype.initFromText=function(e,t,r,n,i,a){_.prototype.initFromNode.call(this,e,t,null,a),this.text=r,this.space=i,this.lang=n},w.prototype.initFromNode=function(e,t,r,n,i){v.prototype.initFromNode.call(this,e,t,r,i),_.prototype.initFromNode.call(this,e,t,r,i),this.lang=n},D.prototype.createDefaultRegion=function(e){var t=new D;return m.call(t,""),y.call(t,{}),E.call(t,[]),_.call(t,0,Number.POSITIVE_INFINITY,null),this.lang=e,t},D.prototype.initFromNode=function(e,t,r,n){m.prototype.initFromNode.call(this,e,null,t,n),_.prototype.initFromNode.call(this,e,null,t,n),E.prototype.initFromNode.call(this,e,null,t,n),this.styleAttrs=O(t,n),this.styleRefs=L(t),this.lang=r},C.prototype.initFromNode=function(e,t,r,n){_.prototype.initFromNode.call(this,e,t,r,n);var i=O(r,n);for(var a in this.qname=null,this.value=null,i)if(i.hasOwnProperty(a)){if(this.qname){B(n,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}}(t,"undefined"==typeof sax?r(5378):sax,"undefined"==typeof imscNames?r(210):imscNames,"undefined"==typeof imscStyles?r(6811):imscStyles,"undefined"==typeof imscUtils?r(5926):imscUtils)},506:(e,t,r)=>{!function(e,t,r){function n(e,t,c,d){var h;if("region"===c.kind)(h=document.createElement("div")).style.position="absolute";else if("body"===c.kind)h=document.createElement("div");else if("div"===c.kind)h=document.createElement("div");else if("image"===c.kind){if(h=document.createElement("img"),null!==e.imgResolver&&null!==c.src){var m=e.imgResolver(c.src,h);m&&(h.src=m),h.height=e.regionH,h.width=e.regionW}}else if("p"===c.kind)h=document.createElement("p");else if("span"===c.kind)if("container"===c.styleAttrs[r.byName.ruby.qname])h=document.createElement("ruby"),e.ruby=!0;else if("base"===c.styleAttrs[r.byName.ruby.qname])h=document.createElement("rb");else if("text"===c.styleAttrs[r.byName.ruby.qname])h=document.createElement("rt");else if("baseContainer"===c.styleAttrs[r.byName.ruby.qname])h=document.createElement("rbc");else if("textContainer"===c.styleAttrs[r.byName.ruby.qname])h=document.createElement("rtc");else{if("delimiter"===c.styleAttrs[r.byName.ruby.qname])return;h=document.createElement("span")}else"br"===c.kind&&(h=document.createElement("br"));if(h){if(c.lang&&("region"!==c.kind&&c.lang===d.lang||(h.lang=c.lang)),t.appendChild(h),h.style.margin="0","region"===c.kind){var y=c.styleAttrs[r.byName.writingMode.qname];"lrtb"===y||"lr"===y?(e.ipd="lr",e.bpd="tb"):"rltb"===y||"rl"===y?(e.ipd="rl",e.bpd="tb"):"tblr"===y?(e.ipd="tb",e.bpd="lr"):"tbrl"!==y&&"tb"!==y||(e.ipd="tb",e.bpd="rl")}else if("p"===c.kind&&"tb"===e.bpd){var E=c.styleAttrs[r.byName.direction.qname];e.ipd="ltr"===E?"lr":"rl"}for(var T=0;T<f.length;T++){var _=f[T],S=c.styleAttrs[_.qname];void 0!==S&&null!==_.map&&_.map(e,h,c,S)}var A=h,b=c.styleAttrs[r.byName.linePadding.qname];if(b&&!b.isZero()){var R=b.toUsedLength(e.w,e.h);if(R>0){var I=Math.ceil(R)+"px";"tb"===e.bpd?(A.style.paddingLeft=I,A.style.paddingRight=I):(A.style.paddingTop=I,A.style.paddingBottom=I),e.lp=b}}var w=c.styleAttrs[r.byName.multiRowAlign.qname];if(w&&"auto"!==w){var D=document.createElement("span");D.style.display="inline-block",D.style.textAlign=w,h.appendChild(D),A=D,e.mra=w}var C=c.styleAttrs[r.byName.rubyReserve.qname];if(C&&"none"!==C[0]&&(e.rubyReserve=C),c.styleAttrs[r.byName.fillLineGap.qname]&&(e.flg=!0),"span"===c.kind&&c.text){var N=c.styleAttrs[r.byName.textEmphasis.qname];if(N&&"none"!==N.style&&(e.textEmphasis=!0),r.byName.textCombine.qname in c.styleAttrs&&"all"===c.styleAttrs[r.byName.textCombine.qname])h.textContent=c.text,N&&u(e,h,0,N);else for(var L="",O=0;O<c.text.length;O++){L+=c.text.charAt(O);var P=c.text.charCodeAt(O);if(P<55296||P>56319||O===c.text.length-1){var M=document.createElement("span");M.textContent=L,N&&u(e,M,0,N),h.appendChild(M),L="",M._isd_element=c}}}if("contents"in c)for(var k=0;k<c.contents.length;k++)n(e,A,c.contents[k],c);var x=[];if("p"===c.kind&&(l(e,A,x,null),e.rubyReserve&&(function(e,t){for(var r=0;r<e.length;r++){var n,i,a=document.createElement("ruby"),o=document.createElement("rb");o.textContent="",a.appendChild(o);var s,l=t.rubyReserve[1].toUsedLength(t.w,t.h)+"px";"both"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&1==e.length?((n=document.createElement("rtc")).style[p]=g?"after":"under",n.textContent="",n.style.fontSize=l,(i=document.createElement("rtc")).style[p]=g?"before":"over",i.textContent="",i.style.fontSize=l,a.appendChild(n),a.appendChild(i)):((n=document.createElement("rtc")).textContent="",n.style.fontSize=l,s="after"===t.rubyReserve[0]||"outside"===t.rubyReserve[0]&&r>0?g?"after":"tb"===t.bpd||"rl"===t.bpd?"under":"over":g?"before":"tb"===t.bpd||"rl"===t.bpd?"over":"under",n.style[p]=s,a.appendChild(n));for(var u=null,c=0;c<e[r].rbc.length;c++)if("ruby"===e[r].rbc[c].localName){u=e[r].rbc[c];for(var f=0;f<u.style.length;f++)a.style.setProperty(u.style.item(f),u.style.getPropertyValue(u.style.item(f)));break}(u=u||e[r].elements[0].node).parentElement.insertBefore(a,u)}}(x,e),e.rubyReserve=null),(e.ruby||e.rubyReserve)&&(function(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<e[r].rbc.length;n++){var i;e[r].rbc[n].style[p]||(i=g?0===r?"before":"after":"tb"===t.bpd||"rl"===t.bpd?0===r?"over":"under":0===r?"under":"over",e[r].rbc[n].style[p]=i)}}(x,e),e.ruby=null),e.textEmphasis&&(function(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<e[r].te.length;n++){var i;e[r].te[n].style[v]&&"none"!==e[r].te[n].style[v]||(i="tb"===t.bpd?0===r?"left over":"left under":"rl"===t.bpd?0===r?"right under":"left under":0===r?"left under":"right under",e[r].te[n].style[v]=i)}}(x,e),e.textEmphasis=null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var r=e[t].elements.length;if(0!==r&&!1===e[t].br){var n=document.createElement("br"),i=e[t].elements[r-1].node;i.parentElement.insertBefore(n,i.nextSibling)}}}(x),e.mra=null),e.lp&&(function(e,t,r){if(null!==e)for(var n=0;n<e.length;n++){var i=e[n].elements.length,a=Math.ceil(t)+"px",o="-"+Math.ceil(t)+"px";if(0!==i){var s=e[n].elements[e[n].start_elem],l=e[n].elements[e[n].end_elem];if(s===l&&(elementBoundingRect=s.node.getBoundingClientRect(),0==elementBoundingRect.width||0==elementBoundingRect.height))continue;"lr"===r.ipd?(s.node.style.marginLeft=o,s.node.style.paddingLeft=a):"rl"===r.ipd?(s.node.style.paddingRight=a,s.node.style.marginRight=o):"tb"===r.ipd&&(s.node.style.paddingTop=a,s.node.style.marginTop=o),"lr"===r.ipd?(l.node.style.marginRight=o,l.node.style.paddingRight=a):"rl"===r.ipd?(l.node.style.paddingLeft=a,l.node.style.marginLeft=o):"tb"===r.ipd&&(l.node.style.paddingBottom=a,l.node.style.marginBottom=o)}}}(x,e.lp.toUsedLength(e.w,e.h),e),e.lp=null),function(e){for(var t=0;t<e.length;t++)for(var r=e[t],n=1;n<r.elements.length;){var o=r.elements[n-1],s=r.elements[n];a(o.node,s.node)?r.elements.splice(n,1):n++}for(var l,u,c=[],f=0;f<e.length;f++)for(var d=0;d<e[f].elements.length;d++)(u=i(l=e[f].elements[d].node,c,!1))&&(l.style.backgroundColor=u);for(var h=0;h<c.length;h++)c[h].style.backgroundColor=""}(x),e.flg)){var F=s(A.getBoundingClientRect(),e);!function(e,t,r,n,i){for(var a=Math.sign(r-t),o=0;o<=e.length;o++){var s,l,u,c;if(s=0===o?Math.round(t):o===e.length?Math.round(r):Math.round((e[o-1].after+e[o].before)/2),o>0&&e[o-1])for(u=0;u<e[o-1].elements.length;u++)l=a*(s-(c=e[o-1].elements[u]).after)+"px","lr"===n.bpd?c.node.style.paddingRight=l:"rl"===n.bpd?c.node.style.paddingLeft=l:"tb"===n.bpd&&(c.node.style.paddingBottom=l);if(o<e.length)for(u=0;u<e[o].elements.length;u++)l=a*((c=e[o].elements[u]).before-s)+"px","lr"===n.bpd?c.node.style.paddingLeft=l:"rl"===n.bpd?c.node.style.paddingRight=l:"tb"===n.bpd&&(c.node.style.paddingTop=l)}}(x,F.before,F.after,e),e.flg=null}if("region"===c.kind&&"tb"===e.bpd&&e.enableRollUp&&c.contents.length>0&&"after"===c.styleAttrs[r.byName.displayAlign.qname]){l(e,A,x,null);var U=new o(""===c.id?"_":c.id,x);if(e.currentISDState[U.id]=U,e.previousISDState&&U.id in e.previousISDState&&e.previousISDState[U.id].plist.length>0&&U.plist.length>1&&U.plist[U.plist.length-2].text===e.previousISDState[U.id].plist[e.previousISDState[U.id].plist.length-1].text){var B=h.firstElementChild,Z=U.plist[U.plist.length-1].after-U.plist[U.plist.length-1].before;B.style.bottom="-"+Z+"px",B.style.transition="transform 0.4s",B.style.position="relative",B.style.transform="translateY(-"+Z+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+c.kind)}function i(e,t,r){return e.style.backgroundColor?(r&&!t.includes(e)&&t.push(e),e.style.backgroundColor):"SPAN"===e.parentElement.nodeName?i(e.parentElement,t,!0):void 0}function a(e,t){if("SPAN"===e.tagName&&"SPAN"===t.tagName&&e._isd_element===t._isd_element){e.textContent+=t.textContent;for(var r=0;r<t.style.length;r++){var n=t.style[r];(n.indexOf("border")>=0||n.indexOf("padding")>=0||n.indexOf("margin")>=0)&&(e.style[n]=t.style[n])}return t.parentElement.removeChild(t),!0}return!1}function o(e,t){this.id=e,this.plist=t}function s(e,t){var r={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(r.before=e.top,r.after=e.bottom,"lr"===t.ipd?(r.start=e.left,r.end=e.right):(r.start=e.right,r.end=e.left)):"lr"===t.bpd?(r.before=e.left,r.after=e.right,r.start=e.top,r.end=e.bottom):"rl"===t.bpd&&(r.before=e.right,r.after=e.left,r.start=e.top,r.end=e.bottom),r}function l(e,t,r,n){if("rt"!==t.localName&&"rtc"!==t.localName){var i,a,o,u,c=t.style.backgroundColor||n;if(0===t.childElementCount)if("span"===t.localName||"rb"===t.localName){var f=s(t.getBoundingClientRect(),e);if(0!==r.length&&(i=f.before,a=f.after,o=r[r.length-1].before,a<(u=r[r.length-1].after)&&i>o||u<=a&&o>=i)){var d=Math.sign(f.after-f.before),h=Math.sign(f.end-f.start);d*(f.before-r[r.length-1].before)<0&&(r[r.length-1].before=f.before),d*(f.after-r[r.length-1].after)>0&&(r[r.length-1].after=f.after),h*(f.start-r[r.length-1].start)<0&&(r[r.length-1].start=f.start,r[r.length-1].start_elem=r[r.length-1].elements.length),h*(f.end-r[r.length-1].end)>0&&(r[r.length-1].end=f.end,r[r.length-1].end_elem=r[r.length-1].elements.length)}else r.push({before:f.before,after:f.after,start:f.start,end:f.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1});r[r.length-1].text+=t.textContent,r[r.length-1].elements.push({node:t,bgcolor:c,before:f.before,after:f.after})}else"br"===t.localName&&0!==r.length&&(r[r.length-1].br=!0);else for(var g=t.firstChild;g;)g.nodeType===Node.ELEMENT_NODE&&(l(e,g,r,c),"ruby"===g.localName||"rtc"===g.localName?r.length>0&&r[r.length-1].rbc.push(g):"span"===g.localName&&g.style[m]&&"none"!==g.style[m]&&r.length>0&&r[r.length-1].te.push(g)),g=g.nextSibling}}function u(e,t,r,n){var i;"none"!==n.style&&("auto"===n.style?t.style[m]="filled":t.style[m]=n.style+" "+n.symbol,("before"===n.position||"after"===n.position)&&(i="tb"===e.bpd?"before"===n.position?"left over":"left under":"rl"===e.bpd?"before"===n.position?"right under":"left under":"before"===n.position?"left under":"right under",t.style[v]=i))}function c(e,t){this.qname=e,this.map=t}e.render=function(e,t,r,i,a,o,s,l,u){var c=i||t.clientHeight,f=a||t.clientWidth;if(null!==e.aspectRatio){var d=c*e.aspectRatio;d>f?c=Math.round(f/e.aspectRatio):f=d}var h=document.createElement("div");h.style.position="relative",h.style.width=f+"px",h.style.height=c+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var g={h:c,w:f,regionH:null,regionW:null,imgResolver:r,displayForcedOnlyMode:o||!1,isd:e,errorHandler:s,previousISDState:l,enableRollUp:u||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null};if(t.appendChild(h),"contents"in e)for(var p=0;p<e.contents.length;p++)n(g,h,e.contents[p],e);return g.currentISDState};for(var f=[new c("http://www.w3.org/ns/ttml#styling backgroundColor",(function(e,t,r,n){0!==n[3]&&(t.style.backgroundColor="rgba("+n[0].toString()+","+n[1].toString()+","+n[2].toString()+","+(n[3]/255).toString()+")")})),new c("http://www.w3.org/ns/ttml#styling color",(function(e,t,r,n){t.style.color="rgba("+n[0].toString()+","+n[1].toString()+","+n[2].toString()+","+(n[3]/255).toString()+")"})),new c("http://www.w3.org/ns/ttml#styling direction",(function(e,t,r,n){t.style.direction=n})),new c("http://www.w3.org/ns/ttml#styling display",(function(e,t,r,n){})),new c("http://www.w3.org/ns/ttml#styling displayAlign",(function(e,t,r,n){t.style.display="flex",t.style.flexDirection="column","before"===n?t.style.justifyContent="flex-start":"center"===n?t.style.justifyContent="center":"after"===n&&(t.style.justifyContent="flex-end")})),new c("http://www.w3.org/ns/ttml#styling extent",(function(e,t,r,n){e.regionH=n.h.toUsedLength(e.w,e.h),e.regionW=n.w.toUsedLength(e.w,e.h);var i=0,a=0,o=r.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=o[0].toUsedLength(e.w,e.h)+o[2].toUsedLength(e.w,e.h),a=o[1].toUsedLength(e.w,e.h)+o[3].toUsedLength(e.w,e.h)),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"})),new c("http://www.w3.org/ns/ttml#styling fontFamily",(function(e,t,r,n){for(var i=[],a=0;a<n.length;a++)"monospaceSerif"===n[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===n[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===n[a]?i.push("monospace"):"sansSerif"===n[a]?i.push("sans-serif"):"serif"===n[a]?i.push("serif"):"monospaceSansSerif"===n[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===n[a]?i.push("serif"):i.push(n[a]);if(i.length>0){for(var o=[i[0]],s=1;s<i.length;s++)-1==o.indexOf(i[s])&&o.push(i[s]);i=o}t.style.fontFamily=i.join(",")})),new c("http://www.w3.org/ns/ttml#styling shear",(function(e,t,r,n){if(0!==n){var i=-.9*n;"tb"===e.bpd?t.style.transform="skewX("+i+"deg)":t.style.transform="skewY("+i+"deg)"}})),new c("http://www.w3.org/ns/ttml#styling fontSize",(function(e,t,r,n){t.style.fontSize=n.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling fontStyle",(function(e,t,r,n){t.style.fontStyle=n})),new c("http://www.w3.org/ns/ttml#styling fontWeight",(function(e,t,r,n){t.style.fontWeight=n})),new c("http://www.w3.org/ns/ttml#styling lineHeight",(function(e,t,r,n){t.style.lineHeight="normal"===n?"normal":n.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling opacity",(function(e,t,r,n){t.style.opacity=n})),new c("http://www.w3.org/ns/ttml#styling origin",(function(e,t,r,n){t.style.top=n.h.toUsedLength(e.w,e.h)+"px",t.style.left=n.w.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling overflow",(function(e,t,r,n){t.style.overflow=n})),new c("http://www.w3.org/ns/ttml#styling padding",(function(e,t,r,n){var i=[];i[0]=n[0].toUsedLength(e.w,e.h)+"px",i[1]=n[3].toUsedLength(e.w,e.h)+"px",i[2]=n[2].toUsedLength(e.w,e.h)+"px",i[3]=n[1].toUsedLength(e.w,e.h)+"px",t.style.padding=i.join(" ")})),new c("http://www.w3.org/ns/ttml#styling position",(function(e,t,r,n){t.style.top=n.h.toUsedLength(e.w,e.h)+"px",t.style.left=n.w.toUsedLength(e.w,e.h)+"px"})),new c("http://www.w3.org/ns/ttml#styling rubyAlign",(function(e,t,r,n){t.style.rubyAlign="spaceAround"===n?"space-around":"center"})),new c("http://www.w3.org/ns/ttml#styling rubyPosition",(function(e,t,r,n){var i;"before"!==n&&"after"!==n||(i=g?n:"tb"===e.bpd||"rl"===e.bpd?"before"===n?"over":"under":"before"===n?"under":"over",t.parentElement.style[p]=i)})),new c("http://www.w3.org/ns/ttml#styling showBackground",null),new c("http://www.w3.org/ns/ttml#styling textAlign",(function(e,t,r,n){var i;i="start"===n?"rl"===e.ipd?"right":"left":"end"===n?"rl"===e.ipd?"left":"right":n,t.style.textAlign=i})),new c("http://www.w3.org/ns/ttml#styling textDecoration",(function(e,t,r,n){t.style.textDecoration=n.join(" ").replace("lineThrough","line-through")})),new c("http://www.w3.org/ns/ttml#styling textOutline",(function(e,t,r,n){})),new c("http://www.w3.org/ns/ttml#styling textShadow",(function(e,t,n,i){var a=n.styleAttrs[r.byName.textOutline.qname];if("none"===i&&"none"===a)t.style.textShadow="";else{var o=[];if("none"!==a){var s="rgba("+a.color[0].toString()+","+a.color[1].toString()+","+a.color[2].toString()+","+(a.color[3]/255).toString()+")";o.push("1px 1px 1px "+s),o.push("-1px 1px 1px "+s),o.push("1px -1px 1px "+s),o.push("-1px -1px 1px "+s)}if("none"!==i)for(var l=0;l<i.length;l++)o.push(i[l].x_off.toUsedLength(e.w,e.h)+"px "+i[l].y_off.toUsedLength(e.w,e.h)+"px "+i[l].b_radius.toUsedLength(e.w,e.h)+"px rgba("+i[l].color[0].toString()+","+i[l].color[1].toString()+","+i[l].color[2].toString()+","+(i[l].color[3]/255).toString()+")");t.style.textShadow=o.join(",")}})),new c("http://www.w3.org/ns/ttml#styling textCombine",(function(e,t,r,n){t.style.textCombineUpright=n})),new c("http://www.w3.org/ns/ttml#styling textEmphasis",(function(e,t,r,n){})),new c("http://www.w3.org/ns/ttml#styling unicodeBidi",(function(e,t,r,n){var i;i="bidiOverride"===n?"bidi-override":n,t.style.unicodeBidi=i})),new c("http://www.w3.org/ns/ttml#styling visibility",(function(e,t,r,n){t.style.visibility=n})),new c("http://www.w3.org/ns/ttml#styling wrapOption",(function(e,t,r,n){"wrap"===n?"preserve"===r.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===r.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"})),new c("http://www.w3.org/ns/ttml#styling writingMode",(function(e,t,r,n){"lrtb"===n||"lr"===n||"rltb"===n||"rl"===n?t.style.writingMode="horizontal-tb":"tblr"===n?t.style.writingMode="vertical-lr":"tbrl"!==n&&"tb"!==n||(t.style.writingMode="vertical-rl")})),new c("http://www.w3.org/ns/ttml#styling zIndex",(function(e,t,r,n){t.style.zIndex=n})),new c("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",(function(e,t,r,n){e.displayForcedOnlyMode&&!1===n&&(t.style.visibility="hidden")}))],d={},h=0;h<f.length;h++)d[f[h].qname]=f[h];var g="webkitRubyPosition"in window.getComputedStyle(document.documentElement),p=g?"webkitRubyPosition":"rubyPosition",m="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",v="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"}(t,"undefined"==typeof imscNames?r(210):imscNames,"undefined"==typeof imscStyles?r(6811):imscStyles,"undefined"==typeof imscUtils?r(5926):imscUtils)},4080:(e,t,r)=>{!function(e,t,r,n){e.generateISD=function(e,t,n){var i,o=new l(e),s={},u={},c=e.head.styling.initials[r.byName.showBackground.qname],f=e.head.styling.initials[r.byName.backgroundColor.qname];for(var d in e.head.layout.regions)if(e.head.layout.regions.hasOwnProperty(d)){var h=e.head.layout.regions[d],g=h.styleAttrs[r.byName.showBackground.qname]||c,p=h.styleAttrs[r.byName.backgroundColor.qname]||f;u[h.id]=("always"===g||void 0===g)&&void 0!==p&&!(t<h.begin||t>=h.end)}for(var m in e.body&&e.body.regionID&&(u[e.body.regionID]=!0),i=null!==e.body?function e(t,r){if(r.contents){var n={};for(var i in r)r.hasOwnProperty(i)&&(n[i]=r[i]);return n.contents=[],r.contents.filter((function(e){return!(t<e.begin||t>=e.end)})).forEach((function(r){var i=e(t,r);i.regionID&&(u[i.regionID]=!0),null!==i&&n.contents.push(i)})),n}return r}(t,e.body):null,void 0!==u[""]&&(u[""]=!0),u)if(u[m]){var v=a(e,t,e.head.layout.regions[m],i,null,"",e.head.layout.regions[m],n,s);null!==v&&o.contents.push(v.element)}return o};var i=[r.byName.color.qname,r.byName.textCombine.qname,r.byName.textDecoration.qname,r.byName.textEmphasis.qname,r.byName.textOutline.qname,r.byName.textShadow.qname];function a(e,t,l,f,d,h,g,p,m){if(t<g.begin||t>=g.end)return null;var v="regionID"in g&&""!==g.regionID?g.regionID:h;if(null!==d&&v!==l.id&&(!("contents"in g)||"contents"in g&&0===g.contents.length||""!==v))return null;var y=new u(g);if("sets"in g)for(var E=0;E<g.sets.length;E++)t<g.sets[E].begin||t>=g.sets[E].end||(y.styleAttrs[g.sets[E].qname]=g.sets[E].value);var T={};for(var _ in y.styleAttrs)if(y.styleAttrs.hasOwnProperty(_)&&(T[_]=!0,"region"===y.kind&&_===r.byName.writingMode.qname&&!(r.byName.direction.qname in y.styleAttrs))){var S=y.styleAttrs[_];"lrtb"===S||"lr"===S?y.styleAttrs[r.byName.direction.qname]="ltr":"rltb"!==S&&"rl"!==S||(y.styleAttrs[r.byName.direction.qname]="rtl")}if(null!==d)for(var A=0;A<r.all.length;A++){var b=r.all[A];if(b.qname===r.byName.textDecoration.qname){var R=d.styleAttrs[b.qname],I=y.styleAttrs[b.qname],w=[];void 0===I?w=R:-1===I.indexOf("none")?((-1===I.indexOf("noUnderline")&&-1!==R.indexOf("underline")||-1!==I.indexOf("underline"))&&w.push("underline"),(-1===I.indexOf("noLineThrough")&&-1!==R.indexOf("lineThrough")||-1!==I.indexOf("lineThrough"))&&w.push("lineThrough"),(-1===I.indexOf("noOverline")&&-1!==R.indexOf("overline")||-1!==I.indexOf("overline"))&&w.push("overline")):w.push("none"),y.styleAttrs[b.qname]=w}else if(b.qname!==r.byName.fontSize.qname||b.qname in y.styleAttrs||"span"!==y.kind||"textContainer"!==y.styleAttrs[r.byName.ruby.qname])if(b.qname!==r.byName.fontSize.qname||b.qname in y.styleAttrs||"span"!==y.kind||"text"!==y.styleAttrs[r.byName.ruby.qname])b.inherit&&b.qname in d.styleAttrs&&!(b.qname in y.styleAttrs)&&(y.styleAttrs[b.qname]=d.styleAttrs[b.qname]);else{var D=d.styleAttrs[r.byName.fontSize.qname];"textContainer"===d.styleAttrs[r.byName.ruby.qname]?y.styleAttrs[b.qname]=D:y.styleAttrs[b.qname]=new n.ComputedLength(.5*D.rw,.5*D.rh)}else{var C=d.styleAttrs[r.byName.fontSize.qname];y.styleAttrs[b.qname]=new n.ComputedLength(.5*C.rw,.5*C.rh)}}for(var N=0;N<r.all.length;N++){var L=r.all[N];if(!(L.qname in y.styleAttrs)&&!(L.qname===r.byName.position.qname&&r.byName.origin.qname in y.styleAttrs||L.qname===r.byName.origin.qname&&r.byName.position.qname in y.styleAttrs)){var O=e.head.styling.initials[L.qname]||L.initial;if(null!==O&&("region"===y.kind||!1===L.inherit&&null!==O)){var P=L.parse(O);null!==P?(y.styleAttrs[L.qname]=P,T[L.qname]=!0):c(p,"Invalid initial value for '"+L.qname+"' on element '"+y.kind)}}}for(var M=0;M<r.all.length;M++){var k=r.all[M];if(k.qname in T&&null!==k.compute){var x=k.compute(e,d,y,y.styleAttrs[k.qname],m);null!==x?y.styleAttrs[k.qname]=x:(y.styleAttrs[k.qname]=k.compute(e,d,y,k.parse(k.initial),m),c(p,"Style '"+k.qname+"' on element '"+y.kind+"' cannot be computed"))}}if("none"===y.styleAttrs[r.byName.display.qname])return null;var F=null;null===d?F=null===f?[]:[f]:"contents"in g&&(F=g.contents);for(var U=0;null!==F&&U<F.length;U++){var B=a(e,t,l,f,y,v,F[U],p,m);null!==B&&y.contents.push(B.element)}for(var Z in y.styleAttrs)if(y.styleAttrs.hasOwnProperty(Z)){var G=!1;if("span"===y.kind){var K=y.styleAttrs[r.byName.ruby.qname];(G=("container"===K||"textContainer"===K||"baseContainer"===K)&&-1!==i.indexOf(Z))||(G="container"!==K&&Z===r.byName.rubyAlign.qname),G||(G=!("textContainer"===K||"text"===K)&&Z===r.byName.rubyPosition.qname)}if(!G){var H=r.byQName[Z];"applies"in H&&(G=-1===H.applies.indexOf(y.kind))}G&&delete y.styleAttrs[Z]}var Y=y.styleAttrs[r.byName.ruby.qname];if("p"===y.kind||"span"===y.kind&&("textContainer"===Y||"text"===Y)){var V=[];o(y,V),function(e){for(var t,r=0;r<e.length;)if("br"!==(t=e[r]).kind&&"preserve"!==t.space){var n=t.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(n)&&(0===r||"br"===(i=e[r-1]).kind||/[\r\n\t ]$/.test(i.text))&&(n=n.substring(1)),t.text=n,0===n.length?e.splice(r,1):r++}else r++;var i,a;for(r=0;r<e.length;r++)"br"!==(t=e[r]).kind&&"preserve"!==t.space?/[ ]$/.test(t.text)&&(r===e.length-1||"br"===(a=e[r+1]).kind||"preserve"===a.space&&/^[\r\n]/.test(a.text))&&(t.text=t.text.slice(0,-1)):r++}(V),s(y)}return"div"===y.kind&&r.byName.backgroundImage.qname in y.styleAttrs||"br"===y.kind||"image"===y.kind||"contents"in y&&y.contents.length>0||"span"===y.kind&&null!==y.text||"region"===y.kind&&"always"===y.styleAttrs[r.byName.showBackground.qname]?{region_id:v,element:y}:null}function o(e,t){if("contents"in e)for(var n=0;n<e.contents.length;n++){var i=e.contents[n],a=i.styleAttrs[r.byName.ruby.qname];("span"!==i.kind||"textContainer"!==a&&"text"!==a)&&("contents"in i?o(i,t):("span"===i.kind&&0!==i.text.length||"br"===i.kind)&&t.push(i))}}function s(e){if("br"===e.kind)return!1;if("text"in e)return 0===e.text.length;if("contents"in e){for(var t=e.contents.length;t--;)s(e.contents[t])&&e.contents.splice(t,1);return 0===e.contents.length}}function l(e){this.contents=[],this.aspectRatio=e.aspectRatio,this.lang=e.lang}function u(e){for(var t in this.kind=e.kind||"region",this.lang=e.lang,e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)e.styleAttrs.hasOwnProperty(t)&&(this.styleAttrs[t]=e.styleAttrs[t]);"src"in e&&(this.src=e.src),"type"in e&&(this.type=e.type),"text"in e?this.text=e.text:("region"===this.kind||"contents"in e)&&(this.contents=[]),"space"in e&&(this.space=e.space)}function c(e,t){if(e&&e.error&&e.error(t))throw t}}(t,"undefined"==typeof imscNames?r(210):imscNames,"undefined"==typeof imscStyles?r(6811):imscStyles,"undefined"==typeof imscUtils?r(5926):imscUtils)},4403:(e,t,r)=>{t.generateISD=r(4080).generateISD,t.fromXML=r(3362).fromXML,t.renderHTML=r(506).render},210:(e,t)=>{!function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"}(t)},6811:(e,t,r)=>{!function(e,t,r){function n(e,t,r,n,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=r,this.applies=n,this.parse=o,this.compute=s}for(var i in e.all=[new n(t.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,r.parseColor,null),new n(t.ns_tts,"color","white",["span"],!0,!0,r.parseColor,null),new n(t.ns_tts,"direction","ltr",["p","span"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"displayAlign","before",["region"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"extent","auto",["tt","region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=r.parseLength(t[0]),i=r.parseLength(t[1]);return i&&n?{h:i,w:n}:null}),(function(e,t,n,i,a){var o,s;if("auto"===i)o=new r.ComputedLength(0,1);else if(null===(o=r.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new r.ComputedLength(1,0);else if(null===(s=r.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new n(t.ns_tts,"fontFamily","default",["span","p"],!0,!0,(function(e){for(var t=e.split(","),r=[],n=0;n<t.length;n++)"'"!==t[n].charAt(0)&&'"'!==t[n].charAt(0)&&"default"===t[n]?r.push("monospaceSerif"):r.push(t[n]);return r}),null),new n(t.ns_tts,"shear","0%",["p"],!0,!0,r.parseLength,(function(e,t,r,n){return"%"!==n.unit?null:Math.abs(n.value)>100?100*Math.sign(n.value):n.value})),new n(t.ns_tts,"fontSize","1c",["span","p"],!0,!0,r.parseLength,(function(t,n,i,a,o){return r.toComputedLength(a.value,a.unit,null!==n?n.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,null!==n?n.styleAttrs[e.byName.fontSize.qname]:t.cellLength.h,t.cellLength.h,t.pxLength.h)})),new n(t.ns_tts,"fontStyle","normal",["span","p"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"fontWeight","normal",["span","p"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"lineHeight","normal",["p"],!0,!0,(function(e){return"normal"===e?e:r.parseLength(e)}),(function(t,n,i,a,o){var s;if("normal"===a)s=a;else if(null===(s=r.toComputedLength(a.value,a.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h)))return null;return s})),new n(t.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new n(t.ns_tts,"origin","auto",["region"],!1,!0,(function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=r.parseLength(t[0]),i=r.parseLength(t[1]);return i&&n?{h:i,w:n}:null}),(function(e,t,n,i,a){var o,s;if("auto"===i)o=new r.ComputedLength(0,0);else if(null===(o=r.toComputedLength(i.h.value,i.h.unit,null,e.dimensions.h,null,e.pxLength.h)))return null;if("auto"===i)s=new r.ComputedLength(0,0);else if(null===(s=r.toComputedLength(i.w.value,i.w.unit,null,e.dimensions.w,null,e.pxLength.w)))return null;return{h:o,w:s}})),new n(t.ns_tts,"overflow","hidden",["region"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"padding","0px",["region"],!1,!0,(function(e){var t=e.split(" ");if(t.length>4)return null;for(var n=[],i=0;i<t.length;i++){var a=r.parseLength(t[i]);if(!a)return null;n.push(a)}return n}),(function(t,n,i,a,o){var s;if(1===a.length)s=[a[0],a[0],a[0],a[0]];else if(2===a.length)s=[a[0],a[1],a[0],a[1]];else if(3===a.length)s=[a[0],a[1],a[2],a[1]];else{if(4!==a.length)return null;s=[a[0],a[1],a[2],a[3]]}var l=i.styleAttrs[e.byName.writingMode.qname];if("lrtb"===l||"lr"===l)s=[s[0],s[3],s[2],s[1]];else if("rltb"===l||"rl"===l)s=[s[0],s[1],s[2],s[3]];else if("tblr"===l)s=[s[3],s[0],s[1],s[2]];else{if("tbrl"!==l&&"tb"!==l)return null;s=[s[3],s[2],s[1],s[0]]}for(var u=[],c=0;c<s.length;c++)if(0===s[c].value)u[c]=new r.ComputedLength(0,0);else if(u[c]=r.toComputedLength(s[c].value,s[c].unit,i.styleAttrs[e.byName.fontSize.qname],0===c||2===c?i.styleAttrs[e.byName.extent.qname].h:i.styleAttrs[e.byName.extent.qname].w,0===c||2===c?t.cellLength.h:t.cellLength.w,0===c||2===c?t.pxLength.h:t.pxLength.w),null===u[c])return null;return u})),new n(t.ns_tts,"position","top left",["region"],!1,!0,(function(e){return r.parsePosition(e)}),(function(t,n,i,a){var o,s;return null===(o=r.toComputedLength(a.v.offset.value,a.v.offset.unit,null,new r.ComputedLength(-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-i.styleAttrs[e.byName.extent.qname].h.rh),null,t.pxLength.h))?null:("bottom"===a.v.edge&&(o=new r.ComputedLength(-o.rw-i.styleAttrs[e.byName.extent.qname].h.rw,t.dimensions.h.rh-o.rh-i.styleAttrs[e.byName.extent.qname].h.rh)),s=r.toComputedLength(a.h.offset.value,a.h.offset.unit,null,new r.ComputedLength(t.dimensions.w.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-i.styleAttrs[e.byName.extent.qname].w.rh),null,t.pxLength.w),null===o?null:("right"===a.h.edge&&(s=new r.ComputedLength(t.dimensions.w.rw-s.rw-i.styleAttrs[e.byName.extent.qname].w.rw,-s.rh-i.styleAttrs[e.byName.extent.qname].w.rh)),{h:o,w:s}))})),new n(t.ns_tts,"ruby","none",["span"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"rubyAlign","center",["span"],!0,!0,(function(e){return"center"!==e&&"spaceAround"!==e?null:e}),null),new n(t.ns_tts,"rubyPosition","outside",["span"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"rubyReserve","none",["p"],!0,!0,(function(e){var t=e.split(" "),n=[null,null];if(0===t.length||t.length>2)return null;if("none"!==t[0]&&"both"!==t[0]&&"after"!==t[0]&&"before"!==t[0]&&"outside"!==t[0])return null;if(n[0]=t[0],2===t.length&&"none"!==t[0]){var i=r.parseLength(t[1]);if(!i)return null;n[1]=i}return n}),(function(t,n,i,a,o){return"none"===a[0]?a:null===(s=null===a[1]?new r.ComputedLength(.5*i.styleAttrs[e.byName.fontSize.qname].rw,.5*i.styleAttrs[e.byName.fontSize.qname].rh):r.toComputedLength(a[1].value,a[1].unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h))?null:[a[0],s];var s})),new n(t.ns_tts,"showBackground","always",["region"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"textAlign","start",["p"],!0,!0,(function(e){return e}),(function(e,t,r,n,i){return"left"===n?"start":"right"===n?"end":n})),new n(t.ns_tts,"textCombine","none",["span"],!0,!0,(function(e){return"none"===e||"all"===e?e:null}),null),new n(t.ns_tts,"textDecoration","none",["span"],!0,!0,(function(e){return e.split(" ")}),null),new n(t.ns_tts,"textEmphasis","none",["span"],!0,!0,(function(e){for(var t=e.split(" "),n={style:null,symbol:null,color:null,position:null},i=0;i<t.length;i++)if("none"===t[i]||"auto"===t[i])n.style=t[i];else if("filled"===t[i]||"open"===t[i])n.style=t[i];else if("circle"===t[i]||"dot"===t[i]||"sesame"===t[i])n.symbol=t[i];else if("current"===t[i])n.color=t[i];else if("outside"===t[i]||"before"===t[i]||"after"===t[i])n.position=t[i];else if(n.color=r.parseColor(t[i]),null===n.color)return null;return null==n.style&&null==n.symbol?n.style="auto":(n.symbol=n.symbol||"circle",n.style=n.style||"filled"),n.position=n.position||"outside",n.color=n.color||"current",n}),null),new n(t.ns_tts,"textOutline","none",["span"],!0,!0,(function(e){if("none"===e)return e;var t={},n=e.split(" ");if(0===n.length||n.length>2)return null;var i=r.parseColor(n[0]);if(t.color=i,null!==i&&n.shift(),1!==n.length)return null;var a=r.parseLength(n[0]);return a?(t.thickness=a,t):null}),(function(t,n,i,a,o){if("none"===a)return a;var s={};return null===a.color?s.color=i.styleAttrs[e.byName.color.qname]:s.color=a.color,s.thickness=r.toComputedLength(a.thickness.value,a.thickness.unit,i.styleAttrs[e.byName.fontSize.qname],i.styleAttrs[e.byName.fontSize.qname],t.cellLength.h,t.pxLength.h),null===s.thickness?null:s})),new n(t.ns_tts,"textShadow","none",["span"],!0,!0,r.parseTextShadow,(function(t,n,i,a){if("none"===a)return a;for(var o=[],s=0;s<a.length;s++){var l={};if(l.x_off=r.toComputedLength(a[s][0].value,a[s][0].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.w),null===l.x_off)return null;if(l.y_off=r.toComputedLength(a[s][1].value,a[s][1].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.y_off)return null;if(null===a[s][2])l.b_radius=0;else if(l.b_radius=r.toComputedLength(a[s][2].value,a[s][2].unit,null,i.styleAttrs[e.byName.fontSize.qname],null,t.pxLength.h),null===l.b_radius)return null;null===a[s][3]?l.color=i.styleAttrs[e.byName.color.qname]:l.color=a[s][3],o.push(l)}return o})),new n(t.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"wrapOption","wrap",["span"],!0,!0,(function(e){return e}),null),new n(t.ns_tts,"writingMode","lrtb",["region"],!1,!0,(function(e){return e}),null),new n(t.ns_tts,"zIndex","auto",["region"],!1,!0,(function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t}),null),new n(t.ns_ebutts,"linePadding","0c",["p"],!0,!1,r.parseLength,(function(e,t,n,i,a){return r.toComputedLength(i.value,i.unit,null,null,e.cellLength.w,null)})),new n(t.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,(function(e){return e}),null),new n(t.ns_smpte,"backgroundImage",null,["div"],!1,!1,(function(e){return e}),null),new n(t.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,(function(e){return"true"===e}),null),new n(t.ns_itts,"fillLineGap","false",["p"],!0,!0,(function(e){return"true"===e}),null)],e.byQName={},e.all)e.byQName[e.all[i].qname]=e.all[i];for(var a in e.byName={},e.all)e.byName[e.all[a].name]=e.all[a]}(t,"undefined"==typeof imscNames?r(210):imscNames,"undefined"==typeof imscUtils?r(5926):imscUtils)},5926:(e,t)=>{!function(e){var t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,r=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,n=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,i={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var a,o=null,s=i[e.toLowerCase()];return void 0!==s?o=s:null!==(a=t.exec(e))?o=[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16),void 0!==a[4]?parseInt(a[4],16):255]:null!==(a=r.exec(e))?o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),255]:null!==(a=n.exec(e))&&(o=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3]),parseInt(a[4])]),o};var a=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;e.parseLength=function(e){var t,r=null;return null!==(t=a.exec(e))&&(r={value:parseFloat(t[1]),unit:t[2]}),r},e.parseTextShadow=function(t){for(var r=t.match(/([^\(,\)]|\([^\)]+\))+/g),n=[],i=0;i<r.length;i++){var a=r[i].split(" ");if(1===a.length&&"none"===a[0])return"none";if(a.length>1&&a.length<5){var o=[null,null,null,null],s=e.parseLength(a.shift());if(null===s)return null;if(o[0]=s,null===(s=e.parseLength(a.shift())))return null;if(o[1]=s,0===a.length){n.push(o);continue}if(null!==(s=e.parseLength(a[0]))&&(o[2]=s,a.shift()),0===a.length){n.push(o);continue}var l=e.parseColor(a[0]);if(null===l)return null;o[3]=l,n.push(o)}}return n},e.parsePosition=function(t){var r=t.split(" "),n=function(e){return"center"===e||"left"===e||"top"===e||"bottom"===e||"right"===e};if(r.length>4)return null;for(var i=0;i<r.length;i++)if(!n(r[i])){var a=e.parseLength(r[i]);if(null===a)return null;r[i]=a}for(var o={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}},s=0;s<r.length;){var l=r[s++];if(n(l)){var u={value:0,unit:"%"};2!==r.length&&s<r.length&&!n(r[s])&&(u=r[s++]),"right"===l?(o.h.edge=l,o.h.offset=u):"bottom"===l?(o.v.edge=l,o.v.offset=u):"left"===l?o.h.offset=u:"top"===l&&(o.v.offset=u)}else{if(1!==r.length&&2!==r.length)return null;1===s?o.h.offset=l:o.v.offset=l}}return o},e.ComputedLength=function(e,t){this.rw=e,this.rh=t},e.ComputedLength.prototype.toUsedLength=function(e,t){return e*this.rw+t*this.rh},e.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh},e.toComputedLength=function(t,r,n,i,a,o){return"%"===r&&i?new e.ComputedLength(i.rw*t/100,i.rh*t/100):"em"===r&&n?new e.ComputedLength(n.rw*t,n.rh*t):"c"===r&&a?new e.ComputedLength(t*a.rw,t*a.rh):"px"===r&&o?new e.ComputedLength(t*o.rw,t*o.rh):"rh"===r?new e.ComputedLength(0,t/100):"rw"===r?new e.ComputedLength(t/100,0):null}}(t)},3516:e=>{"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=97&&t<=122||t>=65&&t<=90}},2219:(e,t,r)=>{"use strict";var n=r(3516),i=r(395);e.exports=function(e){return n(e)||i(e)}},395:e=>{"use strict";e.exports=function(e){var t="string"==typeof e?e.charCodeAt(0):e;return t>=48&&t<=57}},3875:e=>{"use strict";function t(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function r(e,t){for(var r,n="",i=0,a=-1,o=0,s=0;s<=e.length;++s){if(s<e.length)r=e.charCodeAt(s);else{if(47===r)break;r=47}if(47===r){if(a===s-1||1===o);else if(a!==s-1&&2===o){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2))if(n.length>2){var l=n.lastIndexOf("/");if(l!==n.length-1){-1===l?(n="",i=0):i=(n=n.slice(0,l)).length-1-n.lastIndexOf("/"),a=s,o=0;continue}}else if(2===n.length||1===n.length){n="",i=0,a=s,o=0;continue}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(a+1,s):n=e.slice(a+1,s),i=s-a-1;a=s,o=0}else 46===r&&-1!==o?++o:o=-1}return n}var n={resolve:function(){for(var e,n="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var o;a>=0?o=arguments[a]:(void 0===e&&(e=process.cwd()),o=e),t(o),0!==o.length&&(n=o+"/"+n,i=47===o.charCodeAt(0))}return n=r(n,!i),i?n.length>0?"/"+n:"/":n.length>0?n:"."},normalize:function(e){if(t(e),0===e.length)return".";var n=47===e.charCodeAt(0),i=47===e.charCodeAt(e.length-1);return 0!==(e=r(e,!n)).length||n||(e="."),e.length>0&&i&&(e+="/"),n?"/"+e:e},isAbsolute:function(e){return t(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,r=0;r<arguments.length;++r){var i=arguments[r];t(i),i.length>0&&(void 0===e?e=i:e+="/"+i)}return void 0===e?".":n.normalize(e)},relative:function(e,r){if(t(e),t(r),e===r)return"";if((e=n.resolve(e))===(r=n.resolve(r)))return"";for(var i=1;i<e.length&&47===e.charCodeAt(i);++i);for(var a=e.length,o=a-i,s=1;s<r.length&&47===r.charCodeAt(s);++s);for(var l=r.length-s,u=o<l?o:l,c=-1,f=0;f<=u;++f){if(f===u){if(l>u){if(47===r.charCodeAt(s+f))return r.slice(s+f+1);if(0===f)return r.slice(s+f)}else o>u&&(47===e.charCodeAt(i+f)?c=f:0===f&&(c=0));break}var d=e.charCodeAt(i+f);if(d!==r.charCodeAt(s+f))break;47===d&&(c=f)}var h="";for(f=i+c+1;f<=a;++f)f!==a&&47!==e.charCodeAt(f)||(0===h.length?h+="..":h+="/..");return h.length>0?h+r.slice(s+c):(s+=c,47===r.charCodeAt(s)&&++s,r.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(t(e),0===e.length)return".";for(var r=e.charCodeAt(0),n=47===r,i=-1,a=!0,o=e.length-1;o>=1;--o)if(47===(r=e.charCodeAt(o))){if(!a){i=o;break}}else a=!1;return-1===i?n?"/":".":n&&1===i?"//":e.slice(0,i)},basename:function(e,r){if(void 0!==r&&"string"!=typeof r)throw new TypeError('"ext" argument must be a string');t(e);var n,i=0,a=-1,o=!0;if(void 0!==r&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var s=r.length-1,l=-1;for(n=e.length-1;n>=0;--n){var u=e.charCodeAt(n);if(47===u){if(!o){i=n+1;break}}else-1===l&&(o=!1,l=n+1),s>=0&&(u===r.charCodeAt(s)?-1==--s&&(a=n):(s=-1,a=l))}return i===a?a=l:-1===a&&(a=e.length),e.slice(i,a)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!o){i=n+1;break}}else-1===a&&(o=!1,a=n+1);return-1===a?"":e.slice(i,a)},extname:function(e){t(e);for(var r=-1,n=0,i=-1,a=!0,o=0,s=e.length-1;s>=0;--s){var l=e.charCodeAt(s);if(47!==l)-1===i&&(a=!1,i=s+1),46===l?-1===r?r=s:1!==o&&(o=1):-1!==r&&(o=-1);else if(!a){n=s+1;break}}return-1===r||-1===i||0===o||1===o&&r===i-1&&r===n+1?"":e.slice(r,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var r=t.dir||t.root,n=t.base||(t.name||"")+(t.ext||"");return r?r===t.root?r+n:r+"/"+n:n}(0,e)},parse:function(e){t(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;var n,i=e.charCodeAt(0),a=47===i;a?(r.root="/",n=1):n=0;for(var o=-1,s=0,l=-1,u=!0,c=e.length-1,f=0;c>=n;--c)if(47!==(i=e.charCodeAt(c)))-1===l&&(u=!1,l=c+1),46===i?-1===o?o=c:1!==f&&(f=1):-1!==o&&(f=-1);else if(!u){s=c+1;break}return-1===o||-1===l||0===f||1===f&&o===l-1&&o===s+1?-1!==l&&(r.base=r.name=0===s&&a?e.slice(1,l):e.slice(s,l)):(0===s&&a?(r.name=e.slice(1,o),r.base=e.slice(1,l)):(r.name=e.slice(s,o),r.base=e.slice(s,l)),r.ext=e.slice(o,l)),s>0?r.dir=e.slice(0,s-1):a&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};n.posix=n,e.exports=n},8387:(e,t,r)=>{var n=r(1549),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o),a(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},5378:(e,t,r)=>{!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,r){if(!(this instanceof i))return new i(t,r);var a=this;!function(e){for(var t=0,r=n.length;t<r;t++)e[n[t]]=""}(a),a.q=a.c="",a.bufferCheckPosition=e.MAX_BUFFER_LENGTH,a.opt=r||{},a.opt.lowercase=a.opt.lowercase||a.opt.lowercasetags,a.looseCase=a.opt.lowercase?"toLowerCase":"toUpperCase",a.tags=[],a.closed=a.closedRoot=a.sawRoot=!1,a.tag=a.error=null,a.strict=!!t,a.noscript=!(!t&&!a.opt.noscript),a.state=R.BEGIN,a.strictEntities=a.opt.strictEntities,a.ENTITIES=a.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),a.attribList=[],a.opt.xmlns&&(a.ns=Object.create(g)),a.trackPosition=!1!==a.opt.position,a.trackPosition&&(a.position=a.line=a.column=0),w(a,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),i.prototype={end:function(){O(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return L(r,"Cannot write after close. Assign an onready handler.");if(null===t)return O(r);"object"==typeof t&&(t=t.toString());for(var i=0,a="";a=G(t,i++),r.c=a,a;)switch(r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++),r.state){case R.BEGIN:if(r.state=R.BEGIN_WHITESPACE,"\ufeff"===a)continue;Z(r,a);continue;case R.BEGIN_WHITESPACE:Z(r,a);continue;case R.TEXT:if(r.sawRoot&&!r.closedRoot){for(var o=i-1;a&&"<"!==a&&"&"!==a;)(a=G(t,i++))&&r.trackPosition&&(r.position++,"\n"===a?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(o,i-1)}"<"!==a||r.sawRoot&&r.closedRoot&&!r.strict?(!_(s,a)||r.sawRoot&&!r.closedRoot||P(r,"Text data outside of root node."),"&"===a?r.state=R.TEXT_ENTITY:r.textNode+=a):(r.state=R.OPEN_WAKA,r.startTagPosition=r.position);continue;case R.SCRIPT:"<"===a?r.state=R.SCRIPT_ENDING:r.script+=a;continue;case R.SCRIPT_ENDING:"/"===a?r.state=R.CLOSE_TAG:(r.script+="<"+a,r.state=R.SCRIPT);continue;case R.OPEN_WAKA:if("!"===a)r.state=R.SGML_DECL,r.sgmlDecl="";else if(T(s,a));else if(T(p,a))r.state=R.OPEN_TAG,r.tagName=a;else if("/"===a)r.state=R.CLOSE_TAG,r.tagName="";else if("?"===a)r.state=R.PROC_INST,r.procInstName=r.procInstBody="";else{if(P(r,"Unencoded <"),r.startTagPosition+1<r.position){var l=r.position-r.startTagPosition;a=new Array(l).join(" ")+a}r.textNode+="<"+a,r.state=R.TEXT}continue;case R.SGML_DECL:"[CDATA["===(r.sgmlDecl+a).toUpperCase()?(D(r,"onopencdata"),r.state=R.CDATA,r.sgmlDecl="",r.cdata=""):r.sgmlDecl+a==="--"?(r.state=R.COMMENT,r.comment="",r.sgmlDecl=""):"DOCTYPE"===(r.sgmlDecl+a).toUpperCase()?(r.state=R.DOCTYPE,(r.doctype||r.sawRoot)&&P(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===a?(D(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=R.TEXT):T(c,a)?(r.state=R.SGML_DECL_QUOTED,r.sgmlDecl+=a):r.sgmlDecl+=a;continue;case R.SGML_DECL_QUOTED:a===r.q&&(r.state=R.SGML_DECL,r.q=""),r.sgmlDecl+=a;continue;case R.DOCTYPE:">"===a?(r.state=R.TEXT,D(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=a,"["===a?r.state=R.DOCTYPE_DTD:T(c,a)&&(r.state=R.DOCTYPE_QUOTED,r.q=a));continue;case R.DOCTYPE_QUOTED:r.doctype+=a,a===r.q&&(r.q="",r.state=R.DOCTYPE);continue;case R.DOCTYPE_DTD:r.doctype+=a,"]"===a?r.state=R.DOCTYPE:T(c,a)&&(r.state=R.DOCTYPE_DTD_QUOTED,r.q=a);continue;case R.DOCTYPE_DTD_QUOTED:r.doctype+=a,a===r.q&&(r.state=R.DOCTYPE_DTD,r.q="");continue;case R.COMMENT:"-"===a?r.state=R.COMMENT_ENDING:r.comment+=a;continue;case R.COMMENT_ENDING:"-"===a?(r.state=R.COMMENT_ENDED,r.comment=N(r.opt,r.comment),r.comment&&D(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+a,r.state=R.COMMENT);continue;case R.COMMENT_ENDED:">"!==a?(P(r,"Malformed comment"),r.comment+="--"+a,r.state=R.COMMENT):r.state=R.TEXT;continue;case R.CDATA:"]"===a?r.state=R.CDATA_ENDING:r.cdata+=a;continue;case R.CDATA_ENDING:"]"===a?r.state=R.CDATA_ENDING_2:(r.cdata+="]"+a,r.state=R.CDATA);continue;case R.CDATA_ENDING_2:">"===a?(r.cdata&&D(r,"oncdata",r.cdata),D(r,"onclosecdata"),r.cdata="",r.state=R.TEXT):"]"===a?r.cdata+="]":(r.cdata+="]]"+a,r.state=R.CDATA);continue;case R.PROC_INST:"?"===a?r.state=R.PROC_INST_ENDING:T(s,a)?r.state=R.PROC_INST_BODY:r.procInstName+=a;continue;case R.PROC_INST_BODY:if(!r.procInstBody&&T(s,a))continue;"?"===a?r.state=R.PROC_INST_ENDING:r.procInstBody+=a;continue;case R.PROC_INST_ENDING:">"===a?(D(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=R.TEXT):(r.procInstBody+="?"+a,r.state=R.PROC_INST_BODY);continue;case R.OPEN_TAG:T(m,a)?r.tagName+=a:(M(r),">"===a?F(r):"/"===a?r.state=R.OPEN_TAG_SLASH:(_(s,a)&&P(r,"Invalid character in tag name"),r.state=R.ATTRIB));continue;case R.OPEN_TAG_SLASH:">"===a?(F(r,!0),U(r)):(P(r,"Forward-slash in opening tag not followed by >"),r.state=R.ATTRIB);continue;case R.ATTRIB:if(T(s,a))continue;">"===a?F(r):"/"===a?r.state=R.OPEN_TAG_SLASH:T(p,a)?(r.attribName=a,r.attribValue="",r.state=R.ATTRIB_NAME):P(r,"Invalid attribute name");continue;case R.ATTRIB_NAME:"="===a?r.state=R.ATTRIB_VALUE:">"===a?(P(r,"Attribute without value"),r.attribValue=r.attribName,x(r),F(r)):T(s,a)?r.state=R.ATTRIB_NAME_SAW_WHITE:T(m,a)?r.attribName+=a:P(r,"Invalid attribute name");continue;case R.ATTRIB_NAME_SAW_WHITE:if("="===a)r.state=R.ATTRIB_VALUE;else{if(T(s,a))continue;P(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",D(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===a?F(r):T(p,a)?(r.attribName=a,r.state=R.ATTRIB_NAME):(P(r,"Invalid attribute name"),r.state=R.ATTRIB)}continue;case R.ATTRIB_VALUE:if(T(s,a))continue;T(c,a)?(r.q=a,r.state=R.ATTRIB_VALUE_QUOTED):(P(r,"Unquoted attribute value"),r.state=R.ATTRIB_VALUE_UNQUOTED,r.attribValue=a);continue;case R.ATTRIB_VALUE_QUOTED:if(a!==r.q){"&"===a?r.state=R.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=a;continue}x(r),r.q="",r.state=R.ATTRIB_VALUE_CLOSED;continue;case R.ATTRIB_VALUE_CLOSED:T(s,a)?r.state=R.ATTRIB:">"===a?F(r):"/"===a?r.state=R.OPEN_TAG_SLASH:T(p,a)?(P(r,"No whitespace between attributes"),r.attribName=a,r.attribValue="",r.state=R.ATTRIB_NAME):P(r,"Invalid attribute name");continue;case R.ATTRIB_VALUE_UNQUOTED:if(_(f,a)){"&"===a?r.state=R.ATTRIB_VALUE_ENTITY_U:r.attribValue+=a;continue}x(r),">"===a?F(r):r.state=R.ATTRIB;continue;case R.CLOSE_TAG:if(r.tagName)">"===a?U(r):T(m,a)?r.tagName+=a:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=R.SCRIPT):(_(s,a)&&P(r,"Invalid tagname in closing tag"),r.state=R.CLOSE_TAG_SAW_WHITE);else{if(T(s,a))continue;_(p,a)?r.script?(r.script+="</"+a,r.state=R.SCRIPT):P(r,"Invalid tagname in closing tag."):r.tagName=a}continue;case R.CLOSE_TAG_SAW_WHITE:if(T(s,a))continue;">"===a?U(r):P(r,"Invalid characters in closing tag");continue;case R.TEXT_ENTITY:case R.ATTRIB_VALUE_ENTITY_Q:case R.ATTRIB_VALUE_ENTITY_U:var u,d;switch(r.state){case R.TEXT_ENTITY:u=R.TEXT,d="textNode";break;case R.ATTRIB_VALUE_ENTITY_Q:u=R.ATTRIB_VALUE_QUOTED,d="attribValue";break;case R.ATTRIB_VALUE_ENTITY_U:u=R.ATTRIB_VALUE_UNQUOTED,d="attribValue"}";"===a?(r[d]+=B(r),r.entity="",r.state=u):T(r.entity.length?y:v,a)?r.entity+=a:(P(r,"Invalid character in entity name"),r[d]+="&"+r.entity+a,r.entity="",r.state=u);continue;default:throw new Error(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,a=0,o=n.length;a<o;a++){var s=t[n[a]].length;if(s>r)switch(n[a]){case"textNode":C(t);break;case"cdata":D(t,"oncdata",t.cdata),t.cdata="";break;case"script":D(t,"onscript",t.script),t.script="";break;default:L(t,"Max buffer length exceeded: "+n[a])}i=Math.max(i,s)}var l=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=l+t.position}(r),r},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;C(e=this),""!==e.cdata&&(D(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(D(e,"onscript",e.script),e.script="")}};try{t=r(182).Stream}catch(e){t=function(){}}var a=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function o(e,r){if(!(this instanceof o))return new o(e,r);t.apply(this),this._parser=new i(e,r),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,a.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(7503).s;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,r){var n=this;return n._parser["on"+e]||-1===a.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),t.prototype.on.call(n,e,r)};var s="\r\n\t ",l="0124356789",u="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="'\"",f=s+">",d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",g={xml:d,xmlns:h};s=E(s),l=E(l),u=E(u);var p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function E(e){return e.split("").reduce((function(e,t){return e[t]=!0,e}),{})}function T(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function _(e,t){return!T(e,t)}c=E(c),f=E(f);var S,A,b,R=0;for(var I in e.STATE={BEGIN:R++,BEGIN_WHITESPACE:R++,TEXT:R++,TEXT_ENTITY:R++,OPEN_WAKA:R++,SGML_DECL:R++,SGML_DECL_QUOTED:R++,DOCTYPE:R++,DOCTYPE_QUOTED:R++,DOCTYPE_DTD:R++,DOCTYPE_DTD_QUOTED:R++,COMMENT_STARTING:R++,COMMENT:R++,COMMENT_ENDING:R++,COMMENT_ENDED:R++,CDATA:R++,CDATA_ENDING:R++,CDATA_ENDING_2:R++,PROC_INST:R++,PROC_INST_BODY:R++,PROC_INST_ENDING:R++,OPEN_TAG:R++,OPEN_TAG_SLASH:R++,ATTRIB:R++,ATTRIB_NAME:R++,ATTRIB_NAME_SAW_WHITE:R++,ATTRIB_VALUE:R++,ATTRIB_VALUE_QUOTED:R++,ATTRIB_VALUE_CLOSED:R++,ATTRIB_VALUE_UNQUOTED:R++,ATTRIB_VALUE_ENTITY_Q:R++,ATTRIB_VALUE_ENTITY_U:R++,CLOSE_TAG:R++,CLOSE_TAG_SAW_WHITE:R++,SCRIPT:R++,SCRIPT_ENDING:R++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n})),e.STATE)e.STATE[e.STATE[I]]=I;function w(e,t,r){e[t]&&e[t](r)}function D(e,t,r){e.textNode&&C(e),w(e,t,r)}function C(e){e.textNode=N(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode=""}function N(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function L(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,w(e,"onerror",t),e}function O(e){return e.sawRoot&&!e.closedRoot&&P(e,"Unclosed root tag"),e.state!==R.BEGIN&&e.state!==R.BEGIN_WHITESPACE&&e.state!==R.TEXT&&L(e,"Unexpected end"),C(e),e.c="",e.closed=!0,w(e,"onend"),i.call(e,e.strict,e.opt),e}function P(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&L(e,t)}function M(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,D(e,"onopentagstart",r)}function k(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function x(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=k(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==d)P(e,"xml: prefix must be bound to "+d+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==h)P(e,"xmlns: prefix must be bound to "+h+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,D(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function F(e,t){if(e.opt.xmlns){var r=e.tag,n=k(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(P(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){D(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var a=0,o=e.attribList.length;a<o;a++){var s=e.attribList[a],l=s[0],u=s[1],c=k(l,!0),f=c.prefix,d=c.local,h=""===f?"":r.ns[f]||"",g={name:l,value:u,prefix:f,local:d,uri:h};f&&"xmlns"!==f&&!h&&(P(e,"Unbound namespace prefix: "+JSON.stringify(f)),g.uri=f),e.tag.attributes[l]=g,D(e,"onattribute",g)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),D(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=R.TEXT:e.state=R.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function U(e){if(!e.tagName)return P(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=R.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=R.SCRIPT);D(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--&&e.tags[t].name!==n;)P(e,"Unexpected close tag");if(t<0)return P(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=R.TEXT);e.tagName=r;for(var i=e.tags.length;i-- >t;){var a=e.tag=e.tags.pop();e.tagName=e.tag.name,D(e,"onclosetag",e.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var l=e.tags[e.tags.length-1]||e;e.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach((function(t){var r=a.ns[t];D(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=R.TEXT}function B(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),i.toLowerCase()!==r?(P(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function Z(e,t){"<"===t?(e.state=R.OPEN_WAKA,e.startTagPosition=e.position):_(s,t)&&(P(e,"Non-whitespace before first tag."),e.textNode=t,e.state=R.TEXT)}function G(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}R=e.STATE,String.fromCodePoint||(S=String.fromCharCode,A=Math.floor,b=function(){var e,t,r=[],n=-1,i=arguments.length;if(!i)return"";for(var a="";++n<i;){var o=Number(arguments[n]);if(!isFinite(o)||o<0||o>1114111||A(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?r.push(o):(e=55296+((o-=65536)>>10),t=o%1024+56320,r.push(e,t)),(n+1===i||r.length>16384)&&(a+=S.apply(null,r),r.length=0)}return a},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:b,configurable:!0,writable:!0}):String.fromCodePoint=b)}(t)},182:(e,t,r)=>{e.exports=i;var n=r(1159).EventEmitter;function i(){n.call(this)}r(1765)(i,n),i.Readable=r(2846),i.Writable=r(8318),i.Duplex=r(6138),i.Transform=r(9798),i.PassThrough=r(5472),i.finished=r(8800),i.pipeline=r(7295),i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function a(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",l));var o=!1;function s(){o||(o=!0,e.end())}function l(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===n.listenerCount(this,"error"))throw e}function c(){r.removeListener("data",i),e.removeListener("drain",a),r.removeListener("end",s),r.removeListener("close",l),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",c),r.removeListener("close",c),e.removeListener("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("close",c),e.emit("pipe",r),e}},1765:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},3690:e=>{"use strict";var t={};function r(e,r,n){n||(n=Error);var i=function(e){var t,n;function i(t,n,i){return e.call(this,function(e,t,n){return"string"==typeof r?r:r(e,t,n)}(t,n,i))||this}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i}(n);i.prototype.name=n.name,i.prototype.code=e,t[e]=i}function n(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,r){var i,a,o,s,l;if("string"==typeof t&&(a="not ",t.substr(0,4)===a)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-9,r)===t}(e," argument"))o="The ".concat(e," ").concat(i," ").concat(n(t,"type"));else{var u=("number"!=typeof l&&(l=0),l+1>(s=e).length||-1===s.indexOf(".",l)?"argument":"property");o='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(n(t,"type"))}return o+". Received type ".concat(typeof r)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6138:(e,t,r)=>{"use strict";var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var i=r(2846),a=r(8318);r(1765)(u,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var l=o[s];u.prototype[l]||(u.prototype[l]=a.prototype[l])}function u(e){if(!(this instanceof u))return new u(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||process.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},5472:(e,t,r)=>{"use strict";e.exports=i;var n=r(9798);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(1765)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},2846:(e,t,r)=>{"use strict";var n;e.exports=b,b.ReadableState=A,r(1159).EventEmitter;var i,a=function(e,t){return e.listeners(t).length},o=r(9299),s=r(1549).Buffer,l=r.g.Uint8Array||function(){},u=r(964);i=u&&u.debuglog?u.debuglog("stream"):function(){};var c,f,d,h=r(8393),g=r(6163),p=r(7269).getHighWaterMark,m=r(3690).q,v=m.ERR_INVALID_ARG_TYPE,y=m.ERR_STREAM_PUSH_AFTER_EOF,E=m.ERR_METHOD_NOT_IMPLEMENTED,T=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(1765)(b,o);var _=g.errorOrDestroy,S=["error","close","destroy","pause","resume"];function A(e,t,i){n=n||r(6138),e=e||{},"boolean"!=typeof i&&(i=t instanceof n),this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=p(this,e,"readableHighWaterMark",i),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(c||(c=r(7503).s),this.decoder=new c(e.encoding),this.encoding=e.encoding)}function b(e){if(n=n||r(6138),!(this instanceof b))return new b(e);var t=this instanceof n;this._readableState=new A(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function R(e,t,r,n,a){i("readableAddChunk",t);var o,u=e._readableState;if(null===t)u.reading=!1,function(e,t){if(i("onEofChunk"),!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?C(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}}(e,u);else if(a||(o=function(e,t){var r,n;return n=t,s.isBuffer(n)||n instanceof l||"string"==typeof t||void 0===t||e.objectMode||(r=new v("chunk",["string","Buffer","Uint8Array"],t)),r}(u,t)),o)_(e,o);else if(u.objectMode||t&&t.length>0)if("string"==typeof t||u.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)u.endEmitted?_(e,new T):I(e,u,t,!0);else if(u.ended)_(e,new y);else{if(u.destroyed)return!1;u.reading=!1,u.decoder&&!r?(t=u.decoder.write(t),u.objectMode||0!==t.length?I(e,u,t,!1):L(e,u)):I(e,u,t,!1)}else n||(u.reading=!1,L(e,u));return!u.ended&&(u.length<u.highWaterMark||0===u.length)}function I(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&C(e)),L(e,t)}Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),R(this,e,t,!1,r)},b.prototype.unshift=function(e){return R(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){c||(c=r(7503).s);var t=new c(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var w=1073741824;function D(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;i("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(i("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(N,e))}function N(e){var t=e._readableState;i("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,x(e)}function L(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(i("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function P(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function M(e){i("readable nexttick read 0"),e.read(0)}function k(e,t){i("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),x(e),t.flowing&&!t.reading&&e.read(0)}function x(e){var t=e._readableState;for(i("flow",t.flowing);t.flowing&&null!==e.read(););}function F(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function U(e){var t=e._readableState;i("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(B,t,e))}function B(e,t){if(i("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function Z(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){i("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return i("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):C(this),null;if(0===(e=D(e,t))&&t.ended)return 0===t.length&&U(this),null;var n,a=t.needReadable;return i("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&i("length less than watermark",a=!0),t.ended||t.reading?i("reading or ended",a=!1):a&&(i("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=D(r,t))),null===(n=e>0?F(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&U(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){_(this,new E("_read()"))},b.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,i("pipe count=%d opts=%j",n.pipesCount,t);var o=t&&!1===t.end||e===process.stdout||e===process.stderr?g:s;function s(){i("onend"),e.end()}n.endEmitted?process.nextTick(o):r.once("end",o),e.on("unpipe",(function t(a,o){i("onunpipe"),a===r&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,i("cleanup"),e.removeListener("close",d),e.removeListener("finish",h),e.removeListener("drain",l),e.removeListener("error",f),e.removeListener("unpipe",t),r.removeListener("end",s),r.removeListener("end",g),r.removeListener("data",c),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}));var l=function(e){return function(){var t=e._readableState;i("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,x(e))}}(r);e.on("drain",l);var u=!1;function c(t){i("ondata");var a=e.write(t);i("dest.write",a),!1===a&&((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==Z(n.pipes,e))&&!u&&(i("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function f(t){i("onerror",t),g(),e.removeListener("error",f),0===a(e,"error")&&_(e,t)}function d(){e.removeListener("finish",h),g()}function h(){i("onfinish"),e.removeListener("close",d),g()}function g(){i("unpipe"),r.unpipe(e)}return r.on("data",c),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",f),e.once("close",d),e.once("finish",h),e.emit("pipe",r),n.flowing||(i("pipe resume"),r.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Z(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},b.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"===e&&(n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,i("on readable",n.length,n.reading),n.length?C(this):n.reading||process.nextTick(M,this))),r},b.prototype.addListener=b.prototype.on,b.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(P,this),r},b.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(P,this),t},b.prototype.resume=function(){var e=this._readableState;return e.flowing||(i("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(k,e,t))}(this,e)),e.paused=!1,this},b.prototype.pause=function(){return i("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(i("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var a in e.on("end",(function(){if(i("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(a){i("wrapped data"),r.decoder&&(a=r.decoder.write(a)),r.objectMode&&null==a||(r.objectMode||a&&a.length)&&(t.push(a)||(n=!0,e.pause()))})),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){i("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"==typeof Symbol&&(b.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(7299)),f(this)}),Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(b.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(b.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),b._fromList=F,Object.defineProperty(b.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(b.from=function(e,t){return void 0===d&&(d=r(6233)),d(b,e,t)})},9798:(e,t,r)=>{"use strict";e.exports=c;var n=r(3690).q,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,l=r(6138);function u(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);l.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,r){d(e,t,r)}))}function d(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(1765)(c,l),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,l.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){l.prototype._destroy.call(this,e,(function(e){t(e)}))}},8318:(e,t,r)=>{"use strict";function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(void 0),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var i;e.exports=b,b.WritableState=A;var a,o={deprecate:r(7839)},s=r(9299),l=r(1549).Buffer,u=r.g.Uint8Array||function(){},c=r(6163),f=r(7269).getHighWaterMark,d=r(3690).q,h=d.ERR_INVALID_ARG_TYPE,g=d.ERR_METHOD_NOT_IMPLEMENTED,p=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,v=d.ERR_STREAM_DESTROYED,y=d.ERR_STREAM_NULL_VALUES,E=d.ERR_STREAM_WRITE_AFTER_END,T=d.ERR_UNKNOWN_ENCODING,_=c.errorOrDestroy;function S(){}function A(e,t,a){i=i||r(6138),e=e||{},"boolean"!=typeof a&&(a=t instanceof i),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",a),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if("function"!=typeof i)throw new p;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,i){--t.pendingcb,r?(process.nextTick(i,n),process.nextTick(N,e,t),e._writableState.errorEmitted=!0,_(e,n)):(i(n),e._writableState.errorEmitted=!0,_(e,n),N(e,t))}(e,r,n,t,i);else{var a=D(r)||e.destroyed;a||r.corked||r.bufferProcessing||!r.bufferedRequest||w(e,r),n?process.nextTick(I,e,r,a,i):I(e,r,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function b(e){var t=this instanceof(i=i||r(6138));if(!t&&!a.call(b,this))return new b(e);this._writableState=new A(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),s.call(this)}function R(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function I(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),N(e,t)}function w(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,a=new Array(i),o=t.corkedRequestsFree;o.entry=r;for(var s=0,l=!0;r;)a[s]=r,r.isBuf||(l=!1),r=r.next,s+=1;a.allBuffers=l,R(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,c=r.encoding,f=r.callback;if(R(e,t,!1,t.objectMode?1:u.length,u,c,f),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function D(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function C(e,t){e._final((function(r){t.pendingcb--,r&&_(e,r),t.prefinished=!0,e.emit("prefinish"),N(e,t)}))}function N(e,t){var r=D(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(C,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var n=e._readableState;(!n||n.autoDestroy&&n.endEmitted)&&e.destroy()}return r}r(1765)(b,s),A.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(A.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(a=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return!!a.call(this,e)||this===b&&e&&e._writableState instanceof A}})):a=function(e){return e instanceof this},b.prototype.pipe=function(){_(this,new m)},b.prototype.write=function(e,t,r){var n,i=this._writableState,a=!1,o=!i.objectMode&&(n=e,l.isBuffer(n)||n instanceof u);return o&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=S),i.ending?function(e,t){var r=new E;_(e,r),process.nextTick(t,r)}(this,r):(o||function(e,t,r,n){var i;return null===r?i=new y:"string"==typeof r||t.objectMode||(i=new h("chunk",["string","Buffer"],r)),!i||(_(e,i),process.nextTick(n,i),!1)}(this,i,e,r))&&(i.pendingcb++,a=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r)),t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else R(e,t,!1,s,n,i,a);return u}(this,i,o,e,t,r)),a},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||w(this,e))},b.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new T(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(b.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(e,t,r){r(new g("_write()"))},b.prototype._writev=null,b.prototype.end=function(e,t,r){var n=this._writableState;return"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,r){t.ending=!0,N(e,t),r&&(t.finished?process.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r),this},Object.defineProperty(b.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(b.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),b.prototype.destroy=c.destroy,b.prototype._undestroy=c.undestroy,b.prototype._destroy=function(e,t){t(e)}},7299:(e,t,r)=>{"use strict";var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(8800),o=Symbol("lastResolve"),s=Symbol("lastReject"),l=Symbol("error"),u=Symbol("ended"),c=Symbol("lastPromise"),f=Symbol("handlePromise"),d=Symbol("stream");function h(e,t){return{value:e,done:t}}function g(e){var t=e[o];if(null!==t){var r=e[d].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(h(r,!1)))}}function p(e){process.nextTick(g,e)}var m=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[l];if(null!==t)return Promise.reject(t);if(this[u])return Promise.resolve(h(void 0,!0));if(this[d].destroyed)return new Promise((function(t,r){process.nextTick((function(){e[l]?r(e[l]):t(h(void 0,!0))}))}));var r,n=this[c];if(n)r=new Promise(function(e,t){return function(r,n){e.then((function(){t[u]?r(h(void 0,!0)):t[f](r,n)}),n)}}(n,this));else{var i=this[d].read();if(null!==i)return Promise.resolve(h(i,!1));r=new Promise(this[f])}return this[c]=r,r}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[d].destroy(null,(function(e){e?r(e):t(h(void 0,!0))}))}))})),n),m);e.exports=function(e){var t,r=Object.create(v,(i(t={},d,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,l,{value:null,writable:!0}),i(t,u,{value:e._readableState.endEmitted,writable:!0}),i(t,f,{value:function(e,t){var n=r[d].read();n?(r[c]=null,r[o]=null,r[s]=null,e(h(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[l]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(h(void 0,!0))),r[u]=!0})),e.on("readable",p.bind(null,r)),r}},8393:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(1549).Buffer,o=r(9862).inspect,s=o&&o.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t;return t=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,r,n,i=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,r=i,n=s,a.prototype.copy.call(t,r,n),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0==(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(o));break}++n}return this.length-=n,t}},{key:s,value:function(e,t){return o(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}()},6163:e=>{"use strict";function t(e,t){n(e,t),r(e)}function r(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,i){var a=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(i?i(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(n,this,e)):process.nextTick(n,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!i&&e?a._writableState?a._writableState.errorEmitted?process.nextTick(r,a):(a._writableState.errorEmitted=!0,process.nextTick(t,a,e)):process.nextTick(t,a,e):i?(process.nextTick(r,a),i(e)):process.nextTick(r,a)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}},8800:(e,t,r)=>{"use strict";var n=r(3690).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"==typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,l=function(){t.writable||c()},u=t._writableState&&t._writableState.finished,c=function(){s=!1,u=!0,o||a.call(t)},f=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,f=!0,s||a.call(t)},h=function(e){a.call(t,e)},g=function(){var e;return o&&!f?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!u?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},p=function(){t.req.on("finish",c)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",c),t.on("abort",g),t.req?p():t.on("request",p)):s&&!t._writableState&&(t.on("end",l),t.on("close",l)),t.on("end",d),t.on("finish",c),!1!==r.error&&t.on("error",h),t.on("close",g),function(){t.removeListener("complete",c),t.removeListener("abort",g),t.removeListener("request",p),t.req&&t.req.removeListener("finish",c),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",c),t.removeListener("end",d),t.removeListener("error",h),t.removeListener("close",g)}}},6233:e=>{e.exports=function(){throw new Error("Readable.from is not available in the browser")}},7295:(e,t,r)=>{"use strict";var n,i=r(3690).q,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function l(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(8800)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var l=!1;return function(t){if(!s&&!l)return l=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function u(e){e()}function c(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=function(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return l(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(u),a||(o.forEach(u),i(n))}))}));return t.reduce(c)}},7269:(e,t,r)=>{"use strict";var n=r(3690).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},9299:(e,t,r)=>{e.exports=r(1159).EventEmitter},7503:(e,t,r)=>{"use strict";var n=r(8387).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=u,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=c,this.end=f,t=3;break;default:return this.write=d,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function c(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function h(e){return e&&e.length?this.write(e):""}t.s=a,a.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=o(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=o(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},1067:function(e,t,r){var n;!function(i,a){"use strict";var o="function",s="undefined",l="object",u="string",c="model",f="name",d="type",h="vendor",g="version",p="architecture",m="console",v="mobile",y="tablet",E="smarttv",T="wearable",_="embedded",S="Amazon",A="Apple",b="ASUS",R="BlackBerry",I="Browser",w="Chrome",D="Firefox",C="Google",N="Huawei",L="LG",O="Microsoft",P="Motorola",M="Opera",k="Samsung",x="Sony",F="Xiaomi",U="Zebra",B="Facebook",Z=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},G=function(e,t){return typeof e===u&&-1!==K(t).indexOf(K(e))},K=function(e){return e.toLowerCase()},H=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255)},Y=function(e,t){for(var r,n,i,s,u,c,f=0;f<t.length&&!u;){var d=t[f],h=t[f+1];for(r=n=0;r<d.length&&!u;)if(u=d[r++].exec(e))for(i=0;i<h.length;i++)c=u[++n],typeof(s=h[i])===l&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,c):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=c?c.replace(s[1],s[2]):a:this[s[0]]=c?s[1].call(this,c,s[2]):a:4===s.length&&(this[s[0]]=c?s[3].call(this,c.replace(s[1],s[2])):a):this[s]=c||a;f+=2}},V=function(e,t){for(var r in t)if(typeof t[r]===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(G(t[r][n],e))return"?"===r?a:r}else if(G(t[r],e))return"?"===r?a:r;return e},q={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},j={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,g],[/opios[\/ ]+([\w\.]+)/i],[g,[f,M+" Mini"]],[/\bopr\/([\w\.]+)/i],[g,[f,M]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[f,g],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[f,"UC"+I]],[/\bqbcore\/([\w\.]+)/i],[g,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[g,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[f,"IE"]],[/yabrowser\/([\w\.]+)/i],[g,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+I],g],[/\bfocus\/([\w\.]+)/i],[g,[f,D+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[f,M+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[f,M+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[f,"MIUI "+I]],[/fxios\/([-\w\.]+)/i],[g,[f,D]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+I]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+I],g],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,g],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,B],g],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[f,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[f,w+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,w+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[f,"Android "+I]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,g],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[g,[f,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[g,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[g,V,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[f,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[f,D+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,g]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,K]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",K]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,K]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[h,k],[d,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[h,k],[d,v]],[/\((ip(?:hone|od)[\w ]*);/i],[c,[h,A],[d,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[h,A],[d,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[h,N],[d,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[c,[h,N],[d,v]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[h,F],[d,v]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[h,F],[d,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[h,"OPPO"],[d,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[h,"Vivo"],[d,v]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[c,[h,"Realme"],[d,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[h,P],[d,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[h,P],[d,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[h,L],[d,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[h,L],[d,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[h,"Lenovo"],[d,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[h,"Nokia"],[d,v]],[/(pixel c)\b/i],[c,[h,C],[d,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[h,C],[d,v]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[h,x],[d,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[h,x],[d,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[h,"OnePlus"],[d,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[h,S],[d,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[h,S],[d,v]],[/(playbook);[-\w\),; ]+(rim)/i],[c,h,[d,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[h,R],[d,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[h,b],[d,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[h,b],[d,v]],[/(nexus 9)/i],[c,[h,"HTC"],[d,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[h,[c,/_/g," "],[d,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[h,"Acer"],[d,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[h,"Meizu"],[d,v]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[h,"Sharp"],[d,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,c,[d,v]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,c,[d,y]],[/(surface duo)/i],[c,[h,O],[d,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[h,"Fairphone"],[d,v]],[/(u304aa)/i],[c,[h,"AT&T"],[d,v]],[/\bsie-(\w*)/i],[c,[h,"Siemens"],[d,v]],[/\b(rct\w+) b/i],[c,[h,"RCA"],[d,y]],[/\b(venue[\d ]{2,7}) b/i],[c,[h,"Dell"],[d,y]],[/\b(q(?:mv|ta)\w+) b/i],[c,[h,"Verizon"],[d,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[h,"Barnes & Noble"],[d,y]],[/\b(tm\d{3}\w+) b/i],[c,[h,"NuVision"],[d,y]],[/\b(k88) b/i],[c,[h,"ZTE"],[d,y]],[/\b(nx\d{3}j) b/i],[c,[h,"ZTE"],[d,v]],[/\b(gen\d{3}) b.+49h/i],[c,[h,"Swiss"],[d,v]],[/\b(zur\d{3}) b/i],[c,[h,"Swiss"],[d,y]],[/\b((zeki)?tb.*\b) b/i],[c,[h,"Zeki"],[d,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],c,[d,y]],[/\b(ns-?\w{0,9}) b/i],[c,[h,"Insignia"],[d,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[h,"NextBook"],[d,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],c,[d,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],c,[d,v]],[/\b(ph-1) /i],[c,[h,"Essential"],[d,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[h,"Envizen"],[d,y]],[/\b(trio[-\w\. ]+) b/i],[c,[h,"MachSpeed"],[d,y]],[/\btu_(1491) b/i],[c,[h,"Rotor"],[d,y]],[/(shield[\w ]+) b/i],[c,[h,"Nvidia"],[d,y]],[/(sprint) (\w+)/i],[h,c,[d,v]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[h,O],[d,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[h,U],[d,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[h,U],[d,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,c,[d,m]],[/droid.+; (shield) bui/i],[c,[h,"Nvidia"],[d,m]],[/(playstation [345portablevi]+)/i],[c,[h,x],[d,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[h,O],[d,m]],[/smart-tv.+(samsung)/i],[h,[d,E]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[h,k],[d,E]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,L],[d,E]],[/(apple) ?tv/i],[h,[c,A+" TV"],[d,E]],[/crkey/i],[[c,w+"cast"],[h,C],[d,E]],[/droid.+aft(\w)( bui|\))/i],[c,[h,S],[d,E]],[/\(dtv[\);].+(aquos)/i],[c,[h,"Sharp"],[d,E]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[h,H],[c,H],[d,E]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[d,E]],[/((pebble))app/i],[h,c,[d,T]],[/droid.+; (glass) \d/i],[c,[h,C],[d,T]],[/droid.+; (wt63?0{2,3})\)/i],[c,[h,U],[d,T]],[/(quest( 2)?)/i],[c,[h,B],[d,T]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[d,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[c,[d,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[d,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[d,y]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[d,v]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[f,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[f,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,g],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[g,V,q]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[g,V,q]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,"Mac OS"],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[g,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,g],[/\(bb(10);/i],[g,[f,R]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[f,D+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[f,"webOS"]],[/crkey\/([\d\.]+)/i],[g,[f,w+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[f,"Chromium OS"],g],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,g],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[f,g]]},z=function(e,t){if(typeof e===l&&(t=e,e=a),!(this instanceof z))return new z(e,t).getResult();var r=e||(typeof i!==s&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),n=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(j,t):j;return this.getBrowser=function(){var e,t={};return t[f]=a,t[g]=a,Y.call(t,r,n.browser),t.major=typeof(e=t.version)===u?e.replace(/[^\d\.]/g,"").split(".")[0]:a,t},this.getCPU=function(){var e={};return e[p]=a,Y.call(e,r,n.cpu),e},this.getDevice=function(){var e={};return e[h]=a,e[c]=a,e[d]=a,Y.call(e,r,n.device),e},this.getEngine=function(){var e={};return e[f]=a,e[g]=a,Y.call(e,r,n.engine),e},this.getOS=function(){var e={};return e[f]=a,e[g]=a,Y.call(e,r,n.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===u&&e.length>255?H(e,255):e,this},this.setUA(r),this};z.VERSION="1.0.2",z.BROWSER=Z([f,g,"major"]),z.CPU=Z([p]),z.DEVICE=Z([c,h,d,m,v,E,y,T,_]),z.ENGINE=z.OS=Z([f,g]),typeof t!==s?(e.exports&&(t=e.exports=z),t.UAParser=z):r.amdO?(n=function(){return z}.call(t,r,t,e))===a||(e.exports=n):typeof i!==s&&(i.UAParser=z);var W=typeof i!==s&&(i.jQuery||i.Zepto);if(W&&!W.ua){var X=new z;W.ua=X.getResult(),W.ua.get=function(){return X.getUA()},W.ua.set=function(e){X.setUA(e);var t=X.getResult();for(var r in t)W.ua[r]=t[r]}}}("object"==typeof window?window:this)},7839:(e,t,r)=>{function n(e){try{if(!r.g.localStorage)return!1}catch(e){return!1}var t=r.g.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}},9862:()=>{},964:()=>{},3165:e=>{"use strict";e.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},5813:e=>{"use strict";e.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},9460:e=>{"use strict";e.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},7778:e=>{"use strict";e.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},8589:e=>{"use strict";e.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},858:e=>{"use strict";e.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.amdO={},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};return(()=>{"use strict";r.d(n,{default:()=>c}),r(8416);var e,t=r(1715),i=r(8080),a=r(1737),o=r(7688),s=function(){var e,t="application/dash+xml";function r(r,n,i){if(!r||!/^VIDEO$/i.test(r.nodeName))return null;if(r._dashjs_player)return r._dashjs_player;var a,s=r.id||r.name||"video element";if(!(n=n||[].slice.call(r.querySelectorAll("source")).filter((function(e){return e.type==t}))[0])&&r.src)(n=document.createElement("source")).src=r.src;else if(!n&&!r.src)return null;return i=i||{},(a=(0,o.Z)(i).create()).initialize(r,n.src,r.autoplay),e||(e=a.getDebug().getLogger()),e.debug("Converted "+s+" to dash.js player and added content: "+n.src),r._dashjs_player=a,a}function n(e){return/^VIDEO$/i.test(e.nodeName)?e:n(e.parentNode)}return{create:r,createAll:function(e,i){var a=[];e=e||"[data-dashjs-player]";for(var o=(i=i||document).querySelectorAll(e),s=0;s<o.length;s++){var l=r(o[s],null);a.push(l)}for(var u=i.querySelectorAll('source[type="'+t+'"]'),c=0;c<u.length;c++){var f=r(n(u[c]),null);a.push(f)}return a}}}();!("undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate)&&"undefined"!=typeof window&&window&&window.addEventListener&&("complete"===window.document.readyState?window.dashjs?s.createAll():e=window.setInterval((function(){window.dashjs&&(window.clearInterval(e),s.createAll())}),500):window.addEventListener("load",(function e(){window.removeEventListener("load",e),s.createAll()})));const l=s;var u=r(6398);dashjs.Protection=a.default,dashjs.MetricsReporting=i.default,dashjs.MediaPlayerFactory=l,dashjs.Debug=u.Z,dashjs.supportsMediaSource=t.B;const c=dashjs})(),n.default})(),e.exports=t()},631:e=>{!function t(r){e.exports=function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function a(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,r){return d=f()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&c(i,r.prototype),i},d.apply(null,arguments)}function h(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function g(e){var t="function"==typeof Map?new Map:void 0;return g=function(e){if(null===e||!h(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,u(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),c(r,e)},g(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){if(e){if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=m(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function T(e){var t=E(e,"string");return"symbol"==typeof t?t:String(t)}function _(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var S={exports:{}};!function(e,t){var r,n,i,a,o;r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,n=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var i=o.parseURL(e);if(!i)throw new Error("Error trying to parse base URL.");return i.path=o.normalizePath(i.path),o.buildURLFromParts(i)}var a=o.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=o.normalizePath(a.path),o.buildURLFromParts(a)):t;var s=o.parseURL(e);if(!s)throw new Error("Error trying to parse base URL.");if(!s.netLoc&&s.path&&"/"!==s.path[0]){var l=n.exec(s.path);s.netLoc=l[1],s.path=l[2]}s.netLoc&&!s.path&&(s.path="/");var u={scheme:s.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=s.netLoc,"/"!==a.path[0]))if(a.path){var c=s.path,f=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=o.normalizePath(f)}else u.path=s.path,a.params||(u.params=s.params,a.query||(u.query=s.query));return null===u.path&&(u.path=r.alwaysNormalize?o.normalizePath(a.path):a.path),o.buildURLFromParts(u)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=o}(S);var A=S.exports,b=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},R=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e}({}),I=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),w=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.UNKNOWN="unknown",e}({}),D=function(){},C={trace:D,debug:D,log:D,warn:D,info:D,error:D},N=C;function L(e){var t=self.console[e];return t?t.bind(self.console,"["+e+"] >"):D}function O(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(t){N[t]=e[t]?e[t].bind(e):L(t)}))}function P(e,t){if(self.console&&!0===e||"object"==typeof e){O(e,"debug","log","info","warn","error");try{N.log('Debug logs enabled for "'+t+'" in hls.js version 1.4.10')}catch(e){N=C}}else N=C}var M=N,k=/^(\d+)x(\d+)$/,x=/(.+?)=(".*?"|.*?)(?:,|$)/g,F=function(){function e(t){for(var r in"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&("X-"===r.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(r)),this[r]=t[r])}var t=e.prototype;return t.decimalInteger=function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null},t.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t},t.decimalFloatingPoint=function(e){return parseFloat(this[e])},t.optionalFloat=function(e,t){var r=this[e];return r?parseFloat(r):t},t.enumeratedString=function(e){return this[e]},t.bool=function(e){return"YES"===this[e]},t.decimalResolution=function(e){var t=k.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,r={},n='"';for(x.lastIndex=0;null!==(t=x.exec(e));){var i=t[2];0===i.indexOf(n)&&i.lastIndexOf(n)===i.length-1&&(i=i.slice(1,-1)),r[t[1].trim()]=i}return r},e}();function U(e){return"ID"!==e&&"CLASS"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function B(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e}var Z=function(){function e(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){var r=t.attr;for(var n in r)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==r[n]){M.warn('DATERANGE tag attribute: "'+n+'" does not match for tags with ID: "'+e.ID+'"'),this._badValueForSameId=n;break}e=s(new F({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){var i=new Date(this.attr["END-DATE"]);b(i.getTime())&&(this._endDate=i)}}return a(e,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(b(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&b(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),e}(),G=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}},K={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"},H=function(){function e(e){var t;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((t={})[K.AUDIO]=null,t[K.VIDEO]=null,t[K.AUDIOVIDEO]=null,t),this.baseurl=e}return e.prototype.setByteRange=function(e,t){var r=e.split("@",2),n=[];1===r.length?n[0]=t?t.byteRangeEndOffset:0:n[0]=parseInt(r[1]),n[1]=parseInt(r[0])+n[0],this._byteRange=n},a(e,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=A.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}(),Y=function(e){function t(t,r){var n;return(n=e.call(this,r)||this)._decryptdata=null,n.rawProgramDateTime=null,n.programDateTime=null,n.tagList=[],n.duration=0,n.sn=0,n.levelkeys=void 0,n.type=void 0,n.loader=null,n.keyLoader=null,n.level=-1,n.cc=0,n.startPTS=void 0,n.endPTS=void 0,n.startDTS=void 0,n.endDTS=void 0,n.start=0,n.deltaPTS=void 0,n.maxStartPTS=void 0,n.minEndPTS=void 0,n.stats=new G,n.urlId=0,n.data=void 0,n.bitrateTest=!1,n.title=null,n.initSegment=null,n.endList=void 0,n.gap=void 0,n.type=t,n}l(t,e);var r=t.prototype;return r.setKeyFormat=function(e){if(this.levelkeys){var t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}},r.abortRequests=function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()},r.setElementaryStreamInfo=function(e,t,r,n,i,a){void 0===a&&(a=!1);var o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,r),s.startDTS=Math.min(s.startDTS,n),s.endDTS=Math.max(s.endDTS,i)):o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:i,partial:a}},r.clearElementaryStreamInfo=function(){var e=this.elementaryStreams;e[K.AUDIO]=null,e[K.VIDEO]=null,e[K.AUDIOVIDEO]=null},a(t,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{var t=Object.keys(this.levelkeys);if(1===t.length)return this._decryptdata=this.levelkeys[t[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!b(this.programDateTime))return null;var e=b(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t=Object.keys(this.levelkeys),r=t.length;if(r>1||1===r&&this.levelkeys[t[0]].encrypted)return!0}return!1}}]),t}(H),V=function(e){function t(t,r,n,i,a){var o;(o=e.call(this,n)||this).fragOffset=0,o.duration=0,o.gap=!1,o.independent=!1,o.relurl=void 0,o.fragment=void 0,o.index=void 0,o.stats=new G,o.duration=t.decimalFloatingPoint("DURATION"),o.gap=t.bool("GAP"),o.independent=t.bool("INDEPENDENT"),o.relurl=t.enumeratedString("URI"),o.fragment=r,o.index=i;var s=t.enumeratedString("BYTERANGE");return s&&o.setByteRange(s,a),a&&(o.fragOffset=a.fragOffset+a.duration),o}return l(t,e),a(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(H),q=10,j=function(){function e(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}return e.prototype.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay},a(e,[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&b(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||q}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),e}();function z(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function W(e){var t=J(e).subarray(0,16),r=new Uint8Array(16);return r.set(t,16-t.length),r}function X(e){var t=function(e,t,r){var n=e[t];e[t]=e[r],e[r]=n};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function Q(e){var t=e.split(":"),r=null;if("data"===t[0]&&2===t.length){var n=t[1].split(";"),i=n[n.length-1].split(",");if(2===i.length){var a="base64"===i[0],o=i[1];a?(n.splice(-1,1),r=z(o)):r=W(o)}}return r}function J(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}var $={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ee={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function te(e){switch(e){case ee.FAIRPLAY:return $.FAIRPLAY;case ee.PLAYREADY:return $.PLAYREADY;case ee.WIDEVINE:return $.WIDEVINE;case ee.CLEARKEY:return $.CLEARKEY}}var re={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function ne(e){if(e===re.WIDEVINE)return $.WIDEVINE}function ie(e){switch(e){case $.FAIRPLAY:return ee.FAIRPLAY;case $.PLAYREADY:return ee.PLAYREADY;case $.WIDEVINE:return ee.WIDEVINE;case $.CLEARKEY:return ee.CLEARKEY}}function ae(e){var t=e.drmSystems,r=e.widevineLicenseUrl,n=t?[$.FAIRPLAY,$.WIDEVINE,$.PLAYREADY,$.CLEARKEY].filter((function(e){return!!t[e]})):[];return!n[$.WIDEVINE]&&r&&n.push($.WIDEVINE),n}var oe="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function se(e,t,r,n){var i;switch(e){case $.FAIRPLAY:i=["cenc","sinf"];break;case $.WIDEVINE:case $.PLAYREADY:i=["cenc"];break;case $.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+e)}return le(i,t,r,n)}function le(e,t,r,n){return[{initDataTypes:e,persistentState:n.persistentState||"not-allowed",distinctiveIdentifier:n.distinctiveIdentifier||"not-allowed",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:'audio/mp4; codecs="'+e+'"',robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return{contentType:'video/mp4; codecs="'+e+'"',robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}}))}]}function ue(e,t,r){return Uint8Array.prototype.slice?e.slice(t,r):new Uint8Array(Array.prototype.slice.call(e,t,r))}var ce,fe=function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},de=function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128},he=function(e,t){for(var r=t,n=0;fe(e,t);)n+=10,n+=ge(e,t+6),de(e,t+10)&&(n+=10),t+=n;if(n>0)return e.subarray(r,r+n)},ge=function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]},pe=function(e,t){return fe(e,t)&&ge(e,t+6)+10<=e.length-t},me=function(e){for(var t=Ee(e),r=0;r<t.length;r++){var n=t[r];if(ve(n))return be(n)}},ve=function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info},ye=function(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=ge(e,4),n=10;return{type:t,size:r,data:e.subarray(n,n+r)}},Ee=function(e){for(var t=0,r=[];fe(e,t);){for(var n=ge(e,t+6),i=(t+=10)+n;t+8<i;){var a=ye(e.subarray(t)),o=Te(a);o&&r.push(o),t+=a.size+10}de(e,t)&&(t+=10)}return r},Te=function(e){return"PRIV"===e.type?_e(e):"W"===e.type[0]?Ae(e):Se(e)},_e=function(e){if(!(e.size<2)){var t=Re(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}},Se=function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=Re(e.data.subarray(t),!0);t+=r.length+1;var n=Re(e.data.subarray(t));return{key:e.type,info:r,data:n}}var i=Re(e.data.subarray(1));return{key:e.type,data:i}}},Ae=function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=Re(e.data.subarray(t),!0);t+=r.length+1;var n=Re(e.data.subarray(t));return{key:e.type,info:r,data:n}}var i=Re(e.data);return{key:e.type,data:i}},be=function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}},Re=function(e,t){void 0===t&&(t=!1);var r=Ie();if(r){var n=r.decode(e);if(t){var i=n.indexOf("\0");return-1!==i?n.substring(0,i):n}return n.replace(/\0/g,"")}for(var a,o,s,l=e.length,u="",c=0;c<l;){if(0===(a=e[c++])&&t)return u;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:u+=String.fromCharCode(a);break;case 12:case 13:o=e[c++],u+=String.fromCharCode((31&a)<<6|63&o);break;case 14:o=e[c++],s=e[c++],u+=String.fromCharCode((15&a)<<12|(63&o)<<6|(63&s)<<0)}}return u};function Ie(){return ce||void 0===self.TextDecoder||(ce=new self.TextDecoder("utf-8")),ce}var we={hexDump:function(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t}},De=Math.pow(2,32)-1,Ce=[].push,Ne={video:1,audio:2,id3:3,text:4};function Le(e){return String.fromCharCode.apply(null,e)}function Oe(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function Pe(e,t){var r=Me(e,t);return r<0?4294967296+r:r}function Me(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ke(e,t,r){e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function xe(e,t){var r=[];if(!t.length)return r;for(var n=e.byteLength,i=0;i<n;){var a=Pe(e,i),o=a>1?i+a:n;if(Le(e.subarray(i+4,i+8))===t[0])if(1===t.length)r.push(e.subarray(i+8,o));else{var s=xe(e.subarray(i+8,o),t.slice(1));s.length&&Ce.apply(r,s)}i=o}return r}function Fe(e){var t=[],r=e[0],n=8,i=Pe(e,n);n+=4;var a=0,o=0;n+=0===r?8:16,n+=2;var s=e.length+o,l=Oe(e,n);n+=2;for(var u=0;u<l;u++){var c=n,f=Pe(e,c);c+=4;var d=2147483647&f;if(1==(2147483648&f)>>>31)return M.warn("SIDX has hierarchical references (not supported)"),null;var h=Pe(e,c);c+=4,t.push({referenceSize:d,subsegmentDuration:h,info:{duration:h/i,start:s,end:s+d-1}}),s+=d,n=c+=4}return{earliestPresentationTime:a,timescale:i,version:r,referencesCount:l,references:t}}function Ue(e){for(var t=[],r=xe(e,["moov","trak"]),n=0;n<r.length;n++){var i=r[n],a=xe(i,["tkhd"])[0];if(a){var o=a[0],s=0===o?12:20,l=Pe(a,s),u=xe(i,["mdia","mdhd"])[0];if(u){var c=Pe(u,s=0===(o=u[0])?12:20),f=xe(i,["mdia","hdlr"])[0];if(f){var d=Le(f.subarray(8,12)),h={soun:K.AUDIO,vide:K.VIDEO}[d];if(h){var g=xe(i,["mdia","minf","stbl","stsd"])[0],p=void 0;g&&(p=Le(g.subarray(12,16))),t[l]={timescale:c,type:h},t[h]={timescale:c,id:l,codec:p}}}}}}return xe(e,["moov","mvex","trex"]).forEach((function(e){var r=Pe(e,4),n=t[r];n&&(n.default={duration:Pe(e,12),flags:Pe(e,20)})})),t}function Be(e,t){if(!e||!t)return e;var r=t.keyId;return r&&t.isCommonEncryption&&xe(e,["moov","trak"]).forEach((function(e){var t=xe(e,["mdia","minf","stbl","stsd"])[0].subarray(8),n=xe(t,["enca"]),i=n.length>0;i||(n=xe(t,["encv"])),n.forEach((function(e){xe(i?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var t=Ze(e);if(t){var n=t.subarray(8,24);n.some((function(e){return 0!==e}))||(M.log("[eme] Patching keyId in 'enc"+(i?"a":"v")+">sinf>>tenc' box: "+we.hexDump(n)+" -> "+we.hexDump(r)),t.set(r,8))}}))}))})),e}function Ze(e){var t=xe(e,["schm"])[0];if(t){var r=Le(t.subarray(4,8));if("cbcs"===r||"cenc"===r)return xe(e,["schi","tenc"])[0]}return M.error("[eme] missing 'schm' box"),null}function Ge(e,t){return xe(t,["moof","traf"]).reduce((function(t,r){var n=xe(r,["tfdt"])[0],i=n[0],a=xe(r,["tfhd"]).reduce((function(t,r){var a=Pe(r,4),o=e[a];if(o){var s=Pe(n,4);if(1===i){if(s===De)return M.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),t;s*=De+1,s+=Pe(n,8)}var l=s/(o.timescale||9e4);if(isFinite(l)&&(null===t||l<t))return l}return t}),null);return null!==a&&isFinite(a)&&(null===t||a<t)?a:t}),null)}function Ke(e,t){for(var r=0,n=0,i=0,a=xe(e,["moof","traf"]),o=0;o<a.length;o++){var s=a[o],l=xe(s,["tfhd"])[0],u=t[Pe(l,4)];if(u){var c=u.default,f=Pe(l,0)|(null==c?void 0:c.flags),d=null==c?void 0:c.duration;8&f&&(d=Pe(l,2&f?12:8));for(var h=u.timescale||9e4,g=xe(s,["trun"]),p=0;p<g.length;p++)!(r=He(g[p]))&&d&&(r=d*Pe(g[p],4)),u.type===K.VIDEO?n+=r/h:u.type===K.AUDIO&&(i+=r/h)}}if(0===n&&0===i){for(var m=0,v=xe(e,["sidx"]),y=0;y<v.length;y++){var E=Fe(v[y]);null!=E&&E.references&&(m+=E.references.reduce((function(e,t){return e+t.info.duration||0}),0))}return m}return n||i}function He(e){var t=Pe(e,0),r=8;1&t&&(r+=4),4&t&&(r+=4);for(var n=0,i=Pe(e,4),a=0;a<i;a++)256&t&&(n+=Pe(e,r),r+=4),512&t&&(r+=4),1024&t&&(r+=4),2048&t&&(r+=4);return n}function Ye(e,t,r){xe(t,["moof","traf"]).forEach((function(t){xe(t,["tfhd"]).forEach((function(n){var i=Pe(n,4),a=e[i];if(a){var o=a.timescale||9e4;xe(t,["tfdt"]).forEach((function(e){var t=e[0],n=Pe(e,4);if(0===t)n-=r*o,ke(e,4,n=Math.max(n,0));else{n*=Math.pow(2,32),n+=Pe(e,8),n-=r*o,n=Math.max(n,0);var i=Math.floor(n/(De+1)),a=Math.floor(n%(De+1));ke(e,4,i),ke(e,8,a)}}))}}))}))}function Ve(e){var t={valid:null,remainder:null},r=xe(e,["moof"]);if(!r)return t;if(r.length<2)return t.remainder=e,t;var n=r[r.length-1];return t.valid=ue(e,0,n.byteOffset-8),t.remainder=ue(e,n.byteOffset-8),t}function qe(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function je(e,t){var r=[],n=t.samples,i=t.timescale,a=t.id,o=!1;return xe(n,["moof"]).map((function(s){var l=s.byteOffset-8;xe(s,["traf"]).map((function(s){var u=xe(s,["tfdt"]).map((function(e){var t=e[0],r=Pe(e,4);return 1===t&&(r*=Math.pow(2,32),r+=Pe(e,8)),r/i}))[0];return void 0!==u&&(e=u),xe(s,["tfhd"]).map((function(u){var c=Pe(u,4),f=16777215&Pe(u,0),d=0,h=0!=(16&f),g=0,p=0!=(32&f),m=8;c===a&&(0!=(1&f)&&(m+=8),0!=(2&f)&&(m+=4),0!=(8&f)&&(d=Pe(u,m),m+=4),h&&(g=Pe(u,m),m+=4),p&&(m+=4),"video"===t.type&&(o=ze(t.codec)),xe(s,["trun"]).map((function(a){var s=a[0],u=16777215&Pe(a,0),c=0!=(1&u),f=0,h=0!=(4&u),p=0!=(256&u),m=0,v=0!=(512&u),y=0,E=0!=(1024&u),T=0!=(2048&u),_=0,S=Pe(a,4),A=8;c&&(f=Pe(a,A),A+=4),h&&(A+=4);for(var b=f+l,R=0;R<S;R++){if(p?(m=Pe(a,A),A+=4):m=d,v?(y=Pe(a,A),A+=4):y=g,E&&(A+=4),T&&(_=0===s?Pe(a,A):Me(a,A),A+=4),t.type===K.VIDEO)for(var I=0;I<y;){var w=Pe(n,b);We(o,n[b+=4])&&Xe(n.subarray(b,b+w),o?2:1,e+_/i,r),b+=w,I+=w+4}e+=m/i}})))}))}))})),r}function ze(e){if(!e)return!1;var t=e.indexOf("."),r=t<0?e:e.substring(0,t);return"hvc1"===r||"hev1"===r||"dvh1"===r||"dvhe"===r}function We(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6==(31&t)}function Xe(e,t,r,n){var i=Qe(e),a=0;a+=t;for(var o=0,s=0,l=!1,u=0;a<i.length;){o=0;do{if(a>=i.length)break;o+=u=i[a++]}while(255===u);s=0;do{if(a>=i.length)break;s+=u=i[a++]}while(255===u);var c=i.length-a;if(!l&&4===o&&a<i.length){if(l=!0,181===i[a++]){var f=Oe(i,a);if(a+=2,49===f){var d=Pe(i,a);if(a+=4,1195456820===d){var h=i[a++];if(3===h){var g=i[a++],p=64&g,m=p?2+3*(31&g):0,v=new Uint8Array(m);if(p){v[0]=g;for(var y=1;y<m;y++)v[y]=i[a++]}n.push({type:h,payloadType:o,pts:r,bytes:v})}}}}}else if(5===o&&s<c){if(l=!0,s>16){for(var E=[],T=0;T<16;T++){var _=i[a++].toString(16);E.push(1==_.length?"0"+_:_),3!==T&&5!==T&&7!==T&&9!==T||E.push("-")}for(var S=s-16,A=new Uint8Array(S),b=0;b<S;b++)A[b]=i[a++];n.push({payloadType:o,pts:r,uuid:E.join(""),userData:Re(A),userDataBytes:A})}}else if(s<c)a+=s;else if(s>c)break}}function Qe(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;var i=t-r.length,a=new Uint8Array(i),o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),a[n]=e[o];return a}function Je(e){var t=e[0],r="",n="",i=0,a=0,o=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==Le(e.subarray(u,u+1));)r+=Le(e.subarray(u,u+1)),u+=1;for(r+=Le(e.subarray(u,u+1)),u+=1;"\0"!==Le(e.subarray(u,u+1));)n+=Le(e.subarray(u,u+1)),u+=1;n+=Le(e.subarray(u,u+1)),u+=1,i=Pe(e,12),a=Pe(e,16),s=Pe(e,20),l=Pe(e,24),u=28}else if(1===t){i=Pe(e,u+=4);var c=Pe(e,u+=4),f=Pe(e,u+=4);for(u+=4,o=Math.pow(2,32)*c+f,Number.isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,M.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=Pe(e,u),l=Pe(e,u+=4),u+=4;"\0"!==Le(e.subarray(u,u+1));)r+=Le(e.subarray(u,u+1)),u+=1;for(r+=Le(e.subarray(u,u+1)),u+=1;"\0"!==Le(e.subarray(u,u+1));)n+=Le(e.subarray(u,u+1)),u+=1;n+=Le(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:a,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}function $e(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=r.length,a=8,o=i;o--;)a+=r[o].byteLength;var s=new Uint8Array(a);for(s[0]=a>>24&255,s[1]=a>>16&255,s[2]=a>>8&255,s[3]=255&a,s.set(e,4),o=0,a=8;o<i;o++)s.set(r[o],a),a+=r[o].byteLength;return s}function et(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var n,i,a;if(t){n=1,i=new Uint8Array(16*t.length);for(var o=0;o<t.length;o++){var s=t[o];if(16!==s.byteLength)throw new RangeError("Invalid key");i.set(s,16*o)}}else n=0,i=new Uint8Array;n>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;var l=new Uint8Array(4);return r&&r.byteLength>0&&new DataView(l.buffer).setUint32(0,r.byteLength,!1),$e([112,115,115,104],new Uint8Array([n,0,0,0]),e,a,i,l,r||new Uint8Array)}function tt(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;var t={version:0,systemId:"",kids:null,data:null},r=new DataView(e),n=r.getUint32(0);if(e.byteLength!==n&&n>44)return null;if(1886614376!==r.getUint32(4))return null;if(t.version=r.getUint32(8)>>>24,t.version>1)return null;t.systemId=we.hexDump(new Uint8Array(e,12,16));var i=r.getUint32(28);if(0===t.version){if(n-32<i)return null;t.data=new Uint8Array(e,32,i)}else if(1===t.version){t.kids=[];for(var a=0;a<i;a++)t.kids.push(new Uint8Array(e,32+16*a,16))}return t}var rt={},nt=function(){function e(e,t,r,n,i){void 0===n&&(n=[1]),void 0===i&&(i=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=n,this.iv=i,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}e.clearKeyUriToKeyIdMap=function(){rt={}};var t=e.prototype;return t.isSupported=function(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case ee.FAIRPLAY:case ee.WIDEVINE:case ee.PLAYREADY:case ee.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1},t.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof t&&("AES-128"!==this.method||this.iv||M.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var r=it(t);return new e(this.method,this.uri,"identity",this.keyFormatVersions,r)}var n=Q(this.uri);if(n)switch(this.keyFormat){case ee.WIDEVINE:this.pssh=n,n.length>=22&&(this.keyId=n.subarray(n.length-22,n.length-6));break;case ee.PLAYREADY:var i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=et(i,null,n);var a=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),o=String.fromCharCode.apply(null,Array.from(a)),s=o.substring(o.indexOf("<"),o.length),l=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(l){var u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){var c=z(u).subarray(0,16);X(c),this.keyId=c}}break;default:var f=n.subarray(0,16);if(16!==f.length){var d=new Uint8Array(16);d.set(f,16-f.length),f=d}this.keyId=f}if(!this.keyId||16!==this.keyId.byteLength){var h=rt[this.uri];if(!h){var g=Object.keys(rt).length%Number.MAX_SAFE_INTEGER;h=new Uint8Array(16),new DataView(h.buffer,12,4).setUint32(0,g),rt[this.uri]=h}this.keyId=h}return this},e}();function it(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}var at=/\{\$([a-zA-Z0-9-_]+)\}/g;function ot(e){return at.test(e)}function st(e,t,r){if(null!==e.variableList||e.hasVariableRefs)for(var n=r.length;n--;){var i=r[n],a=t[i];a&&(t[i]=lt(e,a))}}function lt(e,t){if(null!==e.variableList||e.hasVariableRefs){var r=e.variableList;return t.replace(at,(function(t){var n=t.substring(2,t.length-1),i=null==r?void 0:r[n];return void 0===i?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'+n+'"')),t):i}))}return t}function ut(e,t,r){var n,i,a=e.variableList;if(a||(e.variableList=a={}),"QUERYPARAM"in t){n=t.QUERYPARAM;try{var o=new self.URL(r).searchParams;if(!o.has(n))throw new Error('"'+n+'" does not match any query parameter in URI: "'+r+'"');i=o.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: "+t.message))}}else n=t.NAME,i=t.VALUE;n in a?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'+n+'"')):a[n]=i||""}function ct(e,t,r){var n=t.IMPORT;if(r&&n in r){var i=e.variableList;i||(e.variableList=i={}),i[n]=r[n]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'+n+'"'))}function ft(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}var dt={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},ht=ft();function gt(e,t){var r=dt[t];return!!r&&!0===r[e.slice(0,4)]}function pt(e,t){var r;return null!=(r=null==ht?void 0:ht.isTypeSupported((t||"video")+'/mp4;codecs="'+e+'"'))&&r}var mt=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,vt=/#EXT-X-MEDIA:(.*)/g,yt=/^#EXT(?:INF|-X-TARGETDURATION):/m,Et=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Tt=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),_t=function(){function e(){}return e.findGroup=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}},e.convertAVC1ToAVCOTI=function(e){var t=e.split(".");if(t.length>2){var r=t.shift()+".";return r+=parseInt(t.shift()).toString(16),r+=("000"+parseInt(t.shift()).toString(16)).slice(-4)}return e},e.resolve=function(e,t){return A.buildAbsoluteURL(t,e,{alwaysNormalize:!0})},e.isMediaPlaylist=function(e){return yt.test(e)},e.parseMasterPlaylist=function(t,r){var n,i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:ot(t)},a=[];for(mt.lastIndex=0;null!=(n=mt.exec(t));)if(n[1]){var o,s=new F(n[1]);st(i,s,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);var l=lt(i,n[2]),u={attrs:s,bitrate:s.decimalInteger("AVERAGE-BANDWIDTH")||s.decimalInteger("BANDWIDTH"),name:s.NAME,url:e.resolve(l,r)},c=s.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),bt((s.CODECS||"").split(/[ ,]+/).filter((function(e){return e})),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=e.convertAVC1ToAVCOTI(u.videoCodec)),null!=(o=u.unknownCodecs)&&o.length||a.push(u),i.levels.push(u)}else if(n[3]){var f=n[3],d=n[4];switch(f){case"SESSION-DATA":var h=new F(d);st(i,h,["DATA-ID","LANGUAGE","VALUE","URI"]);var g=h["DATA-ID"];g&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[g]=h);break;case"SESSION-KEY":var p=St(d,r,i);p.encrypted&&p.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(p)):M.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+d+'"');break;case"DEFINE":var m=new F(d);st(i,m,["NAME","VALUE","QUERYPARAM"]),ut(i,m,r);break;case"CONTENT-STEERING":var v=new F(d);st(i,v,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:e.resolve(v["SERVER-URI"],r),pathwayId:v["PATHWAY-ID"]||"."};break;case"START":i.startTimeOffset=At(d)}}var y=a.length>0&&a.length<i.levels.length;return i.levels=y?a:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i},e.parseMasterPlaylistMedia=function(t,r,n){var i,a={},o=n.levels,s={AUDIO:o.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:o.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(vt.lastIndex=0;null!==(i=vt.exec(t));){var u=new F(i[1]),c=u.TYPE;if(c){var f=s[c],d=a[c]||[];a[c]=d,st(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);var h={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?e.resolve(u.URI,r):""};if(null!=f&&f.length){var g=e.findGroup(f,h.groupId)||f[0];Rt(h,g,"audioCodec"),Rt(h,g,"textCodec")}d.push(h)}}return a},e.parseLevelPlaylist=function(e,t,r,n,i,a){var o,l,u,c=new j(t),f=c.fragments,d=null,h=0,g=0,p=0,m=0,v=null,y=new Y(n,t),E=-1,T=!1;for(Et.lastIndex=0,c.m3u8=e,c.hasVariableRefs=ot(e);null!==(o=Et.exec(e));){T&&(T=!1,(y=new Y(n,t)).start=p,y.sn=h,y.cc=m,y.level=r,d&&(y.initSegment=d,y.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null));var _=o[1];if(_){y.duration=parseFloat(_);var S=(" "+o[2]).slice(1);y.title=S||null,y.tagList.push(S?["INF",_,S]:["INF",_])}else if(o[3]){if(b(y.duration)){y.start=p,u&&Ct(y,u,c),y.sn=h,y.level=r,y.cc=m,y.urlId=i,f.push(y);var A=(" "+o[3]).slice(1);y.relurl=lt(c,A),wt(y,v),v=y,p+=y.duration,h++,g=0,T=!0}}else if(o[4]){var R=(" "+o[4]).slice(1);v?y.setByteRange(R,v):y.setByteRange(R)}else if(o[5])y.rawProgramDateTime=(" "+o[5]).slice(1),y.tagList.push(["PROGRAM-DATE-TIME",y.rawProgramDateTime]),-1===E&&(E=f.length);else{if(!(o=o[0].match(Tt))){M.warn("No matches on slow regex match for level playlist!");continue}for(l=1;l<o.length&&void 0===o[l];l++);var I=(" "+o[l]).slice(1),w=(" "+o[l+1]).slice(1),D=o[l+2]?(" "+o[l+2]).slice(1):"";switch(I){case"PLAYLIST-TYPE":c.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":h=c.startSN=parseInt(w);break;case"SKIP":var C=new F(w);st(c,C,["RECENTLY-REMOVED-DATERANGES"]);var N=C.decimalInteger("SKIPPED-SEGMENTS");if(b(N)){c.skippedSegments=N;for(var L=N;L--;)f.unshift(null);h+=N}var O=C.enumeratedString("RECENTLY-REMOVED-DATERANGES");O&&(c.recentlyRemovedDateranges=O.split("\t"));break;case"TARGETDURATION":c.targetduration=Math.max(parseInt(w),1);break;case"VERSION":c.version=parseInt(w);break;case"EXTM3U":break;case"ENDLIST":c.live=!1;break;case"#":(w||D)&&y.tagList.push(D?[w,D]:[w]);break;case"DISCONTINUITY":m++,y.tagList.push(["DIS"]);break;case"GAP":y.gap=!0,y.tagList.push([I]);break;case"BITRATE":y.tagList.push([I,w]);break;case"DATERANGE":var P=new F(w);st(c,P,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),st(c,P,P.clientAttrs);var k=new Z(P,c.dateRanges[P.ID]);k.isValid||c.skippedSegments?c.dateRanges[k.id]=k:M.warn('Ignoring invalid DATERANGE tag: "'+w+'"'),y.tagList.push(["EXT-X-DATERANGE",w]);break;case"DEFINE":var x=new F(w);st(c,x,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in x?ct(c,x,a):ut(c,x,t);break;case"DISCONTINUITY-SEQUENCE":m=parseInt(w);break;case"KEY":var U=St(w,t,c);if(U.isSupported()){if("NONE"===U.method){u=void 0;break}u||(u={}),u[U.keyFormat]&&(u=s({},u)),u[U.keyFormat]=U}else M.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+w+'"');break;case"START":c.startTimeOffset=At(w);break;case"MAP":var B=new F(w);if(st(c,B,["BYTERANGE","URI"]),y.duration){var G=new Y(n,t);Dt(G,B,r,u),d=G,y.initSegment=d,d.rawProgramDateTime&&!y.rawProgramDateTime&&(y.rawProgramDateTime=d.rawProgramDateTime)}else Dt(y,B,r,u),d=y,T=!0;break;case"SERVER-CONTROL":var K=new F(w);c.canBlockReload=K.bool("CAN-BLOCK-RELOAD"),c.canSkipUntil=K.optionalFloat("CAN-SKIP-UNTIL",0),c.canSkipDateRanges=c.canSkipUntil>0&&K.bool("CAN-SKIP-DATERANGES"),c.partHoldBack=K.optionalFloat("PART-HOLD-BACK",0),c.holdBack=K.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var H=new F(w);c.partTarget=H.decimalFloatingPoint("PART-TARGET");break;case"PART":var q=c.partList;q||(q=c.partList=[]);var z=g>0?q[q.length-1]:void 0,W=g++,X=new F(w);st(c,X,["BYTERANGE","URI"]);var Q=new V(X,y,t,W,z);q.push(Q),y.duration+=Q.duration;break;case"PRELOAD-HINT":var J=new F(w);st(c,J,["URI"]),c.preloadHint=J;break;case"RENDITION-REPORT":var $=new F(w);st(c,$,["URI"]),c.renditionReports=c.renditionReports||[],c.renditionReports.push($);break;default:M.warn("line parsed but not handled: "+o)}}}v&&!v.relurl?(f.pop(),p-=v.duration,c.partList&&(c.fragmentHint=v)):c.partList&&(wt(y,v),y.cc=m,c.fragmentHint=y,u&&Ct(y,u,c));var ee=f.length,te=f[0],re=f[ee-1];if((p+=c.skippedSegments*c.targetduration)>0&&ee&&re){c.averagetargetduration=p/ee;var ne=re.sn;c.endSN="initSegment"!==ne?ne:0,c.live||(re.endList=!0),te&&(c.startCC=te.cc)}else c.endSN=0,c.startCC=0;return c.fragmentHint&&(p+=c.fragmentHint.duration),c.totalduration=p,c.endCC=m,E>0&&It(f,E),c},e}();function St(e,t,r){var n,i,a=new F(e);st(r,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);var o=null!=(n=a.METHOD)?n:"",s=a.URI,l=a.hexadecimalInteger("IV"),u=a.KEYFORMATVERSIONS,c=null!=(i=a.KEYFORMAT)?i:"identity";s&&a.IV&&!l&&M.error("Invalid IV: "+a.IV);var f=s?_t.resolve(s,t):"",d=(u||"1").split("/").map(Number).filter(Number.isFinite);return new nt(o,f,c,d,l)}function At(e){var t=new F(e).decimalFloatingPoint("TIME-OFFSET");return b(t)?t:null}function bt(e,t){["video","audio","text"].forEach((function(r){var n=e.filter((function(e){return gt(e,r)}));if(n.length){var i=n.filter((function(e){return 0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0)}));t[r+"Codec"]=i.length>0?i[0]:n[0],e=e.filter((function(e){return-1===n.indexOf(e)}))}})),t.unknownCodecs=e}function Rt(e,t,r){var n=t[r];n&&(e[r]=n)}function It(e,t){for(var r=e[t],n=t;n--;){var i=e[n];if(!i)return;i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}function wt(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),b(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function Dt(e,t,r,n){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",n&&(e.levelkeys=n),e.initSegment=null}function Ct(e,t,r){e.levelkeys=t;var n=r.encryptedFragments;n.length&&n[n.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||n.push(e)}var Nt={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Lt={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function Ot(e){switch(e.type){case Nt.AUDIO_TRACK:return Lt.AUDIO;case Nt.SUBTITLE_TRACK:return Lt.SUBTITLE;default:return Lt.MAIN}}function Pt(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}var Mt=function(){function e(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}var t=e.prototype;return t.startLoad=function(e){},t.stopLoad=function(){this.destroyInternalLoaders()},t.registerListeners=function(){var e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.unregisterListeners=function(){var e=this.hls;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(R.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},t.createInternalLoader=function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,i=new(r||n)(t);return this.loaders[e.type]=i,i},t.getInternalLoader=function(e){return this.loaders[e.type]},t.resetInternalLoader=function(e){this.loaders[e]&&delete this.loaders[e]},t.destroyInternalLoaders=function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}},t.destroy=function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()},t.onManifestLoading=function(e,t){var r=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Nt.MANIFEST,url:r,deliveryDirectives:null})},t.onLevelLoading=function(e,t){var r=t.id,n=t.level,i=t.url,a=t.deliveryDirectives;this.load({id:r,level:n,responseType:"text",type:Nt.LEVEL,url:i,deliveryDirectives:a})},t.onAudioTrackLoading=function(e,t){var r=t.id,n=t.groupId,i=t.url,a=t.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:Nt.AUDIO_TRACK,url:i,deliveryDirectives:a})},t.onSubtitleTrackLoading=function(e,t){var r=t.id,n=t.groupId,i=t.url,a=t.deliveryDirectives;this.load({id:r,groupId:n,level:null,responseType:"text",type:Nt.SUBTITLE_TRACK,url:i,deliveryDirectives:a})},t.load=function(e){var t,r,n,i=this,a=this.hls.config,o=this.getInternalLoader(e);if(o){var l=o.context;if(l&&l.url===e.url)return void M.trace("[playlist-loader]: playlist request ongoing");M.log("[playlist-loader]: aborting previous loader for type: "+e.type),o.abort()}if(r=e.type===Nt.MANIFEST?a.manifestLoadPolicy.default:s({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part&&(e.type===Nt.LEVEL&&null!==e.level?n=this.hls.levels[e.level].details:e.type===Nt.AUDIO_TRACK&&null!==e.id?n=this.hls.audioTracks[e.id].details:e.type===Nt.SUBTITLE_TRACK&&null!==e.id&&(n=this.hls.subtitleTracks[e.id].details),n)){var u=n.partTarget,c=n.targetduration;if(u&&c){var f=1e3*Math.max(3*u,.8*c);r=s({},r,{maxTimeToFirstByteMs:Math.min(f,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,r.maxTimeToFirstByteMs)})}}var d=r.errorRetry||r.timeoutRetry||{},h={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},g={onSuccess:function(e,t,r,n){var a=i.getInternalLoader(r);i.resetInternalLoader(r.type);var o=e.data;0===o.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),_t.isMediaPlaylist(o)?i.handleTrackOrLevelPlaylist(e,t,r,n||null,a):i.handleMasterPlaylist(e,t,r,n)):i.handleManifestParsingError(e,r,new Error("no EXTM3U delimiter"),n||null,t)},onError:function(e,t,r,n){i.handleNetworkError(t,r,!1,e,n)},onTimeout:function(e,t,r){i.handleNetworkError(t,r,!0,void 0,e)}};o.load(e,h,g)},t.handleMasterPlaylist=function(e,t,r,n){var i=this.hls,a=e.data,o=Pt(e,r),s=_t.parseMasterPlaylist(a,o);if(s.playlistParsingError)this.handleManifestParsingError(e,r,s.playlistParsingError,n,t);else{var l=s.contentSteering,u=s.levels,c=s.sessionData,f=s.sessionKeys,d=s.startTimeOffset,h=s.variableList;this.variableList=h;var g=_t.parseMasterPlaylistMedia(a,o,s),p=g.AUDIO,m=void 0===p?[]:p,v=g.SUBTITLES,y=g["CLOSED-CAPTIONS"];m.length&&(m.some((function(e){return!e.url}))||!u[0].audioCodec||u[0].attrs.AUDIO||(M.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new F({}),bitrate:0,url:""}))),i.trigger(R.MANIFEST_LOADED,{levels:u,audioTracks:m,subtitles:v,captions:y,contentSteering:l,url:o,stats:t,networkDetails:n,sessionData:c,sessionKeys:f,startTimeOffset:d,variableList:h})}},t.handleTrackOrLevelPlaylist=function(e,t,r,n,i){var a=this.hls,o=r.id,s=r.level,l=r.type,u=Pt(e,r),c=b(o)?o:0,f=b(s)?s:c,d=Ot(r),h=_t.parseLevelPlaylist(e.data,u,f,d,c,this.variableList);if(l===Nt.MANIFEST){var g={attrs:new F({}),bitrate:0,details:h,name:"",url:u};a.trigger(R.MANIFEST_LOADED,{levels:[g],audioTracks:[],url:u,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=h,this.handlePlaylistLoaded(h,e,t,r,n,i)},t.handleManifestParsingError=function(e,t,r,n,i){this.hls.trigger(R.ERROR,{type:I.NETWORK_ERROR,details:w.MANIFEST_PARSING_ERROR,fatal:t.type===Nt.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:i})},t.handleNetworkError=function(e,t,r,i,a){void 0===r&&(r=!1);var o="A network "+(r?"timeout":"error"+(i?" (status "+i.code+")":""))+" occurred while loading "+e.type;e.type===Nt.LEVEL?o+=": "+e.level+" id: "+e.id:e.type!==Nt.AUDIO_TRACK&&e.type!==Nt.SUBTITLE_TRACK||(o+=" id: "+e.id+' group-id: "'+e.groupId+'"');var s=new Error(o);M.warn("[playlist-loader]: "+o);var l=w.UNKNOWN,u=!1,c=this.getInternalLoader(e);switch(e.type){case Nt.MANIFEST:l=r?w.MANIFEST_LOAD_TIMEOUT:w.MANIFEST_LOAD_ERROR,u=!0;break;case Nt.LEVEL:l=r?w.LEVEL_LOAD_TIMEOUT:w.LEVEL_LOAD_ERROR,u=!1;break;case Nt.AUDIO_TRACK:l=r?w.AUDIO_TRACK_LOAD_TIMEOUT:w.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Nt.SUBTITLE_TRACK:l=r?w.SUBTITLE_TRACK_LOAD_TIMEOUT:w.SUBTITLE_LOAD_ERROR,u=!1}c&&this.resetInternalLoader(e.type);var f={type:I.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:s,networkDetails:t,stats:a};if(i){var d=(null==t?void 0:t.url)||e.url;f.response=n({url:d,data:void 0},i)}this.hls.trigger(R.ERROR,f)},t.handlePlaylistLoaded=function(e,t,r,n,i,a){var o=this.hls,s=n.type,l=n.level,u=n.id,c=n.groupId,f=n.deliveryDirectives,d=Pt(t,n),h=Ot(n),g="number"==typeof n.level&&h===Lt.MAIN?l:void 0;if(e.fragments.length){e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));var p=e.playlistParsingError;if(p)o.trigger(R.ERROR,{type:I.NETWORK_ERROR,details:w.LEVEL_PARSING_ERROR,fatal:!1,url:d,error:p,reason:p.message,response:t,context:n,level:g,parent:h,networkDetails:i,stats:r});else switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case Nt.MANIFEST:case Nt.LEVEL:o.trigger(R.LEVEL_LOADED,{details:e,level:g||0,id:u||0,stats:r,networkDetails:i,deliveryDirectives:f});break;case Nt.AUDIO_TRACK:o.trigger(R.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:i,deliveryDirectives:f});break;case Nt.SUBTITLE_TRACK:o.trigger(R.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:r,networkDetails:i,deliveryDirectives:f})}}else{var m=new Error("No Segments found in Playlist");o.trigger(R.ERROR,{type:I.NETWORK_ERROR,details:w.LEVEL_EMPTY_ERROR,fatal:!1,url:d,error:m,reason:m.message,response:t,context:n,level:g,parent:h,networkDetails:i,stats:r})}},e}();function kt(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function xt(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){M.debug("[texttrack-utils]: "+r);try{var n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){M.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: "+e)}}"disabled"===r&&(e.mode=r)}function Ft(e){var t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(var r=e.cues.length;r--;)e.removeCue(e.cues[r]);"disabled"===t&&(e.mode=t)}function Ut(e,t,r,n){var i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var a=Zt(e.cues,t,r),o=0;o<a.length;o++)n&&!n(a[o])||e.removeCue(a[o]);"disabled"===i&&(e.mode=i)}function Bt(e,t){if(t<e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return-1;for(var n=0,i=r;n<=i;){var a=Math.floor((i+n)/2);if(t<e[a].startTime)i=a-1;else{if(!(t>e[a].startTime&&n<r))return a;n=a+1}}return e[n].startTime-t<t-e[i].startTime?n:i}function Zt(e,t,r){var n=[],i=Bt(e,t);if(i>-1)for(var a=i,o=e.length;a<o;a++){var s=e[a];if(s.startTime>=t&&s.endTime<=r)n.push(s);else if(s.startTime>r)return n}return n}var Gt={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"},Kt=.25;function Ht(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var Yt=function(){var e=Ht();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function Vt(e,t){return e.getTime()/1e3-t}function qt(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var jt=function(){function e(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}var t=e.prototype;return t.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},t._registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)},t._unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this)},t.onMediaAttached=function(e,t){this.media=t.media},t.onMediaDetaching=function(){this.id3Track&&(Ft(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},t.onManifestLoading=function(){this.dateRangeCuesAppended={}},t.createTrack=function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t},t.getID3Track=function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return kt(r,this.media),r}return this.media.addTextTrack("metadata","id3")}},t.onFragParsingMetadata=function(e,t){if(this.media){var r=this.hls.config,n=r.enableEmsgMetadataCues,i=r.enableID3MetadataCues;if(n||i){var a=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var o=Ht(),s=0;s<a.length;s++){var l=a[s].type;if((l!==Gt.emsg||n)&&i){var u=Ee(a[s].data);if(u){var c=a[s].pts,f=c+a[s].duration;f>Yt&&(f=Yt),f-c<=0&&(f=c+Kt);for(var d=0;d<u.length;d++){var h=u[d];if(!ve(h)){this.updateId3CueEnds(c,l);var g=new o(c,f,"");g.value=h,l&&(g.type=l),this.id3Track.addCue(g)}}}}}}}},t.updateId3CueEnds=function(e,t){var r,n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(var i=n.length;i--;){var a=n[i];a.type===t&&a.startTime<e&&a.endTime===Yt&&(a.endTime=e)}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,i=t.type,a=this.id3Track,o=this.hls;if(o){var s=o.config,l=s.enableEmsgMetadataCues,u=s.enableID3MetadataCues;a&&(l||u)&&Ut(a,r,n,"audio"===i?function(e){return e.type===Gt.audioId3&&u}:"video"===i?function(e){return e.type===Gt.emsg&&l}:function(e){return e.type===Gt.audioId3&&u||e.type===Gt.emsg&&l})}},t.onLevelUpdated=function(e,t){var r=this,n=t.details;if(this.media&&n.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var i=this.dateRangeCuesAppended,a=this.id3Track,o=n.dateRanges,s=Object.keys(o);if(a)for(var l=Object.keys(i).filter((function(e){return!s.includes(e)})),u=function(){var e=l[c];Object.keys(i[e].cues).forEach((function(t){a.removeCue(i[e].cues[t])})),delete i[e]},c=l.length;c--;)u();var f=n.fragments[n.fragments.length-1];if(0!==s.length&&b(null==f?void 0:f.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var d=f.programDateTime/1e3-f.start,h=Ht(),g=function(){var e=s[p],t=o[e],n=i[e],a=(null==n?void 0:n.cues)||{},l=(null==n?void 0:n.durationKnown)||!1,u=Vt(t.startDate,d),c=Yt,f=t.endDate;if(f)c=Vt(f,d),l=!0;else if(t.endOnNext&&!l){var g=s.reduce((function(e,r){var n=o[r];return n.class===t.class&&n.id!==r&&n.startDate>t.startDate&&e.push(n),e}),[]).sort((function(e,t){return e.startDate.getTime()-t.startDate.getTime()}))[0];g&&(c=Vt(g.startDate,d),l=!0)}for(var m=Object.keys(t.attr),v=0;v<m.length;v++){var y=m[v];if(U(y)){var E=a[y];if(E)l&&!n.durationKnown&&(E.endTime=c);else{var T=t.attr[y];E=new h(u,c,""),B(y)&&(T=qt(T)),E.value={key:y,data:T},E.type=Gt.dateRange,E.id=e,r.id3Track.addCue(E),a[y]=E}}}i[e]={cues:a,dateRange:t,durationKnown:l}},p=0;p<s.length;p++)g()}}},e}(),zt=function(){function e(e){var t=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return t.timeupdate()},this.hls=e,this.config=e.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},t.registerListeners=function(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(R.ERROR,this.onError,this)},t.unregisterListeners=function(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(R.ERROR,this.onError,this)},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},t.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},t.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},t.onLevelUpdated=function(e,t){var r=t.details;this.levelDetails=r,r.advanced&&this.timeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},t.onError=function(e,t){var r;t.details===w.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(r=this.levelDetails)&&r.live&&M.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},t.timeupdate=function(){var e=this.media,t=this.levelDetails;if(e&&t){this.currentTime=e.currentTime;var r=this.computeLatency();if(null!==r){this._latency=r;var n=this.config,i=n.lowLatencyMode,a=n.maxLiveSyncPlaybackRate;if(i&&1!==a){var o=this.targetLatency;if(null!==o){var s=r-o,l=s<Math.min(this.maxLatency,o+t.targetduration);if(t.live&&l&&s>.05&&this.forwardBufferLength>1){var u=Math.min(2,Math.max(1,a)),c=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,c))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}}}}},t.estimateLiveEdge=function(){var e=this.levelDetails;return null===e?null:e.edge+e.age},t.computeLatency=function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime},a(e,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config,t=this.levelDetails;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e)return null;var t=e.holdBack,r=e.partHoldBack,n=e.targetduration,i=this.config,a=i.liveSyncDuration,o=i.liveSyncDurationCount,s=i.lowLatencyMode,l=this.hls.userConfig,u=s&&r||t;(l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==a?a:o*n);var c=n,f=1;return u+Math.min(this.stallCount*f,c)}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(null===e||null===t||null===r)return null;var n=r.edge,i=e-t-this.edgeStalled,a=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}}]),e}(),Wt=["NONE","TYPE-0","TYPE-1",null],Xt={No:"",Yes:"YES",v2:"v2"};function Qt(e,t){var r=e.canSkipUntil,n=e.canSkipDateRanges,i=e.endSN;return r&&(void 0!==t?t-i:0)<r?n?Xt.v2:Xt.Yes:Xt.No}var Jt=function(){function e(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}return e.prototype.addDirectives=function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},e}(),$t=function(){function e(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter((function(e){return e})).join(",").replace(/\.[^.,]+/g,"")}return e.prototype.addFallback=function(e){this.url.push(e.url),this._attrs.push(e.attrs)},a(e,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"attrs",get:function(){return this._attrs[this._urlId]}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(e){var t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}},{key:"textGroupId",get:function(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}}]),e}();function er(e,t){var r=t.startPTS;if(b(r)){var n,i=0;t.sn>e.sn?(i=r-e.start,n=e):(i=e.start-r,n=t),n.duration!==i&&(n.duration=i)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration:t.start=Math.max(e.start-t.duration,0)}function tr(e,t,r,n,i,a){n-r<=0&&(M.warn("Fragment should have a positive duration",t),n=r+t.duration,a=i+t.duration);var o=r,s=n,l=t.startPTS,u=t.endPTS;if(b(l)){var c=Math.abs(l-r);b(t.deltaPTS)?t.deltaPTS=Math.max(c,t.deltaPTS):t.deltaPTS=c,o=Math.max(r,l),r=Math.min(r,l),i=Math.min(i,t.startDTS),s=Math.min(n,u),n=Math.max(n,u),a=Math.max(a,t.endDTS)}var f=r-t.start;0!==t.start&&(t.start=r),t.duration=n-t.start,t.startPTS=r,t.maxStartPTS=o,t.startDTS=i,t.endPTS=n,t.minEndPTS=s,t.endDTS=a;var d,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;var g=h-e.startSN,p=e.fragments;for(p[g]=t,d=g;d>0;d--)er(p[d],p[d-1]);for(d=g;d<p.length-1;d++)er(p[d],p[d+1]);return e.fragmentHint&&er(p[p.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,f}function rr(e,t){for(var r=null,n=e.fragments,i=n.length-1;i>=0;i--){var a=n[i].initSegment;if(a){r=a;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;var o,s=0;if(ar(e,t,(function(e,n){e.relurl&&(s=e.cc-n.cc),b(e.startPTS)&&b(e.endPTS)&&(n.start=n.startPTS=e.startPTS,n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.duration=e.endPTS-e.startPTS,n.duration&&(o=n),t.PTSKnown=t.alignedSliding=!0),n.elementaryStreams=e.elementaryStreams,n.loader=e.loader,n.stats=e.stats,n.urlId=e.urlId,e.initSegment&&(n.initSegment=e.initSegment,r=e.initSegment)})),r&&(t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments).forEach((function(e){var t;e.initSegment&&e.initSegment.relurl!==(null==(t=r)?void 0:t.relurl)||(e.initSegment=r)})),t.skippedSegments)if(t.deltaUpdateFailed=t.fragments.some((function(e){return!e})),t.deltaUpdateFailed){M.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var l=t.skippedSegments;l--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=nr(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges));var u=t.fragments;if(s){M.warn("discontinuity sliding from playlist, take drift into account");for(var c=0;c<u.length;c++)u[c].cc+=s}t.skippedSegments&&(t.startCC=t.fragments[0].cc),ir(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),o?tr(t,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS):or(e,t),u.length&&(t.totalduration=t.edge-u[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var f=t.advancedDateTime;if(t.advanced&&f){var d=t.edge;t.driftStart||(t.driftStartTime=f,t.driftStart=d),t.driftEndTime=f,t.driftEnd=d}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}function nr(e,t,r){var n=s({},e);return r&&r.forEach((function(e){delete n[e]})),Object.keys(t).forEach((function(e){var r=new Z(t[e].attr,n[e]);r.isValid?n[e]=r:M.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(t[e].attr)+'"')})),n}function ir(e,t,r){if(e&&t)for(var n=0,i=0,a=e.length;i<=a;i++){var o=e[i],s=t[i+n];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?r(o,s):n--}}function ar(e,t,r){for(var n=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(n?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=i;u<=a;u++){var c=l[o+u],f=s[u];n&&!f&&u<n&&(f=t.fragments[u]=c),c&&f&&r(c,f)}}function or(e,t){var r=t.startSN+t.skippedSegments-e.startSN,n=e.fragments;r<0||r>=n.length||sr(t,n[r].start)}function sr(e,t){if(t){for(var r=e.fragments,n=e.skippedSegments;n<r.length;n++)r[n].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function lr(e,t){void 0===t&&(t=1/0);var r=1e3*e.targetduration;if(e.updated){var n=e.fragments,i=4;if(n.length&&r*i>t){var a=1e3*n[n.length-1].duration;a<r&&(r=a)}}else r/=2;return Math.round(r)}function ur(e,t,r){if(null==e||!e.details)return null;var n=e.details,i=n.fragments[t-n.startSN];return i||((i=n.fragmentHint)&&i.sn===t?i:t<n.startSN&&r&&r.sn===t?r:null)}function cr(e,t,r){var n;return null!=e&&e.details?fr(null==(n=e.details)?void 0:n.partList,t,r):null}function fr(e,t,r){if(e)for(var n=e.length;n--;){var i=e[n];if(i.index===r&&i.fragment.sn===t)return i}return null}function dr(e){switch(e.details){case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_TIMEOUT:case w.LEVEL_LOAD_TIMEOUT:case w.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function hr(e,t){var r=dr(t);return e.default[(r?"timeout":"error")+"Retry"]}function gr(e,t){var r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function pr(e){return n(n({},e),{errorRetry:null,timeoutRetry:null})}function mr(e,t,r,n){return!!e&&t<e.maxNumRetry&&(vr(n)||!!r)}function vr(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}var yr={search:function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){var o=t(a=e[i=(r+n)/2|0]);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null}};function Er(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!b(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;r=r||0;for(var n=0;n<e.length;++n){var i=e[n];if(Sr(t,r,i))return i}return null}function Tr(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=0);var i=null;if(e?i=t[e.sn-t[0].sn+1]||null:0===r&&0===t[0].start&&(i=t[0]),i&&0===_r(r,n,i))return i;var a=yr.search(t,_r.bind(null,r,n));return!a||a===e&&i?i:a}function _r(e,t,r){if(void 0===e&&(e=0),void 0===t&&(t=0),r.start<=e&&r.start+r.duration>e)return 0;var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function Sr(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}function Ar(e,t){return yr.search(e,(function(e){return e.cc<t?1:e.cc>t?-1:0}))}var br=3e5,Rr={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},Ir={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},wr=function(){function e(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=M.log.bind(M,"[info]:"),this.warn=M.warn.bind(M,"[warning]:"),this.error=M.error.bind(M,"[error]:"),this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(R.ERROR,this.onError,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(R.ERROR,this.onError,this),e.off(R.ERROR,this.onErrorOut,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this))},t.destroy=function(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}},t.startLoad=function(e){this.playlistError=0},t.stopLoad=function(){},t.getVariantLevelIndex=function(e){return(null==e?void 0:e.type)===Lt.MAIN?e.level:this.hls.loadLevel},t.onManifestLoading=function(){this.playlistError=0,this.penalizedRenditions={}},t.onLevelUpdated=function(){this.playlistError=0},t.onError=function(e,t){var r,n;if(!t.fatal){var i=this.hls,a=t.context;switch(t.details){case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case w.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction={action:Rr.DoNothing,flags:Ir.None});case w.FRAG_GAP:case w.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=Rr.SendAlternateToPenaltyBox);case w.LEVEL_EMPTY_ERROR:case w.LEVEL_PARSING_ERROR:var o,s,l=t.parent===Lt.MAIN?t.level:i.loadLevel;return void(t.details===w.LEVEL_EMPTY_ERROR&&null!=(o=t.context)&&null!=(s=o.levelDetails)&&s.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,l)));case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==a?void 0:a.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level)));case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.SUBTITLE_LOAD_ERROR:case w.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){var u=i.levels[i.loadLevel];if(u&&(a.type===Nt.AUDIO_TRACK&&a.groupId===u.audioGroupId||a.type===Nt.SUBTITLE_TRACK&&a.groupId===u.textGroupId))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.loadLevel),t.errorAction.action=Rr.SendAlternateToPenaltyBox,void(t.errorAction.flags=Ir.MoveAllAlternatesMatchingHost)}return;case w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var c=i.levels[i.loadLevel],f=null==c?void 0:c.attrs["HDCP-LEVEL"];return void(f&&(t.errorAction={action:Rr.SendAlternateToPenaltyBox,flags:Ir.MoveAllAlternatesMatchingHDCP,hdcpLevel:f}));case w.BUFFER_ADD_CODEC_ERROR:case w.REMUX_ALLOC_ERROR:return void(t.errorAction=this.getLevelSwitchAction(t,null!=(n=t.level)?n:i.loadLevel));case w.INTERNAL_EXCEPTION:case w.BUFFER_APPENDING_ERROR:case w.BUFFER_APPEND_ERROR:case w.BUFFER_FULL_ERROR:case w.LEVEL_SWITCH_ERROR:case w.BUFFER_STALLED_ERROR:case w.BUFFER_SEEK_OVER_HOLE:case w.BUFFER_NUDGE_ON_STALL:return void(t.errorAction={action:Rr.DoNothing,flags:Ir.None})}if(t.type===I.KEY_SYSTEM_ERROR){var d=this.getVariantLevelIndex(t.frag);return t.levelRetry=!1,void(t.errorAction=this.getLevelSwitchAction(t,d))}}},t.getPlaylistRetryOrSwitchAction=function(e,t){var r,n=hr(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++,a=null==(r=e.response)?void 0:r.code;if(mr(n,i,dr(e),a))return{action:Rr.RetryRequest,flags:Ir.None,retryConfig:n,retryCount:i};var o=this.getLevelSwitchAction(e,t);return n&&(o.retryConfig=n,o.retryCount=i),o},t.getFragRetryOrSwitchAction=function(e){var t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],i=t.config,a=i.fragLoadPolicy,o=i.keyLoadPolicy,s=hr(e.details.startsWith("key")?o:a,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(n){var u;e.details!==w.FRAG_GAP&&n.fragmentError++;var c=null==(u=e.response)?void 0:u.code;if(mr(s,l,dr(e),c))return{action:Rr.RetryRequest,flags:Ir.None,retryConfig:s,retryCount:l}}var f=this.getLevelSwitchAction(e,r);return s&&(f.retryConfig=s,f.retryCount=l),f},t.getLevelSwitchAction=function(e,t){var r=this.hls;null==t&&(t=r.loadLevel);var n=this.hls.levels[t];if(n&&(n.loadError++,r.autoLevelEnabled)){for(var i,a,o=-1,s=r.levels,l=r.loadLevel,u=r.minAutoLevel,c=r.maxAutoLevel,f=null==(i=e.frag)?void 0:i.type,d=null!=(a=e.context)?a:{},h=d.type,g=d.groupId,p=s.length;p--;){var m=(p+l)%s.length;if(m!==l&&m>=u&&m<=c&&0===s[m].loadError){var v=s[m];if(e.details===w.FRAG_GAP&&e.frag){var y=s[m].details;if(y){var E=Tr(e.frag,y.fragments,e.frag.start);if(null!=E&&E.gap)continue}}else{if(h===Nt.AUDIO_TRACK&&g===v.audioGroupId||h===Nt.SUBTITLE_TRACK&&g===v.textGroupId)continue;if(f===Lt.AUDIO&&n.audioGroupId===v.audioGroupId||f===Lt.SUBTITLE&&n.textGroupId===v.textGroupId)continue}o=m;break}}if(o>-1&&r.loadLevel!==o)return e.levelRetry=!0,this.playlistError=0,{action:Rr.SendAlternateToPenaltyBox,flags:Ir.None,nextAutoLevel:o}}return{action:Rr.SendAlternateToPenaltyBox,flags:Ir.MoveAllAlternatesMatchingHost}},t.onErrorOut=function(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case Rr.DoNothing:break;case Rr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===w.FRAG_GAP||(t.fatal=!0)}t.fatal&&this.hls.stopLoad()},t.sendAlternateToPenaltyBox=function(e){var t=this.hls,r=e.errorAction;if(r){var n=r.flags,i=r.hdcpLevel,a=r.nextAutoLevel;switch(n){case Ir.None:this.switchLevel(e,a);break;case Ir.MoveAllAlternatesMatchingHost:r.resolved||(r.resolved=this.redundantFailover(e));break;case Ir.MoveAllAlternatesMatchingHDCP:i&&(t.maxHdcpLevel=Wt[Wt.indexOf(i)-1],r.resolved=!0),this.warn('Restricting playback to HDCP-LEVEL of "'+t.maxHdcpLevel+'" or lower')}r.resolved||this.switchLevel(e,a)}},t.switchLevel=function(e,t){void 0!==t&&e.errorAction&&(this.warn("switching to level "+t+" after "+e.details),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)},t.redundantFailover=function(e){var t=this,r=this.hls,n=this.penalizedRenditions,i=e.parent===Lt.MAIN?e.level:r.loadLevel,a=r.levels[i],o=a.url.length,s=e.frag?e.frag.urlId:a.urlId;a.urlId!==s||e.frag&&!a.details||this.penalizeRendition(a,e);for(var l=function(){var l=(s+u)%o,c=n[l];if(!c||Dr(c,e,n[s]))return t.warn("Switching to Redundant Stream "+(l+1)+"/"+o+': "'+a.url[l]+'" after '+e.details),t.playlistError=0,r.levels.forEach((function(e){e.urlId=l})),r.nextLoadLevel=i,{v:!0}},u=1;u<o;u++){var c=l();if("object"==typeof c)return c.v}return!1},t.penalizeRendition=function(e,t){var r=this.penalizedRenditions,n=r[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};n.lastErrorPerfMs=performance.now(),n.errors.push(t),n.details=e.details,r[e.urlId]=n},e}();function Dr(e,t,r){if(performance.now()-e.lastErrorPerfMs>br)return!0;var n=e.details;if(t.details===w.FRAG_GAP&&n&&t.frag){var i=t.frag.start,a=Tr(null,n.fragments,i);if(a&&!a.gap)return!0}if(r&&e.errors.length<r.errors.length){var o=e.errors[e.errors.length-1];if(n&&o.frag&&t.frag&&Math.abs(o.frag.start-t.frag.start)>3*n.targetduration)return!0}return!1}var Cr,Nr=function(){function e(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=M.log.bind(M,t+":"),this.warn=M.warn.bind(M,t+":"),this.hls=e}var t=e.prototype;return t.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},t.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},t.startLoad=function(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()},t.stopLoad=function(){this.canLoad=!1,this.clearTimer()},t.switchParams=function(e,t){var r=null==t?void 0:t.renditionReports;if(r){for(var n=-1,i=0;i<r.length;i++){var a=r[i],o=void 0;try{o=new self.URL(a.URI,t.url).href}catch(e){M.warn("Could not construct new URL for Rendition Report: "+e),o=a.URI||""}if(o===e){n=i;break}o===e.substring(0,o.length)&&(n=i)}if(-1!==n){var s=r[n],l=parseInt(s["LAST-MSN"])||(null==t?void 0:t.lastPartSn),u=parseInt(s["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){var c=Math.min(t.age-t.partTarget,t.targetduration);u>=0&&c>t.partTarget&&(u+=1)}return new Jt(l,u>=0?u:void 0,Xt.No)}}},t.loadPlaylist=function(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())},t.shouldLoadPlaylist=function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)},t.shouldReloadPlaylist=function(e){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)},t.playlistLoaded=function(e,t,r){var n=this,i=t.details,a=t.stats,o=self.performance.now(),s=a.loading.first?Math.max(0,o-a.loading.first):0;if(i.advancedDateTime=Date.now()-s,i.live||null!=r&&r.live){if(i.reloaded(r),r&&this.log("live playlist "+e+" "+(i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:"MISSED")),r&&i.fragments.length>0&&rr(r,i),!this.canLoad||!i.live)return;var l,u=void 0,c=void 0;if(i.canBlockReload&&i.endSN&&i.advanced){var f=this.hls.config.lowLatencyMode,d=i.lastPartSn,h=i.endSN,g=i.lastPartIndex,p=d===h;-1!==g?(u=p?h+1:d,c=p?f?0:g:g+1):u=h+1;var m=i.age,v=m+i.ageHeader,y=Math.min(v-i.partTarget,1.5*i.targetduration);if(y>0){if(r&&y>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+r.tuneInGoal+" to: "+y+" with playlist age: "+i.age),y=0;else{var E=Math.floor(y/i.targetduration);u+=E,void 0!==c&&(c+=Math.round(y%i.targetduration/i.partTarget)),this.log("CDN Tune-in age: "+i.ageHeader+"s last advanced "+m.toFixed(2)+"s goal: "+y+" skip sn "+E+" to part "+c)}i.tuneInGoal=y}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,u,c),f||!p)return void this.loadPlaylist(l)}else i.canBlockReload&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,u,c));var T=this.hls.mainForwardBufferInfo,_=T?T.end-T.len:0,S=lr(i,1e3*(i.edge-_));i.updated&&o>this.requestScheduled+S&&(this.requestScheduled=a.loading.start),void 0!==u&&i.canBlockReload?this.requestScheduled=a.loading.first+S-(1e3*i.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+S<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=S);var A=this.requestScheduled-o;A=Math.max(0,A),this.log("reload live playlist "+e+" in "+Math.round(A)+" ms"),this.timer=self.setTimeout((function(){return n.loadPlaylist(l)}),A)}else this.clearTimer()},t.getDeliveryDirectives=function(e,t,r,n){var i=Qt(e,r);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,i=Xt.No),new Jt(r,n,i)},t.checkRetry=function(e){var t=this,r=e.details,n=dr(e),i=e.errorAction,a=i||{},o=a.action,s=a.retryCount,l=void 0===s?0:s,u=a.retryConfig,c=!!i&&!!u&&(o===Rr.RetryRequest||!i.resolved&&o===Rr.SendAlternateToPenaltyBox);if(c){var f;if(this.requestScheduled=-1,l>=u.maxNumRetry)return!1;if(n&&null!=(f=e.context)&&f.deliveryDirectives)this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" without delivery-directives'),this.loadPlaylist();else{var d=gr(u,l);this.timer=self.setTimeout((function(){return t.loadPlaylist()}),d),this.warn("Retrying playlist loading "+(l+1)+"/"+u.maxNumRetry+' after "'+r+'" in '+d+"ms")}e.levelRetry=!0,i.resolved=!0}return c},e}(),Lr=function(e){function t(t,r){var n;return(n=e.call(this,t,"[level-controller]")||this)._levels=[],n._firstLevel=-1,n._startLevel=void 0,n.currentLevel=null,n.currentLevelIndex=-1,n.manualLevelIndex=-1,n.steering=void 0,n.onParsedComplete=void 0,n.steering=r,n._registerListeners(),n}l(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.ERROR,this.onError,this)},r._unregisterListeners=function(){var e=this.hls;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.ERROR,this.onError,this)},r.destroy=function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),e.prototype.destroy.call(this)},r.startLoad=function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0})),e.prototype.startLoad.call(this)},r.resetLevels=function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]},r.onManifestLoading=function(e,t){this.resetLevels()},r.onManifestLoaded=function(e,t){var r,n=[],i={};t.levels.forEach((function(e){var t,a=e.attrs;-1!==(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))&&(Cr||(Cr=/chrome|firefox/i.test(navigator.userAgent)),Cr&&(e.audioCodec=void 0));var o=a.AUDIO,s=a.CODECS,l=a["FRAME-RATE"],u=a["PATHWAY-ID"],c=a.RESOLUTION,f=a.SUBTITLES,d=(u||".")+"-"+e.bitrate+"-"+c+"-"+l+"-"+s;(r=i[d])?r.addFallback(e):(r=new $t(e),i[d]=r,n.push(r)),Or(r,"audio",o),Or(r,"text",f)})),this.filterAndSortMediaOptions(n,t)},r.filterAndSortMediaOptions=function(e,t){var r=this,n=[],i=[],a=!1,o=!1,s=!1,l=e.filter((function(e){var t=e.audioCodec,r=e.videoCodec,n=e.width,i=e.height,l=e.unknownCodecs;return a||(a=!(!n||!i)),o||(o=!!r),s||(s=!!t),!(null!=l&&l.length)&&(!t||pt(t,"audio"))&&(!r||pt(r,"video"))}));if((a||o)&&s&&(l=l.filter((function(e){var t=e.videoCodec,r=e.width,n=e.height;return!!t||!(!r||!n)}))),0!==l.length){t.audioTracks&&Pr(n=t.audioTracks.filter((function(e){return!e.audioCodec||pt(e.audioCodec,"audio")}))),t.subtitles&&Pr(i=t.subtitles);var u=l.slice(0);l.sort((function(e,t){return e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):a&&e.height!==t.height?e.height-t.height:0}));var c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l)).length!==u.length)for(var f=0;f<u.length;f++)if(u[f].pathwayId===l[0].pathwayId){c=u[f];break}this._levels=l;for(var d=0;d<l.length;d++)if(l[d]===c){this._firstLevel=d,this.log("manifest loaded, "+l.length+" level(s) found, first bitrate: "+c.bitrate);break}var h=s&&!o,g={levels:l,audioTracks:n,subtitleTracks:i,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:o,altAudio:!h&&n.some((function(e){return!!e.url}))};this.hls.trigger(R.MANIFEST_PARSED,g),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else Promise.resolve().then((function(){if(r.hls){var e=new Error("no level with compatible codecs found in manifest");r.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}}))},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===Nt.LEVEL&&t.context.level===this.level&&this.checkRetry(t)},r.onFragLoaded=function(e,t){var r=t.frag;if(void 0!==r&&r.type===Lt.MAIN){var n=this._levels[r.level];void 0!==n&&(n.loadError=0)}},r.onLevelLoaded=function(e,t){var r,n,i=t.level,a=t.details,o=this._levels[i];if(!o)return this.warn("Invalid level index "+i),void(null!=(n=t.deliveryDirectives)&&n.skip&&(a.deltaUpdateFailed=!0));i===this.currentLevelIndex?(0===o.fragmentError&&(o.loadError=0),this.playlistLoaded(i,t,o.details)):null!=(r=t.deliveryDirectives)&&r.skip&&(a.deltaUpdateFailed=!0)},r.onAudioTrackSwitched=function(e,t){var r=this.currentLevel;if(r){var n=this.hls.audioTracks[t.id].groupId;if(r.audioGroupIds&&r.audioGroupId!==n){for(var i=-1,a=0;a<r.audioGroupIds.length;a++)if(r.audioGroupIds[a]===n){i=a;break}-1!==i&&i!==r.urlId&&(r.urlId=i,this.canLoad&&this.startLoad())}}},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){var i=n.urlId,a=n.uri;if(t)try{a=t.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}var o=n.attrs["PATHWAY-ID"];this.log("Loading level index "+r+(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"")+" with"+(o?" Pathway "+o:"")+" URI "+(i+1)+"/"+n.url.length+" "+a),this.clearTimer(),this.hls.trigger(R.LEVEL_LOADING,{url:a,level:r,id:i,deliveryDirectives:t||null})}},r.removeLevel=function(e,t){var r=this,n=function(e,r){return r!==t},i=this._levels.filter((function(i,a){return a!==e||(i.url.length>1&&void 0!==t?(i.url=i.url.filter(n),i.audioGroupIds&&(i.audioGroupIds=i.audioGroupIds.filter(n)),i.textGroupIds&&(i.textGroupIds=i.textGroupIds.filter(n)),i.urlId=0,!0):(r.steering&&r.steering.removeLevel(i),!1))}));this.hls.trigger(R.LEVELS_UPDATED,{levels:i})},r.onLevelsUpdated=function(e,t){var r=t.levels;r.forEach((function(e,t){var r=e.details;null!=r&&r.fragments&&r.fragments.forEach((function(e){e.level=t}))})),this._levels=r},a(t,[{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),n=e<0;if(this.hls.trigger(R.ERROR,{type:I.OTHER_ERROR,details:w.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,t.length-1)}var i=this.currentLevelIndex,a=this.currentLevel,o=a?a.attrs["PATHWAY-ID"]:void 0,l=t[e],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,i!==e||!l.details||!a||o!==u){this.log("Switching to level "+e+(u?" with Pathway "+u:"")+" from level "+i+(o?" with Pathway "+o:""));var c=s({},l,{level:e,maxBitrate:l.maxBitrate,attrs:l.attrs,uri:l.uri,urlId:l.urlId});delete c._attrs,delete c._urlId,this.hls.trigger(R.LEVEL_SWITCHING,c);var f=l.details;if(!f||f.live){var d=this.switchParams(l.uri,null==a?void 0:a.details);this.loadPlaylist(d)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),t}(Nr);function Or(e,t,r){r&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=r):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=r))}function Pr(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}var Mr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},kr=function(){function e(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}var t=e.prototype;return t._registerListeners=function(){var e=this.hls;e.on(R.BUFFER_APPENDED,this.onBufferAppended,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this)},t._unregisterListeners=function(){var e=this.hls;e.off(R.BUFFER_APPENDED,this.onBufferAppended,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this)},t.destroy=function(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null},t.getAppendedFrag=function(e,t){var r=this.activePartLists[t];if(r)for(var n=r.length;n--;){var i=r[n];if(!i)break;var a=i.end;if(i.start<=e&&null!==a&&e<=a)return i}return this.getBufferedFrag(e,t)},t.getBufferedFrag=function(e,t){for(var r=this.fragments,n=Object.keys(r),i=n.length;i--;){var a=r[n[i]];if((null==a?void 0:a.body.type)===t&&a.buffered){var o=a.body;if(o.start<=e&&e<=o.end)return o}}return null},t.detectEvictedFragments=function(e,t,r,n){var i=this;this.timeRanges&&(this.timeRanges[e]=t);var a=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(n){var o=i.fragments[n];if(o&&!(a>=o.body.sn))if(o.buffered||o.loaded){var s=o.range[e];s&&s.time.some((function(e){var r=!i.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&i.removeFragment(o.body),r}))}else o.body.type===r&&i.removeFragment(o.body)}))},t.detectPartialFragments=function(e){var t=this,r=this.timeRanges,n=e.frag,i=e.part;if(r&&"initSegment"!==n.sn){var a=Fr(n),o=this.fragments[a];if(!(!o||o.buffered&&n.gap)){var s=!n.relurl;Object.keys(r).forEach((function(e){var a=n.elementaryStreams[e];if(a){var l=r[e],u=s||!0===a.partial;o.range[e]=t.getBufferedTimes(n,i,u,l)}})),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,o.body.endList&&(this.endListFragments[o.body.type]=o),xr(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}}},t.removeParts=function(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter((function(t){return t.fragment.sn>=e})))},t.fragBuffered=function(e,t){var r=Fr(e),n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)},t.getBufferedTimes=function(e,t,r,n){for(var i={time:[],partial:r},a=e.start,o=e.end,s=e.minEndPTS||o,l=e.maxStartPTS||a,u=0;u<n.length;u++){var c=n.start(u)-this.bufferPadding,f=n.end(u)+this.bufferPadding;if(l>=c&&s<=f){i.time.push({startPTS:Math.max(a,n.start(u)),endPTS:Math.min(o,n.end(u))});break}if(a<f&&o>c)i.partial=!0,i.time.push({startPTS:Math.max(a,n.start(u)),endPTS:Math.min(o,n.end(u))});else if(o<=c)break}return i},t.getPartialFragment=function(e){var t,r,n,i=null,a=0,o=this.bufferPadding,s=this.fragments;return Object.keys(s).forEach((function(l){var u=s[l];u&&xr(u)&&(r=u.body.start-o,n=u.body.end+o,e>=r&&e<=n&&(t=Math.min(e-r,n-e),a<=t&&(i=u.body,a=t)))})),i},t.isEndListAppended=function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||xr(t))},t.getState=function(e){var t=Fr(e),r=this.fragments[t];return r?r.buffered?xr(r)?Mr.PARTIAL:Mr.OK:Mr.APPENDING:Mr.NOT_LOADED},t.isTimeBuffered=function(e,t,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=n&&t<=i)return!0;if(t<=n)return!1}return!1},t.onFragLoaded=function(e,t){var r=t.frag,n=t.part;if("initSegment"!==r.sn&&!r.bitrateTest){var i=n?null:t,a=Fr(r);this.fragments[a]={body:r,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}},t.onBufferAppended=function(e,t){var r=this,n=t.frag,i=t.part,a=t.timeRanges;if("initSegment"!==n.sn){var o=n.type;if(i){var s=this.activePartLists[o];s||(this.activePartLists[o]=s=[]),s.push(i)}this.timeRanges=a,Object.keys(a).forEach((function(e){var t=a[e];r.detectEvictedFragments(e,t,o,i)}))}},t.onFragBuffered=function(e,t){this.detectPartialFragments(t)},t.hasFragment=function(e){var t=Fr(e);return!!this.fragments[t]},t.hasParts=function(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)},t.removeFragmentsInRange=function(e,t,r,n,i){var a=this;n&&!this.hasGaps||Object.keys(this.fragments).forEach((function(o){var s=a.fragments[o];if(s){var l=s.body;l.type!==r||n&&!l.gap||l.start<t&&l.end>e&&(s.buffered||i)&&a.removeFragment(l)}}))},t.removeFragment=function(e){var t=Fr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var n=e.sn;this.activePartLists[e.type]=r.filter((function(e){return e.fragment.sn!==n}))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]},t.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1},e}();function xr(e){var t,r,n;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(r=e.range.audio)?void 0:r.partial)||(null==(n=e.range.audiovideo)?void 0:n.partial))}function Fr(e){return e.type+"_"+e.level+"_"+e.urlId+"_"+e.sn}var Ur=Math.pow(2,17),Br=function(){function e(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}var t=e.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,t){var r=this,i=e.url;if(!i)return Promise.reject(new Kr({type:I.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(l,u){if(r.loader&&r.loader.destroy(),e.gap){if(e.tagList.some((function(e){return"GAP"===e[0]})))return void u(Gr(e));e.gap=!1}var c=r.loader=e.loader=o?new o(a):new s(a),f=Zr(e),d=pr(a.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Ur};e.stats=c.stats,c.load(f,h,{onSuccess:function(t,n,i,a){r.resetLoader(e,c);var o=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),l({frag:e,part:null,payload:o,networkDetails:a})},onError:function(t,a,o,s){r.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:n({url:i,data:void 0},t),error:new Error("HTTP Error "+t.code+" "+t.text),networkDetails:o,stats:s}))},onAbort:function(t,n,i){r.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:function(t,n,i){r.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:i,stats:t}))},onProgress:function(r,n,i,a){t&&t({frag:e,part:null,payload:i,networkDetails:a})}})}))},t.loadPart=function(e,t,r){var i=this;this.abort();var a=this.config,o=a.fLoader,s=a.loader;return new Promise((function(l,u){if(i.loader&&i.loader.destroy(),e.gap||t.gap)u(Gr(e,t));else{var c=i.loader=e.loader=o?new o(a):new s(a),f=Zr(e,t),d=pr(a.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Ur};t.stats=c.stats,c.load(f,h,{onSuccess:function(n,a,o,s){i.resetLoader(e,c),i.updateStatsFromPart(e,t);var u={frag:e,part:t,payload:n.data,networkDetails:s};r(u),l(u)},onError:function(r,a,o,s){i.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:n({url:f.url,data:void 0},r),error:new Error("HTTP Error "+r.code+" "+r.text),networkDetails:o,stats:s}))},onAbort:function(r,n,a){e.stats.aborted=t.stats.aborted,i.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:a,stats:r}))},onTimeout:function(r,n,a){i.resetLoader(e,c),u(new Kr({type:I.NETWORK_ERROR,details:w.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after "+h.timeout+"ms"),networkDetails:a,stats:r}))}})}}))},t.updateStatsFromPart=function(e,t){var r=e.stats,n=t.stats,i=n.total;if(r.loaded+=n.loaded,i){var a=Math.round(e.duration/t.duration),o=Math.min(Math.round(r.loaded/i),a),s=(a-o)*Math.round(r.loaded/o);r.total=r.loaded+s}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=n.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end},t.resetLoader=function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()},e}();function Zr(e,t){void 0===t&&(t=null);var r=t||e,n={frag:e,part:t,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},i=r.byteRangeStartOffset,a=r.byteRangeEndOffset;if(b(i)&&b(a)){var o,s=i,l=a;if("initSegment"===e.sn&&"AES-128"===(null==(o=e.decryptdata)?void 0:o.method)){var u=a-i;u%16&&(l=a+(16-u%16)),0!==i&&(n.resetIV=!0,s=i-16)}n.rangeStart=s,n.rangeEnd=l}return n}function Gr(e,t){var r=new Error("GAP "+(e.gap?"tag":"attribute")+" found"),n={type:I.MEDIA_ERROR,details:w.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(n.part=t),(t||e).stats.aborted=!0,new Kr(n)}var Kr=function(e){function t(t){var r;return(r=e.call(this,t.error.message)||this).data=void 0,r.data=t,r}return l(t,e),t}(g(Error)),Hr=function(){function e(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}var t=e.prototype;return t.abort=function(e){for(var t in this.keyUriToKeyInfo){var r=this.keyUriToKeyInfo[t].loader;if(r){if(e&&e!==r.context.frag.type)return;r.abort()}}},t.detach=function(){for(var e in this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}},t.destroy=function(){for(var e in this.detach(),this.keyUriToKeyInfo){var t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}},t.createKeyLoadError=function(e,t,r,n,i){return void 0===t&&(t=w.KEY_LOAD_ERROR),new Kr({type:I.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:n})},t.loadClear=function(e,t){var r=this;if(this.emeController&&this.config.emeEnabled)for(var n=e.sn,i=e.cc,a=function(){var e=t[o];if(i<=e.cc&&("initSegment"===n||"initSegment"===e.sn||n<e.sn))return r.emeController.selectKeySystemFormat(e).then((function(t){e.setKeyFormat(t)})),"break"},o=0;o<t.length&&"break"!==a();o++);},t.load=function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)},t.loadInternal=function(e,t){var r,n;t&&e.setKeyFormat(t);var i=e.decryptdata;if(!i){var a=new Error(t?"Expected frag.decryptdata to be defined after setting format "+t:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,a))}var o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,new Error('Invalid key URI: "'+o+'"')));var s,l=this.keyUriToKeyInfo[o];if(null!=(r=l)&&r.decryptdata.key)return i.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(null!=(n=l)&&n.keyLoadPromise)switch(null==(s=l.mediaKeySessionContext)?void 0:s.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){return i.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:l}}))}switch(l=this.keyUriToKeyInfo[o]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,w.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'+i.method+'"')))}},t.loadKeyEME=function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n=this.emeController.loadKey(r);if(n)return(e.keyLoadPromise=n.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(t){throw e.keyLoadPromise=null,t}))}return Promise.resolve(r)},t.loadKeyHTTP=function(e,t){var r=this,i=this.config,a=new(0,i.loader)(i);return t.keyLoader=e.loader=a,e.keyLoadPromise=new Promise((function(o,s){var l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=i.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:function(e,t,n,i){var a=n.frag,l=n.keyInfo,u=n.url;if(!a.decryptdata||l!==r.keyUriToKeyInfo[u])return s(r.createKeyLoadError(a,w.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));l.decryptdata.key=a.decryptdata.key=new Uint8Array(e.data),a.keyLoader=null,l.loader=null,o({frag:a,keyInfo:l})},onError:function(e,i,a,o){r.resetLoader(i),s(r.createKeyLoadError(t,w.KEY_LOAD_ERROR,new Error("HTTP Error "+e.code+" loading key "+e.text),a,n({url:l.url,data:void 0},e)))},onTimeout:function(e,n,i){r.resetLoader(n),s(r.createKeyLoadError(t,w.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:function(e,n,i){r.resetLoader(n),s(r.createKeyLoadError(t,w.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};a.load(l,c,f)}))},t.resetLoader=function(e){var t=e.frag,r=e.keyInfo,n=e.url,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[n],i&&i.destroy()},e}(),Yr=function(){function e(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var t=e.prototype;return t.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},t.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},t.onHandlerDestroyed=function(){},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},t.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},t.doTick=function(){},e}(),Vr={length:0,start:function(){return 0},end:function(){return 0}},qr=function(){function e(){}return e.isBuffered=function(t,r){try{if(t)for(var n=e.getBuffered(t),i=0;i<n.length;i++)if(r>=n.start(i)&&r<=n.end(i))return!0}catch(e){}return!1},e.bufferInfo=function(t,r,n){try{if(t){var i,a=e.getBuffered(t),o=[];for(i=0;i<a.length;i++)o.push({start:a.start(i),end:a.end(i)});return this.bufferedInfo(o,r,n)}}catch(e){}return{len:0,start:r,end:r,nextStart:void 0}},e.bufferedInfo=function(e,t,r){t=Math.max(0,t),e.sort((function(e,t){var r=e.start-t.start;return r||t.end-e.end}));var n=[];if(r)for(var i=0;i<e.length;i++){var a=n.length;if(a){var o=n[a-1].end;e[i].start-o<r?e[i].end>o&&(n[a-1].end=e[i].end):n.push(e[i])}else n.push(e[i])}else n=e;for(var s,l=0,u=t,c=t,f=0;f<n.length;f++){var d=n[f].start,h=n[f].end;if(t+r>=d&&t<h)u=d,l=(c=h)-t;else if(t+r<d){s=d;break}}return{len:l,start:u||0,end:c||0,nextStart:s}},e.getBuffered=function(e){try{return e.buffered}catch(e){return M.log("failed to get media.buffered",e),Vr}},e}(),jr=function(e,t,r,n,i,a){void 0===n&&(n=0),void 0===i&&(i=-1),void 0===a&&(a=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=zr(),this.buffering={audio:zr(),video:zr(),audiovideo:zr()},this.level=e,this.sn=t,this.id=r,this.size=n,this.part=i,this.partial=a};function zr(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Wr(e,t){for(var r=null,n=0,i=e.length;n<i;n++){var a=e[n];if(a&&a.cc===t){r=a;break}}return r}function Xr(e,t,r){return!(!t.details||!(r.endCC>r.startCC||e&&e.cc<r.startCC))}function Qr(e,t,r){var n=e.fragments,i=t.fragments;if(i.length&&n.length){var a=Wr(n,i[0].cc);if(a&&(!a||a.startPTS))return a;M.log("No frag in previous level to align on")}else M.log("No fragments to align")}function Jr(e,t){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}function $r(e,t){for(var r=t.fragments,n=0,i=r.length;n<i;n++)Jr(r[n],e);t.fragmentHint&&Jr(t.fragmentHint,e),t.alignedSliding=!0}function en(e,t,r){t&&(tn(e,r,t),!r.alignedSliding&&t.details&&rn(r,t.details),r.alignedSliding||!t.details||r.skippedSegments||or(t.details,r))}function tn(e,t,r){if(Xr(e,r,t)){var n=Qr(r.details,t);n&&b(n.start)&&(M.log("Adjusting PTS using last level due to CC increase within current level "+t.url),$r(n.start,t))}}function rn(e,t){if(t.fragments.length&&e.hasProgramDateTime&&t.hasProgramDateTime){var r=t.fragments[0].programDateTime,n=e.fragments[0].programDateTime,i=(n-r)/1e3+t.fragments[0].start;i&&b(i)&&(M.log("Adjusting PTS using programDateTime delta "+(n-r)+"ms, sliding:"+i.toFixed(3)+" "+e.url+" "),$r(i,e))}}function nn(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,n=t.fragments;if(r.length&&n.length){var i=n[Math.round(n.length/2)-1],a=Wr(r,i.cc)||r[Math.round(r.length/2)-1],o=i.programDateTime,s=a.programDateTime;null!==o&&null!==s&&$r((s-o)/1e3-(a.start-i.start),e)}}}var an=function(){function e(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}return e.prototype.decrypt=function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)},e}(),on=function(){function e(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}return e.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},e}();function sn(e){var t=e.byteLength,r=t&&new DataView(e.buffer).getUint8(t-1);return r?ue(e,0,t-r):e}var ln=function(){function e(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var t=e.prototype;return t.uint8ArrayToUint32Array_=function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r},t.initTable=function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],f=s[3],d=new Uint32Array(256),h=0,g=0,p=0;for(p=0;p<256;p++)d[p]=p<128?p<<1:p<<1^283;for(p=0;p<256;p++){var m=g^g<<1^g<<2^g<<3^g<<4;m=m>>>8^255&m^99,e[h]=m,t[m]=h;var v=d[h],y=d[v],E=d[y],T=257*d[m]^16843008*m;n[h]=T<<24|T>>>8,i[h]=T<<16|T>>>16,a[h]=T<<8|T>>>24,o[h]=T,T=16843009*E^65537*y^257*v^16843008*h,l[m]=T<<24|T>>>8,u[m]=T<<16|T>>>16,c[m]=T<<8|T>>>24,f[m]=T,h?(h=v^d[d[d[E^v]]],g^=d[d[g]]):h=g=1}},t.expandKey=function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,o,s,l,u=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(u),f=this.invKeySchedule=new Uint32Array(u),d=this.sBox,h=this.rcon,g=this.invSubMix,p=g[0],m=g[1],v=g[2],y=g[3];for(a=0;a<u;a++)a<i?s=c[a]=t[a]:(l=s,a%i==0?(l=d[(l=l<<8|l>>>24)>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l],l^=h[a/i|0]<<24):i>6&&a%i==4&&(l=d[l>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l]),c[a]=s=(c[a-i]^l)>>>0);for(o=0;o<u;o++)a=u-o,l=3&o?c[a]:c[a-4],f[o]=o<4||a<=4?l:p[d[l>>>24]]^m[d[l>>>16&255]]^v[d[l>>>8&255]]^y[d[255&l]],f[o]=f[o]>>>0}},t.networkToHostOrderSwap=function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24},t.decrypt=function(e,t,r){for(var n,i,a,o,s,l,u,c,f,d,h,g,p,m,v=this.keySize+6,y=this.invKeySchedule,E=this.invSBox,T=this.invSubMix,_=T[0],S=T[1],A=T[2],b=T[3],R=this.uint8ArrayToUint32Array_(r),I=R[0],w=R[1],D=R[2],C=R[3],N=new Int32Array(e),L=new Int32Array(N.length),O=this.networkToHostOrderSwap;t<N.length;){for(f=O(N[t]),d=O(N[t+1]),h=O(N[t+2]),g=O(N[t+3]),s=f^y[0],l=g^y[1],u=h^y[2],c=d^y[3],p=4,m=1;m<v;m++)n=_[s>>>24]^S[l>>16&255]^A[u>>8&255]^b[255&c]^y[p],i=_[l>>>24]^S[u>>16&255]^A[c>>8&255]^b[255&s]^y[p+1],a=_[u>>>24]^S[c>>16&255]^A[s>>8&255]^b[255&l]^y[p+2],o=_[c>>>24]^S[s>>16&255]^A[l>>8&255]^b[255&u]^y[p+3],s=n,l=i,u=a,c=o,p+=4;n=E[s>>>24]<<24^E[l>>16&255]<<16^E[u>>8&255]<<8^E[255&c]^y[p],i=E[l>>>24]<<24^E[u>>16&255]<<16^E[c>>8&255]<<8^E[255&s]^y[p+1],a=E[u>>>24]<<24^E[c>>16&255]<<16^E[s>>8&255]<<8^E[255&l]^y[p+2],o=E[c>>>24]<<24^E[s>>16&255]<<16^E[l>>8&255]<<8^E[255&u]^y[p+3],L[t]=O(n^I),L[t+1]=O(o^w),L[t+2]=O(a^D),L[t+3]=O(i^C),I=f,w=d,D=h,C=g,t+=4}return L.buffer},e}(),un=16,cn=function(){function e(e,t){var r=(void 0===t?{}:t).removePKCS7Padding,n=void 0===r||r;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=n,n)try{var i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}var t=e.prototype;return t.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},t.isSync=function(){return this.useSoftware},t.flush=function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?sn(r):r},t.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},t.decrypt=function(e,t,r){var n=this;return this.useSoftware?new Promise((function(i,a){n.softwareDecrypt(new Uint8Array(e),t,r);var o=n.flush();o?i(o.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r)},t.softwareDecrypt=function(e,t,r){var n=this.currentIV,i=this.currentResult,a=this.remainderData;this.logOnce("JS AES decrypt"),a&&(e=qe(a,e),this.remainderData=null);var o=this.getValidChunk(e);if(!o.length)return null;n&&(r=n);var s=this.softwareDecrypter;s||(s=this.softwareDecrypter=new ln),s.expandKey(t);var l=i;return this.currentResult=s.decrypt(o.buffer,0,r),this.currentIV=ue(o,-16).buffer,l||null},t.webCryptoDecrypt=function(e,t,r){var n=this,i=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new on(i,t)),this.fastAesKey.expandKey().then((function(t){return i?(n.logOnce("WebCrypto AES decrypt"),new an(i,new Uint8Array(r)).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(i){return M.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+i.name+": "+i.message),n.onWebCryptoError(e,t,r)}))},t.onWebCryptoError=function(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);var n=this.flush();if(n)return n.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},t.getValidChunk=function(e){var t=e,r=e.length-e.length%un;return r!==e.length&&(t=ue(e,0,r),this.remainderData=ue(e,r)),t},t.logOnce=function(e){this.logEnabled&&(M.log("[decrypter]: "+e),this.logEnabled=!1)},e}(),fn={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+"-"+e.end(n).toFixed(3)+"]";return t}},dn={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},hn=function(e){function t(t,r,n,i,a){var o;return(o=e.call(this)||this).hls=void 0,o.fragPrevious=null,o.fragCurrent=null,o.fragmentTracker=void 0,o.transmuxer=null,o._state=dn.STOPPED,o.playlistType=void 0,o.media=null,o.mediaBuffer=null,o.config=void 0,o.bitrateTest=!1,o.lastCurrentTime=0,o.nextLoadPosition=0,o.startPosition=0,o.startTimeOffset=null,o.loadedmetadata=!1,o.retryDate=0,o.levels=null,o.fragmentLoader=void 0,o.keyLoader=void 0,o.levelLastLoaded=null,o.startFragRequested=!1,o.decrypter=void 0,o.initPTS=[],o.onvseeking=null,o.onvended=null,o.logPrefix="",o.log=void 0,o.warn=void 0,o.playlistType=a,o.logPrefix=i,o.log=M.log.bind(M,i+":"),o.warn=M.warn.bind(M,i+":"),o.hls=t,o.fragmentLoader=new Br(t.config),o.keyLoader=n,o.fragmentTracker=r,o.config=t.config,o.decrypter=new cn(t.config),t.on(R.MANIFEST_LOADED,o.onManifestLoaded,p(o)),o}l(t,e);var r=t.prototype;return r.doTick=function(){this.onTickEnd()},r.onTickEnd=function(){},r.startLoad=function(e){},r.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=dn.STOPPED},r._streamEnded=function(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;var r=t.partList;if(null!=r&&r.length){var n=r[r.length-1];return qr.isBuffered(this.media,n.start+n.duration/2)}var i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)},r.getLevelDetails=function(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details},r.onMediaAttached=function(e,t){var r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);var n=this.config;this.levels&&n.autoStartLoad&&this.state===dn.STOPPED&&this.startLoad(n.startPosition)},r.onMediaDetaching=function(){var e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},r.onMediaSeeking=function(){var e=this.config,t=this.fragCurrent,r=this.media,n=this.mediaBuffer,i=this.state,a=r?r.currentTime:0,o=qr.bufferInfo(n||r,a,e.maxBufferHole);if(this.log("media seeking to "+(b(a)?a.toFixed(3):a)+", state: "+i),this.state===dn.ENDED)this.resetLoadingState();else if(t){var s=e.maxFragLookUpTolerance,l=t.start-s,u=t.start+t.duration+s;if(!o.len||u<o.start||l>o.end){var c=a>u;(a<l||c)&&(c&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||o.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()},r.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},r.onManifestLoaded=function(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]},r.onHandlerDestroying=function(){this.stopLoad(),e.prototype.onHandlerDestroying.call(this)},r.onHandlerDestroyed=function(){this.state=dn.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,e.prototype.onHandlerDestroyed.call(this)},r.loadFragment=function(e,t,r){this._loadFragForPlayback(e,t,r)},r._loadFragForPlayback=function(e,t,r){var n=this,i=function(t){if(n.fragContextChanged(e))return n.warn("Fragment "+e.sn+(t.part?" p: "+t.part.index:"")+" of level "+e.level+" was dropped during download."),void n.fragmentTracker.removeFragment(e);e.stats.chunkCount++,n._handleFragmentLoadProgress(t)};this._doFragLoad(e,t,r,i).then((function(t){if(t){var r=n.state;n.fragContextChanged(e)?(r===dn.FRAG_LOADING||!n.fragCurrent&&r===dn.PARSING)&&(n.fragmentTracker.removeFragment(e),n.state=dn.IDLE):("payload"in t&&(n.log("Loaded fragment "+e.sn+" of level "+e.level),n.hls.trigger(R.FRAG_LOADED,t)),n._handleFragmentLoadComplete(t))}})).catch((function(t){n.state!==dn.STOPPED&&n.state!==dn.ERROR&&(n.warn(t),n.resetFragmentLoading(e))}))},r.clearTrackerIfNeeded=function(e){var t,r=this.fragmentTracker;if(r.getState(e)===Mr.APPENDING){var n=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,n),a=Math.max(e.duration,i?i.len:this.config.maxBufferLength);this.reduceMaxBufferLength(a)&&r.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Mr.PARTIAL&&r.removeFragment(e))},r.flushMainBuffer=function(e,t,r){if(void 0===r&&(r=null),e-t){var n={startOffset:e,endOffset:t,type:r};this.hls.trigger(R.BUFFER_FLUSHING,n)}},r._loadInitSegment=function(e,t){var r=this;this._doFragLoad(e,t).then((function(t){if(!t||r.fragContextChanged(e)||!r.levels)throw new Error("init load aborted");return t})).then((function(t){var n=r.hls,i=t.payload,a=e.decryptdata;if(i&&i.byteLength>0&&a&&a.key&&a.iv&&"AES-128"===a.method){var o=self.performance.now();return r.decrypter.decrypt(new Uint8Array(i),a.key.buffer,a.iv.buffer).catch((function(t){throw n.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t})).then((function(r){var i=self.performance.now();return n.trigger(R.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:o,tdecrypt:i}}),t.payload=r,t}))}return t})).then((function(n){var i=r.fragCurrent,a=r.hls;if(!r.levels)throw new Error("init load aborted, missing levels");var o=e.stats;r.state=dn.IDLE,t.fragmentError=0,e.data=new Uint8Array(n.payload),o.parsing.start=o.buffering.start=self.performance.now(),o.parsing.end=o.buffering.end=self.performance.now(),n.frag===i&&a.trigger(R.FRAG_BUFFERED,{stats:o,frag:i,part:null,id:e.type}),r.tick()})).catch((function(t){r.state!==dn.STOPPED&&r.state!==dn.ERROR&&(r.warn(t),r.resetFragmentLoading(e))}))},r.fragContextChanged=function(e){var t=this.fragCurrent;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId},r.fragBufferedComplete=function(e,t){var r,n,i,a,o=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+e.type+" sn: "+e.sn+(t?" part: "+t.index:"")+" of "+(this.playlistType===Lt.MAIN?"level":"track")+" "+e.level+" (frag:["+(null!=(r=e.startPTS)?r:NaN).toFixed(3)+"-"+(null!=(n=e.endPTS)?n:NaN).toFixed(3)+"] > buffer:"+(o?fn.toString(qr.getBuffered(o)):"(detached)")+")"),this.state=dn.IDLE,o&&(!this.loadedmetadata&&e.type==Lt.MAIN&&o.buffered.length&&(null==(i=this.fragCurrent)?void 0:i.sn)===(null==(a=this.fragPrevious)?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},r.seekToStartPos=function(){},r._handleFragmentLoadComplete=function(e){var t=this.transmuxer;if(t){var r=e.frag,n=e.part,i=e.partsLoaded,a=!i||0===i.length||i.some((function(e){return!e})),o=new jr(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!a);t.flush(o)}},r._handleFragmentLoadProgress=function(e){},r._doFragLoad=function(e,t,r,n){var i,a=this;void 0===r&&(r=null);var o=null==t?void 0:t.details;if(!this.levels||!o)throw new Error("frag load aborted, missing level"+(o?"":" detail")+"s");var s=null;if(!e.encrypted||null!=(i=e.decryptdata)&&i.key?!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments):(this.log("Loading key for "+e.sn+" of ["+o.startSN+"-"+o.endSN+"], "+("[stream-controller]"===this.logPrefix?"level":"track")+" "+e.level),this.state=dn.KEY_LOADING,this.fragCurrent=e,s=this.keyLoader.load(e).then((function(e){if(!a.fragContextChanged(e.frag))return a.hls.trigger(R.KEY_LOADED,e),a.state===dn.KEY_LOADING&&(a.state=dn.IDLE),e})),this.hls.trigger(R.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(s=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){var l=o.partList;if(l&&n){r>e.end&&o.fragmentHint&&(e=o.fragmentHint);var u=this.getNextPart(l,e,r);if(u>-1){var c,f=l[u];return this.log("Loading part sn: "+e.sn+" p: "+f.index+" cc: "+e.cc+" of playlist ["+o.startSN+"-"+o.endSN+"] parts [0-"+u+"-"+(l.length-1)+"] "+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),this.nextLoadPosition=f.start+f.duration,this.state=dn.FRAG_LOADING,c=s?s.then((function(r){return!r||a.fragContextChanged(r.frag)?null:a.doFragPartsLoad(e,f,t,n)})).catch((function(e){return a.handleFragLoadError(e)})):this.doFragPartsLoad(e,f,t,n).catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(R.FRAG_LOADING,{frag:e,part:f,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):c}if(!e.url||this.loadedEndOfParts(l,r))return Promise.resolve(null)}}this.log("Loading fragment "+e.sn+" cc: "+e.cc+" "+(o?"of ["+o.startSN+"-"+o.endSN+"] ":"")+("[stream-controller]"===this.logPrefix?"level":"track")+": "+e.level+", target: "+parseFloat(r.toFixed(3))),b(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=dn.FRAG_LOADING;var d,h=this.config.progressive;return d=h&&s?s.then((function(t){return!t||a.fragContextChanged(null==t?void 0:t.frag)?null:a.fragmentLoader.load(e,n)})).catch((function(e){return a.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,h?n:void 0),s]).then((function(e){var t=e[0];return!h&&t&&n&&n(t),t})).catch((function(e){return a.handleFragLoadError(e)})),this.hls.trigger(R.FRAG_LOADING,{frag:e,targetBufferTime:r}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):d},r.doFragPartsLoad=function(e,t,r,n){var i=this;return new Promise((function(a,o){var s,l=[],u=null==(s=r.details)?void 0:s.partList;!function t(s){i.fragmentLoader.loadPart(e,s,n).then((function(n){l[s.index]=n;var o=n.part;i.hls.trigger(R.FRAG_LOADED,n);var c=cr(r,e.sn,s.index+1)||fr(u,e.sn,s.index+1);if(!c)return a({frag:e,part:o,partsLoaded:l});t(c)})).catch(o)}(t)}))},r.handleFragLoadError=function(e){if("data"in e){var t=e.data;e.data&&t.details===w.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(R.ERROR,t)}else this.hls.trigger(R.ERROR,{type:I.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null},r._handleTransmuxerFlush=function(e){var t=this.getCurrentContext(e);if(t&&this.state===dn.PARSING){var r=t.frag,n=t.part,i=t.level,a=self.performance.now();r.stats.parsing.end=a,n&&(n.stats.parsing.end=a),this.updateLevelTiming(r,n,i,e.partial)}else this.fragCurrent||this.state===dn.STOPPED||this.state===dn.ERROR||(this.state=dn.IDLE)},r.getCurrentContext=function(e){var t=this.levels,r=this.fragCurrent,n=e.level,i=e.sn,a=e.part;if(null==t||!t[n])return this.warn("Levels object was unset while buffering fragment "+i+" of level "+n+". The current chunk will not be buffered."),null;var o=t[n],s=a>-1?cr(o,i,a):null,l=s?s.fragment:ur(o,i,r);return l?(r&&r!==l&&(l.stats=r.stats),{frag:l,part:s,level:o}):null},r.bufferFragmentData=function(e,t,r,n,i){var a;if(e&&this.state===dn.PARSING){var o=e.data1,s=e.data2,l=o;if(o&&s&&(l=qe(o,s)),null!=(a=l)&&a.length){var u={type:e.type,frag:t,part:r,chunkMeta:n,parent:t.type,data:l};if(this.hls.trigger(R.BUFFER_APPENDING,u),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}}},r.flushBufferGap=function(e){var t=this.media;if(t)if(qr.isBuffered(t,t.currentTime)){var r=t.currentTime,n=qr.bufferInfo(t,r,0),i=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),o=Math.max(Math.min(e.start-a,n.end-a),r+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}else this.flushMainBuffer(0,e.start)},r.getFwdBufferInfo=function(e,t){var r=this.getLoadPosition();return b(r)?this.getFwdBufferInfoAtPos(e,r,t):null},r.getFwdBufferInfoAtPos=function(e,t,r){var n=this.config.maxBufferHole,i=qr.bufferInfo(e,t,n);if(0===i.len&&void 0!==i.nextStart){var a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&i.nextStart<a.end)return qr.bufferInfo(e,t,Math.max(i.nextStart,n))}return i},r.getMaxBufferLength=function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)},r.reduceMaxBufferLength=function(e){var t=this.config,r=e||t.maxBufferLength;return t.maxMaxBufferLength>=r&&(t.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},r.getAppendedFrag=function(e,t){var r=this.fragmentTracker.getAppendedFrag(e,Lt.MAIN);return r&&"fragment"in r?r.fragment:r},r.getNextFragment=function(e,t){var r=t.fragments,n=r.length;if(!n)return null;var i,a=this.config,o=r[0].start;if(t.live){var s=a.initialLiveManifestSize;if(n<s)return this.warn("Not enough fragments to start playback (have: "+n+", need: "+s+")"),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(i=this.getInitialLiveFragment(t,r),this.startPosition=i?this.hls.liveSyncPosition||i.start:e)}else e<=o&&(i=r[0]);if(!i){var l=a.lowLatencyMode?t.partEnd:t.fragmentEnd;i=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(i)},r.isLoopLoading=function(e,t){var r=this.fragmentTracker.getState(e);return(r===Mr.OK||r===Mr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t},r.getNextFragmentLoopLoading=function(e,t,r,n,i){var a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(null===o)return o;if(e=o,a&&e&&!e.gap&&r.nextStart){var s=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n);if(null!==s&&r.len+s.len>=i)return this.log('buffer full after gaps in "'+n+'" playlist starting at sn: '+e.sn),null}return e},r.mapToInitFragWhenRequired=function(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment},r.getNextPart=function(e,t,r){for(var n=-1,i=!1,a=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(a=a&&!l.independent,n>-1&&r<l.start)break;var u=l.loaded;u?n=-1:(i||l.independent||a)&&l.fragment===t&&(n=o),i=u}return n},r.loadedEndOfParts=function(e,t){var r=e[e.length-1];return r&&t>r.start&&r.loaded},r.getInitialLiveFragment=function(e,t){var r=this.fragPrevious,n=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+r.programDateTime),n=Er(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){var a=t[i-e.startSN];r.cc===a.cc&&(n=a,this.log("Live playlist, switching playlist, load frag with next SN: "+n.sn))}n||(n=Ar(t,r.cc))&&this.log("Live playlist, switching playlist, load frag with same CC: "+n.sn)}}else{var o=this.hls.liveSyncPosition;null!==o&&(n=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n},r.getFragmentAtPosition=function(e,t,r){var n,i=this.config,a=this.fragPrevious,o=r.fragments,s=r.endSN,l=r.fragmentHint,u=i.maxFragLookUpTolerance,c=r.partList,f=!!(i.lowLatencyMode&&null!=c&&c.length&&l);if(f&&l&&!this.bitrateTest&&(o=o.concat(l),s=l.sn),n=e<t?Tr(a,o,e,e>t-u?0:u):o[o.length-1]){var d=n.sn-r.startSN,h=this.fragmentTracker.getState(n);if((h===Mr.OK||h===Mr.PARTIAL&&n.gap)&&(a=n),a&&n.sn===a.sn&&(!f||c[0].fragment.sn>n.sn)&&a&&n.level===a.level){var g=o[d+1];n=n.sn<s&&this.fragmentTracker.getState(g)!==Mr.OK?g:null}}return n},r.synchronizeToLiveEdge=function(e){var t=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,i=r.currentTime,a=e.fragments[0].start,o=e.edge,s=i>=a-t.maxFragLookUpTolerance&&i<=o;if(null!==n&&r.duration>n&&(i<n||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!s&&r.readyState<4||i<o-l)&&(this.loadedmetadata||(this.nextLoadPosition=n),r.readyState&&(this.warn("Playback: "+i.toFixed(3)+" is located too far from the end of live sliding playlist: "+o+", reset currentTime to : "+n.toFixed(3)),r.currentTime=n))}}},r.alignPlaylists=function(e,t){var r=this.levels,n=this.levelLastLoaded,i=this.fragPrevious,a=null!==n?r[n]:null,o=e.fragments.length;if(!o)return this.warn("No fragments in live playlist"),0;var s=e.fragments[0].start,l=!t,u=e.alignedSliding&&b(s);if(l||!u&&!s){en(i,a,e);var c=e.fragments[0].start;return this.log("Live playlist sliding: "+c.toFixed(2)+" start-sn: "+(t?t.startSN:"na")+"->"+e.startSN+" prev-sn: "+(i?i.sn:"na")+" fragments: "+o),c}return s},r.waitForCdnTuneIn=function(e){var t=3;return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*t)},r.setStartPosition=function(e,t){var r=this.startPosition;if(r<t&&(r=-1),-1===r||-1===this.lastCurrentTime){var n=null!==this.startTimeOffset,i=n?this.startTimeOffset:e.startTimeOffset;null!==i&&b(i)?(r=t+i,i<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Start time offset "+i+" found in "+(n?"multivariant":"media")+" playlist, adjust startPosition to "+r),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r},r.getLoadPosition=function(){var e=this.media,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t},r.handleFragLoadAborted=function(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn("Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" was aborted"),this.resetFragmentLoading(e))},r.resetFragmentLoading=function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===dn.FRAG_LOADING_WAITING_RETRY)||(this.state=dn.IDLE)},r.onFragmentOrKeyLoadError=function(e,t){if(t.chunkMeta&&!t.frag){var r=this.getCurrentContext(t.chunkMeta);r&&(t.frag=r.frag)}var n=t.frag;if(n&&n.type===e&&this.levels)if(this.fragContextChanged(n)){var i;this.warn("Frag load error must match current frag to retry "+n.url+" > "+(null==(i=this.fragCurrent)?void 0:i.url))}else{var a=t.details===w.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(n,!0);var o=t.errorAction,s=o||{},l=s.action,u=s.retryCount,c=void 0===u?0:u,f=s.retryConfig;if(o&&l===Rr.RetryRequest&&f){var d;this.resetStartWhenNotLoaded(null!=(d=this.levelLastLoaded)?d:n.level);var h=gr(f,c);this.warn("Fragment "+n.sn+" of "+e+" "+n.level+" errored with "+t.details+", retrying loading "+(c+1)+"/"+f.maxNumRetry+" in "+h+"ms"),o.resolved=!0,this.retryDate=self.performance.now()+h,this.state=dn.FRAG_LOADING_WAITING_RETRY}else f&&o?(this.resetFragmentErrors(e),c<f.maxNumRetry?a||(o.resolved=!0):M.warn(t.details+" reached or exceeded max retry ("+c+")")):(null==o?void 0:o.action)===Rr.SendAlternateToPenaltyBox?this.state=dn.WAITING_LEVEL:this.state=dn.ERROR;this.tickImmediate()}},r.reduceLengthAndFlushBuffer=function(e){if(this.state===dn.PARSING||this.state===dn.PARSED){var t=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,t),n=r&&r.len>.5;n&&this.reduceMaxBufferLength(r.len);var i=!n;return i&&this.warn("Buffer full error while media.currentTime is not buffered, flush "+t+" buffer"),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),i}return!1},r.resetFragmentErrors=function(e){e===Lt.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==dn.STOPPED&&(this.state=dn.IDLE)},r.afterBufferFlushed=function(e,t,r){if(e){var n=qr.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===dn.ENDED&&this.resetLoadingState()}},r.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=dn.IDLE},r.resetStartWhenNotLoaded=function(e){if(!this.loadedmetadata){this.startFragRequested=!1;var t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},r.resetWhenMissingContext=function(e){var t;this.warn("The loading context changed while buffering fragment "+e.sn+" of level "+e.level+". This chunk will not be buffered."),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()},r.removeUnbufferedFrags=function(e){void 0===e&&(e=0),this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)},r.updateLevelTiming=function(e,t,r,n){var i,a=this,o=r.details;if(o){if(Object.keys(e.elementaryStreams).reduce((function(t,i){var s=e.elementaryStreams[i];if(s){var l=s.endPTS-s.startPTS;if(l<=0)return a.warn("Could not parse fragment "+e.sn+" "+i+" duration reliably ("+l+")"),t||!1;var u=n?0:tr(o,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return a.hls.trigger(R.LEVEL_PTS_UPDATED,{details:o,level:r,drift:u,type:i,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1))r.fragmentError=0;else if(null===(null==(i=this.transmuxer)?void 0:i.error)){var s=new Error("Found no media in fragment "+e.sn+" of level "+e.level+" resetting transmuxer to fallback to playlist timing");if(0===r.fragmentError&&(r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(s.message),this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:s,frag:e,reason:"Found no media in msn "+e.sn+' of level "'+r.url+'"'}),!this.hls)return;this.resetTransmuxer()}this.state=dn.PARSED,this.hls.trigger(R.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")},r.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},r.recoverWorkerError=function(e){var t,r,n;"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(r=this.levelLastLoaded)?r:null==(n=this.fragCurrent)?void 0:n.level)?t:0),this.resetLoadingState())},a(t,[{key:"state",get:function(){return this._state},set:function(e){var t=this._state;t!==e&&(this._state=e,this.log(t+"->"+e))}}]),t}(Yr);function gn(){return self.SourceBuffer||self.WebKitSourceBuffer}function pn(){var e=ft();if(!e)return!1;var t=gn(),r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!n}function mn(){var e,t=gn();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}function vn(e,t){return void 0===e&&(e=""),void 0===t&&(t=9e4),{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var yn=function(){function e(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var t=e.prototype;return t.resetInitSegment=function(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},t.resetTimeStamp=function(e){this.initPTS=e,this.resetContiguity()},t.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},t.canParse=function(e,t){return!1},t.appendFrame=function(e,t,r){},t.demux=function(e,t){this.cachedData&&(e=qe(this.cachedData,e),this.cachedData=null);var r,n=he(e,0),i=n?n.length:0,a=this._audioTrack,o=this._id3Track,s=n?me(n):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&b(s))&&(this.basePTS=En(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Gt.audioId3,duration:Number.POSITIVE_INFINITY});i<l;){if(this.canParse(e,i)){var u=this.appendFrame(a,e,i);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=i+=u.length):i=l}else pe(e,i)?(n=he(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Gt.audioId3,duration:Number.POSITIVE_INFINITY}),r=i+=n.length):i++;if(i===l&&r!==l){var c=ue(e,r);this.cachedData?this.cachedData=qe(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:vn(),id3Track:o,textTrack:vn()}},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},t.flush=function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:vn(),id3Track:this._id3Track,textTrack:vn()}},t.destroy=function(){},e}(),En=function(e,t,r){return b(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)};function Tn(e,t,r,n){var i,a,o,s,l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=1+((192&t[r+2])>>>6);var f=(60&t[r+2])>>>2;if(!(f>c.length-1))return o=(1&t[r+2])<<2,o|=(192&t[r+3])>>>6,M.log("manifest codec:"+n+", ADTS type:"+i+", samplingIndex:"+f),/firefox/i.test(l)?f>=6?(i=5,s=new Array(4),a=f-3):(i=2,s=new Array(2),a=f):-1!==l.indexOf("android")?(i=2,s=new Array(2),a=f):(i=5,s=new Array(4),n&&(-1!==n.indexOf("mp4a.40.29")||-1!==n.indexOf("mp4a.40.5"))||!n&&f>=6?a=f-3:((n&&-1!==n.indexOf("mp4a.40.2")&&(f>=6&&1===o||/vivaldi/i.test(l))||!n&&1===o)&&(i=2,s=new Array(2)),a=f)),s[0]=i<<3,s[0]|=(14&f)>>1,s[1]|=(1&f)<<7,s[1]|=o<<3,5===i&&(s[1]|=(14&a)>>1,s[2]=(1&a)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:c[f],channelCount:o,codec:"mp4a.40."+i,manifestCodec:u};e.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+f})}function _n(e,t){return 255===e[t]&&240==(246&e[t+1])}function Sn(e,t){return 1&e[t+1]?7:9}function An(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function bn(e,t){return t+5<e.length}function Rn(e,t){return t+1<e.length&&_n(e,t)}function In(e,t){return bn(e,t)&&_n(e,t)&&An(e,t)<=e.length-t}function wn(e,t){if(Rn(e,t)){var r=Sn(e,t);if(t+r>=e.length)return!1;var n=An(e,t);if(n<=r)return!1;var i=t+n;return i===e.length||Rn(e,i)}return!1}function Dn(e,t,r,n,i){if(!e.samplerate){var a=Tn(t,r,n,i);if(!a)return;e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,M.log("parsed codec:"+e.codec+", rate:"+a.samplerate+", channels:"+a.channelCount)}}function Cn(e){return 9216e4/e}function Nn(e,t){var r=Sn(e,t);if(t+r<=e.length){var n=An(e,t)-r;if(n>0)return{headerLength:r,frameLength:n}}}function Ln(e,t,r,n,i){var a,o=n+i*Cn(e.samplerate),s=Nn(t,r);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,f=Math.max(0,r+c-t.length);f?(a=new Uint8Array(c-u)).set(t.subarray(r+u,t.length),0):a=t.subarray(r+u,r+c);var d={unit:a,pts:o};return f||e.samples.push(d),{sample:d,length:c,missing:f}}var h=t.length-r;return(a=new Uint8Array(h)).set(t.subarray(r,t.length),0),{sample:{unit:a,pts:o},length:h,missing:-1}}var On=function(e){function t(t,r){var n;return(n=e.call(this)||this).observer=void 0,n.config=void 0,n.observer=t,n.config=r,n}l(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,i){e.prototype.resetInitSegment.call(this,t,r,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:i,inputTimeScale:9e4,dropped:0}},t.probe=function(e){if(!e)return!1;for(var t=(he(e,0)||[]).length,r=e.length;t<r;t++)if(wn(e,t))return M.log("ADTS sync word found !"),!0;return!1},r.canParse=function(e,t){return In(e,t)},r.appendFrame=function(e,t,r){Dn(e,this.observer,t,r,e.manifestCodec);var n=Ln(e,t,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n},t}(yn),Pn=/\/emsg[-/]ID3/i,Mn=function(){function e(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}var t=e.prototype;return t.resetTimeStamp=function(){},t.resetInitSegment=function(e,t,r,n){var i=this.videoTrack=vn("video",1),a=this.audioTrack=vn("audio",1),o=this.txtTrack=vn("text",1);if(this.id3Track=vn("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var s=Ue(e);if(s.video){var l=s.video,u=l.id,c=l.timescale,f=l.codec;i.id=u,i.timescale=o.timescale=c,i.codec=f}if(s.audio){var d=s.audio,h=d.id,g=d.timescale,p=d.codec;a.id=h,a.timescale=g,a.codec=p}o.id=Ne.text,i.sampleDuration=0,i.duration=a.duration=n}},t.resetContiguity=function(){this.remainderData=null},e.probe=function(e){return xe(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0},t.demux=function(e,t){this.timeOffset=t;var r=e,n=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=qe(this.remainderData,e));var a=Ve(r);this.remainderData=a.remainder,n.samples=a.valid||new Uint8Array}else n.samples=r;var o=this.extractID3Track(n,t);return i.samples=je(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}},t.flush=function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var n=this.extractID3Track(t,this.timeOffset);return r.samples=je(e,t),{videoTrack:t,audioTrack:vn(),id3Track:n,textTrack:vn()}},t.extractID3Track=function(e,t){var r=this.id3Track;if(e.samples.length){var n=xe(e.samples,["emsg"]);n&&n.forEach((function(e){var n=Je(e);if(Pn.test(n.schemeIdUri)){var i=b(n.presentationTime)?n.presentationTime/n.timeScale:t+n.presentationTimeDelta/n.timeScale,a=4294967295===n.eventDuration?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;a<=.001&&(a=Number.POSITIVE_INFINITY);var o=n.payload;r.samples.push({data:o,len:o.byteLength,dts:i,pts:i,type:Gt.emsg,duration:a})}}))}return r},t.demuxSampleAes=function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},t.destroy=function(){},e}(),kn=null,xn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Fn=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Un=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Bn=[0,1,1,4];function Zn(e,t,r,n,i){if(!(r+24>t.length)){var a=Gn(t,r);if(a&&r+a.frameLength<=t.length){var o=n+i*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(r,r+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),{sample:s,length:a.frameLength,missing:0}}}}function Gn(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,i=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==r&&0!==i&&15!==i&&3!==a){var o=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*xn[14*(3===r?3-n:3===n?3:4)+i-1],u=Fn[3*(3===r?0:2===r?1:2)+a],c=3===s?1:2,f=Un[r][n],d=Bn[n],h=8*f*d,g=Math.floor(f*l/u+o)*d;if(null===kn){var p=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);kn=p?parseInt(p[1]):0}return!!kn&&kn<=87&&2===n&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:g,samplesPerFrame:h}}}function Kn(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function Hn(e,t){return t+1<e.length&&Kn(e,t)}function Yn(e,t){var r=4;return Kn(e,t)&&r<=e.length-t}function Vn(e,t){if(t+1<e.length&&Kn(e,t)){var r=4,n=Gn(e,t),i=r;null!=n&&n.frameLength&&(i=n.frameLength);var a=t+i;return a===e.length||Hn(e,a)}return!1}var qn=function(){function e(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}var t=e.prototype;return t.loadWord=function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i},t.skipBits=function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)},t.readBits=function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&M.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r},t.skipLZ=function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()},t.skipUEG=function(){this.skipBits(1+this.skipLZ())},t.skipEG=function(){this.skipBits(1+this.skipLZ())},t.readUEG=function(){var e=this.skipLZ();return this.readBits(e+1)-1},t.readEG=function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)},t.readBoolean=function(){return 1===this.readBits(1)},t.readUByte=function(){return this.readBits(8)},t.readUShort=function(){return this.readBits(16)},t.readUInt=function(){return this.readBits(32)},t.skipScalingList=function(e){for(var t=8,r=8,n=0;n<e;n++)0!==r&&(r=(t+this.readEG()+256)%256),t=0===r?t:r},t.readSPS=function(){var e,t,r,n=0,i=0,a=0,o=0,s=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),f=this.skipBits.bind(this),d=this.skipEG.bind(this),h=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);s();var p=s();if(l(5),f(3),s(),h(),100===p||110===p||122===p||244===p||44===p||83===p||86===p||118===p||128===p){var m=u();if(3===m&&f(1),h(),h(),f(1),c())for(t=3!==m?8:12,r=0;r<t;r++)c()&&g(r<6?16:64)}h();var v=u();if(0===v)u();else if(1===v)for(f(1),d(),d(),e=u(),r=0;r<e;r++)d();h(),f(1);var y=u(),E=u(),T=l(1);0===T&&f(1),f(1),c()&&(n=u(),i=u(),a=u(),o=u());var _=[1,1];if(c()&&c())switch(s()){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[s()<<8|s(),s()<<8|s()]}return{width:Math.ceil(16*(y+1)-2*n-2*i),height:(2-T)*(E+1)*16-(T?2:4)*(a+o),pixelRatio:_}},t.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},e}(),jn=function(){function e(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new cn(t,{removePKCS7Padding:!1})}var t=e.prototype;return t.decryptBuffer=function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)},t.decryptAacSample=function(e,t,r){var n=this,i=e[t].unit;if(!(i.length<=16)){var a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(o).then((function(a){var o=new Uint8Array(a);i.set(o,16),n.decrypter.isSync()||n.decryptAacSamples(e,t+1,r)}))}},t.decryptAacSamples=function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32||(this.decryptAacSample(e,t,r),this.decrypter.isSync())))return}},t.getAvcEncryptedData=function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r},t.getAvcDecryptedUnit=function(e,t){for(var r=new Uint8Array(t),n=0,i=32;i<e.length-16;i+=160,n+=16)e.set(r.subarray(n,n+16),i);return e},t.decryptAvcSample=function(e,t,r,n,i){var a=this,o=Qe(i.data),s=this.getAvcEncryptedData(o);this.decryptBuffer(s.buffer).then((function(s){i.data=a.getAvcDecryptedUnit(o,s),a.decrypter.isSync()||a.decryptAvcSamples(e,t,r+1,n)}))},t.decryptAvcSamples=function(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type||(this.decryptAvcSample(e,t,r,n,a),this.decrypter.isSync())))return}}},e}(),zn=188,Wn=function(){function e(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=r}e.probe=function(t){var r=e.syncOffset(t);return r>0&&M.warn("MPEG2-TS detected but first sync word found @ offset "+r),-1!==r},e.syncOffset=function(e){for(var t=e.length,r=Math.min(5*zn,e.length-zn)+1,n=0;n<r;){for(var i=!1,a=-1,o=0,s=n;s<t;s+=zn){if(71!==e[s]){if(o)return-1;break}if(o++,-1===a&&0!==(a=s)&&(r=Math.min(a+99*zn,e.length-zn)+1),i||(i=0===Qn(e,s)),i&&o>1&&(0===a&&o>2||s+zn>r))return a}n++}return-1},e.createTrack=function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Ne[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}};var t=e.prototype;return t.resetInitSegment=function(t,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=e.createTrack("video"),this._audioTrack=e.createTrack("audio",i),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n,this._duration=i},t.resetTimeStamp=function(){},t.resetContiguity=function(){var e=this._audioTrack,t=this._avcTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},t.demux=function(t,r,n,i){var a;void 0===n&&(n=!1),void 0===i&&(i=!1),n||(this.sampleAes=null);var o=this._avcTrack,s=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=o.pid,f=o.pesData,d=s.pid,h=l.pid,g=s.pesData,p=l.pesData,m=null,v=this.pmtParsed,y=this._pmtId,E=t.length;if(this.remainderData&&(E=(t=qe(this.remainderData,t)).length,this.remainderData=null),E<zn&&!i)return this.remainderData=t,{audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};var T=Math.max(0,e.syncOffset(t));(E-=(E-T)%zn)<t.byteLength&&!i&&(this.remainderData=new Uint8Array(t.buffer,E,t.buffer.byteLength-E));for(var _=0,S=T;S<E;S+=zn)if(71===t[S]){var A=!!(64&t[S+1]),b=Qn(t,S),D=void 0;if((48&t[S+3])>>4>1){if((D=S+5+t[S+4])===S+zn)continue}else D=S+4;switch(b){case c:A&&(f&&(a=ei(f))&&this.parseAVCPES(o,u,a,!1),f={data:[],size:0}),f&&(f.data.push(t.subarray(D,S+zn)),f.size+=S+zn-D);break;case d:if(A){if(g&&(a=ei(g)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,a);break;case"mp3":this.parseMPEGPES(s,a)}g={data:[],size:0}}g&&(g.data.push(t.subarray(D,S+zn)),g.size+=S+zn-D);break;case h:A&&(p&&(a=ei(p))&&this.parseID3PES(l,a),p={data:[],size:0}),p&&(p.data.push(t.subarray(D,S+zn)),p.size+=S+zn-D);break;case 0:A&&(D+=t[D]+1),y=this._pmtId=Jn(t,D);break;case y:A&&(D+=t[D]+1);var C=$n(t,D,this.typeSupported,n);(c=C.avc)>0&&(o.pid=c),(d=C.audio)>0&&(s.pid=d,s.segmentCodec=C.segmentCodec),(h=C.id3)>0&&(l.pid=h),null===m||v||(M.warn("MPEG-TS PMT found at "+S+" after unknown PID '"+m+"'. Backtracking to sync byte @"+T+" to parse all TS packets."),m=null,S=T-188),v=this.pmtParsed=!0;break;case 17:case 8191:break;default:m=b}}else _++;if(_>0){var N=new Error("Found "+_+" TS packet/s that do not start with 0x47");this.observer.emit(R.ERROR,R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:N,reason:N.message})}o.pesData=f,s.pesData=g,l.pesData=p;var L={audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};return i&&this.extractRemainingSamples(L),L},t.flush=function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e},t.extractRemainingSamples=function(e){var t,r=e.audioTrack,n=e.videoTrack,i=e.id3Track,a=e.textTrack,o=n.pesData,s=r.pesData,l=i.pesData;if(o&&(t=ei(o))?(this.parseAVCPES(n,a,t,!0),n.pesData=null):n.pesData=o,s&&(t=ei(s))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t)}r.pesData=null}else null!=s&&s.size&&M.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=s;l&&(t=ei(l))?(this.parseID3PES(i,t),i.pesData=null):i.pesData=l},t.demuxSampleAes=function(e,t,r){var n=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new jn(this.observer,this.config,t);return this.decrypt(n,i)},t.decrypt=function(e,t){return new Promise((function(r){var n=e.audioTrack,i=e.videoTrack;n.samples&&"aac"===n.segmentCodec?t.decryptAacSamples(n.samples,0,(function(){i.samples?t.decryptAvcSamples(i.samples,0,0,(function(){r(e)})):r(e)})):i.samples&&t.decryptAvcSamples(i.samples,0,0,(function(){r(e)}))}))},t.destroy=function(){this._duration=0},t.parseAVCPES=function(e,t,r,n){var i,a=this,o=this.parseAVCNALu(e,r.data),s=this.avcSample,l=!1;r.data=null,s&&o.length&&!e.audFound&&(ti(s,e),s=this.avcSample=Xn(!1,r.pts,r.dts,"")),o.forEach((function(n){var o;switch(n.type){case 1:var u=!1;i=!0;var c,f=n.data;if(l&&f.length>4){var d=new qn(f).readSliceType();2!==d&&4!==d&&7!==d&&9!==d||(u=!0)}u&&null!=(c=s)&&c.frame&&!s.key&&(ti(s,e),s=a.avcSample=null),s||(s=a.avcSample=Xn(!0,r.pts,r.dts,"")),s.frame=!0,s.key=u;break;case 5:i=!0,null!=(o=s)&&o.frame&&!s.key&&(ti(s,e),s=a.avcSample=null),s||(s=a.avcSample=Xn(!0,r.pts,r.dts,"")),s.key=!0,s.frame=!0;break;case 6:i=!0,Xe(n.data,1,r.pts,t.samples);break;case 7:if(i=!0,l=!0,!e.sps){var h=n.data,g=new qn(h).readSPS();e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.sps=[h],e.duration=a._duration;for(var p=h.subarray(1,4),m="avc1.",v=0;v<3;v++){var y=p[v].toString(16);y.length<2&&(y="0"+y),m+=y}e.codec=m}break;case 8:i=!0,e.pps||(e.pps=[n.data]);break;case 9:i=!1,e.audFound=!0,s&&ti(s,e),s=a.avcSample=Xn(!1,r.pts,r.dts,"");break;case 12:i=!0;break;default:i=!1,s&&(s.debug+="unknown NAL "+n.type+" ")}s&&i&&s.units.push(n)})),n&&s&&(ti(s,e),this.avcSample=null)},t.getLastNalUnit=function(e){var t,r,n=this.avcSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(t=n)&&t.units){var i=n.units;r=i[i.length-1]}return r},t.parseAVCNALu=function(e,t){var r,n,i=t.byteLength,a=e.naluState||0,o=a,s=[],l=0,u=-1,c=0;for(-1===a&&(u=0,c=31&t[0],a=0,l=1);l<i;)if(r=t[l++],a)if(1!==a)if(r)if(1===r){if(u>=0){var f={data:t.subarray(u,l-a-1),type:c};s.push(f)}else{var d=this.getLastNalUnit(e.samples);if(d&&(o&&l<=4-o&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-o)),(n=l-a-1)>0)){var h=new Uint8Array(d.data.byteLength+n);h.set(d.data,0),h.set(t.subarray(0,n),d.data.byteLength),d.data=h,d.state=0}}l<i?(u=l,c=31&t[l],a=0):a=-1}else a=0;else a=3;else a=r?0:2;else a=r?0:1;if(u>=0&&a>=0){var g={data:t.subarray(u,i),type:c,state:a};s.push(g)}if(0===s.length){var p=this.getLastNalUnit(e.samples);if(p){var m=new Uint8Array(p.data.byteLength+t.byteLength);m.set(p.data,0),m.set(t,p.data.byteLength),p.data=m}}return e.naluState=a,s},t.parseAACPES=function(e,t){var r,n,i,a=0,o=this.aacOverFlow,s=t.data;if(o){this.aacOverFlow=null;var l=o.missing,u=o.sample.unit.byteLength;if(-1===l){var c=new Uint8Array(u+s.byteLength);c.set(o.sample.unit,0),c.set(s,u),s=c}else{var f=u-l;o.sample.unit.set(s.subarray(0,l),f),e.samples.push(o.sample),a=o.missing}}for(r=a,n=s.length;r<n-1&&!Rn(s,r);r++);if(r!==a){var d,h=r<n-1;d=h?"AAC PES did not start with ADTS header,offset:"+r:"No ADTS header found in AAC PES";var g=new Error(d);if(M.warn("parsing error: "+d),this.observer.emit(R.ERROR,R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,levelRetry:h,error:g,reason:d}),!h)return}if(Dn(e,this.observer,s,r,this.audioCodec),void 0!==t.pts)i=t.pts;else{if(!o)return void M.warn("[tsdemuxer]: AAC PES unknown PTS");var p=Cn(e.samplerate);i=o.sample.pts+p}for(var m,v=0;r<n;){if(r+=(m=Ln(e,s,r,i,v)).length,m.missing){this.aacOverFlow=m;break}for(v++;r<n-1&&!Rn(s,r);r++);}},t.parseMPEGPES=function(e,t){var r=t.data,n=r.length,i=0,a=0,o=t.pts;if(void 0!==o)for(;a<n;)if(Hn(r,a)){var s=Zn(e,r,a,o,i);if(!s)break;a+=s.length,i++}else a++;else M.warn("[tsdemuxer]: MPEG PES unknown PTS")},t.parseID3PES=function(e,t){if(void 0!==t.pts){var r=s({},t,{type:this._avcTrack?Gt.emsg:Gt.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else M.warn("[tsdemuxer]: ID3 PES unknown PTS")},e}();function Xn(e,t,r,n){return{key:e,frame:!1,pts:t,dts:r,units:[],debug:n,length:0}}function Qn(e,t){return((31&e[t+1])<<8)+e[t+2]}function Jn(e,t){return(31&e[t+10])<<8|e[t+11]}function $n(e,t,r,n){var i={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},a=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<a;){var o=Qn(e,t);switch(e[t]){case 207:if(!n){M.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===i.audio&&(i.audio=o);break;case 21:-1===i.id3&&(i.id3=o);break;case 219:if(!n){M.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===i.avc&&(i.avc=o);break;case 3:case 4:!0!==r.mpeg&&!0!==r.mp3?M.log("MPEG audio found, not supported in this browser"):-1===i.audio&&(i.audio=o,i.segmentCodec="mp3");break;case 36:M.warn("Unsupported HEVC stream type found")}t+=5+((15&e[t+3])<<8|e[t+4])}return i}function ei(e){var t,r,n,i,a,o=0,s=e.data;if(!e||0===e.size)return null;for(;s[0].length<19&&s.length>1;){var l=new Uint8Array(s[0].length+s[1].length);l.set(s[0]),l.set(s[1],s[0].length),s[0]=l,s.splice(1,1)}if(1===((t=s[0])[0]<<16)+(t[1]<<8)+t[2]){if((r=(t[4]<<8)+t[5])&&r>e.size-6)return null;var u=t[7];192&u&&(i=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,64&u?i-(a=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>54e5&&(M.warn(Math.round((i-a)/9e4)+"s delta between PTS and DTS, align them"),i=a):a=i);var c=(n=t[8])+9;if(e.size<=c)return null;e.size-=c;for(var f=new Uint8Array(e.size),d=0,h=s.length;d<h;d++){var g=(t=s[d]).byteLength;if(c){if(c>g){c-=g;continue}t=t.subarray(c),g-=c,c=0}f.set(t,o),o+=g}return r&&(r-=n+3),{data:f,pts:i,dts:a,len:r}}return null}function ti(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,n=r.length;if(!n)return void t.dropped++;var i=r[n-1];e.pts=i.pts,e.dts=i.dts}t.samples.push(e)}e.debug.length&&M.log(e.pts+"/"+e.dts+":"+e.debug)}var ri=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.resetInitSegment=function(t,r,n,i){e.prototype.resetInitSegment.call(this,t,r,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:i,inputTimeScale:9e4,dropped:0}},t.probe=function(e){if(!e)return!1;for(var t=(he(e,0)||[]).length,r=e.length;t<r;t++)if(Vn(e,t))return M.log("MPEG Audio sync word found !"),!0;return!1},r.canParse=function(e,t){return Yn(e,t)},r.appendFrame=function(e,t,r){if(null!==this.basePTS)return Zn(e,t,r,this.basePTS,this.frameIndex)},t}(yn),ni=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},e}(),ii=Math.pow(2,32)-1,ai=function(){function e(){}return e.init=function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))},e.box=function(e){for(var t=8,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var a=n.length,o=a;a--;)t+=n[a].byteLength;var s=new Uint8Array(t);for(s[0]=t>>24&255,s[1]=t>>16&255,s[2]=t>>8&255,s[3]=255&t,s.set(e,4),a=0,t=8;a<o;a++)s.set(n[a],t),t+=n[a].byteLength;return s},e.hdlr=function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])},e.mdat=function(t){return e.box(e.types.mdat,t)},e.mdhd=function(t,r){r*=t;var n=Math.floor(r/(ii+1)),i=Math.floor(r%(ii+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))},e.mfhd=function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},e.minf=function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))},e.moof=function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))},e.moov=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))},e.mvex=function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))},e.mvhd=function(t,r){r*=t;var n=Math.floor(r/(ii+1)),i=Math.floor(r%(ii+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)},e.sdtp=function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,a)},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))},e.avc1=function(t){var r,n,i,a=[],o=[];for(r=0;r<t.sps.length;r++)i=(n=t.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)i=(n=t.pps[r]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],f=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,f>>24,f>>16&255,f>>8&255,255&f])))},e.esds=function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))},e.mp4a=function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))},e.mp3=function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.segmentCodec&&"mp3"===t.codec?e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))},e.tkhd=function(t){var r=t.id,n=t.duration*t.timescale,i=t.width,a=t.height,o=Math.floor(n/(ii+1)),s=Math.floor(n%(ii+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))},e.traf=function(t,r){var n=e.sdtp(t),i=t.id,a=Math.floor(r/(ii+1)),o=Math.floor(r%(ii+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,n.length+16+20+8+16+8+8),n)},e.trak=function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.trex=function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},e.trun=function(t,r){var n,i,a,o,s,l,u=t.samples||[],c=u.length,f=12+16*c,d=new Uint8Array(f);for(r+=8+f,d.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)a=(i=u[n]).duration,o=i.size,s=i.flags,l=i.cts,d.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,d)},e.initSegment=function(t){e.types||e.init();var r=e.moov(t),n=new Uint8Array(e.FTYP.byteLength+r.byteLength);return n.set(e.FTYP),n.set(r,e.FTYP.byteLength),n},e}();ai.types=void 0,ai.HDLR_TYPES=void 0,ai.STTS=void 0,ai.STSC=void 0,ai.STCO=void 0,ai.STSZ=void 0,ai.VMHD=void 0,ai.SMHD=void 0,ai.STSD=void 0,ai.FTYP=void 0,ai.DINF=void 0;var oi=9e4;function si(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);var i=e*t*r;return n?Math.round(i):i}function li(e,t,r,n){return void 0===r&&(r=1),void 0===n&&(n=!1),si(e,t,1/r,n)}function ui(e,t){return void 0===t&&(t=!1),si(e,1e3,1/oi,t)}function ci(e,t){return void 0===t&&(t=1),si(e,oi,1/t)}var fi=1e4,di=1024,hi=1152,gi=null,pi=null,mi=function(){function e(e,t,r,n){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,null===gi){var i=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);gi=i?parseInt(i[1]):0}if(null===pi){var a=navigator.userAgent.match(/Safari\/(\d+)/i);pi=a?parseInt(a[1]):0}}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){M.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e},t.resetNextTimestamp=function(){M.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},t.resetInitSegment=function(){M.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},t.getVideoStartPts=function(e){var t=!1,r=e.reduce((function(e,r){var n=r.pts-e;return n<-4294967296?(t=!0,vi(e,r.pts)):n>0?e:r.pts}),e[0].pts);return t&&M.debug("PTS rollover detected"),r},t.remux=function(e,t,r,n,i,a,o,s){var l,u,c,f,d,h,g=i,p=i,m=e.pid>-1,v=t.pid>-1,y=t.samples.length,E=e.samples.length>0,T=o&&y>0||y>1;if((!m||E)&&(!v||T)||this.ISGenerated||o){this.ISGenerated||(c=this.generateIS(e,t,i,a));var _,S=this.isVideoContiguous,A=-1;if(T&&(A=yi(t.samples),!S&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,A>0){M.warn("[mp4-remuxer]: Dropped "+A+" out of "+y+" video samples due to a missing keyframe");var b=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(A),t.dropped+=A,_=p+=(t.samples[0].pts-b)/t.inputTimeScale}else-1===A&&(M.warn("[mp4-remuxer]: No keyframe found out of "+y+" video samples"),h=!1);if(this.ISGenerated){if(E&&T){var R=this.getVideoStartPts(t.samples),I=(vi(e.samples[0].pts,R)-R)/t.inputTimeScale;g+=Math.max(0,I),p+=Math.max(0,-I)}if(E){if(e.samplerate||(M.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i,a)),u=this.remuxAudio(e,g,this.isAudioContiguous,a,v||T||s===Lt.AUDIO?p:void 0),T){var w=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(M.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,i,a)),l=this.remuxVideo(t,p,S,w)}}else T&&(l=this.remuxVideo(t,p,S,0));l&&(l.firstKeyFrame=A,l.independent=-1!==A,l.firstKeyFramePTS=_)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(d=Ei(r,i,this._initPTS,this._initDTS)),n.samples.length&&(f=Ti(n,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:f,id3:d}},t.generateIS=function(e,t,r,n){var i,a,o,s=e.samples,l=t.samples,u=this.typeSupported,c={},f=this._initPTS,d=!f||n,h="audio/mp4";if(d&&(i=a=1/0),e.config&&s.length&&(e.timescale=e.samplerate,"mp3"===e.segmentCodec&&(u.mpeg?(h="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3")),c.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):ai.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(o=e.inputTimeScale,f&&o===f.timescale?d=!1:i=a=s[0].pts-Math.round(o*r))),t.sps&&t.pps&&l.length&&(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ai.initSegment([t]),metadata:{width:t.width,height:t.height}},d))if(o=t.inputTimeScale,f&&o===f.timescale)d=!1;else{var g=this.getVideoStartPts(l),p=Math.round(o*r);a=Math.min(a,vi(l[0].dts,g)-p),i=Math.min(i,g-p)}if(Object.keys(c).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:i,timescale:o},this._initDTS={baseTime:a,timescale:o}):i=o=void 0,{tracks:c,initPTS:i,timescale:o}},t.remuxVideo=function(e,t,r,n){var i,a,o=e.inputTimeScale,l=e.samples,u=[],c=l.length,f=this._initPTS,d=this.nextAvcDts,h=8,g=this.videoSampleDuration,p=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,v=!1;r&&null!==d||(d=t*o-(l[0].pts-vi(l[0].dts,l[0].pts)));for(var y=f.baseTime*o/f.timescale,E=0;E<c;E++){var T=l[E];T.pts=vi(T.pts-y,d),T.dts=vi(T.dts-y,d),T.dts<l[E>0?E-1:E].dts&&(v=!0)}v&&l.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n})),i=l[0].dts;var _=(a=l[l.length-1].dts)-i,S=_?Math.round(_/(c-1)):g||e.inputTimeScale/30;if(r){var A=i-d,b=A>S,D=A<-1;if((b||D)&&(b?M.warn("AVC: "+ui(A,!0)+" ms ("+A+"dts) hole between fragments detected, filling it"):M.warn("AVC: "+ui(-A,!0)+" ms ("+A+"dts) overlapping between fragments detected"),!D||d>=l[0].pts)){i=d;var C=l[0].pts-A;l[0].dts=i,l[0].pts=C,M.log("Video: First PTS/DTS adjusted: "+ui(C,!0)+"/"+ui(i,!0)+", delta: "+ui(A,!0)+" ms")}}i=Math.max(0,i);for(var N=0,L=0,O=0;O<c;O++){for(var P=l[O],k=P.units,x=k.length,F=0,U=0;U<x;U++)F+=k[U].data.length;L+=F,N+=x,P.length=F,P.dts=Math.max(P.dts,i),p=Math.min(P.pts,p),m=Math.max(P.pts,m)}a=l[c-1].dts;var B,Z=L+4*N+8;try{B=new Uint8Array(Z)}catch(e){return void this.observer.emit(R.ERROR,R.ERROR,{type:I.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:Z,reason:"fail allocating video mdat "+Z})}var G=new DataView(B.buffer);G.setUint32(0,Z),B.set(ai.types.mdat,4);for(var K=!1,H=Number.POSITIVE_INFINITY,Y=Number.POSITIVE_INFINITY,V=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY,j=0;j<c;j++){for(var z=l[j],W=z.units,X=0,Q=0,J=W.length;Q<J;Q++){var $=W[Q],ee=$.data,te=$.data.byteLength;G.setUint32(h,te),h+=4,B.set(ee,h),h+=te,X+=4+te}var re=void 0;if(j<c-1)g=l[j+1].dts-z.dts,re=l[j+1].pts-z.pts;else{var ne=this.config,ie=j>0?z.dts-l[j-1].dts:S;if(re=j>0?z.pts-l[j-1].pts:S,ne.stretchShortVideoTrack&&null!==this.nextAudioPts){var ae=Math.floor(ne.maxBufferHole*o),oe=(n?p+n*o:this.nextAudioPts)-z.pts;oe>ae?((g=oe-ie)<0?g=ie:K=!0,M.log("[mp4-remuxer]: It is approximately "+oe/90+" ms to the next segment; using duration "+g/90+" ms for the last video frame.")):g=ie}else g=ie}var se=Math.round(z.pts-z.dts);H=Math.min(H,g),V=Math.max(V,g),Y=Math.min(Y,re),q=Math.max(q,re),u.push(new Si(z.key,g,X,se))}if(u.length)if(gi){if(gi<70){var le=u[0].flags;le.dependsOn=2,le.isNonSync=0}}else if(pi&&q-Y<V-H&&S/V<.025&&0===u[0].cts){M.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var ue=i,ce=0,fe=u.length;ce<fe;ce++){var de=ue+u[ce].duration,he=ue+u[ce].cts;if(ce<fe-1){var ge=de+u[ce+1].cts;u[ce].duration=ge-he}else u[ce].duration=ce?u[ce-1].duration:S;u[ce].cts=0,ue=de}}g=K||!g?S:g,this.nextAvcDts=d=a+g,this.videoSampleDuration=g,this.isVideoContiguous=!0;var pe={data1:ai.moof(e.sequenceNumber++,i,s({},e,{samples:u})),data2:B,startPTS:p/o,endPTS:(m+g)/o,startDTS:i/o,endDTS:d/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,pe},t.remuxAudio=function(e,t,r,n,i){var a=e.inputTimeScale,o=a/(e.samplerate?e.samplerate:a),l="aac"===e.segmentCodec?di:hi,u=l*o,c=this._initPTS,f="mp3"===e.segmentCodec&&this.typeSupported.mpeg,d=[],h=void 0!==i,g=e.samples,p=f?0:8,m=this.nextAudioPts||-1,v=t*a,y=c.baseTime*a/c.timescale;if(this.isAudioContiguous=r=r||g.length&&m>0&&(n&&Math.abs(v-m)<9e3||Math.abs(vi(g[0].pts-y,v)-m)<20*u),g.forEach((function(e){e.pts=vi(e.pts-y,v)})),!r||m<0){if(g=g.filter((function(e){return e.pts>=0})),!g.length)return;m=0===i?0:n&&!h?Math.max(0,v):g[0].pts}if("aac"===e.segmentCodec)for(var E=this.config.maxAudioFramesDrift,T=0,_=m;T<g.length;T++){var S=g[T],A=S.pts,b=A-_,D=Math.abs(1e3*b/a);if(b<=-E*u&&h)0===T&&(M.warn("Audio frame @ "+(A/a).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*b/a)+" ms."),this.nextAudioPts=m=_=A);else if(b>=E*u&&D<fi&&h){var C=Math.round(b/u);(_=A-C*u)<0&&(C--,_+=u),0===T&&(this.nextAudioPts=m=_),M.warn("[mp4-remuxer]: Injecting "+C+" audio frame @ "+(_/a).toFixed(3)+"s due to "+Math.round(1e3*b/a)+" ms gap.");for(var N=0;N<C;N++){var L=Math.max(_,0),O=ni.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);O||(M.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),O=S.unit.subarray()),g.splice(T,0,{unit:O,pts:L}),_+=u,T++}}S.pts=_,_+=u}for(var P,k=null,x=null,F=0,U=g.length;U--;)F+=g[U].unit.byteLength;for(var B=0,Z=g.length;B<Z;B++){var G=g[B],K=G.unit,H=G.pts;if(null!==x)d[B-1].duration=Math.round((H-x)/o);else{if(r&&"aac"===e.segmentCodec&&(H=m),k=H,!(F>0))return;F+=p;try{P=new Uint8Array(F)}catch(e){return void this.observer.emit(R.ERROR,R.ERROR,{type:I.MUX_ERROR,details:w.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:F,reason:"fail allocating audio mdat "+F})}f||(new DataView(P.buffer).setUint32(0,F),P.set(ai.types.mdat,4))}P.set(K,p);var Y=K.byteLength;p+=Y,d.push(new Si(!0,l,Y,0)),x=H}var V=d.length;if(V){var q=d[d.length-1];this.nextAudioPts=m=x+o*q.duration;var j=f?new Uint8Array(0):ai.moof(e.sequenceNumber++,k/o,s({},e,{samples:d}));e.samples=[];var z=k/a,W=m/a,X={data1:j,data2:P,startPTS:z,endPTS:W,startDTS:z,endDTS:W,type:"audio",hasAudio:!0,hasVideo:!1,nb:V};return this.isAudioContiguous=!0,X}},t.remuxEmptyAudio=function(e,t,r,n){var i=e.inputTimeScale,a=i/(e.samplerate?e.samplerate:i),o=this.nextAudioPts,s=this._initDTS,l=9e4*s.baseTime/s.timescale,u=(null!==o?o:n.startDTS*i)+l,c=n.endDTS*i+l,f=a*di,d=Math.ceil((c-u)/f),h=ni.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(M.warn("[mp4-remuxer]: remux empty Audio"),h){for(var g=[],p=0;p<d;p++){var m=u+p*f;g.push({unit:h,pts:m,dts:m})}return e.samples=g,this.remuxAudio(e,t,r,!1)}M.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},e}();function vi(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function yi(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}function Ei(e,t,r,n){var i=e.samples.length;if(i){for(var a=e.inputTimeScale,o=0;o<i;o++){var s=e.samples[o];s.pts=vi(s.pts-r.baseTime*a/r.timescale,t*a)/a,s.dts=vi(s.dts-n.baseTime*a/n.timescale,t*a)/a}var l=e.samples;return e.samples=[],{samples:l}}}function Ti(e,t,r){var n=e.samples.length;if(n){for(var i=e.inputTimeScale,a=0;a<n;a++){var o=e.samples[a];o.pts=vi(o.pts-r.baseTime*i/r.timescale,t*i)/i}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}var _i,Si=function(e,t,r,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=n,this.flags=new Ai(e)},Ai=function(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1},bi=function(){function e(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}var t=e.prototype;return t.destroy=function(){},t.resetTimeStamp=function(e){this.initPTS=e,this.lastEndTime=null},t.resetNextTimestamp=function(){this.lastEndTime=null},t.resetInitSegment=function(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(Be(e,n)),this.emitInitSegment=!0},t.generateInitSegment=function(e){var t=this.audioCodec,r=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var n=this.initData=Ue(e);t||(t=Ii(n.audio,K.AUDIO)),r||(r=Ii(n.video,K.VIDEO));var i={};n.audio&&n.video?i.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:n.audio?i.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:n.video?i.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:M.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=i},t.remux=function(e,t,r,n,i,a){var o,s,l=this.initPTS,u=this.lastEndTime,c={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};b(u)||(u=this.lastEndTime=i||0);var f=t.samples;if(null==f||!f.length)return c;var d={initPTS:void 0,timescale:1},h=this.initData;if(null!=(o=h)&&o.length||(this.generateInitSegment(f),h=this.initData),null==(s=h)||!s.length)return M.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);var g=Ke(f,h),p=Ge(h,f),m=null===p?i:p;(Ri(l,m,i,g)||d.timescale!==l.timescale&&a)&&(d.initPTS=m-i,l&&1===l.timescale&&M.warn("Adjusting initPTS by "+(d.initPTS-l.baseTime)),this.initPTS=l={baseTime:d.initPTS,timescale:1});var v=e?m-l.baseTime/l.timescale:u,y=v+g;Ye(h,f,l.baseTime/l.timescale),g>0?this.lastEndTime=y:(M.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!h.audio,T=!!h.video,_="";E&&(_+="audio"),T&&(_+="video");var S={data1:f,startPTS:v,startDTS:v,endPTS:y,endDTS:y,type:_,hasAudio:E,hasVideo:T,nb:1,dropped:0};return c.audio="audio"===S.type?S:void 0,c.video="audio"!==S.type?S:void 0,c.initSegment=d,c.id3=Ei(r,i,l,l),n.samples.length&&(c.text=Ti(n,i,l)),c},e}();function Ri(e,t,r,n){if(null===e)return!0;var i=Math.max(n,1),a=t-e.baseTime/e.timescale;return Math.abs(a-r)>i}function Ii(e,t){var r=null==e?void 0:e.codec;return r&&r.length>4?r:"hvc1"===r||"hev1"===r?"hvc1.1.6.L120.90":"av01"===r?"av01.0.04M.08":"avc1"===r||t===K.VIDEO?"avc1.42e01e":"mp4a.40.5"}try{_i=self.performance.now.bind(self.performance)}catch(e){M.debug("Unable to use Performance API on this environment"),_i="undefined"!=typeof self&&self.Date.now}var wi=[{demux:Mn,remux:bi},{demux:Wn,remux:mi},{demux:On,remux:mi},{demux:ri,remux:mi}],Di=function(){function e(e,t,r,n,i){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=n,this.id=i}var t=e.prototype;return t.configure=function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()},t.push=function(e,t,r,n){var i=this,a=r.transmuxing;a.executeStart=_i();var o=new Uint8Array(e),s=this.currentTransmuxState,l=this.transmuxConfig;n&&(this.currentTransmuxState=n);var u=n||s,c=u.contiguous,f=u.discontinuity,d=u.trackSwitch,h=u.accurateTimeOffset,g=u.timeOffset,p=u.initSegmentChange,m=l.audioCodec,v=l.videoCodec,y=l.defaultInitPts,E=l.duration,T=l.initSegmentData,_=Ci(o,t);if(_&&"AES-128"===_.method){var S=this.getDecrypter();if(!S.isSync())return this.decryptionPromise=S.webCryptoDecrypt(o,_.key.buffer,_.iv.buffer).then((function(e){var t=i.push(e,null,r);return i.decryptionPromise=null,t})),this.decryptionPromise;var A=S.softwareDecrypt(o,_.key.buffer,_.iv.buffer);if(r.part>-1&&(A=S.flush()),!A)return a.executeEnd=_i(),Ni(r);o=new Uint8Array(A)}var b=this.needsProbing(f,d);if(b){var D=this.configureTransmuxer(o);if(D)return M.warn("[transmuxer] "+D.message),this.observer.emit(R.ERROR,R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,fatal:!1,error:D,reason:D.message}),a.executeEnd=_i(),Ni(r)}(f||d||p||b)&&this.resetInitSegment(T,m,v,E,t),(f||p||b)&&this.resetInitialTimestamp(y),c||this.resetContiguity();var C=this.transmux(o,_,g,h,r),N=this.currentTransmuxState;return N.contiguous=!0,N.discontinuity=!1,N.trackSwitch=!1,a.executeEnd=_i(),C},t.flush=function(e){var t=this,r=e.transmuxing;r.executeStart=_i();var n=this.decrypter,i=this.currentTransmuxState,a=this.decryptionPromise;if(a)return a.then((function(){return t.flush(e)}));var o=[],s=i.timeOffset;if(n){var l=n.flush();l&&o.push(this.push(l,null,e))}var u=this.demuxer,c=this.remuxer;if(!u||!c)return r.executeEnd=_i(),[Ni(e)];var f=u.flush(s);return Li(f)?f.then((function(r){return t.flushRemux(o,r,e),o})):(this.flushRemux(o,f,e),o)},t.flushRemux=function(e,t,r){var n=t.audioTrack,i=t.videoTrack,a=t.id3Track,o=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;M.log("[transmuxer.ts]: Flushed fragment "+r.sn+(r.part>-1?" p: "+r.part:"")+" of level "+r.level);var c=this.remuxer.remux(n,i,a,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=_i()},t.resetInitialTimestamp=function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))},t.resetContiguity=function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())},t.resetInitSegment=function(e,t,r,n,i){var a=this.demuxer,o=this.remuxer;a&&o&&(a.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,i))},t.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},t.transmux=function(e,t,r,n,i){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,n,i):this.transmuxUnencrypted(e,r,n,i)},t.transmuxUnencrypted=function(e,t,r,n){var i=this.demuxer.demux(e,t,!1,!this.config.progressive),a=i.audioTrack,o=i.videoTrack,s=i.id3Track,l=i.textTrack;return{remuxResult:this.remuxer.remux(a,o,s,l,t,r,!1,this.id),chunkMeta:n}},t.transmuxSampleAes=function(e,t,r,n,i){var a=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return{remuxResult:a.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,n,!1,a.id),chunkMeta:i}}))},t.configureTransmuxer=function(e){for(var t,r=this.config,n=this.observer,i=this.typeSupported,a=this.vendor,o=0,s=wi.length;o<s;o++)if(wi[o].demux.probe(e)){t=wi[o];break}if(!t)return new Error("Failed to find demuxer by probing fragment data");var l=this.demuxer,u=this.remuxer,c=t.remux,f=t.demux;u&&u instanceof c||(this.remuxer=new c(n,r,i,a)),l&&l instanceof f||(this.demuxer=new f(n,r,i),this.probe=f.probe)},t.needsProbing=function(e,t){return!this.demuxer||!this.remuxer||e||t},t.getDecrypter=function(){var e=this.decrypter;return e||(e=this.decrypter=new cn(this.config)),e},e}();function Ci(e,t){var r=null;return e.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(r=t),r}var Ni=function(e){return{remuxResult:{},chunkMeta:e}};function Li(e){return"then"in e&&e.then instanceof Function}var Oi=function(e,t,r,n,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=n,this.defaultInitPts=i||null},Pi=function(e,t,r,n,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=n,this.timeOffset=i,this.initSegmentChange=a},Mi={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,a||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(u=1,l=new Array(f-1);u<f;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),f){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(d=1,l=new Array(f-1);d<f;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(Mi);var ki=_(Mi.exports);function xi(e){var t=new ki,r=function(t,r){e.postMessage({event:t,data:r})};t.on(R.FRAG_DECRYPTED,r),t.on(R.ERROR,r);var n=function(){var e=function(e){var t=function(t){r("workerLog",{logType:e,message:t})};M[e]=t};for(var t in M)e(t)};e.addEventListener("message",(function(i){var a=i.data;switch(a.cmd){case"init":var o=JSON.parse(a.config);e.transmuxer=new Di(t,a.typeSupported,o,a.vendor,a.id),P(o.debug,a.id),n(),r("init",null);break;case"configure":e.transmuxer.configure(a.config);break;case"demux":var s=e.transmuxer.push(a.data,a.decryptdata,a.chunkMeta,a.state);Li(s)?(e.transmuxer.async=!0,s.then((function(t){Fi(e,t)})).catch((function(e){r(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,chunkMeta:a.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker push error"})}))):(e.transmuxer.async=!1,Fi(e,s));break;case"flush":var l=a.chunkMeta,u=e.transmuxer.flush(l);Li(u)||e.transmuxer.async?(Li(u)||(u=Promise.resolve(u)),u.then((function(t){Bi(e,t,l)})).catch((function(e){r(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,chunkMeta:a.chunkMeta,fatal:!1,error:e,err:e,reason:"transmuxer-worker flush error"})}))):Bi(e,u,l)}}))}function Fi(e,t){if(Zi(t.remuxResult))return!1;var r=[],n=t.remuxResult,i=n.audio,a=n.video;return i&&Ui(r,i),a&&Ui(r,a),e.postMessage({event:"transmuxComplete",data:t},r),!0}function Ui(e,t){t.data1&&e.push(t.data1.buffer),t.data2&&e.push(t.data2.buffer)}function Bi(e,t,r){t.reduce((function(t,r){return Fi(e,r)||t}),!1)||e.postMessage({event:"transmuxComplete",data:t[0]}),e.postMessage({event:"flush",data:r})}function Zi(e){return!(e.audio||e.video||e.text||e.id3||e.initSegment)}function Gi(){return!0}function Ki(){var e=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;("+t.toString()+")(true);"],{type:"text/javascript"}),r=self.URL.createObjectURL(e);return{worker:new self.Worker(r),objectURL:r}}function Hi(e){var t=new self.URL(e,self.location.href).href;return{worker:new self.Worker(t),scriptURL:t}}void 0!==r&&r&&xi(self);var Yi=ft()||{isTypeSupported:function(){return!1}},Vi=function(){function e(e,t,r,n){var i=this;this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=r,this.onFlush=n;var o=function(e,t){(t=t||{}).frag=i.frag,t.id=i.id,e===R.ERROR&&(i.error=t.error),i.hls.trigger(e,t)};this.observer=new ki,this.observer.on(R.FRAG_DECRYPTED,o),this.observer.on(R.ERROR,o);var s={mp4:Yi.isTypeSupported("video/mp4"),mpeg:Yi.isTypeSupported("audio/mpeg"),mp3:Yi.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker&&(a.workerPath||Gi()))try{a.workerPath?(M.log("loading Web Worker "+a.workerPath+' for "'+t+'"'),this.workerContext=Hi(a.workerPath)):(M.log('injecting Web Worker for "'+t+'"'),this.workerContext=Ki()),this.onwmsg=function(e){return i.onWorkerMessage(e)};var u=this.workerContext.worker;u.addEventListener("message",this.onwmsg),u.onerror=function(e){var r=new Error(e.message+"  ("+e.filename+":"+e.lineno+")");a.enableWorker=!1,M.warn('Error in "'+t+'" Web Worker, fallback to inline'),i.hls.trigger(R.ERROR,{type:I.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:r})},u.postMessage({cmd:"init",typeSupported:s,vendor:l,id:t,config:JSON.stringify(a)})}catch(e){M.warn('Error setting up "'+t+'" Web Worker, fallback to inline',e),this.resetWorker(),this.error=null,this.transmuxer=new Di(this.observer,s,a,l,t)}else this.transmuxer=new Di(this.observer,s,a,l,t)}var t=e.prototype;return t.resetWorker=function(){if(this.workerContext){var e=this.workerContext,t=e.worker,r=e.objectURL;r&&self.URL.revokeObjectURL(r),t.removeEventListener("message",this.onwmsg),t.onerror=null,t.terminate(),this.workerContext=null}},t.destroy=function(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},t.push=function(e,t,r,n,i,a,o,s,l,u){var c,f,d=this;l.transmuxing.start=self.performance.now();var h=this.transmuxer,g=a?a.start:i.start,p=i.decryptdata,m=this.frag,v=!(m&&i.cc===m.cc),y=!(m&&l.level===m.level),E=m?l.sn-m.sn:-1,T=this.part?l.part-this.part.index:-1,_=0===E&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),S=!y&&(1===E||0===E&&(1===T||_&&T<=0)),A=self.performance.now();(y||E||0===i.stats.parsing.start)&&(i.stats.parsing.start=A),!a||!T&&S||(a.stats.parsing.start=A);var b=!(m&&(null==(c=i.initSegment)?void 0:c.url)===(null==(f=m.initSegment)?void 0:f.url)),R=new Pi(v,S,s,y,g,b);if(!S||v||b){M.log("[transmuxer-interface, "+i.type+"]: Starting new transmux session for sn: "+l.sn+" p: "+l.part+" level: "+l.level+" id: "+l.id+"\n        discontinuity: "+v+"\n        trackSwitch: "+y+"\n        contiguous: "+S+"\n        accurateTimeOffset: "+s+"\n        timeOffset: "+g+"\n        initSegmentChange: "+b);var I=new Oi(r,n,t,o,u);this.configureTransmuxer(I)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:l,state:R},e instanceof ArrayBuffer?[e]:[]);else if(h){var w=h.push(e,p,l,R);Li(w)?(h.async=!0,w.then((function(e){d.handleTransmuxComplete(e)})).catch((function(e){d.transmuxerError(e,l,"transmuxer-interface push error")}))):(h.async=!1,this.handleTransmuxComplete(w))}},t.flush=function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(r){var n=r.flush(e);Li(n)||r.async?(Li(n)||(n=Promise.resolve(n)),n.then((function(r){t.handleFlushResult(r,e)})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error")}))):this.handleFlushResult(n,e)}},t.transmuxerError=function(e,t,r){this.hls&&(this.error=e,this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:r}))},t.handleFlushResult=function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e)})),this.onFlush(t)},t.onWorkerMessage=function(e){var t=e.data,r=this.hls;switch(t.event){case"init":var n,i=null==(n=this.workerContext)?void 0:n.objectURL;i&&self.URL.revokeObjectURL(i);break;case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":M[t.data.logType]&&M[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}},t.configureTransmuxer=function(e){var t=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)},t.handleTransmuxComplete=function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)},e}(),qi=250,ji=2,zi=.1,Wi=.05,Xi=function(){function e(e,t,r,n){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=n}var t=e.prototype;return t.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},t.poll=function(e,t){var r=this.config,n=this.media,i=this.stalled;if(null!==n){var a=n.currentTime,o=n.seeking,s=this.seeking&&!o,l=!this.seeking&&o;if(this.seeking=o,a===e){if(l||s)this.stalled=null;else if(!(n.paused&&!o||n.ended||0===n.playbackRate)&&qr.getBuffered(n).length){var u=qr.bufferInfo(n,a,0),c=u.len>0,f=u.nextStart||0;if(c||f){if(o){var d=u.len>ji,h=!f||t&&t.start<=a||f-a>ji&&!this.fragmentTracker.getPartialFragment(a);if(d||h)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var g,p=Math.max(f,u.start||0)-a,m=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,v=(null==m||null==(g=m.details)?void 0:g.live)?2*m.details.targetduration:ji,y=this.fragmentTracker.getPartialFragment(a);if(p>0&&(p<=v||y))return void this._trySkipBufferHole(y)}var E=self.performance.now();if(null!==i){var T=E-i;if(o||!(T>=qi)||(this._reportStall(u),this.media)){var _=qr.bufferInfo(n,a,r.maxBufferHole);this._tryFixBufferStall(_,T)}}else this.stalled=E}}}else if(this.moved=!0,null!==i){if(this.stallReported){var S=self.performance.now()-i;M.warn("playback not stuck anymore @"+a+", after "+Math.round(S)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},t._tryFixBufferStall=function(e,t){var r=this.config,n=this.fragmentTracker,i=this.media;if(null!==i){var a=i.currentTime,o=n.getPartialFragment(a);if(o&&(this._trySkipBufferHole(o)||!this.media))return;(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-a<r.maxBufferHole)&&t>1e3*r.highBufferWatchdogPeriod&&(M.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},t._reportStall=function(e){var t=this.hls,r=this.media;if(!this.stallReported&&r){this.stallReported=!0;var n=new Error("Playback stalling at @"+r.currentTime+" due to low buffer ("+JSON.stringify(e)+")");M.warn(n.message),t.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:e.len})}},t._trySkipBufferHole=function(e){var t=this.config,r=this.hls,n=this.media;if(null===n)return 0;var i=n.currentTime,a=qr.bufferInfo(n,i,0),o=i<a.start?a.start:a.nextStart;if(o){var s=a.len<=t.maxBufferHole,l=a.len>0&&a.len<1&&n.readyState<3,u=o-i;if(u>0&&(s||l)){if(u>t.maxBufferHole){var c=this.fragmentTracker,f=!1;if(0===i){var d=c.getAppendedFrag(0,Lt.MAIN);d&&o<d.end&&(f=!0)}if(!f){var h=e||c.getAppendedFrag(i,Lt.MAIN);if(h){for(var g=!1,p=h.end;p<o;){var m=c.getPartialFragment(p);if(!m){g=!0;break}p+=m.duration}if(g)return 0}}}var v=Math.max(o+Wi,i+zi);if(M.warn("skipping hole, adjusting currentTime from "+i+" to "+v),this.moved=!0,this.stalled=null,n.currentTime=v,e&&!e.gap){var y=new Error("fragment loaded with buffer holes, seeking from "+i+" to "+v);r.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:y,reason:y.message,frag:e})}return v}}return 0},t._tryNudgeBuffer=function(){var e=this.config,t=this.hls,r=this.media,n=this.nudgeRetry;if(null!==r){var i=r.currentTime;if(this.nudgeRetry++,n<e.nudgeMaxRetry){var a=i+(n+1)*e.nudgeOffset,o=new Error("Nudging 'currentTime' from "+i+" to "+a);M.warn(o.message),r.currentTime=a,t.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{var s=new Error("Playhead still not moving while enough data buffered @"+i+" after "+e.nudgeMaxRetry+" nudges");M.error(s.message),t.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_STALLED_ERROR,error:s,fatal:!0})}}},e}(),Qi=100,Ji=function(e){function t(t,r,n){var i;return(i=e.call(this,t,r,n,"[stream-controller]",Lt.MAIN)||this).audioCodecSwap=!1,i.gapController=null,i.level=-1,i._forceStartLoad=!1,i.altAudio=!1,i.audioOnly=!1,i.fragPlaying=null,i.onvplaying=null,i.onvseeked=null,i.fragLastKbps=0,i.couldBacktrack=!1,i.backtrackFragment=null,i.audioCodecSwitch=!1,i.videoBuffer=null,i._registerListeners(),i}l(t,e);var r=t.prototype;return r._registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(R.ERROR,this.onError,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(R.ERROR,this.onError,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)},r.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},r.startLoad=function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(Qi),this.level=-1,!this.startFragRequested){var n=r.startLevel;-1===n&&(r.config.testBandwidth&&this.levels.length>1?(n=0,this.bitrateTest=!0):n=r.nextAutoLevel),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=dn.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=dn.STOPPED},r.stopLoad=function(){this._forceStartLoad=!1,e.prototype.stopLoad.call(this)},r.doTick=function(){switch(this.state){case dn.WAITING_LEVEL:var e,t=this.levels,r=this.level,n=null==t||null==(e=t[r])?void 0:e.details;if(n&&(!n.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(n))break;this.state=dn.IDLE;break}if(this.hls.nextLoadLevel!==this.level){this.state=dn.IDLE;break}break;case dn.FRAG_LOADING_WAITING_RETRY:var i,a=self.performance.now(),o=this.retryDate;(!o||a>=o||null!=(i=this.media)&&i.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=dn.IDLE)}this.state===dn.IDLE&&this.doTickIdle(),this.onTickEnd()},r.onTickEnd=function(){e.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},r.doTickIdle=function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,n=this.media,i=e.config,a=e.nextLoadLevel;if(null!==t&&(n||!this.startFragRequested&&i.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&null!=r&&r[a]){var o=r[a],s=this.getMainFwdBufferInfo();if(null!==s){var l=this.getLevelDetails();if(l&&this._streamEnded(s,l)){var u={};return this.altAudio&&(u.type="video"),this.hls.trigger(R.BUFFER_EOS,u),void(this.state=dn.ENDED)}e.loadLevel!==a&&-1===e.manualLevel&&this.log("Adapting to level "+a+" from level "+this.level),this.level=e.nextLoadLevel=a;var c=o.details;if(!c||this.state===dn.WAITING_LEVEL||c.live&&this.levelLastLoaded!==a)return this.level=a,void(this.state=dn.WAITING_LEVEL);var f=s.len,d=this.getMaxBufferLength(o.maxBitrate);if(!(f>=d)){this.backtrackFragment&&this.backtrackFragment.start>s.end&&(this.backtrackFragment=null);var h=this.backtrackFragment?this.backtrackFragment.start:s.end,g=this.getNextFragment(h,c);if(this.couldBacktrack&&!this.fragPrevious&&g&&"initSegment"!==g.sn&&this.fragmentTracker.getState(g)!==Mr.OK){var p,m=(null!=(p=this.backtrackFragment)?p:g).sn-c.startSN,v=c.fragments[m-1];v&&g.cc===v.cc&&(g=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&s.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,h)){if(!g.gap){var y=this.audioOnly&&!this.altAudio?K.AUDIO:K.VIDEO,E=(y===K.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;E&&this.afterBufferFlushed(E,y,Lt.MAIN)}g=this.getNextFragmentLoopLoading(g,c,s,Lt.MAIN,d)}g&&(!g.initSegment||g.initSegment.data||this.bitrateTest||(g=g.initSegment),this.loadFragment(g,o,h))}}}},r.loadFragment=function(t,r,n){var i=this.fragmentTracker.getState(t);this.fragCurrent=t,i===Mr.NOT_LOADED||i===Mr.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t,r):this.bitrateTest?(this.log("Fragment "+t.sn+" of level "+t.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(t,r)):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n)):this.clearTrackerIfNeeded(t)},r.getBufferedFrag=function(e){return this.fragmentTracker.getBufferedFrag(e,Lt.MAIN)},r.followingBufferedFrag=function(e){return e?this.getBufferedFrag(e.end+.5):null},r.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},r.nextLevelSwitch=function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);var i=this.getLevelDetails();if(null!=i&&i.live){var a=this.getMainFwdBufferInfo();if(!a||a.len<2*i.targetduration)return}if(!t.paused&&e){var o=e[this.hls.nextLoadLevel],s=this.fragLastKbps;r=s&&this.fragCurrent?this.fragCurrent.duration*o.maxBitrate/(1e3*s)+1:0}else r=0;var l=this.getBufferedFrag(t.currentTime+r);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var c=u.maxStartPTS?u.maxStartPTS:u.start,f=u.duration,d=Math.max(l.end,c+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,.5*f),.75*f));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}},r.abortCurrentFrag=function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case dn.KEY_LOADING:case dn.FRAG_LOADING:case dn.FRAG_LOADING_WAITING_RETRY:case dn.PARSING:case dn.PARSED:this.state=dn.IDLE}this.nextLoadPosition=this.getLoadPosition()},r.flushMainBuffer=function(t,r){e.prototype.flushMainBuffer.call(this,t,r,this.altAudio?"video":null)},r.onMediaAttached=function(t,r){e.prototype.onMediaAttached.call(this,t,r);var n=r.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Xi(this.config,n,this.fragmentTracker,this.hls)},r.onMediaDetaching=function(){var t=this.media;t&&this.onvplaying&&this.onvseeked&&(t.removeEventListener("playing",this.onvplaying),t.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),e.prototype.onMediaDetaching.call(this)},r.onMediaPlaying=function(){this.tick()},r.onMediaSeeked=function(){var e=this.media,t=e?e.currentTime:null;b(t)&&this.log("Media seeked to "+t.toFixed(3));var r=this.getMainFwdBufferInfo();null!==r&&0!==r.len?this.tick():this.warn('Main forward buffer length on "seeked" event '+(r?r.len:"empty")+")")},r.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(R.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1},r.onManifestParsed=function(e,t){var r,n=!1,i=!1;t.levels.forEach((function(e){(r=e.audioCodec)&&(-1!==r.indexOf("mp4a.40.2")&&(n=!0),-1!==r.indexOf("mp4a.40.5")&&(i=!0))})),this.audioCodecSwitch=n&&i&&!mn(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1},r.onLevelLoading=function(e,t){var r=this.levels;if(r&&this.state===dn.IDLE){var n=r[t.level];(!n.details||n.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(n.details))&&(this.state=dn.WAITING_LEVEL)}},r.onLevelLoaded=function(e,t){var r,n=this.levels,i=t.level,a=t.details,o=a.totalduration;if(n){this.log("Level "+i+" loaded ["+a.startSN+","+a.endSN+"]"+(a.lastPartSn?"[part-"+a.lastPartSn+"-"+a.lastPartIndex+"]":"")+", cc ["+a.startCC+", "+a.endCC+"] duration:"+o);var s=n[i],l=this.fragCurrent;!l||this.state!==dn.FRAG_LOADING&&this.state!==dn.FRAG_LOADING_WAITING_RETRY||l.level===t.level&&l.urlId===s.urlId||!l.loader||this.abortCurrentFrag();var u=0;if(a.live||null!=(r=s.details)&&r.live){if(a.fragments[0]||(a.deltaUpdateFailed=!0),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,s.details)}if(s.details=a,this.levelLastLoaded=i,this.hls.trigger(R.LEVEL_UPDATED,{details:a,level:i}),this.state===dn.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=dn.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,u),this.tick()}else this.warn("Levels were reset while loading level "+i)},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,i=e.payload,a=this.levels;if(a){var o=a[r.level],s=o.details;if(!s)return this.warn("Dropping fragment "+r.sn+" of level "+r.level+" after level details were reset"),void this.fragmentTracker.removeFragment(r);var l=o.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=r.initSegment)?void 0:t.data,f=this._getAudioCodec(o),d=this.transmuxer=this.transmuxer||new Vi(this.hls,Lt.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=n?n.index:-1,g=-1!==h,p=new jr(r.level,r.sn,r.stats.chunkCount,i.byteLength,h,g),m=this.initPTS[r.cc];d.push(i,c,f,l,r,n,s.totalduration,u,p,m)}else this.warn("Levels were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r.onAudioTrackSwitching=function(e,t){var r=this.altAudio;if(!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n&&(this.log("Switching to main audio track, cancel main fragment load"),n.abortRequests(),this.fragmentTracker.removeFragment(n)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var i=this.hls;r&&(i.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),i.trigger(R.AUDIO_TRACK_SWITCHED,t)}},r.onAudioTrackSwitched=function(e,t){var r=t.id,n=!!this.hls.audioTracks[r].url;if(n){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=n,this.tick()},r.onBufferCreated=function(e,t){var r,n,i=t.tracks,a=!1;for(var o in i){var s=i[o];if("main"===s.id){if(n=o,r=s,"video"===o){var l=i[o];l&&(this.videoBuffer=l.buffer)}}else a=!0}a&&r?(this.log("Alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media},r.onFragBuffered=function(e,t){var r=t.frag,n=t.part;if(!r||r.type===Lt.MAIN){if(this.fragContextChanged(r))return this.warn("Fragment "+r.sn+(n?" p: "+n.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===dn.PARSED&&(this.state=dn.IDLE));var i=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*i.total/(i.buffering.end-i.loading.first)),"initSegment"!==r.sn&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}},r.onError=function(e,t){var r;if(t.fatal)this.state=dn.ERROR;else switch(t.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Lt.MAIN,t);break;case w.LEVEL_LOAD_ERROR:case w.LEVEL_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==dn.WAITING_LEVEL||(null==(r=t.context)?void 0:r.type)!==Nt.LEVEL||(this.state=dn.IDLE);break;case w.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}},r.checkBuffer=function(){var e=this.media,t=this.gapController;if(e&&t&&e.readyState){if(this.loadedmetadata||!qr.getBuffered(e).length){var r=this.state!==dn.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}},r.onFragLoadEmergencyAborted=function(){this.state=dn.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},r.onBufferFlushed=function(e,t){var r=t.type;if(r!==K.AUDIO||this.audioOnly&&!this.altAudio){var n=(r===K.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,r,Lt.MAIN)}},r.onLevelsUpdated=function(e,t){this.levels=t.levels},r.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},r.seekToStartPos=function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to "+r+", already seeking at "+t);var n=qr.getBuffered(e),i=(n.length?n.start(0):0)-r;i>0&&(i<this.config.maxBufferHole||i<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+i+" to match buffer start"),r+=i,this.startPosition=r),this.log("seek to target start position "+r+" from current time "+t),e.currentTime=r}}},r._getAudioCodec=function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t},r._loadBitrateTestFrag=function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(n){var i=r.hls;if(n&&!r.fragContextChanged(e)){t.fragmentError=0,r.state=dn.IDLE,r.startFragRequested=!1,r.bitrateTest=!1;var a=e.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),i.trigger(R.FRAG_LOADED,n),e.bitrateTest=!1}}))},r._handleTransmuxComplete=function(e){var t,r="main",n=this.hls,i=e.remuxResult,a=e.chunkMeta,o=this.getCurrentContext(a);if(o){var s=o.frag,l=o.part,u=o.level,c=i.video,f=i.text,d=i.id3,h=i.initSegment,g=u.details,p=this.altAudio?void 0:i.audio;if(this.fragContextChanged(s))this.fragmentTracker.removeFragment(s);else{if(this.state=dn.PARSING,h){if(null!=h&&h.tracks){var m=s.initSegment||s;this._bufferInitSegment(u,h.tracks,m,a),n.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:m,id:r,tracks:h.tracks})}var v=h.initPTS,y=h.timescale;b(v)&&(this.initPTS[s.cc]={baseTime:v,timescale:y},n.trigger(R.INIT_PTS_FOUND,{frag:s,id:r,initPTS:v,timescale:y}))}if(c&&g&&"initSegment"!==s.sn){var E=g.fragments[s.sn-1-g.startSN],T=s.sn===g.startSN,_=!E||s.cc>E.cc;if(!1!==i.independent){var S=c.startPTS,A=c.endPTS,I=c.startDTS,w=c.endDTS;if(l)l.elementaryStreams[c.type]={startPTS:S,endPTS:A,startDTS:I,endDTS:w};else if(c.firstKeyFrame&&c.independent&&1===a.id&&!_&&(this.couldBacktrack=!0),c.dropped&&c.independent){var D=this.getMainFwdBufferInfo(),C=(D?D.end:this.getLoadPosition())+this.config.maxBufferHole,N=c.firstKeyFramePTS?c.firstKeyFramePTS:S;if(!T&&C<N-this.config.maxBufferHole&&!_)return void this.backtrack(s);_&&(s.gap=!0),s.setElementaryStreamInfo(c.type,s.start,A,s.start,w,!0)}s.setElementaryStreamInfo(c.type,S,A,I,w),this.backtrackFragment&&(this.backtrackFragment=s),this.bufferFragmentData(c,s,l,a,T||_)}else{if(!T&&!_)return void this.backtrack(s);s.gap=!0}}if(p){var L=p.startPTS,O=p.endPTS,P=p.startDTS,M=p.endDTS;l&&(l.elementaryStreams[K.AUDIO]={startPTS:L,endPTS:O,startDTS:P,endDTS:M}),s.setElementaryStreamInfo(K.AUDIO,L,O,P,M),this.bufferFragmentData(p,s,l,a)}if(g&&null!=d&&null!=(t=d.samples)&&t.length){var k={id:r,frag:s,details:g,samples:d.samples};n.trigger(R.FRAG_PARSING_METADATA,k)}if(g&&f){var x={id:r,frag:s,details:g,samples:f.samples};n.trigger(R.FRAG_PARSING_USERDATA,x)}}}else this.resetWhenMissingContext(a)},r._bufferInitSegment=function(e,t,r,n){var i=this;if(this.state===dn.PARSING){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;var a=t.audio,o=t.video,s=t.audiovideo;if(a){var l=e.audioCodec,u=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(l&&(l=-1!==l.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==a.metadata.channelCount&&-1===u.indexOf("firefox")&&(l="mp4a.40.5")),-1!==u.indexOf("android")&&"audio/mpeg"!==a.container&&(l="mp4a.40.2",this.log("Android: force audio codec to "+l)),e.audioCodec&&e.audioCodec!==l&&this.log('Swapping manifest audio codec "'+e.audioCodec+'" for "'+l+'"'),a.levelCodec=l,a.id="main",this.log("Init audio buffer, container:"+a.container+", codecs[selected/level/parsed]=["+(l||"")+"/"+(e.audioCodec||"")+"/"+a.codec+"]")}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log("Init video buffer, container:"+o.container+", codecs[level/parsed]=["+(e.videoCodec||"")+"/"+o.codec+"]")),s&&this.log("Init audiovideo buffer, container:"+s.container+", codecs[level/parsed]=["+(e.attrs.CODECS||"")+"/"+s.codec+"]"),this.hls.trigger(R.BUFFER_CODECS,t),Object.keys(t).forEach((function(e){var a=t[e].initSegment;null!=a&&a.byteLength&&i.hls.trigger(R.BUFFER_APPENDING,{type:e,data:a,frag:r,part:null,chunkMeta:n,parent:r.type})})),this.tick()}},r.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,Lt.MAIN)},r.backtrack=function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=dn.IDLE},r.checkFragmentChanged=function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(qr.isBuffered(e,r)?t=this.getAppendedFrag(r):qr.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var n=this.fragPlaying,i=t.level;n&&t.sn===n.sn&&n.level===i&&t.urlId===n.urlId||(this.fragPlaying=t,this.hls.trigger(R.FRAG_CHANGED,{frag:t}),n&&n.level===i||this.hls.trigger(R.LEVEL_SWITCHED,{level:i}))}}},a(t,[{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}},{key:"currentProgramDateTime",get:function(){var e=this.media;if(e){var t=e.currentTime,r=this.currentFrag;if(r&&b(t)&&b(r.programDateTime)){var n=r.programDateTime+1e3*(t-r.start);return new Date(n)}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),t}(hn),$i=function(){function e(e,t,r){void 0===t&&(t=0),void 0===r&&(r=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}var t=e.prototype;return t.sample=function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e},t.getTotalWeight=function(){return this.totalWeight_},t.getEstimate=function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_},e}(),ea=function(){function e(e,t,r,n){void 0===n&&(n=100),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new $i(e),this.fast_=new $i(t),this.defaultTTFB_=n,this.ttfb_=new $i(e)}var t=e.prototype;return t.update=function(e,t){var r=this.slow_,n=this.fast_,i=this.ttfb_;r.halfLife!==e&&(this.slow_=new $i(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new $i(t,n.getEstimate(),n.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new $i(e,i.getEstimate(),i.getTotalWeight()))},t.sample=function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)},t.sampleTTFB=function(e){var t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))},t.canEstimate=function(){return this.fast_.getTotalWeight()>=this.minWeight_},t.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},t.getEstimateTTFB=function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_},t.destroy=function(){},e}(),ta=function(){function e(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;var t=e.config;this.bwEstimator=new ea(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this)},t.unregisterListeners=function(){var e=this.hls;e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this)},t.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},t.onFragLoading=function(e,t){var r,n=t.frag;this.ignoreFragment(n)||(this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))},t.onLevelSwitching=function(e,t){this.clearTimer()},t.getTimeToLoadFrag=function(e,t,r,n){return e+r/t+(n?this.lastLevelLoadSec:0)},t.onLevelLoaded=function(e,t){var r=this.hls.config,n=t.stats,i=n.total,a=n.bwEstimate;b(i)&&b(a)&&(this.lastLevelLoadSec=8*i/a),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)},t._abandonRulesCheck=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,n=r.autoLevelEnabled,i=r.media;if(e&&i){var a=performance.now(),o=t?t.stats:e.stats,s=t?t.duration:e.duration,l=a-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||0===e.level)return this.clearTimer(),void(this._nextAutoLevel=-1);if(n&&!i.paused&&i.playbackRate&&i.readyState){var u=r.mainForwardBufferInfo;if(null!==u){var c=this.bwEstimator.getEstimateTTFB(),f=Math.abs(i.playbackRate);if(!(l<=Math.max(c,s/(2*f)*1e3))){var d=u.len/f;if(!(d>=2*s/f)){var h=o.loading.first?o.loading.first-o.loading.start:-1,g=o.loaded&&h>-1,p=this.bwEstimator.getEstimate(),m=r.levels,v=r.minAutoLevel,y=m[e.level],E=o.total||Math.max(o.loaded,Math.round(s*y.maxBitrate/8)),T=l-h;T<1&&g&&(T=Math.min(l,8*o.loaded/p));var _=g?1e3*o.loaded/T:0,S=_?(E-o.loaded)/_:8*E/p+c/1e3;if(!(S<=d)){var A,I=_?8*_:p,w=Number.POSITIVE_INFINITY;for(A=e.level-1;A>v;A--){var D=m[A].maxBitrate;if((w=this.getTimeToLoadFrag(c/1e3,I,s*D,!m[A].details))<d)break}w>=S||w>10*s||(r.nextLoadLevel=A,g?this.bwEstimator.sample(l-Math.min(c,h),o.loaded):this.bwEstimator.sampleTTFB(l),this.clearTimer(),M.warn("[abr] Fragment "+e.sn+(t?" part "+t.index:"")+" of level "+e.level+" is loading too slowly;\n      Time to underbuffer: "+d.toFixed(3)+" s\n      Estimated load time for current fragment: "+S.toFixed(3)+" s\n      Estimated load time for down switch fragment: "+w.toFixed(3)+" s\n      TTFB estimate: "+h+"\n      Current BW estimate: "+(b(p)?(p/1024).toFixed(3):"Unknown")+" Kb/s\n      New BW estimate: "+(this.bwEstimator.getEstimate()/1024).toFixed(3)+" Kb/s\n      Aborting and switching to level "+A),e.loader&&(this.fragCurrent=this.partCurrent=null,e.abortRequests()),r.trigger(R.FRAG_LOAD_EMERGENCY_ABORTED,{frag:e,part:t,stats:o}))}}}}}}},t.onFragLoaded=function(e,t){var r=t.frag,n=t.part,i=n?n.stats:r.stats;if(r.type===Lt.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var a=n?n.duration:r.duration,o=this.hls.levels[r.level],s=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+a;o.loaded={bytes:s,duration:l},o.realBitrate=Math.round(8*s/l)}if(r.bitrateTest){var u={stats:i,frag:r,part:n,id:r.type};this.onFragBuffered(R.FRAG_BUFFERED,u),r.bitrateTest=!1}}},t.onFragBuffered=function(e,t){var r=t.frag,n=t.part,i=null!=n&&n.stats.loaded?n.stats:r.stats;if(!i.aborted&&!this.ignoreFragment(r)){var a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}},t.ignoreFragment=function(e){return e.type!==Lt.MAIN||"initSegment"===e.sn},t.clearTimer=function(){self.clearInterval(this.timer)},t.getNextABRAutoLevel=function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls,n=r.maxAutoLevel,i=r.config,a=r.minAutoLevel,o=r.media,s=t?t.duration:e?e.duration:0,l=o&&0!==o.playbackRate?Math.abs(o.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,c=r.mainForwardBufferInfo,f=(c?c.len:0)/l,d=this.findBestLevel(u,a,n,f,i.abrBandWidthFactor,i.abrBandWidthUpFactor);if(d>=0)return d;M.trace("[abr] "+(f?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var h=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,g=i.abrBandWidthFactor,p=i.abrBandWidthUpFactor;if(!f){var m=this.bitrateTestDelay;m&&(h=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-m,M.trace("[abr] bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),g=p=1)}return d=this.findBestLevel(u,a,n,f+h,g,p),Math.max(d,0)},t.findBestLevel=function(e,t,r,n,i,a){for(var o,s=this.fragCurrent,l=this.partCurrent,u=this.lastLoadedFragLevel,c=this.hls.levels,f=c[u],d=!(null==f||null==(o=f.details)||!o.live),h=null==f?void 0:f.codecSet,g=l?l.duration:s?s.duration:0,p=this.bwEstimator.getEstimateTTFB()/1e3,m=t,v=-1,y=r;y>=t;y--){var E=c[y];if(!E||h&&E.codecSet!==h)E&&(m=Math.min(y,m),v=Math.max(y,v));else{-1!==v&&M.trace("[abr] Skipped level(s) "+m+"-"+v+' with CODECS:"'+c[v].attrs.CODECS+'"; not compatible with "'+f.attrs.CODECS+'"');var T=E.details,_=(l?null==T?void 0:T.partTarget:null==T?void 0:T.averagetargetduration)||g,S=void 0;S=y<=u?i*e:a*e;var A=c[y].maxBitrate,R=this.getTimeToLoadFrag(p,S,A*_,void 0===T);if(M.trace("[abr] level:"+y+" adjustedbw-bitrate:"+Math.round(S-A)+" avgDuration:"+_.toFixed(1)+" maxFetchDuration:"+n.toFixed(1)+" fetchDuration:"+R.toFixed(1)),S>A&&(0===R||!b(R)||d&&!this.bitrateTestDelay||R<n))return y}}return-1},a(e,[{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;var r=this.getNextABRAutoLevel();if(-1!==e){var n=this.hls.levels;if(n.length>Math.max(e,r)&&n[e].loadError<=n[r].loadError)return e}return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}}]),e}(),ra=function(){function e(){this.chunks=[],this.dataLength=0}var t=e.prototype;return t.push=function(e){this.chunks.push(e),this.dataLength+=e.length},t.flush=function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:na(t,r),this.reset(),e):new Uint8Array(0)},t.reset=function(){this.chunks.length=0,this.dataLength=0},e}();function na(e,t){for(var r=new Uint8Array(t),n=0,i=0;i<e.length;i++){var a=e[i];r.set(a,n),n+=a.length}return r}var ia=100,aa=function(e){function t(t,r,n){var i;return(i=e.call(this,t,r,n,"[audio-stream-controller]",Lt.AUDIO)||this).videoBuffer=null,i.videoTrackCC=-1,i.waitingVideoCC=-1,i.bufferedTrack=null,i.switchingTrack=null,i.trackId=-1,i.waitingData=null,i.mainDetails=null,i.bufferFlushed=!1,i.cachedTrackLoadedData=null,i._registerListeners(),i}l(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null},r._registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this),e.on(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(R.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this),e.off(R.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)},r.onInitPtsFound=function(e,t){var r=t.frag,n=t.id,i=t.initPTS,a=t.timescale;if("main"===n){var o=r.cc;this.initPTS[r.cc]={baseTime:i,timescale:a},this.log("InitPTS for cc: "+o+" found from main: "+i),this.videoTrackCC=o,this.state===dn.WAITING_INIT_PTS&&this.tick()}},r.startLoad=function(e){if(!this.levels)return this.startPosition=e,void(this.state=dn.STOPPED);var t=this.lastCurrentTime;this.stopLoad(),this.setInterval(ia),t>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t,this.state=dn.IDLE):(this.loadedmetadata=!1,this.state=dn.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},r.doTick=function(){switch(this.state){case dn.IDLE:this.doTickIdle();break;case dn.WAITING_TRACK:var t,r=this.levels,n=this.trackId,i=null==r||null==(t=r[n])?void 0:t.details;if(i){if(this.waitForCdnTuneIn(i))break;this.state=dn.WAITING_INIT_PTS}break;case dn.FRAG_LOADING_WAITING_RETRY:var a,o=performance.now(),s=this.retryDate;(!s||o>=s||null!=(a=this.media)&&a.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=dn.IDLE);break;case dn.WAITING_INIT_PTS:var l=this.waitingData;if(l){var u=l.frag,c=l.part,f=l.cache,d=l.complete;if(void 0!==this.initPTS[u.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=dn.FRAG_LOADING;var h={frag:u,part:c,payload:f.flush(),networkDetails:null};this._handleFragmentLoadProgress(h),d&&e.prototype._handleFragmentLoadComplete.call(this,h)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+u.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var g=this.getLoadPosition(),p=qr.bufferInfo(this.mediaBuffer,g,this.config.maxBufferHole);_r(p.end,this.config.maxFragLookUpTolerance,u)<0&&(this.log("Waiting fragment cc ("+u.cc+") @ "+u.start+" cancelled because another fragment at "+p.end+" is needed"),this.clearWaitingFragment())}}else this.state=dn.IDLE}this.onTickEnd()},r.clearWaitingFragment=function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=dn.IDLE)},r.resetLoadingState=function(){this.clearWaitingFragment(),e.prototype.resetLoadingState.call(this)},r.onTickEnd=function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)},r.doTickIdle=function(){var e=this.hls,t=this.levels,r=this.media,n=this.trackId,i=e.config;if(null!=t&&t[n]&&(r||!this.startFragRequested&&i.startFragPrefetch)){var a=t[n],o=a.details;if(!o||o.live&&this.levelLastLoaded!==n||this.waitForCdnTuneIn(o))this.state=dn.WAITING_TRACK;else{var s=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&s&&(this.bufferFlushed=!1,this.afterBufferFlushed(s,K.AUDIO,Lt.AUDIO));var l=this.getFwdBufferInfo(s,Lt.AUDIO);if(null!==l){var u=this.bufferedTrack,c=this.switchingTrack;if(!c&&this._streamEnded(l,o))return e.trigger(R.BUFFER_EOS,{type:"audio"}),void(this.state=dn.ENDED);var f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,Lt.MAIN),d=l.len,h=this.getMaxBufferLength(null==f?void 0:f.len);if(!(d>=h)||c){var g=o.fragments[0].start,p=l.end;if(c&&r){var m=this.getLoadPosition();u&&c.attrs!==u.attrs&&(p=m),o.PTSKnown&&m<g&&(l.end>g||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=g+.05)}var v=this.getNextFragment(p,o),y=!1;if(v&&this.isLoopLoading(v,p)&&(y=!!v.gap,v=this.getNextFragmentLoopLoading(v,o,l,Lt.MAIN,h)),v){var E=f&&v.start>f.end+o.targetduration;if(E||(null==f||!f.len)&&l.len){var T=this.getAppendedFrag(v.start,Lt.MAIN);if(null===T)return;if(y||(y=!!T.gap||!!E&&0===f.len),E&&!y||y&&l.nextStart&&l.nextStart<T.end)return}this.loadFragment(v,a,p)}else this.bufferFlushed=!0}}}}},r.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.min(Math.max(r,t),this.config.maxMaxBufferLength):r},r.onMediaDetaching=function(){this.videoBuffer=null,e.prototype.onMediaDetaching.call(this)},r.onAudioTracksUpdated=function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new $t(e)}))},r.onAudioTrackSwitching=function(e,t){var r=!!t.url;this.trackId=t.id;var n=this.fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?this.setInterval(ia):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=dn.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=dn.STOPPED),this.tick()},r.onManifestLoading=function(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1},r.onLevelLoaded=function(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(R.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},r.onAudioTrackLoaded=function(e,t){var r;if(null!=this.mainDetails){var n=this.levels,i=t.details,a=t.id;if(n){this.log("Track "+a+" loaded ["+i.startSN+","+i.endSN+"]"+(i.lastPartSn?"[part-"+i.lastPartSn+"-"+i.lastPartIndex+"]":"")+",duration:"+i.totalduration);var o=n[a],s=0;if(i.live||null!=(r=o.details)&&r.live){var l=this.mainDetails;if(i.fragments[0]||(i.deltaUpdateFailed=!0),i.deltaUpdateFailed||!l)return;!o.details&&i.hasProgramDateTime&&l.hasProgramDateTime?(nn(i,l),s=i.fragments[0].start):s=this.alignPlaylists(i,o.details)}o.details=i,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&i.live||this.setStartPosition(o.details,s),this.state!==dn.WAITING_TRACK||this.waitForCdnTuneIn(i)||(this.state=dn.IDLE),this.tick()}else this.warn("Audio tracks were reset while loading level "+a)}else this.cachedTrackLoadedData=t},r._handleFragmentLoadProgress=function(e){var t,r=e.frag,n=e.part,i=e.payload,a=this.config,o=this.trackId,s=this.levels;if(s){var l=s[o];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);var c=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2",f=this.transmuxer;f||(f=this.transmuxer=new Vi(this.hls,Lt.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var d=this.initPTS[r.cc],h=null==(t=r.initSegment)?void 0:t.data;if(void 0!==d){var g=!1,p=n?n.index:-1,m=-1!==p,v=new jr(r.level,r.sn,r.stats.chunkCount,i.byteLength,p,m);f.push(i,h,c,"",r,n,u.totalduration,g,v,d)}else this.log("Unknown video PTS for cc "+r.cc+", waiting for video PTS before demuxing audio frag "+r.sn+" of ["+u.startSN+" ,"+u.endSN+"],track "+o),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new ra,complete:!1}).cache.push(new Uint8Array(i)),this.waitingVideoCC=this.videoTrackCC,this.state=dn.WAITING_INIT_PTS}else this.warn("Audio track is undefined on fragment load progress")}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+r.sn+" of level "+r.level+" will not be buffered")},r._handleFragmentLoadComplete=function(t){this.waitingData?this.waitingData.complete=!0:e.prototype._handleFragmentLoadComplete.call(this,t)},r.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},r.onBufferCreated=function(e,t){var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)},r.onFragBuffered=function(e,t){var r=t.frag,i=t.part;if(r.type===Lt.AUDIO)if(this.fragContextChanged(r))this.warn("Fragment "+r.sn+(i?" p: "+i.index:"")+" of level "+r.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+(this.switchingTrack?this.switchingTrack.name:"false"));else{if("initSegment"!==r.sn){this.fragPrevious=r;var a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(R.AUDIO_TRACK_SWITCHED,n({},a)))}this.fragBufferedComplete(r,i)}else if(!this.loadedmetadata&&r.type===Lt.MAIN){var o=this.videoBuffer||this.media;o&&qr.getBuffered(o).length&&(this.loadedmetadata=!0)}},r.onError=function(t,r){var n;if(r.fatal)this.state=dn.ERROR;else switch(r.details){case w.FRAG_GAP:case w.FRAG_PARSING_ERROR:case w.FRAG_DECRYPT_ERROR:case w.FRAG_LOAD_ERROR:case w.FRAG_LOAD_TIMEOUT:case w.KEY_LOAD_ERROR:case w.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Lt.AUDIO,r);break;case w.AUDIO_TRACK_LOAD_ERROR:case w.AUDIO_TRACK_LOAD_TIMEOUT:case w.LEVEL_PARSING_ERROR:r.levelRetry||this.state!==dn.WAITING_TRACK||(null==(n=r.context)?void 0:n.type)!==Nt.AUDIO_TRACK||(this.state=dn.IDLE);break;case w.BUFFER_FULL_ERROR:if(!r.parent||"audio"!==r.parent)return;this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case w.INTERNAL_EXCEPTION:this.recoverWorkerError(r)}},r.onBufferFlushed=function(e,t){t.type===K.AUDIO&&(this.bufferFlushed=!0,this.state===dn.ENDED&&(this.state=dn.IDLE))},r._handleTransmuxComplete=function(e){var t,r="audio",n=this.hls,i=e.remuxResult,a=e.chunkMeta,o=this.getCurrentContext(a);if(o){var l=o.frag,u=o.part,c=o.level.details,f=i.audio,d=i.text,h=i.id3,g=i.initSegment;if(!this.fragContextChanged(l)&&c){if(this.state=dn.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),null!=g&&g.tracks){var p=l.initSegment||l;this._bufferInitSegment(g.tracks,p,a),n.trigger(R.FRAG_PARSING_INIT_SEGMENT,{frag:p,id:r,tracks:g.tracks})}if(f){var m=f.startPTS,v=f.endPTS,y=f.startDTS,E=f.endDTS;u&&(u.elementaryStreams[K.AUDIO]={startPTS:m,endPTS:v,startDTS:y,endDTS:E}),l.setElementaryStreamInfo(K.AUDIO,m,v,y,E),this.bufferFragmentData(f,l,u,a)}if(null!=h&&null!=(t=h.samples)&&t.length){var T=s({id:r,frag:l,details:c},h);n.trigger(R.FRAG_PARSING_METADATA,T)}if(d){var _=s({id:r,frag:l,details:c},d);n.trigger(R.FRAG_PARSING_USERDATA,_)}}else this.fragmentTracker.removeFragment(l)}else this.resetWhenMissingContext(a)},r._bufferInitSegment=function(e,t,r){if(this.state===dn.PARSING){e.video&&delete e.video;var n=e.audio;if(n){n.levelCodec=n.codec,n.id="audio",this.log("Init audio buffer, container:"+n.container+", codecs[parsed]=["+n.codec+"]"),this.hls.trigger(R.BUFFER_CODECS,e);var i=n.initSegment;if(null!=i&&i.byteLength){var a={type:"audio",frag:t,part:null,chunkMeta:r,parent:t.type,data:i};this.hls.trigger(R.BUFFER_APPENDING,a)}this.tick()}}},r.loadFragment=function(t,r,n){var i,a=this.fragmentTracker.getState(t);this.fragCurrent=t,this.switchingTrack||a===Mr.NOT_LOADED||a===Mr.PARTIAL?"initSegment"===t.sn?this._loadInitSegment(t,r):null!=(i=r.details)&&i.live&&!this.initPTS[t.cc]?(this.log("Waiting for video PTS in continuity counter "+t.cc+" of live stream before loading audio fragment "+t.sn+" of level "+this.trackId),this.state=dn.WAITING_INIT_PTS):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n)):this.clearTrackerIfNeeded(t)},r.completeAudioSwitch=function(t){var r=this.hls,i=this.media,a=this.bufferedTrack,o=null==a?void 0:a.attrs,s=t.attrs;i&&o&&(o.CHANNELS!==s.CHANNELS||o.NAME!==s.NAME||o.LANGUAGE!==s.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),e.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=t,this.switchingTrack=null,r.trigger(R.AUDIO_TRACK_SWITCHED,n({},t))},t}(hn),oa=function(e){function t(t){var r;return(r=e.call(this,t,"[audio-track-controller]")||this).tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.currentTrack=null,r.selectDefaultTrack=!0,r.registerListeners(),r}l(t,e);var r=t.prototype;return r.registerListeners=function(){var e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(R.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(R.ERROR,this.onError,this)},r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,e.prototype.destroy.call(this)},r.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.audioTracks||[]},r.onAudioTrackLoaded=function(e,t){var r=t.id,n=t.groupId,i=t.details,a=this.tracksInGroup[r];if(a&&a.groupId===n){var o=a.details;a.details=t.details,this.log("audio-track "+r+' "'+a.name+'" lang:'+a.lang+" group:"+n+" loaded ["+i.startSN+"-"+i.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Track with id:"+r+" and group:"+n+" not found in active group "+a.groupId)},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.audioGroupIds){var r=t.audioGroupIds[t.urlId];if(this.groupId!==r){this.groupId=r||null;var n=this.tracks.filter((function(e){return!r||e.groupId===r}));this.selectDefaultTrack&&!n.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),this.tracksInGroup=n;var i={audioTracks:n};this.log("Updating audio tracks, "+n.length+" track(s) found in group:"+r),this.hls.trigger(R.AUDIO_TRACKS_UPDATED,i),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===Nt.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))},r.setAudioTrack=function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var r=this.currentTrack;t[this.trackId];var i=t[e],a=i.groupId,o=i.name;if(this.log("Switching to audio-track "+e+' "'+o+'" lang:'+i.lang+" group:"+a),this.trackId=e,this.currentTrack=i,this.selectDefaultTrack=!1,this.hls.trigger(R.AUDIO_TRACK_SWITCHING,n({},i)),!i.details||i.details.live){var s=this.switchParams(i.url,null==r?void 0:r.details);this.loadPlaylist(s)}}},r.selectInitialTrack=function(){var e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{var r=new Error("No track found for running audio group-ID: "+this.groupId+" track count: "+e.length);this.warn(r.message),this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:r})}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var n=t[r];if(!this.selectDefaultTrack||n.default){if(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===n.attrs["STABLE-RENDITION-ID"])return n.id;if(e.name===n.name&&e.lang===n.lang)return n.id}}return-1},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,i=r.groupId,a=r.url;if(t)try{a=t.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("loading audio-track playlist "+n+' "'+r.name+'" lang:'+r.lang+" group:"+i),this.clearTimer(),this.hls.trigger(R.AUDIO_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null})}},a(t,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}]),t}(Nr);function sa(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!la(e[r].attrs,t[r].attrs))return!1;return!0}function la(e,t){var r=e["STABLE-RENDITION-ID"];return r?r===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some((function(r){return e[r]!==t[r]}))}var ua=500,ca=function(e){function t(t,r,n){var i;return(i=e.call(this,t,r,n,"[subtitle-stream-controller]",Lt.SUBTITLE)||this).levels=[],i.currentTrackId=-1,i.tracksBuffered=[],i.mainDetails=null,i._registerListeners(),i}l(t,e);var r=t.prototype;return r.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},r._registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.LEVEL_LOADED,this.onLevelLoaded,this),e.on(R.ERROR,this.onError,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.FRAG_BUFFERED,this.onFragBuffered,this)},r._unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.LEVEL_LOADED,this.onLevelLoaded,this),e.off(R.ERROR,this.onError,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.FRAG_BUFFERED,this.onFragBuffered,this)},r.startLoad=function(e){this.stopLoad(),this.state=dn.IDLE,this.setInterval(ua),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()},r.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},r.onMediaDetaching=function(){this.tracksBuffered=[],e.prototype.onMediaDetaching.call(this)},r.onLevelLoaded=function(e,t){this.mainDetails=t.details},r.onSubtitleFragProcessed=function(e,t){var r=t.frag,n=t.success;if(this.fragPrevious=r,this.state=dn.IDLE,n){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,o=r.start,s=0;s<i.length;s++)if(o>=i[s].start&&o<=i[s].end){a=i[s];break}var l=r.start+r.duration;a?a.end=l:(a={start:o,end:l},i.push(a)),this.fragmentTracker.fragBuffered(r)}}},r.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset;if(0===r&&n!==Number.POSITIVE_INFINITY){var i=n-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=i)e.shift();else{if(!(e[t].start<i))break;e[t].start=i,t++}})),this.fragmentTracker.removeFragmentsInRange(r,i,Lt.SUBTITLE)}},r.onFragBuffered=function(e,t){var r;this.loadedmetadata||t.frag.type!==Lt.MAIN||null!=(r=this.media)&&r.buffered.length&&(this.loadedmetadata=!0)},r.onError=function(e,t){var r=t.frag;(null==r?void 0:r.type)===Lt.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==dn.STOPPED&&(this.state=dn.IDLE))},r.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks;sa(this.levels,n)?this.levels=n.map((function(e){return new $t(e)})):(this.tracksBuffered=[],this.levels=n.map((function(e){var t=new $t(e);return r.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Lt.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null)},r.onSubtitleTrackSwitch=function(e,t){if(this.currentTrackId=t.id,this.levels.length&&-1!==this.currentTrackId){var r=this.levels[this.currentTrackId];null!=r&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(ua)}else this.clearInterval()},r.onSubtitleTrackLoaded=function(e,t){var r,n=t.details,i=t.id,a=this.currentTrackId,o=this.levels;if(o.length){var s=o[a];if(!(i>=o.length||i!==a)&&s){this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(n.live||null!=(r=s.details)&&r.live){var u=this.mainDetails;if(n.deltaUpdateFailed||!u)return;var c=u.fragments[0];s.details?0===(l=this.alignPlaylists(n,s.details))&&c&&sr(n,l=c.start):n.hasProgramDateTime&&u.hasProgramDateTime?(nn(n,u),l=n.fragments[0].start):c&&sr(n,l=c.start)}s.details=n,this.levelLastLoaded=i,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(s.details,l),this.tick(),n.live&&!this.fragCurrent&&this.media&&this.state===dn.IDLE&&(Tr(null,n.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0))}}},r._handleFragmentLoadComplete=function(e){var t=this,r=e.frag,n=e.payload,i=r.decryptdata,a=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&i&&i.key&&i.iv&&"AES-128"===i.method){var o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer).catch((function(e){throw a.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:r}),e})).then((function(e){var t=performance.now();a.trigger(R.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:o,tdecrypt:t}})})).catch((function(e){t.warn(e.name+": "+e.message),t.state=dn.IDLE}))}},r.doTick=function(){if(this.media){if(this.state===dn.IDLE){var e=this.currentTrackId,t=this.levels,r=t[e];if(!t.length||!r||!r.details)return;var n=this.config,i=this.getLoadPosition(),a=qr.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,n.maxBufferHole),o=a.end,s=a.len,l=this.getFwdBufferInfo(this.media,Lt.MAIN),u=r.details;if(s>this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration)return;var c=u.fragments,f=c.length,d=u.edge,h=null,g=this.fragPrevious;if(o<d){var p=n.maxFragLookUpTolerance,m=o>d-p?0:p;!(h=Tr(g,c,Math.max(c[0].start,o),m))&&g&&g.start<c[0].start&&(h=c[0])}else h=c[f-1];if(!h)return;if("initSegment"!==(h=this.mapToInitFragWhenRequired(h)).sn){var v=c[h.sn-u.startSN-1];v&&v.cc===h.cc&&this.fragmentTracker.getState(v)===Mr.NOT_LOADED&&(h=v)}this.fragmentTracker.getState(h)===Mr.NOT_LOADED&&this.loadFragment(h,r,o)}}else this.state=dn.IDLE},r.getMaxBufferLength=function(t){var r=e.prototype.getMaxBufferLength.call(this);return t?Math.max(r,t):r},r.loadFragment=function(t,r,n){this.fragCurrent=t,"initSegment"===t.sn?this._loadInitSegment(t,r):(this.startFragRequested=!0,e.prototype.loadFragment.call(this,t,r,n))},a(t,[{key:"mediaBufferTimeRanges",get:function(){return new fa(this.tracksBuffered[this.currentTrackId]||[])}}]),t}(hn),fa=function(e){this.buffered=void 0;var t=function(t,r,n){if((r>>>=0)>n-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+r+") is greater than the maximum bound ("+n+")");return e[r][t]};this.buffered={get length(){return e.length},end:function(r){return t("end",r,e.length)},start:function(r){return t("start",r,e.length)}}},da=function(e){function t(t){var r;return(r=e.call(this,t,"[subtitle-track-controller]")||this).media=null,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.selectDefaultTrack=!0,r.queuedDefaultTrack=-1,r.trackChangeListener=function(){return r.onTextTracksChanged()},r.asyncPollTrackChange=function(){return r.pollTrackChange(0)},r.useTextTrackPolling=!1,r.subtitlePollingInterval=-1,r._subtitleDisplay=!0,r.registerListeners(),r}l(t,e);var r=t.prototype;return r.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,e.prototype.destroy.call(this)},r.registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.LEVEL_LOADING,this.onLevelLoading,this),e.on(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(R.ERROR,this.onError,this)},r.unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.LEVEL_LOADING,this.onLevelLoading,this),e.off(R.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(R.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(R.ERROR,this.onError,this)},r.onMediaAttached=function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},r.pollTrackChange=function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)},r.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),ha(this.media.textTracks).forEach((function(e){Ft(e)})),this.subtitleTrack=-1,this.media=null)},r.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},r.onManifestParsed=function(e,t){this.tracks=t.subtitleTracks},r.onSubtitleTrackLoaded=function(e,t){var r=t.id,n=t.details,i=this.trackId,a=this.tracksInGroup[i];if(a){var o=a.details;a.details=t.details,this.log("subtitle track "+r+" loaded ["+n.startSN+"-"+n.endSN+"]"),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Invalid subtitle track id "+r)},r.onLevelLoading=function(e,t){this.switchLevel(t.level)},r.onLevelSwitching=function(e,t){this.switchLevel(t.level)},r.switchLevel=function(e){var t=this.hls.levels[e];if(null!=t&&t.textGroupIds){var r=t.textGroupIds[t.urlId],n=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==r){var i=this.tracks.filter((function(e){return!r||e.groupId===r}));this.tracksInGroup=i;var a=this.findTrackId(null==n?void 0:n.name)||this.findTrackId();this.groupId=r||null;var o={subtitleTracks:i};this.log("Updating subtitle tracks, "+i.length+' track(s) found in "'+r+'" group-id'),this.hls.trigger(R.SUBTITLE_TRACKS_UPDATED,o),-1!==a&&this.setSubtitleTrack(a,n)}else this.shouldReloadPlaylist(n)&&this.setSubtitleTrack(this.trackId,n)}},r.findTrackId=function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var n=t[r];if((!this.selectDefaultTrack||n.default)&&(!e||e===n.name))return n.id}return-1},r.onError=function(e,t){!t.fatal&&t.context&&t.context.type===Nt.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)},r.loadPlaylist=function(t){e.prototype.loadPlaylist.call(this);var r=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(r)){var n=r.id,i=r.groupId,a=r.url;if(t)try{a=t.addDirectives(a)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: "+e)}this.log("Loading subtitle playlist for id "+n),this.hls.trigger(R.SUBTITLE_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null})}},r.toggleTrackModes=function(e){var t=this,r=this.media,n=this.trackId;if(r){var i=ha(r.textTracks),a=i.filter((function(e){return e.groupId===t.groupId}));if(-1===e)[].slice.call(i).forEach((function(e){e.mode="disabled"}));else{var o=a[n];o&&(o.mode="disabled")}var s=a[e];s&&(s.mode=this.subtitleDisplay?"showing":"hidden")}},r.setSubtitleTrack=function(e,t){var r,n=this.tracksInGroup;if(this.media){if(this.trackId!==e&&this.toggleTrackModes(e),!(this.trackId===e&&(-1===e||null!=(r=n[e])&&r.details)||e<-1||e>=n.length)){this.clearTimer();var i=n[e];if(this.log("Switching to subtitle-track "+e+(i?' "'+i.name+'" lang:'+i.lang+" group:"+i.groupId:"")),this.trackId=e,i){var a=i.id,o=i.groupId,s=void 0===o?"":o,l=i.name,u=i.type,c=i.url;this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:a,groupId:s,name:l,type:u,url:c});var f=this.switchParams(i.url,null==t?void 0:t.details);this.loadPlaylist(f)}else this.hls.trigger(R.SUBTITLE_TRACK_SWITCH,{id:e})}}else this.queuedDefaultTrack=e},r.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var e=-1,t=ha(this.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=r;else if("showing"===t[r].mode){e=r;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},a(t,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1;var t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}}]),t}(Nr);function ha(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||t.push(e[r])}return t}var ga=function(){function e(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}var t=e.prototype;return t.append=function(e,t){var r=this.queues[t];r.push(e),1===r.length&&this.buffers[t]&&this.executeNext(t)},t.insertAbort=function(e,t){this.queues[t].unshift(e),this.executeNext(t)},t.appendBlocker=function(e){var t,r=new Promise((function(e){t=e})),n={execute:t,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(n,e),r},t.executeNext=function(e){var t=this.buffers,r=this.queues,n=t[e],i=r[e];if(i.length){var a=i[0];try{a.execute()}catch(t){M.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),a.onError(t),null!=n&&n.updating||(i.shift(),this.executeNext(e))}}},t.shiftAndExecuteNext=function(e){this.queues[e].shift(),this.executeNext(e)},t.current=function(e){return this.queues[e][0]},e}(),pa=ft(),ma=/([ha]vc.)(?:\.[^.,]+)+/,va=function(){function e(e){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var e=t.media,r=t.mediaSource;M.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",t._onMediaEmptied),t.updateMediaElementDuration(),t.hls.trigger(R.MEDIA_ATTACHED,{media:e})),r&&r.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){M.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){M.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var e=t.media,r=t._objectUrl;e&&e.src!==r&&M.error("Media element src was set while attaching MediaSource ("+r+" > "+e.src+")")},this.hls=e,this._initSourceBuffer(),this.registerListeners()}var t=e.prototype;return t.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},t.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},t.registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.BUFFER_RESET,this.onBufferReset,this),e.on(R.BUFFER_APPENDING,this.onBufferAppending,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.BUFFER_EOS,this.onBufferEos,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(R.FRAG_PARSED,this.onFragParsed,this),e.on(R.FRAG_CHANGED,this.onFragChanged,this)},t.unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.BUFFER_RESET,this.onBufferReset,this),e.off(R.BUFFER_APPENDING,this.onBufferAppending,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.BUFFER_EOS,this.onBufferEos,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(R.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(R.FRAG_PARSED,this.onFragParsed,this),e.off(R.FRAG_CHANGED,this.onFragChanged,this)},t._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new ga(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},t.onManifestLoading=function(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null},t.onManifestParsed=function(e,t){var r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,M.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(e,t){var r=this.media=t.media;if(r&&pa){var n=this.mediaSource=new pa;n.addEventListener("sourceopen",this._onMediaSourceOpen),n.addEventListener("sourceended",this._onMediaSourceEnded),n.addEventListener("sourceclose",this._onMediaSourceClose),r.src=self.URL.createObjectURL(n),this._objectUrl=r.src,r.addEventListener("emptied",this._onMediaEmptied)}},t.onMediaDetaching=function(){var e=this.media,t=this.mediaSource,r=this._objectUrl;if(t){if(M.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){M.warn("[buffer-controller]: onMediaDetaching: "+e.message+" while calling endOfStream")}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),e.src===r?(e.removeAttribute("src"),e.load()):M.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(R.MEDIA_DETACHED,void 0)},t.onBufferReset=function(){var e=this;this.getSourceBufferTypes().forEach((function(t){var r=e.sourceBuffer[t];try{r&&(e.removeBufferListeners(t),e.mediaSource&&e.mediaSource.removeSourceBuffer(r),e.sourceBuffer[t]=void 0)}catch(e){M.warn("[buffer-controller]: Failed to reset the "+t+" buffer",e)}})),this._initSourceBuffer()},t.onBufferCodecs=function(e,t){var r=this,n=this.getSourceBufferTypes().length;Object.keys(t).forEach((function(e){if(n){var i=r.tracks[e];if(i&&"function"==typeof i.buffer.changeType){var a=t[e],o=a.id,s=a.codec,l=a.levelCodec,u=a.container,c=a.metadata,f=(i.levelCodec||i.codec).replace(ma,"$1"),d=(l||s).replace(ma,"$1");if(f!==d){var h=u+";codecs="+(l||s);r.appendChangeType(e,h),M.log("[buffer-controller]: switching codec "+f+" to "+d),r.tracks[e]={buffer:i.buffer,codec:s,container:u,levelCodec:l,metadata:c,id:o}}}}else r.pendingTracks[e]=t[e]})),n||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.appendChangeType=function(e,t){var r=this,n=this.operationQueue,i={execute:function(){var i=r.sourceBuffer[e];i&&(M.log("[buffer-controller]: changing "+e+" sourceBuffer type to "+t),i.changeType(t)),n.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){M.warn("[buffer-controller]: Failed to change "+e+" SourceBuffer type",t)}};n.append(i,e)},t.onBufferAppending=function(e,t){var r=this,n=this.hls,i=this.operationQueue,a=this.tracks,o=t.data,s=t.type,l=t.frag,u=t.part,c=t.chunkMeta,f=c.buffering[s],d=self.performance.now();f.start=d;var h=l.stats.buffering,g=u?u.stats.buffering:null;0===h.start&&(h.start=d),g&&0===g.start&&(g.start=d);var p=a.audio,m=!1;"audio"===s&&"audio/mpeg"===(null==p?void 0:p.container)&&(m=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);var v=l.start,y={execute:function(){if(f.executeStart=self.performance.now(),m){var e=r.sourceBuffer[s];if(e){var t=v-e.timestampOffset;Math.abs(t)>=.1&&(M.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+v+" (delta: "+t+") sn: "+l.sn+")"),e.timestampOffset=v)}}r.appendExecutor(o,s)},onStart:function(){},onComplete:function(){var e=self.performance.now();f.executeEnd=f.end=e,0===h.first&&(h.first=e),g&&0===g.first&&(g.first=e);var t=r.sourceBuffer,n={};for(var i in t)n[i]=qr.getBuffered(t[i]);r.appendError=0,r.hls.trigger(R.BUFFER_APPENDED,{type:s,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:n})},onError:function(e){M.error("[buffer-controller]: Error encountered while trying to append to the "+s+" SourceBuffer",e);var t={type:I.MEDIA_ERROR,parent:l.type,details:w.BUFFER_APPEND_ERROR,frag:l,part:u,chunkMeta:c,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=w.BUFFER_FULL_ERROR:(r.appendError++,t.details=w.BUFFER_APPEND_ERROR,r.appendError>n.config.appendErrorMaxRetry&&(M.error("[buffer-controller]: Failed "+n.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),t.fatal=!0)),n.trigger(R.ERROR,t)}};i.append(y,s)},t.onBufferFlushing=function(e,t){var r=this,n=this.operationQueue,i=function(e){return{execute:r.removeExecutor.bind(r,e,t.startOffset,t.endOffset),onStart:function(){},onComplete:function(){r.hls.trigger(R.BUFFER_FLUSHED,{type:e})},onError:function(t){M.warn("[buffer-controller]: Failed to remove from "+e+" SourceBuffer",t)}}};t.type?n.append(i(t.type),t.type):this.getSourceBufferTypes().forEach((function(e){n.append(i(e),e)}))},t.onFragParsed=function(e,t){var r=this,n=t.frag,i=t.part,a=[],o=i?i.elementaryStreams:n.elementaryStreams;o[K.AUDIOVIDEO]?a.push("audiovideo"):(o[K.AUDIO]&&a.push("audio"),o[K.VIDEO]&&a.push("video"));var s=function(){var e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);var t=i?i.stats:n.stats;r.hls.trigger(R.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})};0===a.length&&M.warn("Fragments must have at least one ElementaryStreamType set. type: "+n.type+" level: "+n.level+" sn: "+n.sn),this.blockBuffers(s,a)},t.onFragChanged=function(e,t){this.flushBackBuffer()},t.onBufferEos=function(e,t){var r=this;this.getSourceBufferTypes().reduce((function(e,n){var i=r.sourceBuffer[n];return!i||t.type&&t.type!==n||(i.ending=!0,i.ended||(i.ended=!0,M.log("[buffer-controller]: "+n+" sourceBuffer now EOS"))),e&&!(i&&!i.ended)}),!0)&&(M.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers((function(){r.getSourceBufferTypes().forEach((function(e){var t=r.sourceBuffer[e];t&&(t.ending=!1)}));var e=r.mediaSource;e&&"open"===e.readyState?(M.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()):e&&M.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+e.readyState)})))},t.onLevelUpdated=function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},t.flushBackBuffer=function(){var e=this.hls,t=this.details,r=this.media,n=this.sourceBuffer;if(r&&null!==t){var i=this.getSourceBufferTypes();if(i.length){var a=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(b(a)&&!(a<0)){var o=r.currentTime,s=t.levelTargetDuration,l=Math.max(a,s),u=Math.floor(o/s)*s-l;i.forEach((function(r){var i=n[r];if(i){var a=qr.getBuffered(i);if(a.length>0&&u>a.start(0)){if(e.trigger(R.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live)e.trigger(R.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u});else if(i.ended&&a.end(a.length-1)-o<2*s)return void M.info("[buffer-controller]: Cannot flush "+r+" back buffer while SourceBuffer is in ended state");e.trigger(R.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:r})}}}))}}}},t.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var e=this.details,t=this.hls,r=this.media,n=this.mediaSource,i=e.fragments[0].start+e.totalduration,a=r.duration,o=b(n.duration)?n.duration:0;e.live&&t.config.liveDurationInfinity?(M.log("[buffer-controller]: Media Source duration is set to Infinity"),n.duration=1/0,this.updateSeekableRange(e)):(i>o&&i>a||!b(a))&&(M.log("[buffer-controller]: Updating Media Source duration to "+i.toFixed(3)),n.duration=i)}},t.updateSeekableRange=function(e){var t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&null!=t&&t.setLiveSeekableRange){var n=Math.max(0,r[0].start),i=Math.max(n,n+e.totalduration);t.setLiveSeekableRange(n,i)}},t.checkPendingTracks=function(){var e=this.bufferCodecEventsExpected,t=this.operationQueue,r=this.pendingTracks,n=Object.keys(r).length;if(n&&!e||2===n){this.createSourceBuffers(r),this.pendingTracks={};var i=this.getSourceBufferTypes();if(i.length)this.hls.trigger(R.BUFFER_CREATED,{tracks:this.tracks}),i.forEach((function(e){t.executeNext(e)}));else{var a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}},t.createSourceBuffers=function(e){var t=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var n in e)if(!t[n]){var i=e[n];if(!i)throw Error("source buffer exists for track "+n+", however track does not");var a=i.levelCodec||i.codec,o=i.container+";codecs="+a;M.log("[buffer-controller]: creating sourceBuffer("+o+")");try{var s=t[n]=r.addSourceBuffer(o),l=n;this.addBufferListener(l,"updatestart",this._onSBUpdateStart),this.addBufferListener(l,"updateend",this._onSBUpdateEnd),this.addBufferListener(l,"error",this._onSBUpdateError),this.tracks[n]={buffer:s,codec:a,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id}}catch(e){M.error("[buffer-controller]: error while trying to add sourceBuffer: "+e.message),this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:o})}}},t._onSBUpdateStart=function(e){this.operationQueue.current(e).onStart()},t._onSBUpdateEnd=function(e){var t=this.operationQueue;t.current(e).onComplete(),t.shiftAndExecuteNext(e)},t._onSBUpdateError=function(e,t){var r=new Error(e+" SourceBuffer error");M.error("[buffer-controller]: "+r,t),this.hls.trigger(R.ERROR,{type:I.MEDIA_ERROR,details:w.BUFFER_APPENDING_ERROR,error:r,fatal:!1});var n=this.operationQueue.current(e);n&&n.onError(t)},t.removeExecutor=function(e,t,r){var n=this.media,i=this.mediaSource,a=this.operationQueue,o=this.sourceBuffer[e];if(!n||!i||!o)return M.warn("[buffer-controller]: Attempting to remove from the "+e+" SourceBuffer, but it does not exist"),void a.shiftAndExecuteNext(e);var s=b(n.duration)?n.duration:1/0,l=b(i.duration)?i.duration:1/0,u=Math.max(0,t),c=Math.min(r,s,l);c>u&&!o.ending?(o.ended=!1,M.log("[buffer-controller]: Removing ["+u+","+c+"] from the "+e+" SourceBuffer"),o.remove(u,c)):a.shiftAndExecuteNext(e)},t.appendExecutor=function(e,t){var r=this.operationQueue,n=this.sourceBuffer[t];if(!n)return M.warn("[buffer-controller]: Attempting to append to the "+t+" SourceBuffer, but it does not exist"),void r.shiftAndExecuteNext(t);n.ended=!1,n.appendBuffer(e)},t.blockBuffers=function(e,t){var r=this;if(void 0===t&&(t=this.getSourceBufferTypes()),!t.length)return M.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(e);var n=this.operationQueue,i=t.map((function(e){return n.appendBlocker(e)}));Promise.all(i).then((function(){e(),t.forEach((function(e){var t=r.sourceBuffer[e];null!=t&&t.updating||n.shiftAndExecuteNext(e)}))}))},t.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},t.addBufferListener=function(e,t,r){var n=this.sourceBuffer[e];if(n){var i=r.bind(this,e);this.listeners[e].push({event:t,listener:i}),n.addEventListener(t,i)}},t.removeBufferListeners=function(e){var t=this.sourceBuffer[e];t&&this.listeners[e].forEach((function(e){t.removeEventListener(e.event,e.listener)}))},e}(),ya={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Ea=function(e){var t=e;return ya.hasOwnProperty(e)&&(t=ya[e]),String.fromCharCode(t)},Ta=15,_a=100,Sa={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Aa={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ba={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Ra={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ia=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],wa=function(){function e(){this.time=null,this.verboseLevel=0}return e.prototype.log=function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;M.log(this.time+" ["+e+"] "+r)}},e}(),Da=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Ca=function(){function e(e,t,r,n,i){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=r||!1,this.background=n||"black",this.flash=i||!1}var t=e.prototype;return t.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},t.setStyles=function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}},t.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},t.equals=function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},t.copy=function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},t.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},e}(),Na=function(){function e(e,t,r,n,i,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new Ca(t,r,n,i,a)}var t=e.prototype;return t.reset=function(){this.uchar=" ",this.penState.reset()},t.setChar=function(e,t){this.uchar=e,this.penState.copy(t)},t.setPenState=function(e){this.penState.copy(e)},t.equals=function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},t.copy=function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},t.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},e}(),La=function(){function e(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var t=0;t<_a;t++)this.chars.push(new Na);this.logger=e,this.pos=0,this.currPenState=new Ca}var t=e.prototype;return t.equals=function(e){for(var t=!0,r=0;r<_a;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<_a;t++)this.chars[t].copy(e.chars[t])},t.isEmpty=function(){for(var e=!0,t=0;t<_a;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},t.setCursor=function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>_a&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=_a)},t.moveCursor=function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)},t.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},t.insertChar=function(e){var t=this;e>=144&&this.backSpace();var r=Ea(e);this.pos>=_a?this.logger.log(0,(function(){return"Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1))},t.clearFromPos=function(e){var t;for(t=e;t<_a;t++)this.chars[t].reset()},t.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},t.clearToEndOfRow=function(){this.clearFromPos(this.pos)},t.getTextString=function(){for(var e=[],t=!0,r=0;r<_a;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")},t.setPenStyles=function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)},e}(),Oa=function(){function e(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var t=0;t<Ta;t++)this.rows.push(new La(e));this.logger=e,this.currRow=Ta-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var t=e.prototype;return t.reset=function(){for(var e=0;e<Ta;e++)this.rows[e].clear();this.currRow=Ta-1},t.equals=function(e){for(var t=!0,r=0;r<Ta;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t},t.copy=function(e){for(var t=0;t<Ta;t++)this.rows[t].copy(e.rows[t])},t.isEmpty=function(){for(var e=!0,t=0;t<Ta;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},t.backSpace=function(){this.rows[this.currRow].backSpace()},t.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},t.insertChar=function(e){this.rows[this.currRow].insertChar(e)},t.setPen=function(e){this.rows[this.currRow].setPenStyles(e)},t.moveCursor=function(e){this.rows[this.currRow].moveCursor(e)},t.setCursor=function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)},t.setPAC=function(e){this.logger.log(2,(function(){return"pacData = "+JSON.stringify(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<Ta;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var a=i.rows[n].cueStartTime,o=this.logger.time;if(a&&null!==o&&a<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[n+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var f={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(f)},t.setBkgData=function(e){this.logger.log(2,(function(){return"bkgData = "+JSON.stringify(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)},t.setRollUpRows=function(e){this.nrRollUpRows=e},t.rollUp=function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}else this.logger.log(3,"roll_up but nrRollUpRows not set yet")},t.getDisplayText=function(e){e=e||!1;for(var t=[],r="",n=-1,i=0;i<Ta;i++){var a=this.rows[i].getTextString();a&&(n=i+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r},t.getTextAndFormat=function(){return this.rows},e}(),Pa=function(){function e(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Oa(r),this.nonDisplayedMemory=new Oa(r),this.lastOutputScreen=new Oa(r),this.currRollUpRow=this.displayedMemory.rows[Ta-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var t=e.prototype;return t.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Ta-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},t.getHandler=function(){return this.outputFilter},t.setHandler=function(e){this.outputFilter=e},t.setPAC=function(e){this.writeScreen.setPAC(e)},t.setBkgData=function(e){this.writeScreen.setBkgData(e)},t.setMode=function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},t.insertChars=function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return n+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())},t.ccRCL=function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},t.ccBS=function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},t.ccAOF=function(){},t.ccAON=function(){},t.ccDER=function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},t.ccRU=function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},t.ccFON=function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},t.ccRDC=function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},t.ccTR=function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")},t.ccRTD=function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")},t.ccEDM=function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},t.ccCR=function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},t.ccENM=function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},t.ccEOC=function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)},t.ccTO=function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},t.ccMIDROW=function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16,n=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=n[r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},t.outputDataUpdate=function(e){void 0===e&&(e=!1);var t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},t.cueSplitAtTime=function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))},e}(),Ma=function(){function e(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var n=new wa;this.channels=[null,new Pa(e,t,n),new Pa(e+1,r,n)],this.cmdHistory=Fa(),this.logger=n}var t=e.prototype;return t.getHandler=function(e){return this.channels[e].getHandler()},t.setHandler=function(e,t){this.channels[e].setHandler(t)},t.addData=function(e,t){var r,n,i,a=!1;this.logger.time=e;for(var o=0;o<t.length;o+=2)if(n=127&t[o],i=127&t[o+1],0!==n||0!==i){if(this.logger.log(3,"["+Da([t[o],t[o+1]])+"] -> ("+Da([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(a=this.parseChars(n,i))){var s=this.currentChannel;s&&s>0?this.channels[s].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}r||a||this.logger.log(2,"Couldn't parse cleaned data "+Da([n,i])+" orig: "+Da([t[o],t[o+1]]))}},t.parseCmd=function(e,t){var r=this.cmdHistory;if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=33&&t<=35))return!1;if(xa(e,t,r))return ka(null,null,r),this.logger.log(3,"Repeated command ("+Da([e,t])+") is dropped"),!0;var n=20===e||21===e||23===e?1:2,i=this.channels[n];return 20===e||21===e||28===e||29===e?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),ka(e,t,r),this.currentChannel=n,!0},t.parseMidrow=function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(3,"MIDROW ("+Da([e,t])+")"),!0)}return!1},t.parsePAC=function(e,t){var r,n=this.cmdHistory;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127||(16===e||24===e)&&t>=64&&t<=95))return!1;if(xa(e,t,n))return ka(null,null,n),!0;var i=e<=23?1:2;r=t>=64&&t<=95?1===i?Sa[e]:ba[e]:1===i?Aa[e]:Ra[e];var a=this.channels[i];return!!a&&(a.setPAC(this.interpretPAC(r,t)),ka(e,t,n),this.currentChannel=i,!0)},t.interpretPAC=function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n},t.parseChars=function(e,t){var r,n,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19?(n=17===a?t+80:18===a?t+112:t+144,this.logger.log(2,"Special char '"+Ea(n)+"' in channel "+r),i=[n]):e>=32&&e<=127&&(i=0===t?[e]:[e,t]),i){var o=Da(i);this.logger.log(3,"Char codes =  "+o.join(",")),ka(e,t,this.cmdHistory)}return i},t.parseBackgroundAttributes=function(e,t){var r;if(!((16===e||24===e)&&t>=32&&t<=47||(23===e||31===e)&&t>=45&&t<=47))return!1;var n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=Ia[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(n),ka(e,t,this.cmdHistory),!0},t.reset=function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}this.cmdHistory=Fa()},t.cueSplitAtTime=function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}},e}();function ka(e,t,r){r.a=e,r.b=t}function xa(e,t,r){return r.a===e&&r.b===t}function Fa(){return{a:null,b:null}}var Ua=function(){function e(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}var t=e.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},t.newCue=function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},t.reset=function(){this.cueRanges=[],this.startTime=null},e}(),Ba=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var r=t.toLowerCase();return!!~e.indexOf(r)&&r}function n(t){return r(e,t)}function i(e){return r(t,e)}function a(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)e[o]=a[o]}return e}function o(e,t,r){var o=this,s={enumerable:!0};o.hasBeenReset=!1;var l="",u=!1,c=e,f=t,d=r,h=null,g="",p=!0,m="auto",v="start",y=50,E="middle",T=50,_="middle";Object.defineProperty(o,"id",a({},s,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(o,"pauseOnExit",a({},s,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(o,"startTime",a({},s,{get:function(){return c},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},s,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},s,{get:function(){return d},set:function(e){d=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},s,{get:function(){return h},set:function(e){h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},s,{get:function(){return g},set:function(e){var t=n(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");g=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},s,{get:function(){return p},set:function(e){p=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},s,{get:function(){return m},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},s,{get:function(){return v},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");v=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},s,{get:function(){return y},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},s,{get:function(){return E},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},s,{get:function(){return T},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},s,{get:function(){return _},set:function(e){var t=i(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");_=t,this.hasBeenReset=!0}})),o.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}(),Za=function(){function e(){}return e.prototype.decode=function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))},e}();function Ga(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(n||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var Ka=function(){function e(){this.values=Object.create(null)}var t=e.prototype;return t.set=function(e,t){this.get(e)||""===t||(this.values[e]=t)},t.get=function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},t.has=function(e){return e in this.values},t.alt=function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},t.integer=function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},t.percent=function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1},e}();function Ha(e,t,r,n){var i=n?e.split(n):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(r);2===o.length&&t(o[0],o[1])}}var Ya=new Ba(0,0,""),Va="middle"===Ya.align?"middle":"center";function qa(e,t,r){var n=e;function i(){var t=Ga(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(e,t){var n=new Ka;Ha(e,(function(e,t){var i;switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),n.integer(e,i[0]),n.percent(e,i[0])&&n.set("snapToLines",!1),n.alt(e,i[0],["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",Va,"end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",Va,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",Va,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===Ya.line&&(i=-1),t.line=i,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",Va);var a=n.get("position","auto");"auto"===a&&50===Ya.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}function o(){e=e.replace(/^\s+/,"")}if(o(),t.startTime=i(),o(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.slice(3),o(),t.endTime=i(),o(),a(e,t)}function ja(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var za=function(){function e(){this.state="INITIAL",this.buffer="",this.decoder=new Za,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var t=e.prototype;return t.parse=function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=ja(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),n}function n(e){Ha(e,(function(e,t){}),/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var i="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(i=r()).match(/^()?WEBVTT([ \t].*)?$/);if(null==a||!a[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var o=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:i=r(),t.state){case"HEADER":/:/.test(i)?n(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new Ba(0,0,""),t.state="CUE",-1===i.indexOf("--\x3e")){t.cue.id=i;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{qa(i,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},t.flush=function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this},e}(),Wa=/\r\n|\n\r|\n|\r/g,Xa=function(e,t,r){return void 0===r&&(r=0),e.slice(r,r+t.length)===t},Qa=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(b(t)&&b(r)&&b(n)&&b(i)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+e);return t+=1e3*r,t+=6e4*n,t+=36e5*i},Ja=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()};function $a(e,t,r){return Ja(e.toString())+Ja(t.toString())+Ja(r)}var eo=function(e,t,r){var n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;null!=(a=i)&&a.new;){var a;e.ccOffset+=n.start-i.start,n.new=!1,i=e[(n=i).prevCC]}e.presentationOffset=r};function to(e,t,r,n,i,a,o){var s,l=new za,u=Re(new Uint8Array(e)).trim().replace(Wa,"\n").split("\n"),c=[],f=t?ci(t.baseTime,t.timescale):0,d="00:00.000",h=0,g=0,p=!0;l.oncue=function(e){var a=r[n],o=r.ccOffset,l=(h-f)/9e4;if(null!=a&&a.new&&(void 0!==g?o=r.ccOffset=a.start:eo(r,n,l)),l){if(!t)return void(s=new Error("Missing initPTS for VTT MPEGTS"));o=l-r.presentationOffset}var u=e.endTime-e.startTime,d=vi(9e4*(e.startTime+o-g),9e4*i)/9e4;e.startTime=Math.max(d,0),e.endTime=Math.max(d+u,0);var p=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(p)),e.id||(e.id=$a(e.startTime,e.endTime,p)),e.endTime>0&&c.push(e)},l.onparsingerror=function(e){s=e},l.onflush=function(){s?o(s):a(c)},u.forEach((function(e){if(p){if(Xa(e,"X-TIMESTAMP-MAP=")){p=!1,e.slice(16).split(",").forEach((function(e){Xa(e,"LOCAL:")?d=e.slice(6):Xa(e,"MPEGTS:")&&(h=parseInt(e.slice(7)))}));try{g=Qa(d)/1e3}catch(e){s=e}return}""===e&&(p=!1)}l.parse(e+"\n")})),l.flush()}var ro="stpp.ttml.im1t",no=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,io=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ao={left:"start",center:"center",right:"end",start:"start",end:"end"};function oo(e,t,r,n){var i=xe(new Uint8Array(e),["mdat"]);if(0!==i.length){var a=i.map((function(e){return Re(e)})),o=li(t.baseTime,1,t.timescale);try{a.forEach((function(e){return r(so(e,o))}))}catch(e){n(e)}}else n(new Error("Could not parse IMSC1 mdat"))}function so(e,t){var r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(n).reduce((function(e,t){return e[t]=r.getAttribute("ttp:"+t)||n[t],e}),{}),a="preserve"!==r.getAttribute("xml:space"),o=uo(lo(r,"styling","style")),l=uo(lo(r,"layout","region")),u=lo(r,"body","[begin]");return[].map.call(u,(function(e){var r=co(e,a);if(!r||!e.hasAttribute("begin"))return null;var n=po(e.getAttribute("begin"),i),u=po(e.getAttribute("dur"),i),c=po(e.getAttribute("end"),i);if(null===n)throw go(e);if(null===c){if(null===u)throw go(e);c=n+u}var f=new Ba(n-t,c-t,r);f.id=$a(f.startTime,f.endTime,f.text);var d=fo(l[e.getAttribute("region")],o[e.getAttribute("style")],o),h=d.textAlign;if(h){var g=ao[h];g&&(f.lineAlign=g),f.align=h}return s(f,d),f})).filter((function(e){return null!==e}))}function lo(e,t,r){var n=e.getElementsByTagName(t)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function uo(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function co(e,t){return[].slice.call(e.childNodes).reduce((function(e,r,n){var i;return"br"===r.nodeName&&n?e+"\n":null!=(i=r.childNodes)&&i.length?co(r,t):t?e+r.textContent.trim().replace(/\s+/g," "):e+r.textContent}),"")}function fo(e,t,r){var n="http://www.w3.org/ns/ttml#styling",i=null,a=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return o&&r.hasOwnProperty(o)&&(i=r[o]),a.reduce((function(r,a){var o=ho(t,n,a)||ho(e,n,a)||ho(i,n,a);return o&&(r[a]=o),r}),{})}function ho(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function go(e){return new Error("Could not parse ttml timestamp "+e)}function po(e,t){if(!e)return null;var r=Ga(e);return null===r&&(no.test(e)?r=mo(e,t):io.test(e)&&(r=vo(e,t))),r}function mo(e,t){var r=no.exec(e),n=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/t.frameRate}function vo(e,t){var r=io.exec(e),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/t.frameRate;case"t":return n/t.tickRate}return n}var yo=function(){function e(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_o(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var t=new Ua(this,"textTrack1"),r=new Ua(this,"textTrack2"),n=new Ua(this,"textTrack3"),i=new Ua(this,"textTrack4");this.cea608Parser1=new Ma(1,t,r),this.cea608Parser2=new Ma(3,n,i)}e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(R.FRAG_LOADING,this.onFragLoading,this),e.on(R.FRAG_LOADED,this.onFragLoaded,this),e.on(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(R.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=e.prototype;return t.destroy=function(){var e=this.hls;e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(R.FRAG_LOADING,this.onFragLoading,this),e.off(R.FRAG_LOADED,this.onFragLoaded,this),e.off(R.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(R.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(R.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(R.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(R.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,t,r,n,i){for(var a=!1,o=i.length;o--;){var s=i[o],l=To(s[0],s[1],t,r);if(l>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],r),a=!0,l/(r-t)>.5))return}if(a||i.push([t,r]),this.config.renderTextTracksNatively){var u=this.captionsTracks[e];this.Cues.newCue(u,t,r,n)}else{var c=this.Cues.newCue(null,t,r,n);this.hls.trigger(R.CUES_PARSED,{type:"captions",cues:c,track:e})}},t.onInitPtsFound=function(e,t){var r=this,n=t.frag,i=t.id,a=t.initPTS,o=t.timescale,s=this.unparsedVttFrags;"main"===i&&(this.initPTS[n.cc]={baseTime:a,timescale:o}),s.length&&(this.unparsedVttFrags=[],s.forEach((function(e){r.onFragLoaded(R.FRAG_LOADED,e)})))},t.getExistingTrack=function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r];if(n[e])return n}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,n=this.media,i=t[e],a=i.label,o=i.languageCode,s=this.getExistingTrack(e);if(s)r[e]=s,Ft(r[e]),kt(r[e],n);else{var l=this.createTextTrack("captions",a,o);l&&(l[e]=!0,r[e]=l)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},t.createTextTrack=function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)},t.onMediaAttaching=function(e,t){this.media=t.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach((function(t){Ft(e[t]),delete e[t]})),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=_o(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)Ft(t[r])}},t.onSubtitleTracksUpdated=function(e,t){var r=this,n=t.subtitleTracks||[],i=n.some((function(e){return e.textCodec===ro}));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(sa(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){var a=this.media?this.media.textTracks:null;this.tracks.forEach((function(e,t){var n;if(a&&t<a.length){for(var i=null,o=0;o<a.length;o++)if(Eo(a[o],e)){i=a[o];break}i&&(n=i)}if(n)Ft(n);else{var s=r._captionsOrSubtitlesFromCharacteristics(e);(n=r.createTextTrack(s,e.name,e.lang))&&(n.mode="disabled")}n&&(n.groupId=e.groupId,r.textTracks.push(n))}))}else if(this.tracks.length){var o=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger(R.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}},t._captionsOrSubtitlesFromCharacteristics=function(e){if(e.attrs.CHARACTERISTICS){var t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),r=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&r)return"captions"}return"subtitles"},t.onManifestLoaded=function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var n="textTrack"+t[1],i=r.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}}))},t.closedCaptionsForLevel=function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]},t.onFragLoading=function(e,t){var r=this.cea608Parser1,n=this.cea608Parser2,i=this.lastSn,a=this.lastPartIndex;if(this.enabled&&r&&n&&t.frag.type===Lt.MAIN){var o,s,l=t.frag.sn,u=null!=(o=null==t||null==(s=t.part)?void 0:s.index)?o:-1;l===i+1||l===i&&u===a+1||(r.reset(),n.reset()),this.lastSn=l,this.lastPartIndex=u}},t.onFragLoaded=function(e,t){var r=t.frag,n=t.payload;if(r.type===Lt.SUBTITLE)if(n.byteLength){var i=r.decryptdata,a="stats"in t;if(null==i||!i.encrypted||a){var o=this.tracks[r.level],s=this.vttCCs;s[r.cc]||(s[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===ro?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,t){var r=this,n=this.hls;oo(t,this.initPTS[e.cc],(function(t){r._appendCues(t,e.level),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){M.log("Failed to parse IMSC1: "+t),n.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))},t._parseVTTs=function(e){var t,r=this,n=e.frag,i=e.payload,a=this.initPTS,o=this.unparsedVttFrags,s=a.length-1;if(a[n.cc]||-1!==s){var l=this.hls;to(null!=(t=n.initSegment)&&t.data?qe(n.initSegment.data,new Uint8Array(i)):i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(function(e){r._appendCues(e,n.level),l.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(function(t){var a="Missing initPTS for VTT MPEGTS"===t.message;a?o.push(e):r._fallbackToIMSC1(n,i),M.log("Failed to parse VTT cue: "+t),a&&s>n.cc||l.trigger(R.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}else o.push(e)},t._fallbackToIMSC1=function(e,t){var r=this,n=this.tracks[e.level];n.textCodec||oo(t,this.initPTS[e.cc],(function(){n.textCodec=ro,r._parseIMSC1(e,t)}),(function(){n.textCodec="wvtt"}))},t._appendCues=function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((function(e){return xt(n,e)}))}else{var i=this.tracks[t];if(!i)return;var a=i.default?"default":"subtitles"+t;r.trigger(R.CUES_PARSED,{type:"subtitles",cues:e,track:a})}},t.onFragDecrypted=function(e,t){t.frag.type===Lt.SUBTITLE&&this.onFragLoaded(R.FRAG_LOADED,t)},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,t){var r=this.cea608Parser1,n=this.cea608Parser2;if(this.enabled&&r&&n){var i=t.frag,a=t.samples;if(i.type!==Lt.MAIN||"NONE"!==this.closedCaptionsForLevel(i))for(var o=0;o<a.length;o++){var s=a[o].bytes;if(s){var l=this.extractCea608Data(s);r.addData(a[o].pts,l[0]),n.addData(a[o].pts,l[1])}}}},t.onBufferFlushing=function(e,t){var r=t.startOffset,n=t.endOffset,i=t.endOffsetSubtitles,a=t.type,o=this.media;if(o&&!(o.currentTime<n)){if(!a||"video"===a){var s=this.captionsTracks;Object.keys(s).forEach((function(e){return Ut(s[e],r,n)}))}if(this.config.renderTextTracksNatively&&0===r&&void 0!==i){var l=this.textTracks;Object.keys(l).forEach((function(e){return Ut(l[e],r,i)}))}}},t.extractCea608Data=function(e){for(var t=[[],[]],r=31&e[0],n=2,i=0;i<r;i++){var a=e[n++],o=127&e[n++],s=127&e[n++];if((0!==o||0!==s)&&0!=(4&a)){var l=3&a;0!==l&&1!==l||(t[l].push(o),t[l].push(s))}}return t},e}();function Eo(e,t){return!!e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)}function To(e,t,r,n){return Math.min(t,n)-Math.max(e,r)}function _o(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}var So=function(){function e(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},t.registerListeners=function(){var e=this.hls;e.on(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.BUFFER_CODECS,this.onBufferCodecs,this),e.on(R.MEDIA_DETACHING,this.onMediaDetaching,this)},t.unregisterListener=function(){var e=this.hls;e.off(R.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.BUFFER_CODECS,this.onBufferCodecs,this),e.off(R.MEDIA_DETACHING,this.onMediaDetaching,this)},t.onFpsDropLevelCapping=function(e,t){var r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})},t.onMediaAttaching=function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null},t.onManifestParsed=function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onBufferCodecs=function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},t.onMediaDetaching=function(){this.stopCapping()},t.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var e=this.hls.levels;if(e.length){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}},t.getMaxLevel=function(t){var r=this,n=this.hls.levels;if(!n.length)return-1;var i=n.filter((function(e,n){return r.isLevelAllowed(e)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},t.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},t.getDimensions=function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t},t.isLevelAllowed=function(e){return!this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))},e.getMaxLevelByMediaSize=function(e,t,r){if(null==e||!e.length)return-1;for(var n=function(e,t){return!t||e.width!==t.width||e.height!==t.height},i=e.length-1,a=0;a<e.length;a+=1){var o=e[a];if((o.width>=t||o.height>=r)&&n(o,e[a+1])){i=a;break}}return i},a(e,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}}]),e}(),Ao=function(){function e(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}var t=e.prototype;return t.setStreamController=function(e){this.streamController=e},t.registerListeners=function(){this.hls.on(R.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.unregisterListeners=function(){this.hls.off(R.MEDIA_ATTACHING,this.onMediaAttaching,this)},t.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},t.onMediaAttaching=function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}},t.checkFPS=function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*a/i,l=this.hls;if(l.trigger(R.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),s>0&&a>l.config.fpsDroppedMonitoringThreshold*o){var u=l.currentLevel;M.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger(R.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}},t.checkFPSInterval=function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)},e}(),bo="[eme]",Ro=function(){function e(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=e.CDMCleanupPromise?[e.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=M.debug.bind(M,bo),this.log=M.log.bind(M,bo),this.warn=M.warn.bind(M,bo),this.error=M.error.bind(M,bo),this.hls=t,this.config=t.config,this.registerListeners()}var t=e.prototype;return t.destroy=function(){this.unregisterListeners(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null},t.registerListeners=function(){this.hls.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(R.MANIFEST_LOADED,this.onManifestLoaded,this)},t.unregisterListeners=function(){this.hls.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(R.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(R.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(R.MANIFEST_LOADED,this.onManifestLoaded,this)},t.getLicenseServerUrl=function(e){var t=this.config,r=t.drmSystems,n=t.widevineLicenseUrl,i=r[e];if(i)return i.licenseUrl;if(e===$.WIDEVINE&&n)return n;throw new Error('no license server URL configured for key-system "'+e+'"')},t.getServerCertificateUrl=function(e){var t=this.config.drmSystems[e];if(t)return t.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+e+'"]')},t.attemptKeySystemAccess=function(e){var t=this,r=this.hls.levels,n=function(e,t,r){return!!e&&r.indexOf(e)===t},i=r.map((function(e){return e.audioCodec})).filter(n),a=r.map((function(e){return e.videoCodec})).filter(n);return i.length+a.length===0&&a.push("avc1.42e01e"),new Promise((function(r,n){!function e(o){var s=o.shift();t.getMediaKeysPromise(s,i,a).then((function(e){return r({keySystem:s,mediaKeys:e})})).catch((function(t){o.length?e(o):n(t instanceof Io?t:new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))}(e)}))},t.requestMediaKeySystemAccess=function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var n="Configured requestMediaKeySystemAccess is not a function "+r;return null===oe&&"http:"===self.location.protocol&&(n="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(n))}return r(e,t)},t.getMediaKeysPromise=function(e,t,r){var n=this,i=se(e,t,r,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e],o=null==a?void 0:a.keySystemAccess;if(!o){this.log('Requesting encrypted media "'+e+'" key-system access with config: '+JSON.stringify(i)),o=this.requestMediaKeySystemAccess(e,i);var s=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch((function(t){n.log('Failed to obtain access to key-system "'+e+'": '+t)})),o.then((function(t){n.log('Access for key-system "'+t.keySystem+'" obtained');var r=n.fetchServerCertificate(e);return n.log('Create media-keys for "'+e+'"'),s.mediaKeys=t.createMediaKeys().then((function(t){return n.log('Media-keys created for "'+e+'"'),r.then((function(r){return r?n.setMediaKeysServerCertificate(t,e,r):t}))})),s.mediaKeys.catch((function(t){n.error('Failed to create media-keys for "'+e+'"}: '+t)})),s.mediaKeys}))}return o.then((function(){return a.mediaKeys}))},t.createMediaKeySessionContext=function(e){var t=e.decryptdata,r=e.keySystem,n=e.mediaKeys;this.log('Creating key-system session "'+r+'" keyId: '+we.hexDump(t.keyId||[]));var i=n.createSession(),a={decryptdata:t,keySystem:r,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a},t.renewKeySession=function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),n=this.getKeyIdString(t),i="cenc";this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,i,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)},t.getKeyIdString=function(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return we.hexDump(e.keyId)},t.updateKeySession=function(e,t){var r,n=e.mediaKeysSession;return this.log('Updating key-session "'+n.sessionId+'" for keyID '+we.hexDump((null==(r=e.decryptdata)?void 0:r.keyId)||[])+"\n      } (data length: "+(t?t.byteLength:t)+")"),n.update(t)},t.selectKeySystemFormat=function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+e.sn+" "+e.type+": "+e.level+") key formats "+t.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise},t.getKeyFormatPromise=function(e){var t=this;return new Promise((function(r,n){var i=ae(t.config),a=e.map(te).filter((function(e){return!!e&&-1!==i.indexOf(e)}));return t.getKeySystemSelectionPromise(a).then((function(e){var t=e.keySystem,i=ie(t);i?r(i):n(new Error('Unable to find format for key-system "'+t+'"'))})).catch(n)}))},t.loadKey=function(e){var t=this,r=e.keyInfo.decryptdata,n=this.getKeyIdString(r),i="(keyId: "+n+' format: "'+r.keyFormat+'" method: '+r.method+" uri: "+r.uri+")";this.log("Starting session for key "+i);var a=this.keyIdToKeySessionPromise[n];return a||(a=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(r).then((function(n){var a=n.keySystem,o=n.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: "+e.frag.sn+" "+e.frag.type+": "+e.frag.level+" using key "+i),t.attemptSetMediaKeys(a,o).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:r}),n="cenc";return t.generateRequestWithPreferredKeySession(e,n,r.pssh,"playlist-key")}))}))).catch((function(e){return t.handleError(e)})),a},t.throwIfDestroyed=function(e){if(!this.hls)throw new Error("invalid state")},t.handleError=function(e){this.hls&&(this.error(e.message),e instanceof Io?this.hls.trigger(R.ERROR,e.data):this.hls.trigger(R.ERROR,{type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))},t.getKeySystemForKeyPromise=function(e){var t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){var n=te(e.keyFormat),i=n?[n]:ae(this.config);return this.attemptKeySystemAccess(i)}return r},t.getKeySystemSelectionPromise=function(e){if(e.length||(e=ae(this.config)),0===e.length)throw new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(e)},t._onMediaEncrypted=function(e){var t=this,r=e.initDataType,n=e.initData;if(this.debug('"'+e.type+'" event: init data type: "'+r+'"'),null!==n){var i,a;if("sinf"===r&&this.config.drmSystems[$.FAIRPLAY]){var o=Le(new Uint8Array(n));try{var s=z(JSON.parse(o).sinf),l=Ze(new Uint8Array(s));if(!l)return;i=l.subarray(8,24),a=$.FAIRPLAY}catch(e){return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var u=tt(n);if(null===u)return;0===u.version&&u.systemId===re.WIDEVINE&&u.data&&(i=u.data.subarray(8,24)),a=ne(u.systemId)}if(a&&i){for(var c=we.hexDump(i),f=this.keyIdToKeySessionPromise,d=this.mediaKeySessions,h=f[c],g=function(){var e=d[p],a=e.decryptdata;if(a.pssh||!a.keyId)return"continue";var o=we.hexDump(a.keyId);return c===o||-1!==a.uri.replace(/-/g,"").indexOf(c)?(h=f[o],delete f[o],a.pssh=new Uint8Array(n),a.keyId=i,h=f[c]=h.then((function(){return t.generateRequestWithPreferredKeySession(e,r,n,"encrypted-event-key-match")})),"break"):void 0},p=0;p<d.length;p++){var m=g();if("continue"!==m&&"break"===m)break}h||(h=f[c]=this.getKeySystemSelectionPromise([a]).then((function(e){var a,o=e.keySystem,s=e.mediaKeys;t.throwIfDestroyed();var l=new nt("ISO-23001-7",c,null!=(a=ie(o))?a:"");return l.pssh=new Uint8Array(n),l.keyId=i,t.attemptSetMediaKeys(o,s).then((function(){t.throwIfDestroyed();var e=t.createMediaKeySessionContext({decryptdata:l,keySystem:o,mediaKeys:s});return t.generateRequestWithPreferredKeySession(e,r,n,"encrypted-event-no-match")}))}))),h.catch((function(e){return t.handleError(e)}))}}},t._onWaitingForKey=function(e){this.log('"'+e.type+'" event')},t.attemptSetMediaKeys=function(e,t){var r=this,n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+e+'"');var i=Promise.all(n).then((function(){if(!r.media)throw new Error("Attempted to set mediaKeys without media element attached");return r.media.setMediaKeys(t)}));return this.setMediaKeysQueue.push(i),i.then((function(){r.log('Media-keys set for "'+e+'"'),n.push(i),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return-1===n.indexOf(e)}))}))},t.generateRequestWithPreferredKeySession=function(e,t,r,n){var i,a,o=this,s=null==(i=this.config.drmSystems)||null==(a=i[e.keySystem])?void 0:a.generateRequest;if(s)try{var l=s.call(this.hls,t,r,e);if(!l)throw new Error("Invalid response from configured generateRequest filter");t=l.initDataType,r=e.decryptdata.pssh=l.initData?new Uint8Array(l.initData):null}catch(e){var u;if(this.warn(e.message),null!=(u=this.hls)&&u.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'+n+'" (no initData)'),Promise.resolve(e);var c=this.getKeyIdString(e.decryptdata);this.log('Generating key-session request for "'+n+'": '+c+" (init data type: "+t+" length: "+(r?r.byteLength:null)+")");var f=new ki;e.mediaKeysSession.onmessage=function(t){var r=e.mediaKeysSession;if(r){var n=t.messageType,i=t.message;o.log('"'+n+'" message event for session "'+r.sessionId+'" message size: '+i.byteLength),"license-request"===n||"license-renewal"===n?o.renewLicense(e,i).catch((function(e){o.handleError(e),f.emit("error",e)})):"license-release"===n?e.keySystem===$.FAIRPLAY&&(o.updateKeySession(e,J("acknowledged")),o.removeSession(e)):o.warn('unhandled media key message type "'+n+'"')}else f.emit("error",new Error("invalid state"))},e.mediaKeysSession.onkeystatuseschange=function(t){if(e.mediaKeysSession){o.onKeyStatusChange(e);var r=e.keyStatus;f.emit("keyStatus",r),"expired"===r&&(o.warn(e.keySystem+" expired for key "+c),o.renewKeySession(e))}else f.emit("error",new Error("invalid state"))};var d=new Promise((function(e,t){f.on("error",t),f.on("keyStatus",(function(r){r.startsWith("usable")?e():"output-restricted"===r?t(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===r?t(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+r+'"')):"expired"===r?t(new Error("key expired while generating request")):o.warn('unhandled key status change "'+r+'"')}))}));return e.mediaKeysSession.generateRequest(t,r).then((function(){var t;o.log('Request generated for key-session "'+(null==(t=e.mediaKeysSession)?void 0:t.sessionId)+'" keyId: '+c)})).catch((function(e){throw new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},"Error generating key-session request: "+e)})).then((function(){return d})).catch((function(t){throw f.removeAllListeners(),o.removeSession(e),t})).then((function(){return f.removeAllListeners(),e}))},t.onKeyStatusChange=function(e){var t=this;e.mediaKeysSession.keyStatuses.forEach((function(r,n){t.log('key status change "'+r+'" for keyStatuses keyId: '+we.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))+" session keyId: "+we.hexDump(new Uint8Array(e.decryptdata.keyId||[]))+" uri: "+e.decryptdata.uri),e.keyStatus=r}))},t.fetchServerCertificate=function(e){var t=this.config,r=new(0,t.loader)(t),i=this.getServerCertificateUrl(e);return i?(this.log('Fetching serverCertificate for "'+e+'"'),new Promise((function(a,o){var s={responseType:"arraybuffer",url:i},l=t.certLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:function(e,t,r,n){a(e.data)},onError:function(t,r,a,l){o(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:n({url:s.url,data:void 0},t)},'"'+e+'" certificate request failed ('+i+"). Status: "+t.code+" ("+t.text+")"))},onTimeout:function(t,r,n){o(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:s.url,data:void 0}},'"'+e+'" certificate request timed out ('+i+")"))},onAbort:function(e,t,r){o(new Error("aborted"))}};r.load(s,u,c)}))):Promise.resolve()},t.setMediaKeysServerCertificate=function(e,t,r){var n=this;return new Promise((function(i,a){e.setServerCertificate(r).then((function(a){n.log("setServerCertificate "+(a?"success":"not supported by CDM")+" ("+(null==r?void 0:r.byteLength)+') on "'+t+'"'),i(e)})).catch((function(e){a(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))},t.renewLicense=function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(e){throw new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}))},t.setupLicenseXHR=function(e,t,r,n){var i=this,a=this.config.licenseXhrSetup;return a?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return a.call(i.hls,e,t,r,n)})).catch((function(o){if(!r.decryptdata)throw o;return e.open("POST",t,!0),a.call(i.hls,e,t,r,n)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||n}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))},t.requestLicense=function(e,t){var r=this,n=this.config.keyLoadPolicy.default;return new Promise((function(i,a){var o=r.getLicenseServerUrl(e.keySystem);r.log("Sending license request to URL: "+o);var s=new XMLHttpRequest;s.responseType="arraybuffer",s.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(4===s.readyState)if(200===s.status){r._requestLicenseFailureCount=0;var l=s.response;r.log("License received "+(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,s,o,e)}catch(e){r.error(e)}i(l)}else{var c=n.errorRetry,f=c?c.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>f||s.status>=400&&s.status<500)a(new Io({type:I.KEY_SYSTEM_ERROR,details:w.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:s,response:{url:o,data:void 0,code:s.status,text:s.statusText}},"License Request XHR failed ("+o+"). Status: "+s.status+" ("+s.statusText+")"));else{var d=f-r._requestLicenseFailureCount+1;r.warn("Retrying license request, "+d+" attempts left"),r.requestLicense(e,t).then(i,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=s,r.setupLicenseXHR(s,o,e,t).then((function(e){var t=e.xhr,r=e.licenseChallenge;t.send(r)}))}))},t.onMediaAttached=function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}},t.onMediaDetached=function(){var t=this,r=this.media,n=this.mediaKeySessions;r&&(r.removeEventListener("encrypted",this.onMediaEncrypted),r.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},nt.clearKeyUriToKeyIdMap();var i=n.length;e.CDMCleanupPromise=Promise.all(n.map((function(e){return t.removeSession(e)})).concat(null==r?void 0:r.setMediaKeys(null).catch((function(e){t.log("Could not clear media keys: "+e+". media.src: "+(null==r?void 0:r.src))})))).then((function(){i&&(t.log("finished closing key sessions and clearing media keys"),n.length=0)})).catch((function(e){t.log("Could not close sessions and clear media keys: "+e+". media.src: "+(null==r?void 0:r.src))}))},t.onManifestLoading=function(){this.keyFormatPromise=null},t.onManifestLoaded=function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var n=r.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys "+n.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(n)}},t.removeSession=function(e){var t=this,r=e.mediaKeysSession,n=e.licenseXhr;if(r){this.log("Remove licenses and keys and close session "+r.sessionId),r.onmessage=null,r.onkeystatuseschange=null,n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),r.remove().catch((function(e){t.log("Could not remove session: "+e)})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: "+e)}))}},e}();Ro.CDMCleanupPromise=void 0;var Io=function(e){function t(t,r){var n;return(n=e.call(this,r)||this).data=void 0,t.error||(t.error=new Error(r)),n.data=t,t.err=t.error,n}return l(t,e),t}(g(Error)),wo=1,Do={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},Co="h",No=function(){function e(t){var r=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){r.initialized&&(r.starved=!0),r.buffering=!0},this.onPlaying=function(){r.initialized||(r.initialized=!0),r.buffering=!1},this.applyPlaylistData=function(e){try{r.apply(e,{ot:Do.MANIFEST,su:!r.initialized})}catch(e){M.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var t=e.frag,n=r.hls.levels[t.level],i=r.getObjectType(t),a={d:1e3*t.duration,ot:i};i!==Do.VIDEO&&i!==Do.AUDIO&&i!=Do.MUXED||(a.br=n.bitrate/1e3,a.tb=r.getTopBandwidth(i)/1e3,a.bl=r.getBufferLength(i)),r.apply(e,a)}catch(e){M.warn("Could not generate segment CMCD data.",e)}},this.hls=t;var n=this.config=t.config,i=n.cmcd;null!=i&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.uuid(),this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.registerListeners())}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(R.MEDIA_DETACHED,this.onMediaDetached,this),e.on(R.BUFFER_CREATED,this.onBufferCreated,this)},t.unregisterListeners=function(){var e=this.hls;e.off(R.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(R.MEDIA_DETACHED,this.onMediaDetached,this),e.off(R.BUFFER_CREATED,this.onBufferCreated,this)},t.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},t.onMediaAttached=function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},t.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},t.onBufferCreated=function(e,t){var r,n;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=t.tracks.video)?void 0:n.buffer},t.createData=function(){var e;return{v:wo,sf:Co,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},t.apply=function(t,r){void 0===r&&(r={}),s(r,this.createData());var n=r.ot===Do.INIT||r.ot===Do.VIDEO||r.ot===Do.MUXED;if(this.starved&&n&&(r.bs=!0,r.su=!0,this.starved=!1),null==r.su&&(r.su=this.buffering),this.useHeaders){var i=e.toHeaders(r);if(!Object.keys(i).length)return;t.headers||(t.headers={}),s(t.headers,i)}else{var a=e.toQuery(r);if(!a)return;t.url=e.appendQueryToUri(t.url,a)}},t.getObjectType=function(e){var t=e.type;return"subtitle"===t?Do.TIMED_TEXT:"initSegment"===e.sn?Do.INIT:"audio"===t?Do.AUDIO:"main"===t?this.hls.audioTracks.length?Do.VIDEO:Do.MUXED:void 0},t.getTopBandwidth=function(e){var t,r=0,n=this.hls;if(e===Do.AUDIO)t=n.audioTracks;else{var i=n.maxAutoLevel,a=i>-1?i+1:n.levels.length;t=n.levels.slice(0,a)}for(var o,s=y(t);!(o=s()).done;){var l=o.value;l.bitrate>r&&(r=l.bitrate)}return r>0?r:NaN},t.getBufferLength=function(e){var t=this.hls.media,r=e===Do.AUDIO?this.audioBuffer:this.videoBuffer;return r&&t?1e3*qr.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN},t.createPlaylistLoader=function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var n=e.prototype;return n.destroy=function(){this.loader.destroy()},n.abort=function(){this.loader.abort()},n.load=function(e,r,n){t(e),this.loader.load(e,r,n)},a(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},t.createFragmentLoader=function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(e){this.loader=void 0,this.loader=new r(e)}var n=e.prototype;return n.destroy=function(){this.loader.destroy()},n.abort=function(){this.loader.abort()},n.load=function(e,r,n){t(e),this.loader.load(e,r,n)},a(e,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()},e.uuid=function(){var e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)},e.serialize=function(e){for(var t,r=[],n=function(e){return!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e},i=function(e){return Math.round(e)},a=function(e){return 100*i(e/100)},o=function(e){return encodeURIComponent(e)},s={br:i,d:i,bl:a,dl:a,mtp:a,nor:o,rtp:a,tb:i},l=y(Object.keys(e||{}).sort());!(t=l()).done;){var u=t.value,c=e[u];if(n(c)&&!("v"===u&&1===c||"pr"==u&&1===c)){var f=s[u];f&&(c=f(c));var d=typeof c,h=void 0;h="ot"===u||"sf"===u||"st"===u?u+"="+c:"boolean"===d?u:"number"===d?u+"="+c:u+"="+JSON.stringify(c),r.push(h)}}return r.join(",")},e.toHeaders=function(t){for(var r={},n=["Object","Request","Session","Status"],i=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},o=0,s=Object.keys(t);o<s.length;o++){var l=s[o];i[null!=a[l]?a[l]:1][l]=t[l]}for(var u=0;u<i.length;u++){var c=e.serialize(i[u]);c&&(r["CMCD-"+n[u]]=c)}return r},e.toQuery=function(t){return"CMCD="+encodeURIComponent(e.serialize(t))},e.appendQueryToUri=function(e,t){if(!t)return e;var r=e.includes("?")?"&":"?";return""+e+r+t},e}(),Lo=3e5,Oo=function(){function e(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=M.log.bind(M,"[content-steering]:"),this.registerListeners()}var t=e.prototype;return t.registerListeners=function(){var e=this.hls;e.on(R.MANIFEST_LOADING,this.onManifestLoading,this),e.on(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(R.MANIFEST_PARSED,this.onManifestParsed,this),e.on(R.ERROR,this.onError,this)},t.unregisterListeners=function(){var e=this.hls;e&&(e.off(R.MANIFEST_LOADING,this.onManifestLoading,this),e.off(R.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(R.MANIFEST_PARSED,this.onManifestParsed,this),e.off(R.ERROR,this.onError,this))},t.startLoad=function(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){var e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)},t.stopLoad=function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)},t.destroy=function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null},t.removeLevel=function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})))},t.onManifestLoading=function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null},t.onManifestLoaded=function(e,t){var r=t.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())},t.onManifestParsed=function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks},t.onError=function(e,t){var r=t.errorAction;if((null==r?void 0:r.action)===Rr.SendAlternateToPenaltyBox&&r.flags===Ir.MoveAllAlternatesMatchingHost){var n=this.pathwayPriority,i=this.pathwayId;this.penalizedPathways[i]||(this.penalizedPathways[i]=performance.now()),!n&&this.levels&&(n=this.levels.reduce((function(e,t){return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])),n&&n.length>1&&(this.updatePathwayPriority(n),r.resolved=this.pathwayId!==i)}},t.filterParsedLevels=function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var r=e[0].pathwayId;this.log("No levels found in Pathway "+this.pathwayId+'. Setting initial Pathway to "'+r+'"'),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length?(this.log("Found "+t.length+"/"+e.length+' levels in Pathway "'+this.pathwayId+'"'),t):e},t.getLevelsForPathway=function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))},t.updatePathwayPriority=function(e){var t;this.pathwayPriority=e;var r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((function(e){n-r[e]>Lo&&delete r[e]}));for(var i=0;i<e.length;i++){var a=e[i];if(!r[a]){if(a===this.pathwayId)return;var o=this.hls.nextLoadLevel,s=this.hls.levels[o];if((t=this.getLevelsForPathway(a)).length>0){this.log('Setting Pathway to "'+a+'"'),this.pathwayId=a,this.hls.trigger(R.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[o];s&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==s.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==s.bitrate&&this.log("Unstable Pathways change from bitrate "+s.bitrate+" to "+l.bitrate),this.hls.nextLoadLevel=o);break}}}},t.clonePathways=function(e){var t=this,r=this.levels;if(r){var n={},i={};e.forEach((function(e){var a=e.ID,o=e["BASE-ID"],l=e["URI-REPLACEMENT"];if(!r.some((function(e){return e.pathwayId===a}))){var u=t.getLevelsForPathway(o).map((function(e){var t=s({},e);t.details=void 0,t.url=Mo(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l);var r=new F(e.attrs);r["PATHWAY-ID"]=a;var o=r.AUDIO&&r.AUDIO+"_clone_"+a,u=r.SUBTITLES&&r.SUBTITLES+"_clone_"+a;o&&(n[r.AUDIO]=o,r.AUDIO=o),u&&(i[r.SUBTITLES]=u,r.SUBTITLES=u),t.attrs=r;var c=new $t(t);return Or(c,"audio",o),Or(c,"text",u),c}));r.push.apply(r,u),Po(t.audioTracks,n,l,a),Po(t.subtitleTracks,i,l,a)}}))}},t.loadSteeringManifest=function(e){var t,r=this,n=this.hls.config,i=n.loader;this.loader&&this.loader.destroy(),this.loader=new i(n);try{t=new self.URL(e)}catch(t){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: "+e)}if("data:"!==t.protocol){var a=0|(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+a)}var o={responseType:"json",url:t.href},s=n.steeringManifestLoadPolicy.default,l=s.errorRetry||s.timeoutRetry||{},u={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},c={onSuccess:function(e,n,i,a){r.log('Loaded steering manifest: "'+t+'"');var o=e.data;if(1===o.VERSION){r.updated=performance.now(),r.timeToLoad=o.TTL;var s=o["RELOAD-URI"],l=o["PATHWAY-CLONES"],u=o["PATHWAY-PRIORITY"];if(s)try{r.uri=new self.URL(s,t).href}catch(e){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: "+s)}r.scheduleRefresh(r.uri||i.url),l&&r.clonePathways(l),u&&r.updatePathwayPriority(u)}else r.log("Steering VERSION "+o.VERSION+" not supported!")},onError:function(e,t,n,i){if(r.log("Error loading steering manifest: "+e.code+" "+e.text+" ("+t.url+")"),r.stopLoad(),410===e.code)return r.enabled=!1,void r.log("Steering manifest "+t.url+" no longer available");var a=1e3*r.timeToLoad;if(429!==e.code)r.scheduleRefresh(r.uri||t.url,a);else{var o=r.loader;if("function"==typeof(null==o?void 0:o.getResponseHeader)){var s=o.getResponseHeader("Retry-After");s&&(a=1e3*parseFloat(s))}r.log("Steering manifest "+t.url+" rate limited")}},onTimeout:function(e,t,n){r.log("Timeout loading steering manifest ("+t.url+")"),r.scheduleRefresh(r.uri||t.url)}};this.log("Requesting steering manifest: "+t),this.loader.load(o,u,c)},t.scheduleRefresh=function(e,t){var r=this;void 0===t&&(t=1e3*this.timeToLoad),self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout((function(){r.loadSteeringManifest(e)}),t)},e}();function Po(e,t,r,n){e&&Object.keys(t).forEach((function(i){var a=e.filter((function(e){return e.groupId===i})).map((function(e){var a=s({},e);return a.details=void 0,a.attrs=new F(a.attrs),a.url=a.attrs.URI=Mo(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),a.groupId=a.attrs["GROUP-ID"]=t[i],a.attrs["PATHWAY-ID"]=n,a}));e.push.apply(e,a)}))}function Mo(e,t,r,n){var i,a=n.HOST,o=n.PARAMS,s=n[r];t&&(i=null==s?void 0:s[t])&&(e=i);var l=new self.URL(e);return a&&!i&&(l.host=a),o&&Object.keys(o).sort().forEach((function(e){e&&l.searchParams.set(e,o[e])})),l.href}var ko=/^age:\s*[\d.]+\s*$/im,xo=function(){function e(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new G,this.retryDelay=0}var t=e.prototype;return t.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},t.abortInternal=function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},t.load=function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()},t.loadInternal=function(){var e=this,t=this.config,r=this.context;if(t){var n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;var a=this.xhrSetup;a?Promise.resolve().then((function(){if(!e.stats.aborted)return a(n,r.url)})).catch((function(e){return n.open("GET",r.url,!0),a(n,r.url)})).then((function(){e.stats.aborted||e.openAndSendXhr(n,r,t)})).catch((function(t){e.callbacks.onError({code:n.status,text:t.message},r,n,i)})):this.openAndSendXhr(n,r,t)}},t.openAndSendXhr=function(e,t,r){e.readyState||e.open("GET",t.url,!0);var n=this.context.headers,i=r.loadPolicy,a=i.maxTimeToFirstByteMs,o=i.maxLoadTimeMs;if(n)for(var s in n)e.setRequestHeader(s,n[s]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&b(a)?a:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()},t.readystatechange=function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var n=t.readyState,i=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var a=t.status,o="text"!==t.responseType;if(a>=200&&a<300&&(o&&t.response||null!==t.responseText)){r.loading.end=Math.max(self.performance.now(),r.loading.first);var s=o?t.response:t.responseText,l="arraybuffer"===t.responseType?s.byteLength:s.length;if(r.loaded=r.total=l,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first),!this.callbacks)return;var u=this.callbacks.onProgress;if(u&&u(r,e,s,t),!this.callbacks)return;var c={url:t.responseURL,data:s,code:a};this.callbacks.onSuccess(c,r,e,t)}else{var f=i.loadPolicy.errorRetry;mr(f,r.retry,!1,a)?this.retry(f):(M.error(a+" while loading "+e.url),this.callbacks.onError({code:a,text:t.statusText},e,t,r))}}}},t.loadtimeout=function(){var e,t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry;if(mr(t,this.stats.retry,!0))this.retry(t);else{M.warn("timeout while loading "+this.context.url);var r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}},t.retry=function(e){var t=this.context,r=this.stats;this.retryDelay=gr(e,r.retry),r.retry++,M.warn((status?"HTTP Status "+status:"Timeout")+" while loading "+t.url+", retrying "+r.retry+"/"+e.maxNumRetry+" in "+this.retryDelay+"ms"),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)},t.loadprogress=function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)},t.getCacheAge=function(){var e=null;if(this.loader&&ko.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.loader&&new RegExp("^"+e+":\\s*[\\d.]+\\s*$","im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null},e}();function Fo(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var Uo=/(\d+)-(\d+)\/(\d+)/,Bo=function(){function e(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||Ho,this.controller=new self.AbortController,this.stats=new G}var t=e.prototype;return t.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},t.abortInternal=function(){var e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())},t.abort=function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},t.load=function(e,t,r){var n=this,i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();var a=Zo(e,this.controller.signal),o=r.onProgress,s="arraybuffer"===e.responseType,l=s?"byteLength":"length",u=t.loadPolicy,c=u.maxTimeToFirstByteMs,f=u.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=c&&b(c)?c:f,this.requestTimeout=self.setTimeout((function(){n.abortInternal(),r.onTimeout(i,e,n.response)}),t.timeout),self.fetch(this.request).then((function(a){n.response=n.loader=a;var l=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(n.requestTimeout),t.timeout=f,n.requestTimeout=self.setTimeout((function(){n.abortInternal(),r.onTimeout(i,e,n.response)}),f-(l-i.loading.start)),!a.ok){var u=a.status,c=a.statusText;throw new Yo(c||"fetch, bad network response",u,a)}return i.loading.first=l,i.total=Ko(a.headers)||i.total,o&&b(t.highWaterMark)?n.loadProgressively(a,i,e,t.highWaterMark,o):s?a.arrayBuffer():"json"===e.responseType?a.json():a.text()})).then((function(a){var s=n.response;self.clearTimeout(n.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);var u=a[l];u&&(i.loaded=i.total=u);var c={url:s.url,data:a,code:s.status};o&&!b(t.highWaterMark)&&o(i,e,a,s),r.onSuccess(c,i,e,s)})).catch((function(t){if(self.clearTimeout(n.requestTimeout),!i.aborted){var a=t&&t.code||0,o=t?t.message:null;r.onError({code:a,text:o},e,t?t.details:null,i)}}))},t.getCacheAge=function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e},t.getResponseHeader=function(e){return this.response?this.response.headers.get(e):null},t.loadProgressively=function(e,t,r,n,i){void 0===n&&(n=0);var a=new ra,o=e.body.getReader();return function s(){return o.read().then((function(o){if(o.done)return a.dataLength&&i(t,r,a.flush(),e),Promise.resolve(new ArrayBuffer(0));var l=o.value,u=l.length;return t.loaded+=u,u<n||a.dataLength?(a.push(l),a.dataLength>=n&&i(t,r,a.flush(),e)):i(t,r,l,e),s()})).catch((function(){return Promise.reject()}))}()},e}();function Zo(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(s({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}function Go(e){var t=Uo.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}function Ko(e){var t=e.get("Content-Range");if(t){var r=Go(t);if(b(r))return r}var n=e.get("Content-Length");if(n)return parseInt(n)}function Ho(e,t){return new self.Request(e.url,t)}var Yo=function(e){function t(t,r,n){var i;return(i=e.call(this,t)||this).code=void 0,i.details=void 0,i.code=r,i.details=n,i}return l(t,e),t}(g(Error)),Vo=/\s/,qo={newCue:function(e,t,r,n){for(var i,a,o,s,l,u=[],c=self.VTTCue||self.TextTrackCue,f=0;f<n.rows.length;f++)if(o=!0,s=0,l="",!(i=n.rows[f]).isEmpty()){for(var d,h=0;h<i.chars.length;h++)Vo.test(i.chars[h].uchar)&&o?s++:(l+=i.chars[h].uchar,o=!1);i.cueStartTime=t,t===r&&(r+=1e-4),s>=16?s--:s++;var g=ja(l.trim()),p=$a(t,r,g);null!=e&&null!=(d=e.cues)&&d.getCueById(p)||((a=new c(t,r,g)).id=p,a.line=f+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(a))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return xt(e,t)}))),u}},jo=n(n({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:xo,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:ta,bufferController:va,capLevelController:So,errorController:wr,fpsController:Ao,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:oe,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},zo()),{},{subtitleStreamController:ca,subtitleTrackController:da,timelineController:yo,audioStreamController:aa,audioTrackController:oa,emeController:Ro,cmcdController:No,contentSteeringController:Oo});function zo(){return{cueHandler:qo,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Wo(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var r=Xo(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((function(e){var n=("level"===e?"playlist":e)+"LoadPolicy",a=void 0===t[n],o=[];i.forEach((function(i){var s=e+"Loading"+i,l=t[s];if(void 0!==l&&a){o.push(s);var u=r[n].default;switch(t[n]={default:u},i){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l}}})),o.length&&M.warn('hls.js config: "'+o.join('", "')+'" setting(s) are deprecated, use "'+n+'": '+JSON.stringify(t[n]))})),n(n({},r),t)}function Xo(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Xo):Object.keys(e).reduce((function(t,r){return t[r]=Xo(e[r]),t}),{}):e}function Qo(e){var t=e.loader;t!==Bo&&t!==xo?(M.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):Fo()&&(e.loader=Bo,e.progressive=!0,e.enableSoftwareAES=!0,M.log("[config]: Progressive streaming enabled, using FetchLoader"))}var Jo=function(){function e(t){void 0===t&&(t={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new ki,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,P(t.debug||!1,"Hls instance");var r=this.config=Wo(e.DefaultConfig,t);this.userConfig=t,this._autoLevelCapping=-1,r.progressive&&Qo(r);var n=r.abrController,i=r.bufferController,a=r.capLevelController,o=r.errorController,s=r.fpsController,l=new o(this),u=this.abrController=new n(this),c=this.bufferController=new i(this),f=this.capLevelController=new a(this),d=new s(this),h=new Mt(this),g=new jt(this),p=r.contentSteeringController,m=p?new p(this):null,v=this.levelController=new Lr(this,m),y=new kr(this),E=new Hr(this.config),T=this.streamController=new Ji(this,y,E);f.setStreamController(T),d.setStreamController(T);var _=[h,v,T];m&&_.splice(1,0,m),this.networkControllers=_;var S=[u,c,f,d,g,y];this.audioTrackController=this.createController(r.audioTrackController,_);var A=r.audioStreamController;A&&_.push(new A(this,y,E)),this.subtitleTrackController=this.createController(r.subtitleTrackController,_);var b=r.subtitleStreamController;b&&_.push(new b(this,y,E)),this.createController(r.timelineController,S),E.emeController=this.emeController=this.createController(r.emeController,S),this.cmcdController=this.createController(r.cmcdController,S),this.latencyController=this.createController(zt,S),this.coreComponents=S,_.push(l);var I=l.onErrorOut;"function"==typeof I&&this.on(R.ERROR,I,l)}e.isSupported=function(){return pn()};var t=e.prototype;return t.createController=function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null},t.on=function(e,t,r){void 0===r&&(r=this),this._emitter.on(e,t,r)},t.once=function(e,t,r){void 0===r&&(r=this),this._emitter.once(e,t,r)},t.removeAllListeners=function(e){this._emitter.removeAllListeners(e)},t.off=function(e,t,r,n){void 0===r&&(r=this),this._emitter.off(e,t,r,n)},t.listeners=function(e){return this._emitter.listeners(e)},t.emit=function(e,t,r){return this._emitter.emit(e,t,r)},t.trigger=function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){M.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(R.ERROR,{type:I.OTHER_ERROR,details:w.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1},t.listenerCount=function(e){return this._emitter.listenerCount(e)},t.destroy=function(){M.log("destroy"),this.trigger(R.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null},t.attachMedia=function(e){M.log("attachMedia"),this._media=e,this.trigger(R.MEDIA_ATTACHING,{media:e})},t.detachMedia=function(){M.log("detachMedia"),this.trigger(R.MEDIA_DETACHING,void 0),this._media=null},t.loadSource=function(e){this.stopLoad();var t=this.media,r=this.url,n=this.url=A.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});M.log("loadSource:"+n),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(R.MANIFEST_LOADING,{url:e})},t.startLoad=function(e){void 0===e&&(e=-1),M.log("startLoad("+e+")"),this.networkControllers.forEach((function(t){t.startLoad(e)}))},t.stopLoad=function(){M.log("stopLoad"),this.networkControllers.forEach((function(e){e.stopLoad()}))},t.swapAudioCodec=function(){M.log("swapAudioCodec"),this.streamController.swapAudioCodec()},t.recoverMediaError=function(){M.log("recoverMediaError");var e=this._media;this.detachMedia(),e&&this.attachMedia(e)},t.removeLevel=function(e,t){void 0===t&&(t=0),this.levelController.removeLevel(e,t)},a(e,[{key:"levels",get:function(){var e=this.levelController.levels;return e||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){M.log("set currentLevel:"+e),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){M.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){M.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){M.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){M.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(M.log("set autoLevelCapping:"+e),this._autoLevelCapping=e)}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){Wt.indexOf(e)>-1&&(this._maxHdcpLevel=e)}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,n=this.maxHdcpLevel;if(e=-1===r&&t&&t.length?t.length-1:r,n)for(var i=e;i--;){var a=t[i].attrs["HDCP-LEVEL"];if(a&&a<=n)return i}return e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.4.10"}},{key:"Events",get:function(){return R}},{key:"ErrorTypes",get:function(){return I}},{key:"ErrorDetails",get:function(){return w}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:jo},set:function(t){e.defaultConfig=t}}]),e}();return Jo.defaultConfig=void 0,Jo}()}(!1)},607:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newPlayer=void 0;var n=r(582),i=r(274),a=r(860),o=r(622);n.__exportStar(r(287),t),n.__exportStar(r(251),t),n.__exportStar(r(860),t),n.__exportStar(r(274),t),t.newPlayer=function(e,t,r){if(r&&r.type)return"application/dash+xml"===r.type?new i.PlayerDash(e,t,r):"application/x-mpegURL"===r.type?new a.PlayerHls(e,t,r):new o.PlayerNative(e,t,r);var n=e.substring(e.lastIndexOf("/")+1).split(".").pop();return"m3u8"===n?new a.PlayerHls(e,t,r):"mpd"===n?new i.PlayerDash(e,t,r):new o.PlayerNative(e,t,r)}},287:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerType=void 0,t.PlayerType=["DASH","HLS","NATIVE"]},274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerDash=void 0;var n=r(582),i=n.__importStar(r(176)),a=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n.__extends(t,e),t.getCodecName=function(e){var t=/"(.*?)"/g.exec(e);if(t&&t.length>0&&t[1])return t[1]},t.prototype.load=function(){this.reset();try{this.player=i.MediaPlayer().create(),this.player.updateSettings({debug:{logLevel:0}}),this.player.initialize(this.htmlPlayer,this.url,!1),this.config&&"number"==typeof this.config.initialRenditionKbps&&(this.config.initialRenditionKbps>=0?this.player.updateSettings({streaming:{abr:{autoSwitchBitrate:{audio:!0,video:!1},initialBitrate:{video:this.config.initialRenditionKbps}},lastBitrateCachingInfo:{enabled:!1}}}):this.player.updateSettings({streaming:{abr:{autoSwitchBitrate:{audio:!0,video:!0}},lastBitrateCachingInfo:{enabled:!1}}})),this.initListeners(),this.playerType="DASH"}catch(e){console.error(e)}},t.prototype.destroy=function(){try{this.htmlPlayer.src="",void 0!==this.player&&this.player.reset()}catch(e){console.error(e)}finally{this.htmlPlayer.pause(),this.htmlPlayer.removeAttribute("src"),this.htmlPlayer.load(),this.playerType=void 0,this.reset()}},t.prototype.getRenditions=function(){if(void 0!==this.player)return this.convertBitratesToIRenditions(this.player.getBitrateInfoListFor("video"))},t.prototype.setRendition=function(e,t){if(void 0!==this.player){if("number"!=typeof e){var r=this.getRenditions();if(void 0!==r&&r.length>0)for(var n=0;n<r.length;n++)if(r[n].bitrate===e.bitrate)return this.setRendition(n,t);return this.setRendition(-1,t)}-1===e?this.player.updateSettings({streaming:{abr:{autoSwitchBitrate:{audio:!0,video:!0}}}}):(this.player.updateSettings({streaming:{abr:{autoSwitchBitrate:{audio:!0,video:!1}},lastBitrateCachingInfo:{enabled:!1}}}),this.player.setQualityFor("video",e))}},t.prototype.getCurrentRendition=function(){if(void 0!==this.player){var e=this.getRenditions();if(void 0!==e&&e.length>0){var t=this.player.getQualityFor("video");if(t>=0&&e.length>t)return e[t]}}},t.prototype.convertBitratesToIRenditions=function(e){if(void 0!==e&&0!==e.length){var r,n;try{r=this.player.getCurrentTrackFor("video")}catch(e){}try{n=this.player.getCurrentTrackFor("audio")}catch(e){}return e.map((function(e){return{audioCodec:n&&n.codec?t.getCodecName(n.codec):void 0,bitrate:void 0!==e.bitrate?e.bitrate:void 0,height:void 0!==e.height?e.height:void 0,level:void 0!==e.qualityIndex?e.qualityIndex:void 0,videoCodec:r&&r.codec?t.getCodecName(r.codec):void 0,width:void 0!==e.width?e.width:void 0}}))}},t}(r(251).Player);t.PlayerDash=a},860:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerHls=void 0;var n=r(582),i=n.__importDefault(r(631)),a=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n.__extends(t,e),t.convertLevelsToIRenditions=function(e){if(void 0!==e&&0!==e.length)return e.map((function(e,t){return{audioCodec:void 0!==e.audioCodec?e.audioCodec:void 0,bitrate:void 0!==e.bitrate?e.bitrate:void 0,height:void 0!==e.height?e.height:void 0,level:t,name:void 0!==e.name?e.name:void 0,videoCodec:void 0!==e.videoCodec?e.videoCodec:void 0,width:void 0!==e.width?e.width:void 0}}))},t.prototype.load=function(){var e=this;this.reset();try{if(i.default.isSupported()){if(this.player=new i.default,this.player.loadSource(this.url),this.player.attachMedia(this.htmlPlayer),this.config&&"number"==typeof this.config.initialRenditionIndex)if(this.config.initialRenditionIndex>=0){var t=function(t,r){e.config.initialRenditionIndex>r.levels.length-1?e.player.loadLevel=r.levels.length-1:e.player.loadLevel=e.config.initialRenditionIndex};this.player.on(i.default.Events.MANIFEST_PARSED,t),this.player.off(i.default.Events.MANIFEST_PARSED,t)}else this.player.loadLevel=-1}else this.htmlPlayer.canPlayType("application/vnd.apple.mpegurl")&&(this.player=void 0,this.htmlPlayer.src=this.url);this.initListeners(),this.playerType="HLS"}catch(e){console.error(e)}},t.prototype.destroy=function(){try{this.htmlPlayer.src="",void 0!==this.player&&this.player.destroy()}catch(e){console.error(e)}finally{this.htmlPlayer.pause(),this.htmlPlayer.removeAttribute("src"),this.htmlPlayer.load(),this.playerType=void 0,this.reset()}},t.prototype.getRenditions=function(){if(void 0!==this.player)return t.convertLevelsToIRenditions(this.player.levels)},t.prototype.setRendition=function(e,t){if(void 0!==this.player){if("number"!=typeof e){var r=this.getRenditions();if(void 0!==r&&r.length>0)for(var n=0;n<r.length;n++)if(r[n].bitrate===e.bitrate)return this.setRendition(n,t);return this.setRendition(-1,t)}t?this.player.currentLevel=e:this.player.loadLevel=e}},t.prototype.getCurrentRendition=function(){if(void 0!==this.player){var e=this.getRenditions();if(void 0!==e&&e.length>0){var t=this.player.currentLevel;if(t>=0&&e.length>t)return e[t]}}},t}(r(251).Player);t.PlayerHls=a},622:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerNative=void 0;var n=r(582),i=function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return n.__extends(t,e),t.prototype.load=function(){this.reset(),this.player=this.htmlPlayer,this.htmlPlayer.src=this.url,this.playerType="NATIVE",this.initListeners()},t.prototype.destroy=function(){this.htmlPlayer.pause(),this.htmlPlayer.removeAttribute("src"),this.htmlPlayer.load(),this.playerType=void 0,this.reset()},t.prototype.getRenditions=function(){return[]},t.prototype.setRendition=function(e,t){},t.prototype.getCurrentRendition=function(){},t}(r(251).Player);t.PlayerNative=i},251:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;var n=r(582),i=n.__importStar(r(593)),a=function(){function e(e,t,r){var n=this;this.url=e,this.htmlPlayer=t,this.config=r,this.updateStats=function(){n.stats={buffered:i.timeRangesToITimeRanges(i.getBuffered(n.htmlPlayer)),droppedFrames:i.getDroppedFrames(n.htmlPlayer),duration:i.getDuration(n.htmlPlayer),loadTime:n.stats.loadTime,played:i.timeRangesToITimeRanges(i.getPlayed(n.htmlPlayer)),seekable:i.timeRangesToITimeRanges(i.getSeekable(n.htmlPlayer))}},this.loadStart=function(){n.updateStats(),-1===n.stats.loadTime&&(n.loadStartTime=(new Date).getTime())},this.loadEnd=function(){n.updateStats(),-1===n.stats.loadTime&&(n.stats.loadTime=((new Date).getTime()-n.loadStartTime)/1e3),n.updateStats()},this.resetStats(),this.load(),this.initListeners()}return e.prototype.getStats=function(){return this.stats},e.prototype.pause=function(){this.htmlPlayer.pause()},e.prototype.play=function(){return n.__awaiter(this,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,this.htmlPlayer.play()];case 1:return e.sent(),[2]}}))}))},e.prototype.currentTime=function(e){if(void 0===e)return this.htmlPlayer.currentTime;this.htmlPlayer.currentTime=e},e.prototype.volume=function(e){if(void 0===e)return this.htmlPlayer.volume;this.htmlPlayer.volume=e},e.prototype.playbackRate=function(e){if(void 0===e)return this.htmlPlayer.playbackRate;this.htmlPlayer.playbackRate=e},e.prototype.reset=function(){this.destroyListeners(),this.resetStats()},e.prototype.resetStats=function(){this.stats={buffered:[],droppedFrames:0,duration:0,loadTime:-1,played:[],seekable:[]}},e.prototype.initListeners=function(){this.htmlPlayer.addEventListener("timeupdate",this.updateStats),this.htmlPlayer.addEventListener("loadstart",this.loadStart),this.htmlPlayer.addEventListener("canplay",this.loadEnd)},e.prototype.destroyListeners=function(){this.htmlPlayer.removeEventListener("timeupdate",this.updateStats),this.htmlPlayer.removeEventListener("loadstart",this.loadStart),this.htmlPlayer.removeEventListener("canplay",this.loadEnd)},e}();t.Player=a},593:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timeRangesToITimeRanges=t.getPlayed=t.getSeekable=t.getBuffered=t.getDuration=t.getDroppedFrames=void 0,t.getDroppedFrames=function(e){if(e)return e.getVideoPlaybackQuality().droppedVideoFrames},t.getDuration=function(e){if(e)return e.duration},t.getBuffered=function(e){if(e)return e.buffered},t.getSeekable=function(e){if(e)return e.seekable},t.getPlayed=function(e){if(e)return e.played},t.timeRangesToITimeRanges=function(e){var t=[];if(e&&e.length>0)for(var r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}},582:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__addDisposableResource:()=>M,__assign:()=>a,__asyncDelegator:()=>R,__asyncGenerator:()=>b,__asyncValues:()=>I,__await:()=>A,__awaiter:()=>g,__classPrivateFieldGet:()=>L,__classPrivateFieldIn:()=>P,__classPrivateFieldSet:()=>O,__createBinding:()=>m,__decorate:()=>s,__disposeResources:()=>x,__esDecorate:()=>u,__exportStar:()=>v,__extends:()=>i,__generator:()=>p,__importDefault:()=>N,__importStar:()=>C,__makeTemplateObject:()=>w,__metadata:()=>h,__param:()=>l,__propKey:()=>f,__read:()=>E,__rest:()=>o,__runInitializers:()=>c,__setFunctionName:()=>d,__spread:()=>T,__spreadArray:()=>S,__spreadArrays:()=>_,__values:()=>y,default:()=>F});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function l(e,t){return function(r,n){t(r,n,e)}}function u(e,t,r,n,i,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=n.kind,u="getter"===l?"get":"setter"===l?"set":"value",c=!t&&e?n.static?e:e.prototype:null,f=t||(c?Object.getOwnPropertyDescriptor(c,n.name):{}),d=!1,h=r.length-1;h>=0;h--){var g={};for(var p in n)g[p]="access"===p?{}:n[p];for(var p in n.access)g.access[p]=n.access[p];g.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var m=(0,r[h])("accessor"===l?{get:f.get,set:f.set}:f[u],g);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(s=o(m.get))&&(f.get=s),(s=o(m.set))&&(f.set=s),(s=o(m.init))&&i.unshift(s)}else(s=o(m))&&("field"===l?i.unshift(s):f[u]=s)}c&&Object.defineProperty(c,n.name,f),d=!0}function c(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function f(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function g(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function p(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var m=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||m(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function E(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function T(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(E(arguments[t]));return e}function _(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function S(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function A(e){return this instanceof A?(this.v=e,this):new A(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof A?Promise.resolve(r.value.v).then(l,u):c(a[0][2],r)}catch(e){c(a[0][3],e)}var r}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function R(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:A(e[n](t)),done:!1}:i?i(t):t}:i}}function I(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var D=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&m(t,e,r);return D(t,e),t}function N(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function O(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function P(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function M(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var k="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function x(e){function t(t){e.error=e.hasError?new k(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,(function(e){return t(e),r()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const F={__extends:i,__assign:a,__rest:o,__decorate:s,__param:l,__metadata:h,__awaiter:g,__generator:p,__createBinding:m,__exportStar:v,__values:y,__read:E,__spread:T,__spreadArrays:_,__spreadArray:S,__await:A,__asyncGenerator:b,__asyncDelegator:R,__asyncValues:I,__makeTemplateObject:w,__importStar:C,__importDefault:N,__classPrivateFieldGet:L,__classPrivateFieldSet:O,__classPrivateFieldIn:P,__addDisposableResource:M,__disposeResources:x}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}return r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(607)})()));